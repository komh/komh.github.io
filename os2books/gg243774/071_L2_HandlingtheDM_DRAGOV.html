<HTML>
<HEAD>
<TITLE>Handling the DM_DRAGOVER Message</TITLE>
</HEAD>
<BODY>
<H1>Handling the DM_DRAGOVER Message</H1><!-- entering slot 73 -->
<PRE>  PDRAGITEM pDItem;                             /* Pointer to DRAGITEM   */
  PDRAGINFO pDInfo;                             /* Pointer to DRAGINFO   */

  case DM_DRAGOVER:
       pdinfo = (PDRAGINFO)mp1;                 /* Get DRAGINFO pointer  */
       DrgAccessDraginfo(pdinfo);               /* Access DRAGINFO       */
       pditem = DrgQueryDragitemPtr(pdinfo,     /* Access DRAGITEM       */
                                    0);         /* Index to DRAGITEM     */
       if (!DrgVerifyRMF(pditem,                /* Check valid rendering */
                        "DRM_SHAREMEM",         /* mechanisms and data   */
                        "DRF_TEXT"))            /* formats               */
          {
          DrgFreeDraginfo(pdinfo);              /* Free DRAGINFO         */
          return(MPFROM2SHORT(DOR_DROP,         /* Return okay to drop   */
                              DO_COPY));        /* Copy operation valid  */
          }
       else
          {
         DrgFreeDraginfo(pdinfo);               /* Free DRAGINFO         */
         return(MPFROM2SHORT(DOR_NEVERDROP,     /* Drop not valid        */
                             0));               /* No valid operations   */
          }
       break;
</PRE>


<P><HR>

<A HREF="070_L2_ReceivingaDM_PRINTOB.html">[Back: Receiving a DM_PRINTOBJECT Message]</A> <BR>
<A HREF="072_L2_HandlingtheDM_DROPMe.html">[Next: Handling the DM_DROP Message]</A> 
</BODY>
</HTML>
