<HTML>
<HEAD>
<META HTTP-EQUIV="CONTENT-TYPE" CONTENT="TEXT/HTML; CHARSET=UTF-8">
<TITLE>Adding an Item to a Context Menu</TITLE>
</HEAD>
<BODY>
<H1>Adding an Item to a Context Menu</H1><!-- entering slot 48 -->
<PRE>#define MI_LOCK     WPMENUID_USER+1
   :
   :
SOM_Scope BOOL SOMLINK pwfolder_wpModifyPopupMenu(PWFolder *somSelf,
                                                  HWND hwndMenu,
                                                  HWND hwndCnr,
                                                  ULONG iPosition)
{
    PWFolderData *somThis =                     /* Get instance data     */
                 PWFolderGetData(somSelf);
    PWFolderMethodDebug("PWFolder",             /* Set debug info        */
                        "pwfolder_wpModifyPopupMenu");

    _wpInsertPopupMenuItems(somSelf,            /* Insert menu item      */
                            hwndMenu,           /* Menu handle           */
                            iPosition,          /* Default position      */
                            hModule,            /* Module handle         */
                            MI_LOCK,            /* Menu item id          */
                            0);                 /* No submenu id         */

    return(parent_wpModifyPopupMenu(somSelf,    /* Allow default proc to */
                                    hwndMenu,   /* occur                 */
                                    hwndCnr,
                                    iPosition));
}
</PRE>


<P><HR>

<A HREF="046_L2_AddingaNewMethod.html">[Back: Adding a New Method]</A> <BR>
<A HREF="048_L2_InvokingaMethodviaaC.html">[Next: Invoking a Method via a Context Menu Item]</A> 
</BODY>
</HTML>
