<HTML>
<HEAD>
<META HTTP-EQUIV="CONTENT-TYPE" CONTENT="TEXT/HTML; CHARSET=UTF-8">
<TITLE>Generic Subroutines</TITLE>
</HEAD>
<BODY>
<H1>Generic Subroutines</H1><!-- entering slot 487 -->
<P>
In addition to code reuse at the application object level, significant productivity
gains can be achieved by the reuse of application code at the subroutine
level, to carry out common operating system and Presentation Manager functions.

<P>
For example, initialization functions are required to perform tasks related
to initializing the Presentation Manager environment and any data areas
to be used by utility routines.  Functions required to be performed include:
<!-- lm: 0x2 0 -->
<P>
<LI><!-- lm: 0x2 2 -->Registration of the application to Presentation Manager
<!-- lm: 0x2 0 -->
<BR>
<LI><!-- lm: 0x2 2 -->Creation of a message queue<!-- lm: 0x2 0 -->
<BR>
<LI><!-- lm: 0x2 2 -->Creation of an entry in the Workplace Shell Window
List.<!-- lm: 0x2 0 -->
<BR>

<P>
These functions may be combined into one or more standard initialization
routines, which may be invoked upon entry to an application or thread. Examples
of the necessary code are given in <A HREF="024_L2_SampleApplicationMai.html">Figure
"Sample Application Main Routine (Part 1) - Registration"</A>, <A HREF="025_L2_SampleApplicationMai.html">Figure
"Sample Application Main Routine (Part 2) - Window Creation"</A> and <A HREF="026_L2_WinAddSwitchEntryFun.html">Figure
"WinAddSwitchEntry() Function"</A>.
<P>
Termination functions required by Presentation Manager applications could
also be standardized;  these functions include:<!-- lm: 0x2 0 -->
<P>
<LI><!-- lm: 0x2 2 -->Removing the application from the Workplace Shell
Window List<!-- lm: 0x2 0 -->
<BR>
<LI><!-- lm: 0x2 2 -->Destroying the application's main window<!-- lm: 0x2 0 -->
<BR>
<LI><!-- lm: 0x2 2 -->Destroying the primary thread's message queue<!-- lm: 0x2 0 -->
<BR>
<LI><!-- lm: 0x2 2 -->Deregistration of the application from the Presentation
Manager environment.<!-- lm: 0x2 0 -->
<BR>

<P>
These operations are performed by Presentation Manager upon termination
of the application if the application does not perform them explicitly.
 However, it is recommended that the application carries out these actions,
since they may then be achieved in a controlled manner.  Examples of the
necessary code are given in <A HREF="025_L2_SampleApplicationMai.html">Figure
"Sample Application Main Routine (Part 2) - Window Creation"</A>.
<P>
Other functions may often be required during the execution of an application,
such as:<!-- lm: 0x2 0 -->
<P>
<LI><!-- lm: 0x2 2 -->Obtaining the window handle of the application's main
client window. An example of this procedure is given in <A HREF="254_L3_IdentifyingtheDestin.html">Identifying
the Destination Window</A>.<!-- lm: 0x2 0 -->
<P>
<LI><!-- lm: 0x2 2 -->Passing a message from a subclass window procedure
to the original window procedure for that window class.  An example is given
in <A HREF="031_L2_SubclassWindowProced.html">Figure "Subclass Window Procedure"</A>.
<!-- lm: 0x2 0 -->
<BR>

<P>
These functions may also be combined into standard subroutines and placed
in a library, thereby avoiding the need for application developers to repetitively
code such functions.
<P>
A final function often used in the stepwise development of object-oriented
Presentation Manager applications is a small routine to display a message
box with the message "Action Not Yet Implemented", invoked when the user
selects a menu bar or pulldown entry for which a method has not yet been
coded.  This function is typically invoked as the default case for the WM_COMMAND
message class.  In this way, methods within a window procedure may be implemented
in a stepwise manner, and testing of existing methods may occur while new
ones are being added.  Selecting an action for which no method has yet been
implemented will always result in the same message box being displayed.


<P><HR>

<A HREF="443_L2_DialogBoxes.html">[Back: Dialog Boxes]</A> <BR>
<A HREF="445_L2_Granularity.html">[Next: Granularity]</A> 
</BODY>
</HTML>
