<HTML>
<HEAD>
<META HTTP-EQUIV="CONTENT-TYPE" CONTENT="TEXT/HTML; CHARSET=UTF-8">
<TITLE>Creating a DLL</TITLE>
<STYLE>
PRE {
  FONT-FAMILY: Consolas, "Lucida Console", "Courier New", Courier, MONOSPACE;
}
</STYLE>
</HEAD>
<BODY>
<H1>Creating a DLL</H1><!-- entering slot 434 -->
<P>
To build a DLL from a particular source code module, the code is compiled
in a similar manner to that used for any other Presentation Manager application
code.  However, use of the<B> /Ge-</B> option will cause the C Set/2 compiler
to produce a DLL module.
<PRE>CC /L- /G3 /Ti+ /Gm+ /Ge- MYDLL OS2386.LIB MYDLL.DEF
</PRE>

<P>
This command sequence instructs the compiler to take the file MYPROG.C,
to compile and link edit it to produce a dynamic link library named MYPROG.DLL,
and to use the file named MYPROG.DEF as input to the linking process.  Use
of the<B> /Gm+</B> option enables multithreading, and use of the<B> /Ge-
</B>option directs C Set/2 to produce a DLL module.
<P>
A sample module definition file for use when creating a DLL is shown in
<A HREF="122_L2_SampleModuleDefiniti.html">Figure "Sample Module Definition
File to Create a DLL"</A>:
<P>
The following rules apply to module definition files when used to create
dynamic link libraries:<!-- lm: 0x2 0 -->
<P>
<LI><!-- lm: 0x2 2 -->The<B> LIBRARY</B> statement must be used, and the
module name declared must be the same as the file name of the DLL.  The
keywords<B> INITINSTANCE</B> and<B> TERMINSTANCE</B> may be used to indicate
that any initialization code should be executed for each process which accesses
the DLL.<!-- lm: 0x2 0 -->
<P>
<LI><!-- lm: 0x2 2 -->If the DLL will be accessed by separate processes
within the system, separate data segments should be created for each process;
this is achieved by specifying<B> DATA MULTIPLE</B> in the module definition
file<!-- lm: 0x2 0 -->
<P>
<LI><!-- lm: 0x2 2 -->The<B> STACKSIZE</B> statement must not be used since
a DLL does not use a stack.<!-- lm: 0x2 0 -->
<P>
<LI><!-- lm: 0x2 2 -->An<B> EXPORTS</B> statement must be included, defining
each function that will be exported from the DLL.<!-- lm: 0x2 0 -->
<BR>

<P>
The DLL module must be copied to a directory referenced by the LIBPATH statement
in CONFIG.SYS. This is typically the C:\OS2\DLL directory, although another
directory may be used if so desired.

<P><HR>

<A HREF="391_L2_DynamicLinkLibraries.html">[Back: Dynamic Link Libraries]</A> <BR>
<A HREF="393_L3_UsingaDLL.html">[Next: Using a DLL]</A> 
</BODY>
</HTML>
