<HTML>
<HEAD>
<META HTTP-EQUIV="CONTENT-TYPE" CONTENT="TEXT/HTML; CHARSET=UTF-8">
<TITLE>User-Initiated Communication</TITLE>
<STYLE>
PRE {
  FONT-FAMILY: Consolas, "Lucida Console", "Courier New", Courier, MONOSPACE;
}
</STYLE>
</HEAD>
<BODY>
<H1>User-Initiated Communication</H1><!-- entering slot 316 -->
<P>
The latter case is somewhat more complex, since the two objects may have
no defined relationship.  A conversation must be initiated between the two,
whereby each determines the nature of the other, and whether a drop operation
is valid at the present time.  If so, each object passes the information
required to carry out the requested action.
<P>
<B>Dragging an Object</B>
<P>
When the user begins to drag an object, the object being dragged is notified
by the system, which invokes the object's<I> _wpFormatDragItem</I> method.
This method is used to build a DRAGITEM structure, which is passed to another
object if the current object is dragged over it or dropped upon it. The
DRAGITEM structure contains rendering information about the object, which
is used by other objects over which the object is dragged, in order to determine
whether a drop operation is valid at that point.
<P>
Default information for the DRAGITEM structure is inserted by the default
processing provided by the parent class, but an object class may override
the method and include its own class-specific processing.  The DRAGITEM
structure is nested within a DRAGINFO structure, which is passed to any
object over which the current object is dragged.  In a situation where more
than one object is being dragged simultaneously, a separate DRAGITEM structure
is produced for each object, and the entire set of structures is combined
using a single DRAGINFO structure.
<P>
When an object is dragged over another object, the system invokes the<I> _wpDragOver
</I>method in the object being dragged over.  This method receives a DRAGINFO
structure, which contains a variety of information including pointers to
one or more DRAGITEM structures.  The object may examine these structures
and determine whether any of the objects being dragged can be dropped over
it.  If not, the object changes the mouse pointer to indicate that a drop
operation is not valid.
<P>
<B>Dropping an Object</B>
<P>
When a drop operation occurs, the object being dropped upon is notified
by the system, which invokes the<I> _wpDrop</I> method. This method accepts
the DRAGINFO structure, which may be examined by the object to determine
the correct action to be taken.  The rendering information contained in
the DRAGITEM structure may be sufficient to allow the action to be completed,
or the object being dropped upon may initiate a conversation with the object
being dragged over it, in order to gain sufficient information to complete
the action.
<P>
The rendering information provided in the DRAGITEM structure, and its use
by a Presentation Manager or Workplace Shell object, is described in detail
in <A HREF="289_L1_DirectManipulation.html">Direct Manipulation</A>.

<P><HR>

<A HREF="286_L3_ApplicationInitiated.html">[Back: Application-Initiated Communication]</A> <BR>
<A HREF="288_L2_Summary.html">[Next: Summary]</A> 
</BODY>
</HTML>
