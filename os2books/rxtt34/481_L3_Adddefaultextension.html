<HTML XPOS=20% YPOS=BOTTOM WIDTH=80% HEIGHT=100%>
<HEAD>
<!-- extra bytes: 03 00 14 14 00 08 00 11 50 00 64 00 --><TITLE>Add default extension</TITLE>
</HEAD>
<BODY>
<H1>Add default extension</H1><!-- entering slot 500 --><A AUTO VIEWPORT DEPENDENT GROUP=4100 HREF="107_L4_Menu.html">[Autolink] Menu</A><P><!-- extra bytes: 4C 06 04 10 04 00 -->
<P>

<P>

<PRE> 
/* ------------------------------------------------------------------ */
/* function: Add a default extension to a filename if necessary       */
/*                                                                    */
/* usage:    newFileName = CheckExtension( fileName, extension )      */
/*                                                                    */
/* where:    fileName = the filename to check                         */
/*           extension = default extension                            */
/*                                                                    */
/* returns:  the filename with extension                              */
/*                                                                    */
CheckExtension: PROCEDURE expose (exposeList)
  parse arg fileName, extension

                        /* init the return code                       */
  thisRC = fileName

  if fileName &lt;&gt; '' &amp; extension &lt;&gt; '' then
  do
    dotPos = lastpos( '.', fileName )
    backslashPos = lastpos( '\', fileName )

    if ( dotPos &lt;= backslashPos ) then
      thisRC  = fileName || extension
  end /* if fileName &lt;&gt; '' &amp; extension &lt;&gt; '' then */

return thisRC
</PRE>

<P>


<P><HR>

<A HREF="480_L3_Copyafilewithaprogre.html">[Back: Copy a file with a progress indicator]</A> <BR>
<A HREF="482_L2_Runtimetests&methods.html">[Next: Runtime tests & methods]</A> 
</BODY>
</HTML>
