<HTML XPOS=20% YPOS=BOTTOM WIDTH=80% HEIGHT=100%>
<HEAD>
<!-- extra bytes: 03 00 14 14 00 08 00 11 50 00 64 00 --><TITLE>Save the Desktop</TITLE>
</HEAD>
<BODY>
<H1>Save the Desktop</H1><!-- entering slot 435 --><A AUTO VIEWPORT DEPENDENT GROUP=4100 HREF="107_L4_Menu.html">[Autolink] Menu</A><P><!-- extra bytes: 4C 06 04 10 04 00 -->
<P>

<P>

<PRE> 
/*                                                                    */
/* Name:     SaveWPS.CMD                                              */
/*                                                                    */
/* Function:                                                          */
/*   Save the desktop (OS/2 3.0 and above)                            */
/*                                                                    */
/* Usage:                                                             */
/*   SaveWPS                                                          */
/*                                                                    */
/* Where:                                                             */
/*   -                                                                */
/*                                                                    */
/* Returns:                                                           */
/*   -                                                                */
/*                                                                    */
/* Credits:                                                           */
/*   -                                                                */
/*                                                                    */
/* History:                                                           */
/*   -                                                                */
/*                                                                    */
/* Notes:                                                             */
/*   Create a program object for the program "\OS2\PMREXX.EXE" and    */
/*   insert the name of the file with the code below as parameters.   */
/*                                                                    */
/* (c) 1996 <A HREF="002_L1_GeneralForeword.html">Bernd Schemmer</A>, Germany, EMail: Bernd.Schemmer@gmx.de     */
/*                                                                    */

                        /* load the necessary function from REXXUTIL  */
  call rxFuncAdd 'SysSaveObject', 'REXXUTIL', 'SysSaveObject'

                        /* save the desktop object &amp; check the result */
  if SysSaveObject( '&lt;WP_DESKTOP&gt;', 0 ) = 1 then
    rc = rxMessageBox( 'Desktop saved.'     ,,
                       'SaveWPS - Result '  ,,
                       'OK'                 ,,
                       'INFORMATION' )
  else
    rc = rxMessageBox( 'Error saving the Desktop!' ,,
                       'SaveWPS - Result '         ,,
                       'OK'                        ,,
                       'ERROR' )

                        /* release the function SysSaveObject         */
  call rxFuncDrop 'SysSaveObject'
exit 0
</PRE>

<P>
 

<P><HR>

<A HREF="421_L3_Startaprogramwithspe.html">[Back: Start a program with specific settings]</A> <BR>
<A HREF="423_L2_Icons.html">[Next: Icons ...]</A> 
</BODY>
</HTML>
