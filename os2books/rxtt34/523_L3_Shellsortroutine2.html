<HTML XPOS=20% YPOS=BOTTOM WIDTH=80% HEIGHT=100%>
<HEAD>
<!-- extra bytes: 03 00 14 14 00 08 00 11 50 00 64 00 --><TITLE>Shellsort routine - 2 -</TITLE>
</HEAD>
<BODY>
<H1>Shellsort routine - 2 -</H1><!-- entering slot 544 --><A AUTO VIEWPORT DEPENDENT GROUP=4100 HREF="107_L4_Menu.html">[Autolink] Menu</A><P><!-- extra bytes: 4C 06 04 10 04 00 -->
<P>

<P>
another SHELL-Sortroutine
<BR>
Captured from a message from<B> Ian Collier</B> (see <A HREF="945_L2H_EMailaddressesC.html">EMail
Addresses</A>) in a public Internet news group (see <A HREF="880_L3_InternetNewsgroupsLi.html">Internet
- Newsgroups</A>)
<P>
"That algorithm is a weird variation on Shell sort that I've never seen
before.  A shell sort is a bit like a glorified bubble sort but it usually
performs better, and it can be written as follows.  Notice that the last
pass, with d=1, is equivalent to a bubble sort; we expect the list to be
mostly in order by this time so that the bubble sort finishes quicky.  The
earlier passes are like bubble sorts that make elements travel more quickly
when they are further out of place.  [A quick test on 300 lines of news
articles showed that the above program performed 10428 comparisons.  A bubble
sort did 33374 comparisons.]" 
<PRE> 
/* ------------------------------------------------------------------ */
/* function: variation of Shell sort                                  */
/*                                                                    */
/* call:     ShellSort                                                */
/*                                                                    */
/* returns:  nothing                                                  */
/*                                                                    */
/* notes:    You must save the elements to sort in the stem "STEM."   */
/*           stem.0 must contain the number of elements in the stem.  */
/*                                                                    */
ShellSort: PROCEDURE expose stem.
  d = stem.0 % 2                /* d is a distance measurement        */
  do while d &gt; 0
     do until finished          /* start of mini-bubblesort loop      */
        finished = 1
        do i=1 to stem.0-d
           j = i+d      /* we now compare and swap items i and i+d    */
           if stem.i &gt;&gt; stem.j then do                       /* v2.80 */
              temp = stem.i
              stem.i = stem.j
              stem.j = temp
              finished = 0
           end
        end i
     end                        /* end of mini-bubblesort loop        */
     d = d%2
  end
RETURN
</PRE>

<P>
 

<P><HR>

<A HREF="522_L3_Shellsortroutine1.html">[Back: Shellsort routine - 1 -]</A> <BR>
<A HREF="524_L3_Anothersortroutine.html">[Next: Another sort routine]</A> 
</BODY>
</HTML>
