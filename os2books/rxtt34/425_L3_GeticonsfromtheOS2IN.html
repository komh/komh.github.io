<HTML XPOS=20% YPOS=BOTTOM WIDTH=80% HEIGHT=100%>
<HEAD>
<META HTTP-EQUIV="CONTENT-TYPE" CONTENT="TEXT/HTML; CHARSET=UTF-8">
<!-- extra bytes: 03 00 14 14 00 08 00 11 50 00 64 00 --><TITLE>Get icons from the OS2.INI file</TITLE>
<STYLE>
PRE {
  FONT-FAMILY: Consolas, "Lucida Console", "Courier New", Courier, MONOSPACE;
}
</STYLE>
</HEAD>
<BODY>
<H1>Get icons from the OS2.INI file</H1><!-- entering slot 439 --><A AUTO VIEWPORT DEPENDENT GROUP=4100 HREF="107_L4_Menu.html">[Autolink] Menu</A><P><!-- extra bytes: 4C 06 04 10 04 00 -->
<P>

<P>
Use the following program to get the icons saved in the file<B> OS2.INI
</B>(see also <A HREF="424_L3_Iconresourcesindefau.html">Icon resources
in default OS/2 DLLs</A> and <A HREF="426_L3_Extracttheiconfromth.html">Extract
the icon from the EAs</A>):
<PRE> 
/*                                                                    */
/* Name:     GetWICO.CMD                                              */
/*                                                                    */
/* Function:                                                          */
/*   sample program to get the icons from the OS2.INI file            */
/*                                                                    */
/* Usage:                                                             */
/*   GetWICO                                                          */
/*                                                                    */
/* Where:                                                             */
/*   -                                                                */
/*                                                                    */
/* Returns:                                                           */
/*   -                                                                */
/*                                                                    */
/* Credits:                                                           */
/*   -                                                                */
/*                                                                    */
/* History:                                                           */
/*   18.01.1996 /bs                                                   */
/*     - initial release for RXT&amp;T v2.00                              */
/*                                                                    */
/* Notes:                                                             */
/*                                                                    */
/*   The .ICO files are created in the current directory.             */
/*                                                                    */
/*   Tested only with WARP.                                           */
/*                                                                    */
/*                                                                    */
/* (c) 1996 <A HREF="002_L1_GeneralForeword.html">Bernd Schemmer</A>, Germany, EMail: Bernd.Schemmer@gmx.de     */
/*                                                                    */

                        /* load REXXUTIL function                     */
  call rxFuncAdd "SysIni", "REXXUTIL", "SysIni"

  say "GetWICO - get the icons from the OS2.INI file"

                        /* get a list of the icons                    */
  call SysIni "USER", "PM_Abstract:Icons", "ALL:" , "icons."

  call CharOut,  "Creating " || icons.0 || " .ICO files "

  do i = 1 to icons.0
    curIconFile = "ICO_" || icons.i || ".ICO"

    call CharOut , "."
    call stream curIconFile, "c", "OPEN WRITE"

    call CharOut curIconFile ,,
                 sysIni( "User", "PM_Abstract:Icons", icons.i )

    call stream curIconFile, "c", "CLOSE"
  end /* do i = 1 to icons.0 */
  call LineOut , " done."

exit 0
</PRE>

<P>
 

<P><HR>

<A HREF="424_L3_Iconresourcesindefau.html">[Back: Icon resources in default OS/2 DLLs]</A> <BR>
<A HREF="426_L3_Extracttheiconfromth.html">[Next: Extract the icon from the EAs]</A> 
</BODY>
</HTML>
