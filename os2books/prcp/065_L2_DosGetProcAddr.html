<HTML>
<HEAD>
<TITLE>DosGetProcAddr</TITLE>
</HEAD>
<BODY>
<H1>DosGetProcAddr</H1><!-- entering slot 80 -->Bindings:  <A HREF="240_L2H_DosGetProcAddr.html">C</A>,
<A HREF="415_L2H_DosGetProcAddr.html">MASM</A>
<BR>

<P>
This call returns a far address to a desired procedure within a dynamic
link module.<!-- lm: 0x2 1 -->
<UL>
<P>
DosGetProcAddr<!-- lm: 0x2 20 -->
<UL> (ModuleHandle, ProcName, ProcAddress)
<!-- lm: 0x2 1 -->
</UL><!-- lm: 0x2 1 -->
<P>
<B>ModuleHandle</B> (HMODULE) - input<!-- lm: 0x11 4 -->
<UL> Handle of
the dynamic link module.<!-- lm: 0x2 1 -->
</UL><B> ProcName</B> (PSZ) -
input<!-- lm: 0x11 4 -->
<UL> Address of a name string that contains the
referenced procedure name.
<P>
Alternatively, if the selector portion of the pointer is null, the offset
portion of the pointer is an explicit entry number (ordinal) within the
dynamic link module.
<P>
DosGetProcAddr for entries within the DOSCALLS module are only supported
for ordinal references.  References to the DOSCALLS module by name strings
are not supported and return an error.  Dynamic link ordinal numbers for
DOSCALLS routines are resolved by linking with DOSCALLS.LIB.<!-- lm: 0x2 1 -->
</UL><B> ProcAddress
</B>(PFN FAR *) - output<!-- lm: 0x11 4 -->
<UL> Procedure address.<!-- lm: 0x2 1 -->
</UL><B> rc
</B>(USHORT) - return<!-- lm: 0x11 4 -->
<UL> Return code descriptions are:
<!-- lm: 0x2 4 -->
<P>
<LI><!-- lm: 0x2 14 -->NO_ERROR<!-- lm: 0x2 4 --> 6<!-- lm: 0x2 14 -->
<UL> ERROR_INVALID_HANDLE
<!-- lm: 0x2 4 -->
</UL>95<!-- lm: 0x2 14 -->
<UL> ERROR_INTERRUPT<!-- lm: 0x2 4 -->
</UL>127<!-- lm: 0x2 14 -->
<UL> ERROR_PROC_NOT_FOUND<!-- lm: 0x2 1 -->
</UL><B>Remarks</B>
<P>
A 32-bit address, consisting of a selector and offset, is returned for a
specified procedure.
<P>
To free the dynamic link module, issue <A HREF="044_L2_DosFreeModule.html">DosFreeModule</A>.
After <A HREF="044_L2_DosFreeModule.html">DosFreeModule</A> is issued, procedure
entry addresses returned for this handle or no longer valid.
<P>
Other run-time dynamic link calls are <A HREF="076_L2_DosLoadModule.html">DosLoadModule</A>,
<A HREF="062_L2_DosGetModName.html">DosGetModName</A>, and <A HREF="061_L2_DosGetModHandle.html">DosGetModHandle</A>.


<P><HR>

<A HREF="064_L2_DosGetPPID.html">[Back: DosGetPPID]</A> <BR>
<A HREF="066_L2_DosGetPrty.html">[Next: DosGetPrty]</A> 
</BODY>
</HTML>
