<HTML>
<HEAD>
<META HTTP-EQUIV="CONTENT-TYPE" CONTENT="TEXT/HTML; CHARSET=UTF-8">
<TITLE>DosScanEnv</TITLE>
<STYLE>
PRE {
  FONT-FAMILY: Consolas, "Lucida Console", "Courier New", Courier, MONOSPACE;
}
</STYLE>
</HEAD>
<BODY>
<H1>DosScanEnv</H1><!-- entering slot 161 -->Bindings:  <A HREF="306_L2H_DosScanEnv.html">C</A>,
<A HREF="481_L2H_DosScanEnv.html">MASM</A>
<BR>

<P>
This call scans (searches) an environment segment for an environment variable.
<!-- lm: 0x2 1 -->
<UL>
<P>
DosScanEnv<!-- lm: 0x2 15 -->
<UL> (EnvVarName, ResultPointer)<!-- lm: 0x2 1 -->
</UL><!-- lm: 0x2 1 -->
<P>
<B>EnvVarName</B> (PSZ) - input<!-- lm: 0x11 4 -->
<UL> Address of the name
of the environment variable.  Do not include a trailing " = ", since this
is not part of the name.<!-- lm: 0x2 1 -->
</UL><B> ResultPointer</B> (PSZ
FAR *) - output<!-- lm: 0x11 4 -->
<UL> Address where the system returns
the pointer to the environment string. ResultPointer points to the first
character of the string that is the value of the environment variable and
can be passed directly into <A HREF="132_L2_DosSearchPath.html">DosSearchPath</A>.
<!-- lm: 0x2 1 -->
</UL><B>rc</B> (USHORT) - return<!-- lm: 0x11 4 -->
<UL> Return
code descriptions are:<!-- lm: 0x2 4 -->
<P>
<LI><!-- lm: 0x2 14 -->NO_ERROR<!-- lm: 0x2 4 --> 203<!-- lm: 0x2 14 -->
<UL> ERROR_ENVVAR_NOT_FOUND
<!-- lm: 0x2 1 -->
</UL><B>Remarks</B>
<P>
Assume that the process' environment contains:
<PRE>        "DPATH=c:\sysdir;c:\libdir"
               |
               │
               │
               └---- ResultPointer points here after the
                        following call to DosScanEnv:

        DosScanEnv("DPATH", &amp;ResultPointer);
</PRE>

<P>
As noted above, ResultPointer points to the first character of the value
of the environment variable.

<P><HR>

<A HREF="130_L2_DosRmDir.html">[Back: DosRmDir]</A> <BR>
<A HREF="132_L2_DosSearchPath.html">[Next: DosSearchPath]</A> 
</BODY>
</HTML>
