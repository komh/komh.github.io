<HTML>
<HEAD>
<META HTTP-EQUIV="CONTENT-TYPE" CONTENT="TEXT/HTML; CHARSET=UTF-8">
<TITLE>DosInsMessage</TITLE>
<STYLE>
PRE {
  FONT-FAMILY: Consolas, "Lucida Console", "Courier New", Courier, MONOSPACE;
}
</STYLE>
</HEAD>
<BODY>
<H1>DosInsMessage</H1><!-- entering slot 89 -->Bindings:  <A HREF="249_L2H_DosInsMessage.html">C</A>,
<A HREF="424_L2H_DosInsMessage.html">MASM</A>
<BR>

<P>
This call inserts variable text string information into the body of a message.
 This is useful when messages are loaded before insertion text strings are
known.<!-- lm: 0x2 1 -->
<UL>
<P>
DosInsMessage<!-- lm: 0x2 20 -->
<UL> (IvTable, IvCount, MsgInput, MsgInLength,
DataArea, DataLength,MsgLength)<!-- lm: 0x2 1 -->
</UL><!-- lm: 0x2 1 -->
<P>
<B>IvTable</B> (PCHAR FAR *) - input<!-- lm: 0x11 4 -->
<UL> List of double-word
pointers.  Each pointer points to an ASCIIZ or null terminated DBCS string
(variable insertion text).  0 to 9 strings can be present.<!-- lm: 0x2 1 -->
</UL><B> IvCount
</B>(USHORT) - input<!-- lm: 0x11 4 -->
<UL> 0-9 is the count of variable
insertion text strings. If IvCount is 0, IvTable is ignored.<!-- lm: 0x2 1 -->
</UL><B> MsgInput
</B>(PSZ) - input<!-- lm: 0x11 4 -->
<UL> Address of the input message.
<!-- lm: 0x2 1 -->
</UL><B>MsgInLength</B> (USHORT) - input<!-- lm: 0x11 4 -->
<UL> Length,
in bytes, of the input message.<!-- lm: 0x2 1 -->
</UL><B> DataArea</B> (PCHAR)
- output<!-- lm: 0x11 4 -->
<UL> Address of the user storage that returns
the updated message. If the message is too long to fit in the caller's buffer,
as much of the message text as possible is returned with the appropriate
return code.<!-- lm: 0x2 1 -->
</UL><B> DataLength</B> (USHORT) - input
<!-- lm: 0x11 4 -->
<UL>Length, in bytes, of the user's storage area.<!-- lm: 0x2 1 -->
</UL><B> MsgLength
</B>(PUSHORT) - output<!-- lm: 0x11 4 -->
<UL> Address of the length, in
bytes, of the updated message.<!-- lm: 0x2 1 -->
</UL><B> rc</B> (USHORT)
- return<!-- lm: 0x11 4 -->
<UL> Return code descriptions are:<!-- lm: 0x2 4 -->
<P>
<LI><!-- lm: 0x2 14 -->NO_ERROR<!-- lm: 0x2 4 --> 316<!-- lm: 0x2 14 -->
<UL> ERROR_MR_MSG_TOO_LONG
<!-- lm: 0x2 4 -->
</UL>320<!-- lm: 0x2 14 -->
<UL> ERROR_MR_INV_IVCOUNT<!-- lm: 0x2 1 -->
</UL><B>Remarks</B>
<P>
DosInsMessage returns an error indicating that IvCount is out of range when
IvCount is greater than 9.  A default message is also placed in the caller's
buffer.  Refer to <A HREF="060_L2_DosGetMessage.html">DosGetMessage</A> for
details on the default messages.  If the numeric value of x in the
<BR>
%x sequence for %1through%9 is less than or equal to IvCount, then text
insertion, by substitution for %x, is performed for all occurrences of %x
in the body of the message.  Otherwise text insertion is ignored and the
%x sequence is returned unchanged in the message. Text insertion is performed
for all text strings defined by IvCount and IvTable.
<P>
Variable data insertion does not depend on a blank character delimiter nor
are blanks automatically inserted.

<P><HR>

<A HREF="073_L2_DosHoldSignal.html">[Back: DosHoldSignal]</A> <BR>
<A HREF="075_L2_DosKillProcess.html">[Next: DosKillProcess]</A> 
</BODY>
</HTML>
