<HTML>
<HEAD>
<META HTTP-EQUIV="CONTENT-TYPE" CONTENT="TEXT/HTML; CHARSET=UTF-8">
<TITLE>DosLoadModule</TITLE>
</HEAD>
<BODY>
<H1>DosLoadModule</H1><!-- entering slot 91 -->Bindings:  <A HREF="251_L2H_DosLoadModule.html">C</A>,
<A HREF="426_L2H_DosLoadModule.html">MASM</A>
<BR>

<P>
This call loads a dynamic link module and returns a handle for the module.
<!-- lm: 0x2 1 -->
<UL>
<P>
DosLoadModule<!-- lm: 0x2 19 -->
<UL> (ObjNameBuf, ObjNameBufL, ModuleName,
ModuleHandle)<!-- lm: 0x2 1 -->
</UL><!-- lm: 0x2 1 -->
<P>
<B>ObjNameBuf</B> (PSZ) - output<!-- lm: 0x11 4 -->
<UL> Address of the
name of an object that contributed to the failure of DosLoadModule.<!-- lm: 0x2 1 -->
</UL><B> ObjNameBufL
</B>(USHORT) - input<!-- lm: 0x11 4 -->
<UL> Length, in bytes, of the buffer
described by ObjNameBuf.<!-- lm: 0x2 1 -->
</UL><B> ModuleName</B> (PSZ)
- input<!-- lm: 0x11 4 -->
<UL> Address of the ASCIIZ name string containing
the dynamic link module name or the pathname string.  The filename extension
used for dynamic link libraries is .DLL.  When a pathname is provided, the
module name may have any extension.  The internal module name (the name
given in the LIBRARY statement in the .DEF file) must be the same as the
filename without the extension.<!-- lm: 0x2 1 -->
</UL><B> ModuleHandle
</B>(PHMODULE) - output<!-- lm: 0x11 4 -->
<UL> Address of the handle for
the dynamic link module.<!-- lm: 0x2 1 -->
</UL><B> rc</B> (USHORT) - return
<!-- lm: 0x11 4 -->
<UL>Return code descriptions are:<!-- lm: 0x2 4 -->
<P>
<LI><!-- lm: 0x2 14 -->NO_ERROR<!-- lm: 0x2 4 --> 2<!-- lm: 0x2 14 -->
<UL> ERROR_FILE_NOT_FOUND
<!-- lm: 0x2 4 -->
</UL>3<!-- lm: 0x2 14 -->
<UL> ERROR_PATH_NOT_FOUND<!-- lm: 0x2 4 -->
</UL>4<!-- lm: 0x2 14 -->
<UL> ERROR_TOO_MANY_OPEN_FILES<!-- lm: 0x2 4 -->
</UL>5<!-- lm: 0x2 14 -->
<UL> ERROR_ACCESS_DENIED<!-- lm: 0x2 4 -->
</UL>8<!-- lm: 0x2 14 -->
<UL> ERROR_NOT_ENOUGH_MEMORY<!-- lm: 0x2 4 -->
</UL>11<!-- lm: 0x2 14 -->
<UL> ERROR_BAD_FORMAT<!-- lm: 0x2 4 -->
</UL>26<!-- lm: 0x2 14 -->
<UL> ERROR_NOT_DOS_DISK<!-- lm: 0x2 4 -->
</UL>32<!-- lm: 0x2 14 -->
<UL> ERROR_SHARING_VIOLATION<!-- lm: 0x2 4 -->
</UL>33<!-- lm: 0x2 14 -->
<UL> ERROR_LOCK_VIOLATION<!-- lm: 0x2 4 -->
</UL>36<!-- lm: 0x2 14 -->
<UL> ERROR_SHARING_BUFFER_EXCEEDED<!-- lm: 0x2 4 -->
</UL>95<!-- lm: 0x2 14 -->
<UL> ERROR_INTERRUPT<!-- lm: 0x2 4 -->
</UL>108<!-- lm: 0x2 14 -->
<UL> ERROR_DRIVE_LOCKED<!-- lm: 0x2 4 -->
</UL>123<!-- lm: 0x2 14 -->
<UL> ERROR_INVALID_NAME<!-- lm: 0x2 4 -->
</UL>127<!-- lm: 0x2 14 -->
<UL> ERROR_PROC_NOT_FOUND<!-- lm: 0x2 4 -->
</UL>180<!-- lm: 0x2 14 -->
<UL> ERROR_INVALID_SEGMENT_NUMBER<!-- lm: 0x2 4 -->
</UL>182<!-- lm: 0x2 14 -->
<UL> ERROR_INVALID_ORDINAL<!-- lm: 0x2 4 -->
</UL>190<!-- lm: 0x2 14 -->
<UL> ERROR_INVALID_MODULETYPE<!-- lm: 0x2 4 -->
</UL>191<!-- lm: 0x2 14 -->
<UL> ERROR_INVALID_EXE_SIGNATURE<!-- lm: 0x2 4 -->
</UL>192<!-- lm: 0x2 14 -->
<UL> ERROR_EXE_MARKED_INVALID<!-- lm: 0x2 4 -->
</UL>194<!-- lm: 0x2 14 -->
<UL> ERROR_ITERATED_DATA_EXCEEDS_64k<!-- lm: 0x2 4 -->
</UL>195<!-- lm: 0x2 14 -->
<UL> ERROR_INVALID_MINALLOCSIZE<!-- lm: 0x2 4 -->
</UL>196<!-- lm: 0x2 14 -->
<UL> ERROR_DYNLINK_FROM_INVALID_RING<!-- lm: 0x2 4 -->
</UL>198<!-- lm: 0x2 14 -->
<UL> ERROR_INVALID_SEGDPL<!-- lm: 0x2 4 -->
</UL>199<!-- lm: 0x2 14 -->
<UL> ERROR_AUTODATASEG_EXCEEDS_64k<!-- lm: 0x2 4 -->
</UL>201<!-- lm: 0x2 14 -->
<UL> ERROR_RELOC_CHAIN_XEEDS_SEGLIM<!-- lm: 0x2 4 -->
</UL>206<!-- lm: 0x2 14 -->
<UL> ERROR_FILENAME_EXCED_RANGE<!-- lm: 0x2 1 -->
</UL><B>Remarks</B>
<P>
If the file is an OS/2 dynamic link module, it is loaded, and a handle is
returned.  This handle is used for freeing the dynamic link module with
a <A HREF="044_L2_DosFreeModule.html">DosFreeModule</A> request, getting
procedure addresses with <A HREF="065_L2_DosGetProcAddr.html">DosGetProcAddr
</A>requests, and getting the fully qualified file name with a <A HREF="062_L2_DosGetModName.html">DosGetModName
</A>request.
<P>
DosLoadModule may not be called from a dynamic library initialization routine
if the module to be loaded or any module referenced by it contains a dynamic
link library initialization routing.

<P><HR>

<A HREF="075_L2_DosKillProcess.html">[Back: DosKillProcess]</A> <BR>
<A HREF="077_L2_DosLockSeg.html">[Next: DosLockSeg]</A> 
</BODY>
</HTML>
