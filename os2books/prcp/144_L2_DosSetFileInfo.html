<HTML>
<HEAD>
<META HTTP-EQUIV="CONTENT-TYPE" CONTENT="TEXT/HTML; CHARSET=UTF-8">
<TITLE>DosSetFileInfo</TITLE>
</HEAD>
<BODY>
<H1>DosSetFileInfo</H1><!-- entering slot 176 -->Bindings:  <A HREF="319_L2H_DosSetFileInfo.html">C</A>,
<A HREF="494_L2H_DosSetFileInfo.html">MASM</A>
<BR>

<P>
This call sets attribute and extended attribute information for a file.
<!-- lm: 0x2 1 -->
<UL>
<P>
DosSetFileInfo<!-- lm: 0x2 20 -->
<UL> (FileHandle, FileInfoLevel, FileInfoBuf,
FileInfoBufSize)<!-- lm: 0x2 1 -->
</UL><!-- lm: 0x2 1 -->
<P>
<B>FileHandle</B> (HFILE) - input<!-- lm: 0x11 4 -->
<UL> File handle.<!-- lm: 0x2 1 -->
</UL><B> FileInfoLevel
</B>(USHORT) - input<!-- lm: 0x11 4 -->
<UL> Level of file information being
set. A value of 1 or 2 can be specified. The structures described in FileInfoBuf
indicate the information being set for each of these levels.<!-- lm: 0x2 1 -->
</UL><B> FileInfoBuf
</B>(PBYTE) - input<!-- lm: 0x11 4 -->
<UL> Address of the storage area
containing the structures for file information levels.<!-- lm: 0x2 4 -->
<P>
<B>Level 1 Information</B><!-- lm: 0x11 7 -->
<UL> FileInfoBuf contains
the following structure, to which information is specified in the following
format:<!-- lm: 0x2 7 -->
<P>
<B>filedate</B> (FDATE)<!-- lm: 0x11 10 -->
<UL> Structure containing the
date of file creation.<!-- lm: 0x2 10 -->
<P>
Bit<!-- lm: 0x2 20 -->
<UL> Description<!-- lm: 0x2 10 -->
</UL>15-9<!-- lm: 0x2 20 -->
<UL> Year, in binary, of file creation<!-- lm: 0x2 10 -->
</UL>8-5<!-- lm: 0x2 20 -->
<UL> Month, in binary, of file creation<!-- lm: 0x2 10 -->
</UL>4-0<!-- lm: 0x2 20 -->
<UL> Day, in binary, of file creation.<!-- lm: 0x2 7 -->
</UL><B> filetime
</B>(FTIME)<!-- lm: 0x11 10 -->
<UL> Structure containing the time of file
creation.<!-- lm: 0x2 10 -->
<P>
Bit<!-- lm: 0x2 20 -->
<UL> Description<!-- lm: 0x2 10 -->
</UL>15-11<!-- lm: 0x2 20 -->
<UL> Hours, in binary, of file creation<!-- lm: 0x2 10 -->
</UL>10-5<!-- lm: 0x2 20 -->
<UL> Minutes, in binary, of file creation<!-- lm: 0x2 10 -->
</UL>4-0<!-- lm: 0x2 20 -->
<UL> Seconds, in binary number of two-second
increments, of file creation.<!-- lm: 0x2 7 -->
</UL><B> fileaccessdate
</B>(FDATE)<!-- lm: 0x11 10 -->
<UL> Structure containing the date of last
access. See FDATE in filedate.<!-- lm: 0x2 7 -->
</UL><B> fileaccesstime
</B>(FTIME)<!-- lm: 0x11 10 -->
<UL> Structure containing the time of last
access. See FTIME in filetime.<!-- lm: 0x2 7 -->
</UL><B> writeaccessdate
</B>(FDATE)<!-- lm: 0x11 10 -->
<UL> Structure containing the date of last
write. See FDATE in filedate.<!-- lm: 0x2 7 -->
</UL><B> writeaccesstime
</B>(FTIME)<!-- lm: 0x11 10 -->
<UL> Structure containing the time of last
write. See FTIME in filetime.<!-- lm: 0x2 7 -->
</UL><B> filesize</B> (ULONG)
<!-- lm: 0x11 10 -->
<UL>File size.<!-- lm: 0x2 7 -->
</UL><B> filealloc
</B>(ULONG)<!-- lm: 0x11 10 -->
<UL> Allocated file size.<!-- lm: 0x2 7 -->
</UL><B> fileattrib
</B>(USHORT)<!-- lm: 0x11 10 -->
<UL> Attributes of the file, defined in
<A HREF="145_L2_DosSetFileMode.html">DosSetFileMode</A>.<!-- lm: 0x2 4 -->
</UL><B> Level
2 Information</B><!-- lm: 0x11 7 -->
<UL> FileInfoBuf contains an EAOP structure,
which has the following format:<!-- lm: 0x2 7 -->
<P>
<B>fpGEAList</B> (PGEALIST)<!-- lm: 0x11 10 -->
<UL> Address of GEAList.
GEAList is a packed array of variable length "get EA" structures, each containing
an EA name and the length of the name.<!-- lm: 0x2 7 -->
</UL><B> fpFEAList
</B>(PFEALIST)<!-- lm: 0x11 10 -->
<UL> Address of FEAList. FEAList is a
packed array of variable length "full EA" structures, each containing an
EA name and its corresponding value, as well as the lengths of the name
and the value.<!-- lm: 0x2 7 -->
</UL><B> oError</B> (ULONG)<!-- lm: 0x11 10 -->
<UL> Offset
into structure where error has occurred.<!-- lm: 0x2 4 -->
</UL>  <!-- lm: 0x11 7 -->
<UL> Level
2 sets a series of EA name/value pairs. On input, FileInfoBuf is an EAOP
structure above.  fpGEAList is ignored. fpFEAList points to a data area
where the relevant FEA list is to be found.  oError is ignored. Following
is the format of the FEAList structure:<!-- lm: 0x2 7 -->
<P>
<B>cbList</B> (ULONG)<!-- lm: 0x11 10 -->
<UL> Length of the FEA list, including
the length itself.<!-- lm: 0x2 7 -->
</UL><B> list</B> (FEA)<!-- lm: 0x11 10 -->
<UL> List
of FEA structures.  An FEA structure has the following format:<!-- lm: 0x2 10 -->
<P>
<B>Flags</B> (BYTE)<!-- lm: 0x11 13 -->
<UL> Bit indicator describing the
characteristics of the EA being defined.<!-- lm: 0x2 13 -->
<P>
Bit<!-- lm: 0x2 23 -->
<UL> Description<!-- lm: 0x2 13 -->
</UL>7<!-- lm: 0x2 23 -->
<UL> Critical EA.<!-- lm: 0x2 13 -->
</UL>6-0<!-- lm: 0x2 23 -->
<UL> Reserved and must be set to zero.<!-- lm: 0x2 10 -->
</UL>  
<!-- lm: 0x11 13 -->
<UL>If bit 7 is set to 1, this indicates a critical
EA.  If bit 7 is 0, this means the EA is noncritical; that is, the EA is
not essential to the intended use by an application of the file with which
it is associated.<!-- lm: 0x2 10 -->
</UL><B> cbName</B> (BYTE)<!-- lm: 0x11 13 -->
<UL> Length
of EA ASCIIZ name, which does not include the null character.<!-- lm: 0x2 10 -->
</UL><B> cbValue
</B>(USHORT)<!-- lm: 0x11 13 -->
<UL> Length of EA value, which cannot exceed
64KB.<!-- lm: 0x2 10 -->
</UL><B> szName</B> (PSZ)<!-- lm: 0x11 13 -->
<UL> Address
of the ASCIIZ name of EA.<!-- lm: 0x2 10 -->
</UL><B> aValue</B> (PSZ)<!-- lm: 0x11 13 -->
<UL> Address
of the free-format value of EA.<!-- lm: 0x2 7 -->
</UL><B> Note:</B><!-- lm: 0x11 10 -->
<UL> The
szName and aValue fields are not included as part of header or include files.
 Because of their variable lengths, these entries must be built manually.
<!-- lm: 0x2 4 -->
</UL> <!-- lm: 0x11 7 -->
<UL> On output, fpGEAList is
unchanged.  fpFEAList is unchanged as is the area pointed to by fpFEAList.
 If an error occurred during the set, oError is the offset of the FEA where
the error occurred.  The API return code is the error code corresponding
to the condition generating the error.  If no error occurred, oError is
undefined.<!-- lm: 0x2 1 -->
</UL><B> FileInfoBufSize</B> (USHORT) - input
<!-- lm: 0x11 4 -->
<UL>Length of FileInfoBuf.<!-- lm: 0x2 1 -->
</UL><B> rc
</B>(USHORT) - return<!-- lm: 0x11 4 -->
<UL> Return code descriptions are:
<!-- lm: 0x2 4 -->
<P>
<LI><!-- lm: 0x2 14 -->NO_ERROR<!-- lm: 0x2 4 --> 1<!-- lm: 0x2 14 -->
<UL> ERROR_INVALID_FUNCTION
<!-- lm: 0x2 4 -->
</UL>5<!-- lm: 0x2 14 -->
<UL> ERROR_ACCESS_DENIED<!-- lm: 0x2 4 -->
</UL>6<!-- lm: 0x2 14 -->
<UL> ERROR_INVALID_HANDLE<!-- lm: 0x2 4 -->
</UL>87<!-- lm: 0x2 14 -->
<UL> ERROR_INVALID_PARAMETER<!-- lm: 0x2 4 -->
</UL>122<!-- lm: 0x2 14 -->
<UL> ERROR_INSUFFICIENT_BUFFER<!-- lm: 0x2 4 -->
</UL>124<!-- lm: 0x2 14 -->
<UL> ERROR_INVALID_LEVEL<!-- lm: 0x2 4 -->
</UL>130<!-- lm: 0x2 14 -->
<UL> ERROR_DIRECT<!-- entering slot 177 -->_
ACCESS _ HANDLE<!-- lm: 0x2 4 -->
</UL>254<!-- lm: 0x2 14 -->
<UL>ERROR _ INVALID _ EA _ NAME<!-- lm: 0x2 4 -->
</UL>255<!-- lm: 0x2 14 -->
<UL>ERROR _ EA _ LIST _ INCONSISTENT<!-- lm: 0x2 1 -->
</UL><B>Remarks</B>
<P>
DosSetFileInfo is successful only when the file is opened for write access,
with a deny-both sharing mode specified for access to the file by other
processes.  If the file is already opened with conflicting sharing rights,
the call to <A HREF="091_L2_DosOpen.html">DosOpen</A> or <A HREF="092_L2_DosOpen2.html">DosOpen2
</A>will fail.
<P>
A 0 value in the date and time components of a field does not change the
field.  For example, if both "last write date" and "last write time" are
specified as 0 in the Level 1 information structure, then both attributes
of the file are left unchanged.  If either "last write date" or "last write
time" are specified as non-zero, both attributes of the file are set to
the new values.
<P>
The FAT file system supports modification of only the dates and times of
the last write. Creation and last access dates and times are not affected.

<P>
The last modification date and time will get changed if the extended attributes
are modified.
<P>

<BR>
<B>Family API Considerations</B>
<P>
It is not possible to create a label with leading blank characters in DOS
mode, because of restrictions on the previous Interrupt 21h function call
(create an FCB type file), which must be used by FAPI.

<P><HR>

<A HREF="143_L2_DosSetFHandState.html">[Back: DosSetFHandState]</A> <BR>
<A HREF="145_L2_DosSetFileMode.html">[Next: DosSetFileMode]</A> 
</BODY>
</HTML>
