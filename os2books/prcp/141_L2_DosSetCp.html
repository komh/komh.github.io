<HTML>
<HEAD>
<META HTTP-EQUIV="CONTENT-TYPE" CONTENT="TEXT/HTML; CHARSET=UTF-8">
<TITLE>DosSetCp</TITLE>
</HEAD>
<BODY>
<H1>DosSetCp</H1><!-- entering slot 172 -->Bindings:  <A HREF="316_L2H_DosSetCp.html">C</A>,
<A HREF="491_L2H_DosSetCp.html">MASM</A>
<BR>

<P>
This call allows a process to set its code page and the session's display
code page and keyboard code page.<!-- lm: 0x2 1 -->
<UL>
<P>
DosSetCp<!-- lm: 0x2 13 -->
<UL> (CodePage, Reserved)<!-- lm: 0x2 1 -->
</UL><!-- lm: 0x2 1 -->
<P>
<B>CodePage</B> (USHORT) - input<!-- lm: 0x11 4 -->
<UL> Code page identifier
word that has one of the following values:<!-- lm: 0x2 4 -->
<P>
Value<!-- lm: 0x2 14 -->
<UL> Definition<!-- lm: 0x2 4 -->
</UL>437<!-- lm: 0x2 14 -->
<UL> IBM PC US 437 code page<!-- lm: 0x2 4 -->
</UL>850<!-- lm: 0x2 14 -->
<UL> Multilingual code page<!-- lm: 0x2 4 -->
</UL>860<!-- lm: 0x2 14 -->
<UL> Portuguese code page<!-- lm: 0x2 4 -->
</UL>863<!-- lm: 0x2 14 -->
<UL> Canadian-French code page<!-- lm: 0x2 4 -->
</UL>865<!-- lm: 0x2 14 -->
<UL> Nordic code page.<!-- lm: 0x2 1 -->
</UL><B> Reserved
</B>(USHORT) - input<!-- lm: 0x11 4 -->
<UL> Reserved must be set to zero.
<!-- lm: 0x2 1 -->
</UL><B>rc</B> (USHORT) - return<!-- lm: 0x11 4 -->
<UL> Return
code descriptions are:<!-- lm: 0x2 4 -->
<P>
<LI><!-- lm: 0x2 14 -->NO_ERROR<!-- lm: 0x2 4 --> 5<!-- lm: 0x2 14 -->
<UL> ERROR_ACCESS_DENIED
<!-- lm: 0x2 4 -->
</UL>13<!-- lm: 0x2 14 -->
<UL> ERROR_INVALID_DATA<!-- lm: 0x2 4 -->
</UL>472<!-- lm: 0x2 14 -->
<UL> ERROR_INVALID_CODE_PAGE<!-- lm: 0x2 4 -->
</UL>482<!-- lm: 0x2 14 -->
<UL> ERROR_CP_SWITCH_INCOMPLETE<!-- lm: 0x2 1 -->
</UL><B>Remarks</B>
<P>
DosSetCp allows a program to set its code page.  See CONFIG.SYS and the
CODEPAGE command for preparing code pages for the system.  The first code
page specified in the CODEPAGE command is the default system code page.
 The session code page of a new session is set to the default system code
page.  A session's code page can be changed by the user with the CHCP command
at the command prompt.  The process code page of a new program started from
a session command prompt is set to that session's code page.
<P>
DosSetCp sets the process code page of the calling process.  The code page
of a process is used in a series of ways.  First, the printer code page
is set to the process code page through the file system and printer spooler
when the process makes an open printer request.  Calling DosSetCp does not
affect the code page of a printer opened prior to the call and does not
affect the code page of a printer opened by another process.  Second, country
dependent information, by default, is retrieved encoded in the code page
of the calling process.  And third, a newly created process inherits its
process code page from its parent process.
<P>
DosSetCp also sets, in the session to which the calling process belongs,
the code page for the session's default logical keyboard and automatically
flushes the keyboard buffer.  It also sets the display code page for the
session's logical display.  This setting of the code page for the session's
default logical keyboard and display overrides any previous setting by DosSetCp,
<A HREF="151_L2_DosSetProcCp.html">DosSetProcCp</A>, KbdSetCp, and VioSetCp
by any process in the same session.  Also see <A HREF="151_L2_DosSetProcCp.html">DosSetProcCp</A>.


<P><HR>

<A HREF="140_L2_DosSendSignal.html">[Back: DosSendSignal]</A> <BR>
<A HREF="142_L2_DosSetDateTime.html">[Next: DosSetDateTime]</A> 
</BODY>
</HTML>
