<HTML>
<HEAD>
<META HTTP-EQUIV="CONTENT-TYPE" CONTENT="TEXT/HTML; CHARSET=UTF-8">
<TITLE>MouRegister</TITLE>
</HEAD>
<BODY>
<H1>MouRegister</H1><!-- entering slot 646 -->Bindings:  <A HREF="623_L2H_MouRegister.html">C</A>,
<A HREF="646_L2H_MouRegister.html">MASM</A>
<BR>

<P>
This call registers a mouse subsystem within a session.<!-- lm: 0x2 1 -->
<UL>
<P>
MouRegister<!-- lm: 0x2 17 -->
<UL> (ModuleName, EntryName, Mask)<!-- lm: 0x2 1 -->
</UL><!-- lm: 0x2 1 -->
<P>
<B>ModuleName</B> (PSZ) - input<!-- lm: 0x11 4 -->
<UL> Address of the dynamic
link module name.  The maximum length is 9 bytes (including ASCIIZ terminator).
<!-- lm: 0x2 1 -->
</UL><B>EntryName</B> (PSZ) - input<!-- lm: 0x11 4 -->
<UL> Address
of the dynamic link entry point name of a routine that receives control
when any of the registered functions are called.  The maximum length is
33 bytes (including ASCIIZ terminator).<!-- lm: 0x2 1 -->
</UL><B> Mask
</B>(ULONG) - input<!-- lm: 0x11 4 -->
<UL> A mask of bits, where each bit
set to 1 identifies a mouse function being registered.  Bit values are:
<!-- lm: 0x2 4 -->
<P>
Bit<!-- lm: 0x2 14 -->
<UL> Description<!-- lm: 0x2 4 -->
</UL>31-22<!-- lm: 0x2 14 -->
<UL> Reserved, set to zero<!-- lm: 0x2 4 -->
</UL>21<!-- lm: 0x2 14 -->
<UL> MouSetDevStatus<!-- lm: 0x2 4 -->
</UL>20<!-- lm: 0x2 14 -->
<UL> MouFlushQue<!-- lm: 0x2 4 -->
</UL>19<!-- lm: 0x2 14 -->
<UL> MouInitReal<!-- lm: 0x2 4 -->
</UL>18<!-- lm: 0x2 14 -->
<UL> MouSetPtrPos<!-- lm: 0x2 4 -->
</UL>17<!-- lm: 0x2 14 -->
<UL> MouGetPtrPos<!-- lm: 0x2 4 -->
</UL>16<!-- lm: 0x2 14 -->
<UL> MouRemovePtr<!-- lm: 0x2 4 -->
</UL>15<!-- lm: 0x2 14 -->
<UL> MouDrawPtr<!-- lm: 0x2 4 -->
</UL>14<!-- lm: 0x2 14 -->
<UL> MouSetPtrShape<!-- lm: 0x2 4 -->
</UL>13<!-- lm: 0x2 14 -->
<UL> MouGetPtrShape<!-- lm: 0x2 4 -->
</UL>12<!-- lm: 0x2 14 -->
<UL> MouClose<!-- lm: 0x2 4 -->
</UL>11<!-- lm: 0x2 14 -->
<UL> MouOpen<!-- lm: 0x2 4 -->
</UL>10<!-- lm: 0x2 14 -->
<UL> Reserved<!-- lm: 0x2 4 -->
</UL>9<!-- lm: 0x2 14 -->
<UL> Reserved<!-- lm: 0x2 4 -->
</UL>8<!-- lm: 0x2 14 -->
<UL> MouSetEventMask<!-- lm: 0x2 4 -->
</UL>7<!-- lm: 0x2 14 -->
<UL> MouSetScaleFact<!-- lm: 0x2 4 -->
</UL>6<!-- lm: 0x2 14 -->
<UL> MouGetEventMask<!-- lm: 0x2 4 -->
</UL>5<!-- lm: 0x2 14 -->
<UL> MouGetScaleFact<!-- lm: 0x2 4 -->
</UL>4<!-- lm: 0x2 14 -->
<UL> MouReadEventQue<!-- lm: 0x2 4 -->
</UL>3<!-- lm: 0x2 14 -->
<UL> MouGetNumQueEl<!-- lm: 0x2 4 -->
</UL>2<!-- lm: 0x2 14 -->
<UL> MouGetDevStatus<!-- lm: 0x2 4 -->
</UL>1<!-- lm: 0x2 14 -->
<UL> MouGetNumMickeys<!-- lm: 0x2 4 -->
</UL>0<!-- lm: 0x2 14 -->
<UL> MouGetNumButtons.<!-- lm: 0x2 1 -->
</UL><B> rc
</B>(USHORT) - return<!-- lm: 0x11 4 -->
<UL> Return code descriptions are:
<!-- lm: 0x2 4 -->
<P>
<LI><!-- lm: 0x2 14 -->NO_ERROR<!-- lm: 0x2 4 --> 385<!-- lm: 0x2 14 -->
<UL> ERROR_MOUSE_NO_DEVICE
<!-- lm: 0x2 4 -->
</UL>413<!-- lm: 0x2 14 -->
<UL> ERROR_MOUSE_INVALID_ASCIIZ<!-- lm: 0x2 4 -->
</UL>414<!-- lm: 0x2 14 -->
<UL> ERROR_MOUSE_INVALID_MASK<!-- lm: 0x2 4 -->
</UL>415<!-- lm: 0x2 14 -->
<UL> ERROR_MOUSE_REGISTER<!-- lm: 0x2 4 -->
</UL>466<!-- lm: 0x2 14 -->
<UL> ERROR_MOU_DETACHED<!-- lm: 0x2 4 -->
</UL>505<!-- lm: 0x2 14 -->
<UL> ERROR_MOU_EXTENDED_SG<!-- lm: 0x2 1 -->
</UL><B>Remarks</B>
<P>
The Base Mouse Subsystem is the default mouse subsystem. There can be only
one MouRegister outstanding for each session without an intervening <A HREF="586_L2_MouDeRegister.html">MouDeRegister</A>.
 <A HREF="586_L2_MouDeRegister.html">MouDeRegister</A> must be issued by
the same process that issued MouRegister.
<P>
When any registered function is called, control is routed to EntryName.
 When this routine is entered, four additional values are pushed onto the
stack.  The first is the index number (Word) of the function being called.
 The second is a near pointer (Word). The third is the caller's DS register
(Word).  The fourth is the return address (DWord) to the mouse router.  For
example, if <A HREF="592_L2_MouGetNumMickeys.html">MouGetNumMickeys</A> were
called and control routed to EntryName, the stack would appear as if the
following instructions were executed:
<PRE>PUSH@ WORD    NumberOfMickeys
PUSH  WORD    DeviceHandle
CALL  FAR     MouGetNumMickeys
PUSH  WORD    Function Code
CALL  NEAR    Entry point in Mouse Router
PUSH  DS       
CALL  FAR     EntryName.
</PRE>

<P>
When a registered function returns to the Mouse Router, AX is interpreted
as follows:<!-- lm: 0x2 1 -->
<P>
AX = 0<!-- lm: 0x11 4 -->
<UL> No error.  Do not invoke the Base Mouse Subsystem
routine. Return AX = 0.<!-- lm: 0x2 1 -->
</UL> AX = -1<!-- lm: 0x11 4 -->
<UL> Invoke
the BaseMouse Subsystem routine.  Return AX = return code from the Base
Mouse Subsystem.<!-- lm: 0x2 1 -->
</UL> AX = error (if not 0 or -1)<!-- lm: 0x11 4 -->
<UL> Do
not invoke the Base Mouse Subsystem Routine.  Return AX = error.<!-- lm: 0x2 1 -->
</UL>
<P>
When the mouse router receives a mouse call, it routes it to the Base Mouse
Subsystem unless an application or other mouse subsystem has previously
issued MouRegister for that call.  If the call was registered, the subsystem
is entered at the EntryName specified, and provided with the applicable
function code.
<P>
The registered function mask is used to determine whether a requested<!-- entering slot 647 -->
function is performed by the registered mouse subsystem or default to the
Base Mouse Subsystem.
<P>
The following list shows the relationship of the mouse API calls and the
Function Code passed to either the Base Mouse Subsystem or a registered
mouse subsystem.<!-- lm: 0x2 1 -->
<P>
MOU API calls<!-- lm: 0x2 29 -->
<UL> Function Code<!-- lm: 0x2 1 -->
</UL>MouGetNumButtons<!-- lm: 0x2 29 -->
<UL> 00H<!-- lm: 0x2 1 -->
</UL>MouGetNumMickeys<!-- lm: 0x2 29 -->
<UL> 01H<!-- lm: 0x2 1 -->
</UL>MouGetDevStatus<!-- lm: 0x2 29 -->
<UL> 02H<!-- lm: 0x2 1 -->
</UL>MouGetNumQueEl<!-- lm: 0x2 29 -->
<UL> 03H<!-- lm: 0x2 1 -->
</UL>MouReadEventQue<!-- lm: 0x2 29 -->
<UL> 03H<!-- lm: 0x2 1 -->
</UL>MouGetScaleFact<!-- lm: 0x2 29 -->
<UL> 05H<!-- lm: 0x2 1 -->
</UL>MouGetEventMask<!-- lm: 0x2 29 -->
<UL> 06H<!-- lm: 0x2 1 -->
</UL>MouSetScaleFact<!-- lm: 0x2 29 -->
<UL> 07H<!-- lm: 0x2 1 -->
</UL>MouSetEventMask<!-- lm: 0x2 29 -->
<UL> 08H<!-- lm: 0x2 1 -->
</UL>Reserved<!-- lm: 0x2 29 -->
<UL> 09H<!-- lm: 0x2 1 -->
</UL>Reserved<!-- lm: 0x2 29 -->
<UL> 0AH<!-- lm: 0x2 1 -->
</UL>MouOpen<!-- lm: 0x2 29 -->
<UL> 0BH<!-- lm: 0x2 1 -->
</UL>MouClose<!-- lm: 0x2 29 -->
<UL> 0CH<!-- lm: 0x2 1 -->
</UL>MouGetPtrShape<!-- lm: 0x2 29 -->
<UL> 0DH<!-- lm: 0x2 1 -->
</UL>MouSetPtrShape<!-- lm: 0x2 29 -->
<UL> 0EH<!-- lm: 0x2 1 -->
</UL>MouDrawPtr<!-- lm: 0x2 29 -->
<UL> 0FH<!-- lm: 0x2 1 -->
</UL>MouRemovePtr<!-- lm: 0x2 29 -->
<UL> 10H<!-- lm: 0x2 1 -->
</UL>MouGetPtrPos<!-- lm: 0x2 29 -->
<UL> 11H<!-- lm: 0x2 1 -->
</UL>MouSetPtrPos<!-- lm: 0x2 29 -->
<UL> 12H<!-- lm: 0x2 1 -->
</UL>MouInitReal<!-- lm: 0x2 29 -->
<UL> 13H<!-- lm: 0x2 1 -->
</UL>MouFlushQue<!-- lm: 0x2 29 -->
<UL> 14H<!-- lm: 0x2 1 -->
</UL>MouSetDevStatus<!-- lm: 0x2 29 -->
<UL> 15H<!-- lm: 0x2 1 -->
</UL>
<P>
A registered mouse sybsystem must leave the stack, on exit, in the exact
state it was received.

<P><HR>

<A HREF="599_L2_MouReadEventQue.html">[Back: MouReadEventQue]</A> <BR>
<A HREF="601_L2_MouRemovePtr.html">[Next: MouRemovePtr]</A> 
</BODY>
</HTML>
