<HTML>
<HEAD>
<TITLE>KbdGetStatus</TITLE>
</HEAD>
<BODY>
<H1>KbdGetStatus</H1><!-- entering slot 579 -->Bindings:  <A HREF="554_L2H_KbdGetStatus.html">C</A>,
<A HREF="573_L2H_KbdGetStatus.html">MASM</A>
<BR>

<P>
This call gets the current state of the keyboard.<!-- lm: 0x2 1 -->
<UL>
<P>
KbdGetStatus<!-- lm: 0x2 17 -->
<UL> (StatData, KbdHandle)<!-- lm: 0x2 1 -->
</UL><!-- lm: 0x2 1 -->
<P>
<B>StatData</B> (PKBDINFO) - output<!-- lm: 0x11 4 -->
<UL> Address of the
keyboard status structure:<!-- lm: 0x2 4 -->
<P>
<B>length</B> (USHORT)<!-- lm: 0x11 7 -->
<UL> Length, in bytes, of this
data structure, including length.<!-- lm: 0x2 7 -->
<P>
10<!-- lm: 0x2 17 -->
<UL> Only valid value.<!-- lm: 0x2 4 -->
</UL><B> sysstate
</B>(USHORT)<!-- lm: 0x11 7 -->
<UL> State as follows:<!-- lm: 0x2 7 -->
<P>
Bit<!-- lm: 0x2 17 -->
<UL> Description<!-- lm: 0x2 7 -->
</UL>15-9<!-- lm: 0x2 17 -->
<UL> Reserved, set to zero.<!-- lm: 0x2 7 -->
</UL>8<!-- lm: 0x2 17 -->
<UL> Shift return is on.<!-- lm: 0x2 7 -->
</UL>7<!-- lm: 0x2 17 -->
<UL> Length of the turn-around character (meaningful
only if bit 6 is on).<!-- lm: 0x2 7 -->
</UL>6<!-- lm: 0x2 17 -->
<UL> Turn-around character is modified.<!-- lm: 0x2 7 -->
</UL>5<!-- lm: 0x2 17 -->
<UL> Interim character flags are modified.<!-- lm: 0x2 7 -->
</UL>4<!-- lm: 0x2 17 -->
<UL> Shift state is modified.<!-- lm: 0x2 7 -->
</UL>3<!-- lm: 0x2 17 -->
<UL> ASCII mode is on.<!-- lm: 0x2 7 -->
</UL>2<!-- lm: 0x2 17 -->
<UL> Binary mode is on.<!-- lm: 0x2 7 -->
</UL>1<!-- lm: 0x2 17 -->
<UL> Echo off.<!-- lm: 0x2 7 -->
</UL>0<!-- lm: 0x2 17 -->
<UL> Echo on.<!-- lm: 0x2 4 -->
</UL><B> turnchardef
</B>(USHORT)<!-- lm: 0x11 7 -->
<UL> Definition of the turn-around character.
In ASCII and extended-ASCII format, the turn-around character is defined
as the carriage return.  In ASCII format only, the turn-around character
is defined in the low-order byte.<!-- lm: 0x2 4 -->
</UL><B> intcharflag
</B>(USHORT)<!-- lm: 0x11 7 -->
<UL> Interim character flags:<!-- lm: 0x2 7 -->
<P>
Bit<!-- lm: 0x2 17 -->
<UL> Description<!-- lm: 0x2 7 -->
</UL>15-8<!-- lm: 0x2 17 -->
<UL> NLS shift state.<!-- lm: 0x2 7 -->
</UL>7<!-- lm: 0x2 17 -->
<UL> Interim character flag is on.<!-- lm: 0x2 7 -->
</UL>6<!-- lm: 0x2 17 -->
<UL> Reserved, set to zero.<!-- lm: 0x2 7 -->
</UL>5<!-- lm: 0x2 17 -->
<UL> Application requested immediate conversion.
<!-- lm: 0x2 7 -->
</UL>4-0<!-- lm: 0x2 17 -->
<UL> Reserved, set to zero.<!-- lm: 0x2 4 -->
</UL><B> shiftstate
</B>(USHORT)<!-- lm: 0x11 7 -->
<UL> Shift state as follows:<!-- lm: 0x2 7 -->
<P>
Bit<!-- lm: 0x2 17 -->
<UL> Description<!-- lm: 0x2 7 -->
</UL>15<!-- lm: 0x2 17 -->
<UL> SysReq key down<!-- lm: 0x2 7 -->
</UL>14<!-- lm: 0x2 17 -->
<UL> CapsLock key down<!-- lm: 0x2 7 -->
</UL>13<!-- lm: 0x2 17 -->
<UL> NumLock key down<!-- lm: 0x2 7 -->
</UL>12<!-- lm: 0x2 17 -->
<UL> ScrollLock key down<!-- lm: 0x2 7 -->
</UL>11<!-- lm: 0x2 17 -->
<UL> Right Alt key down<!-- lm: 0x2 7 -->
</UL>10<!-- lm: 0x2 17 -->
<UL> Right Ctrl key down<!-- lm: 0x2 7 -->
</UL>9<!-- lm: 0x2 17 -->
<UL> Left Alt key down<!-- lm: 0x2 7 -->
</UL>8<!-- lm: 0x2 17 -->
<UL> Left Ctrl key down<!-- lm: 0x2 7 -->
</UL>7<!-- lm: 0x2 17 -->
<UL> Insert on<!-- lm: 0x2 7 -->
</UL>6<!-- lm: 0x2 17 -->
<UL> CapsLock on<!-- lm: 0x2 7 -->
</UL>5<!-- lm: 0x2 17 -->
<UL> NumLock on<!-- lm: 0x2 7 -->
</UL>4<!-- lm: 0x2 17 -->
<UL> ScrollLock on<!-- lm: 0x2 7 -->
</UL>3<!-- lm: 0x2 17 -->
<UL> Either Alt key down<!-- lm: 0x2 7 -->
</UL>2<!-- lm: 0x2 17 -->
<UL> Either Ctrl key down<!-- lm: 0x2 7 -->
</UL>1<!-- lm: 0x2 17 -->
<UL> Left Shift key down<!-- lm: 0x2 7 -->
</UL>0<!-- lm: 0x2 17 -->
<UL> Right Shift key down.<!-- lm: 0x2 1 -->
</UL><B> KbdHandle
</B>(HKBD) - input<!-- lm: 0x11 4 -->
<UL> Default keyboard or the logical
keyboard.<!-- lm: 0x2 1 -->
</UL><B> rc</B> (USHORT) - return<!-- lm: 0x11 4 -->
<UL> Return
code descriptions are:<!-- lm: 0x2 4 -->
<P>
<LI><!-- lm: 0x2 14 -->NO_ERROR<!-- lm: 0x2 4 --> 376<!-- lm: 0x2 14 -->
<UL> ERROR_KBD_INVALID_LENGTH
<!-- lm: 0x2 4 -->
</UL>439<!-- lm: 0x2 14 -->
<UL> ERROR_KBD_INVALID_HANDLE<!-- lm: 0x2 4 -->
</UL>445<!-- lm: 0x2 14 -->
<UL> ERROR_KBD_FOCUS_REQUIRED<!-- lm: 0x2 4 -->
</UL>447<!-- lm: 0x2 14 -->
<UL> ERROR_KBD_KEYBOARD_BUSY<!-- lm: 0x2 4 -->
</UL>464<!-- lm: 0x2 14 -->
<UL> ERROR_KBD_DETACHED<!-- lm: 0x2 4 -->
</UL>504<!-- lm: 0x2 14 -->
<UL> ERROR_KBD_EXTENDED_SG<!-- lm: 0x2 1 -->
</UL><B>Remarks</B>
<P>
The initial state of the keyboard is established by the system at application
load time.  Some default states may be modified by the application through
<A HREF="542_L2_KbdSetStatus.html">KbdSetStatus</A>.  KbdGetStatus returns
only those keyboard parameters initially set by <A HREF="542_L2_KbdSetStatus.html">KbdSetStatus</A>.
The returned parameters are:<!-- lm: 0x2 1 -->
<P>
o<!-- lm: 0x2 3 -->
<UL>Input Mode<!-- lm: 0x2 1 -->
</UL>o<!-- lm: 0x2 3 -->
<UL>Interim Character Flags<!-- lm: 0x2 1 -->
</UL>o<!-- lm: 0x2 3 -->
<UL>Shift State<!-- lm: 0x2 1 -->
</UL>o<!-- lm: 0x2 3 -->
<UL>Echo State<!-- lm: 0x2 1 -->
</UL>o<!-- lm: 0x2 3 -->
<UL>Turnaround Character<!-- lm: 0x2 1 -->
</UL>
<P>
KbdGetStatus completes only when the handle has access to the physical keyboard
(focus) or the handle is 0 and no other handle has the focus.
<P>
<B>Family API Considerations</B>
<P>
Some options operate differently in the DOS mode than in the OS/2 mode.
Therefore, the following restrictions apply to KbdGetStatus when coding
in the DOS mode:<!-- lm: 0x2 1 -->
<P>
o<!-- lm: 0x2 3 -->
<UL>Interim character is not supported<!-- lm: 0x2 1 -->
</UL>o<!-- lm: 0x2 3 -->
<UL>TurnAround character is not supported<!-- lm: 0x2 1 -->
</UL>o<!-- lm: 0x2 3 -->
<UL>NLS_SHIFT_STATE is always NULL.<!-- lm: 0x2 1 -->
</UL>o<!-- lm: 0x2 3 -->
<UL>KbdHandle is ignored.<!-- lm: 0x2 1 -->
</UL>

<P><HR>

<A HREF="534_L2_KbdGetHWId.html">[Back: KbdGetHWId]</A> <BR>
<A HREF="536_L2_KbdOpen.html">[Next: KbdOpen]</A> 
</BODY>
</HTML>
