<HTML>
<HEAD>
<META HTTP-EQUIV="CONTENT-TYPE" CONTENT="TEXT/HTML; CHARSET=UTF-8">
<TITLE>DosDupHandle</TITLE>
<STYLE>
PRE {
  FONT-FAMILY: Consolas, "Lucida Console", "Courier New", Courier, MONOSPACE;
}
</STYLE>
</HEAD>
<BODY>
<H1>DosDupHandle</H1><!-- entering slot 29 -->Bindings:  <A HREF="202_L2H_DosDupHandle.html">C</A>,
<A HREF="377_L2H_DosDupHandle.html">MASM</A>
<BR>

<P>
This call returns a new file handle for an open file, which refers to the
same position in the file as the old file handle.<!-- lm: 0x2 1 -->
<UL>
<P>
DosDupHandle<!-- lm: 0x2 18 -->
<UL> (OldFileHandle, NewFileHandle)<!-- lm: 0x2 1 -->
</UL><!-- lm: 0x2 1 -->
<P>
<B>OldFileHandle</B> (HFILE) - input<!-- lm: 0x11 4 -->
<UL> Current file
handle.<!-- lm: 0x2 1 -->
</UL><B> NewFileHandle</B> (PHFILE) - input/output
<!-- lm: 0x11 4 -->
<UL>Address of a Word.  On input, values and their meanings
are:<!-- lm: 0x2 4 -->
<P>
Value<!-- lm: 0x2 14 -->
<UL> Definition<!-- lm: 0x2 4 -->
</UL> FFFFH<!-- lm: 0x2 14 -->
<UL> Allocate a new file handle and return
it here.<!-- lm: 0x2 4 -->
</UL>&lt;&gt;FFFFH<!-- lm: 0x2 14 -->
<UL> Assign this value as the new
file handle. A valid value is any of the handles assigned to standard I/O,
or the handle of a file currently opened by the process.
<P>
On output, a value of FFFFH returns a value for NewFileHandle, allocated
by OS/2.<!-- lm: 0x2 1 -->
</UL><B> rc</B> (USHORT) - return<!-- lm: 0x11 4 -->
<UL> Return
code descriptions are:<!-- lm: 0x2 4 -->
<P>
<LI><!-- lm: 0x2 14 -->NO_ERROR<!-- lm: 0x2 4 --> 4<!-- lm: 0x2 14 -->
<UL> ERROR_TOO_MANY_OPEN_FILES
<!-- lm: 0x2 4 -->
</UL>6<!-- lm: 0x2 14 -->
<UL> ERROR_INVALID_HANDLE<!-- lm: 0x2 4 -->
</UL>114<!-- lm: 0x2 14 -->
<UL> ERROR_INVALID_TARGET_HANDLE<!-- lm: 0x2 1 -->
</UL><B>Remarks</B>
<P>
Duplicating the handle duplicates and ties all handle-specific information
between OldFileHandle and NewFileHandle. For example, if you move the read/write
pointer of either handle by a <A HREF="124_L2_DosRead.html">DosRead</A>,
<A HREF="173_L2_DosWrite.html">DosWrite</A>, or <A HREF="010_L2_DosChgFilePtr.html">DosChgFilePtr
</A>function call, the pointer for the other handle is also changed.
<P>
The valid values for NewFileHandle include the following handles for standard
I/O, which are always available to the process:<!-- lm: 0x2 1 -->
<P>
0000H<!-- lm: 0x2 11 -->
<UL> Standard input<!-- lm: 0x2 1 -->
</UL>0001H<!-- lm: 0x2 11 -->
<UL> Standard output<!-- lm: 0x2 1 -->
</UL>0002H<!-- lm: 0x2 11 -->
<UL> Standard error.<!-- lm: 0x2 1 -->
</UL>
<P>
If a file handle value of a currently open file is specified in NewFileHandle,
the file handle is closed before it is redefined as the duplicate of OldFileHandle.
Avoid using arbitrary values for NewFileHandle.
<P>
Issuing a <A HREF="012_L2_DosClose.html">DosClose</A> against a file handle
does not affect the duplicate handle.

<P><HR>

<A HREF="026_L2_DosDisConnectNmPipe.html">[Back: DosDisConnectNmPipe]</A> <BR>
<A HREF="028_L2_DosEditName.html">[Next: DosEditName]</A> 
</BODY>
</HTML>
