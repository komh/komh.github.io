<HTML>
<HEAD>
<META HTTP-EQUIV="CONTENT-TYPE" CONTENT="TEXT/HTML; CHARSET=UTF-8">
<TITLE>DosQAppType</TITLE>
</HEAD>
<BODY>
<H1>DosQAppType</H1><!-- entering slot 132 -->Bindings:  <A HREF="282_L2H_DosQAppType.html">C</A>,
<A HREF="457_L2H_DosQAppType.html">MASM</A>
<BR>

<P>
This call returns the application type of an executable file.<!-- lm: 0x2 1 -->
<UL>
<P>
DosQAppType<!-- lm: 0x2 17 -->
<UL> (ExecutableFileName, AppType)<!-- lm: 0x2 1 -->
</UL><!-- lm: 0x2 1 -->
<P>
<B>ExecutableFileName</B> (PSZ) - input<!-- lm: 0x11 4 -->
<UL> Address
of the ASCIIZ string containing the filename of the executable file where
the flags are returned.
<P>
If the string appears to be a fully qualified path (contains a " : " in
the second position and/or contains a " \ "), only the indicated drive:directory
is searched. If the string is not a fully qualified path, the current directory
is searched.  If the filename is not found in the current directory, each
drive:directory specification in the PATH defined in the current program's
environment is searched for this file.  Note that any extension (.xxx) is
acceptable for the executable filename.  If no extension is specified, a
default extension of ".exe" is used. AppType is a word that contains flags
denoting the application type, as determined by reading the executable file
header specified by ExecutableFileName. Note that the call sequence passes
a pointer to a location in application memory to return the application
type flags.<!-- lm: 0x2 1 -->
</UL><B> AppType</B> (PUSHORT) - output<!-- lm: 0x11 4 -->
<UL> Address
of the application type defined as follows:<!-- lm: 0x2 4 -->
<P>
Bit<!-- lm: 0x2 14 -->
<UL> Description<!-- lm: 0x2 4 -->
</UL> 15-6<!-- lm: 0x2 14 -->
<UL> Reserved.
<!-- lm: 0x2 4 -->
</UL>5<!-- lm: 0x2 14 -->
<UL> Set to 1 if executable
file is PC DOS format.  Bits 0, 1, 2, 3, and 4 are set to zero.<!-- lm: 0x2 4 -->
</UL> 4
<!-- lm: 0x2 14 -->
<UL>Set to 1 if executable file is a dynamic link module.
 Bits 0, 1, 2, 3, and 5 are set to 0.<!-- lm: 0x2 4 -->
</UL> 3<!-- lm: 0x2 14 -->
<UL> Set
to 1 if executable has been "bound" (BIND command) as a Family API application.
 Bits 0, 1 and 2 still apply.<!-- lm: 0x2 4 -->
</UL> 2-0<!-- lm: 0x2 14 -->
<UL> Bits
2, 1 and 0 indicate application type, as specified in the header of the
executable file.<!-- lm: 0x2 7 -->
</UL> Value<!-- lm: 0x2 17 -->
<UL> Definition
<!-- lm: 0x2 7 -->
</UL>000<!-- lm: 0x2 17 -->
<UL> Application type is not specified in executable
header.<!-- lm: 0x2 7 -->
</UL>001<!-- lm: 0x2 17 -->
<UL> Application is NOTWINDOWCOMPAT<!-- lm: 0x2 7 -->
</UL>010<!-- lm: 0x2 17 -->
<UL> Application type is WINDOWCOMPAT<!-- lm: 0x2 7 -->
</UL>011<!-- lm: 0x2 17 -->
<UL> Application type is WINDOWAPI<!-- lm: 0x2 1 -->
</UL><B> rc
</B>(USHORT) - return<!-- lm: 0x11 4 -->
<UL> Return code descriptions are:
<!-- lm: 0x2 4 -->
<P>
<LI><!-- lm: 0x2 14 -->NO_ERROR<!-- lm: 0x2 4 --> 2<!-- lm: 0x2 14 -->
<UL> ERROR_FILE_NOT_FOUND
<!-- lm: 0x2 4 -->
</UL>3<!-- lm: 0x2 14 -->
<UL> ERROR_PATH_NOT_FOUND<!-- lm: 0x2 4 -->
</UL>4<!-- lm: 0x2 14 -->
<UL> ERROR_TOO_MANY_OPEN_FILES<!-- lm: 0x2 4 -->
</UL>11<!-- lm: 0x2 14 -->
<UL> ERROR_BAD_FORMAT<!-- lm: 0x2 4 -->
</UL>15<!-- lm: 0x2 14 -->
<UL> ERROR_INVALID_DRIVE<!-- lm: 0x2 4 -->
</UL>32<!-- lm: 0x2 14 -->
<UL> ERROR_SHARING_VIOLATION<!-- lm: 0x2 4 -->
</UL>108<!-- lm: 0x2 14 -->
<UL> ERROR_DRIVE_LOCKED<!-- lm: 0x2 4 -->
</UL>110<!-- lm: 0x2 14 -->
<UL> ERROR_OPEN_FAILED<!-- lm: 0x2 4 -->
</UL>191<!-- lm: 0x2 14 -->
<UL> ERROR_INVALID_EXE_SIGNATURE<!-- lm: 0x2 4 -->
</UL>192<!-- lm: 0x2 14 -->
<UL> ERROR_EXE_MARKED_INVALID<!-- lm: 0x2 1 -->
</UL><B>Remarks</B>
<P>
This function is used by the Presentation Manager shell to determine the
application type being executed.  The application type is specified at link
time in the module definition file.

<P><HR>

<A HREF="106_L2_DosPutMessage.html">[Back: DosPutMessage]</A> <BR>
<A HREF="108_L2_DosQCurDir.html">[Next: DosQCurDir]</A> 
</BODY>
</HTML>
