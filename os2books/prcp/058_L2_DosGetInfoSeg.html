<HTML>
<HEAD>
<TITLE>DosGetInfoSeg</TITLE>
</HEAD>
<BODY>
<H1>DosGetInfoSeg</H1><!-- entering slot 71 -->Bindings:  <A HREF="233_L2H_DosGetInfoSeg.html">C</A>,
<A HREF="408_L2H_DosGetInfoSeg.html">MASM</A>
<BR>

<P>
This call returns the address of a global and local information segment,
specific to a process.<!-- lm: 0x2 1 -->
<UL>
<P>
DosGetInfoSeg<!-- lm: 0x2 19 -->
<UL> (GlobalSeg, LocalSeg)<!-- lm: 0x2 1 -->
</UL><!-- lm: 0x2 1 -->
<P>
<B>GlobalSeg</B> (PSEL) - output<!-- lm: 0x11 4 -->
<UL> Address of the
global information segment structure, as defined below:<!-- lm: 0x2 4 -->
<P>
<B>time</B> (ULONG)<!-- lm: 0x11 7 -->
<UL> Time in seconds since 1/1/1970.
<!-- lm: 0x2 4 -->
</UL><B>millisecs</B> (ULONG)<!-- lm: 0x11 7 -->
<UL> Time
in milliseconds.<!-- lm: 0x2 4 -->
</UL><B> hours</B> (UCHAR)<!-- lm: 0x11 7 -->
<UL> Current
hour.<!-- lm: 0x2 4 -->
</UL><B> minute</B> (UCHAR)<!-- lm: 0x11 7 -->
<UL> Current
minute.<!-- lm: 0x2 4 -->
</UL><B> seconds</B> (UCHAR)<!-- lm: 0x11 7 -->
<UL> Current
second.<!-- lm: 0x2 4 -->
</UL><B> hundredsec</B> (UCHAR)<!-- lm: 0x11 7 -->
<UL> Current
hundredth of a second.<!-- lm: 0x2 4 -->
</UL><B> timezone</B> (USHORT)
<!-- lm: 0x11 7 -->
<UL>Minutes from UTC; if hex FFFFH, timezone is undefined.
<!-- lm: 0x2 4 -->
</UL><B>interval</B> (USHORT)<!-- lm: 0x11 7 -->
<UL> Timer
interval in tenths of milliseconds.<!-- lm: 0x2 4 -->
</UL><B> day</B> (UCHAR)
<!-- lm: 0x11 7 -->
<UL>Day.<!-- lm: 0x2 4 -->
</UL><B> month</B> (UCHAR)
<!-- lm: 0x11 7 -->
<UL>Month.<!-- lm: 0x2 4 -->
</UL><B> year</B> (USHORT)
<!-- lm: 0x11 7 -->
<UL>Year.<!-- lm: 0x2 4 -->
</UL><B> weekday</B> (UCHAR)
<!-- lm: 0x11 7 -->
<UL>Day-of-week:<!-- lm: 0x2 7 -->
<P>
Value<!-- lm: 0x2 17 -->
<UL> Definition<!-- lm: 0x2 7 -->
</UL>0<!-- lm: 0x2 17 -->
<UL> Sunday<!-- lm: 0x2 7 -->
</UL>1<!-- lm: 0x2 17 -->
<UL> Monday<!-- lm: 0x2 7 -->
</UL>2<!-- lm: 0x2 17 -->
<UL> Tuesday<!-- lm: 0x2 7 -->
</UL>3<!-- lm: 0x2 17 -->
<UL> Wednesday<!-- lm: 0x2 7 -->
</UL>4<!-- lm: 0x2 17 -->
<UL> Thursday<!-- lm: 0x2 7 -->
</UL>5<!-- lm: 0x2 17 -->
<UL> Friday<!-- lm: 0x2 7 -->
</UL>6<!-- lm: 0x2 17 -->
<UL> Saturday<!-- lm: 0x2 4 -->
</UL><B> majorversion
</B>(UCHAR)<!-- lm: 0x11 7 -->
<UL> Major version number.<!-- lm: 0x2 4 -->
</UL><B> minorversion
</B>(UCHAR)<!-- lm: 0x11 7 -->
<UL> Minor version number.<!-- lm: 0x2 4 -->
</UL><B> revision
</B>(UCHAR)<!-- lm: 0x11 7 -->
<UL> Revision letter.<!-- lm: 0x2 4 -->
</UL><B> currentsession
</B>(UCHAR)<!-- lm: 0x11 7 -->
<UL> Current foreground full-screen session.
<!-- lm: 0x2 4 -->
</UL><B>maxnumsessions</B> (UCHAR)<!-- lm: 0x11 7 -->
<UL> Maximum
number of full-screen sessions.<!-- lm: 0x2 4 -->
</UL><B> hugeshift</B> (UCHAR)
<!-- lm: 0x11 7 -->
<UL>Shift count for huge segments.<!-- lm: 0x2 4 -->
</UL><B> protmodeind
</B>(UCHAR)<!-- lm: 0x11 7 -->
<UL> Protect-mode-only indicator:<!-- lm: 0x2 7 -->
<P>
Value<!-- lm: 0x2 17 -->
<UL> Definition<!-- lm: 0x2 7 -->
</UL>0<!-- lm: 0x2 17 -->
<UL> DOS mode and OS/2 mode.<!-- lm: 0x2 7 -->
</UL>1<!-- lm: 0x2 17 -->
<UL> OS/2 mode only.<!-- lm: 0x2 4 -->
</UL><B> lastprocess
</B>(USHORT)<!-- lm: 0x11 7 -->
<UL> Process ID of the current foreground
process.<!-- lm: 0x2 4 -->
</UL><B> dynvarflag</B> (UCHAR)<!-- lm: 0x11 7 -->
<UL> Dynamic
variation flag:<!-- lm: 0x2 7 -->
<P>
Value<!-- lm: 0x2 17 -->
<UL> Definition<!-- lm: 0x2 7 -->
</UL>0<!-- lm: 0x2 17 -->
<UL> Absolute<!-- lm: 0x2 7 -->
</UL>1<!-- lm: 0x2 17 -->
<UL> Enabled.<!-- lm: 0x2 4 -->
</UL><B> maxwait
</B>(UCHAR)<!-- lm: 0x11 7 -->
<UL> Maximum wait in seconds.<!-- lm: 0x2 4 -->
</UL><B> mintimeslice
</B>(USHORT)<!-- lm: 0x11 7 -->
<UL> Minimum timeslice in milliseconds.
<!-- lm: 0x2 4 -->
</UL><B>maxtimeslice</B> (USHORT)<!-- lm: 0x11 7 -->
<UL> Maximum
timeslice in milliseconds.<!-- lm: 0x2 4 -->
</UL><B> bootdrive</B> (USHORT)
<!-- lm: 0x11 7 -->
<UL>Drive from which the system was booted:<!-- lm: 0x2 7 -->
<P>
Value<!-- lm: 0x2 17 -->
<UL> Definition<!-- lm: 0x2 7 -->
</UL>1<!-- lm: 0x2 17 -->
<UL> Drive A.<!-- lm: 0x2 7 -->
</UL>2<!-- lm: 0x2 17 -->
<UL> Drive B.<!-- lm: 0x2 7 -->
</UL>.<!-- lm: 0x2 17 -->
<UL>  <!-- lm: 0x2 7 -->
</UL>.<!-- lm: 0x2 17 -->
<UL>  <!-- lm: 0x2 7 -->
</UL>.<!-- lm: 0x2 17 -->
<UL>  <!-- lm: 0x2 7 -->
</UL>n<!-- lm: 0x2 17 -->
<UL> Drive n.<!-- lm: 0x2 4 -->
</UL><B> traceflags
</B>(UCHAR)<!-- lm: 0x11 7 -->
<UL> 32 system trace major code flags. Each
bit corresponds to a trace major code, hex 00-FFH. The most significant
bit (left-most) of the first byte corresponds to major code hex 00H.<!-- lm: 0x2 7 -->
<P>
Value<!-- lm: 0x2 17 -->
<UL> Definition<!-- lm: 0x2 7 -->
</UL>0<!-- lm: 0x2 17 -->
<UL> Trace disabled.<!-- lm: 0x2 7 -->
</UL>1<!-- lm: 0x2 17 -->
<UL> Trace enabled.<!-- lm: 0x2 4 -->
</UL><B> maxtextsessions
</B>(UCHAR)<!-- lm: 0x11 7 -->
<UL> Maximum number of VIO windowable sessions.
<!-- lm: 0x2 4 -->
</UL><B>maxpmsessions</B> (UCHAR)<!-- lm: 0x11 7 -->
<UL> Maximum
number of Presentation Manager sessions.<!-- lm: 0x2 1 -->
</UL><B> LocalSeg
</B>(PSEL) - output<!-- lm: 0x11 4 -->
<UL> Address of the selector for
the local information segment structure, as defined below:<!-- lm: 0x2 4 -->
<P>
<B>processid</B> (PID)<!-- lm: 0x11 7 -->
<UL> Current process ID.<!-- lm: 0x2 4 -->
</UL><B> parentprocessid
</B>(PID)<!-- lm: 0x11 7 -->
<UL> Parent process ID.<!-- lm: 0x2 4 -->
</UL><B> threadprty
</B>(USHORT)<!-- lm: 0x11 7 -->
<UL> Priority of current thread.<!-- lm: 0x2 4 -->
</UL><B> threadid
</B>(TID)<!-- lm: 0x11 7 -->
<UL> Current thread ID.<!-- lm: 0x2 4 -->
</UL><B> sessionid
</B>(USHORT)<!-- lm: 0x11 7 -->
<UL> Current session ID.<!-- lm: 0x2 4 -->
</UL><B> procstatus
</B>(UCHAR)<!-- lm: 0x11 7 -->
<UL> Process status.<!-- lm: 0x2 4 -->
</UL><B> unused
</B>(UCHAR)<!-- lm: 0x11 7 -->
<UL> Unused.<!-- lm: 0x2 4 -->
</UL><B> foregroundprocess
</B>(BOOL)<!-- lm: 0x11 7 -->
<UL> Current process is in foreground (has
keyboard focus). Value -1 implies yes, 0 implies no.<!-- lm: 0x2 4 -->
</UL><B> typeProcess
</B>(UCHAR)<!-- lm: 0x11 7 -->
<UL> Type of process:<!-- lm: 0x2 7 -->
<P>
Value<!-- lm: 0x2 17 -->
<UL> Definition<!-- lm: 0x2 7 -->
</UL>0<!-- lm: 0x2 17 -->
<UL> Full screen protect mode session.<!-- lm: 0x2 7 -->
</UL>1<!-- lm: 0x2 17 -->
<UL> Requires real mode.<!-- lm: 0x2 7 -->
</UL>2<!-- lm: 0x2 17 -->
<UL> VIO windowable protect mode session.<!-- lm: 0x2 7 -->
</UL>3<!-- lm: 0x2 17 -->
<UL> Presentation Manager protect mode session.
<!-- lm: 0x2 7 -->
</UL>4<!-- lm: 0x2 17 -->
<UL> Detached protect mode process.<!-- lm: 0x2 4 -->
</UL><B> unused
</B>(UCHAR)<!-- lm: 0x11 7 -->
<UL> Unused.<!-- lm: 0x2 4 -->
</UL><B> environmentsel
</B>(SEL)<!-- lm: 0x11 7 -->
<UL> Environment selector.<!-- lm: 0x2 4 -->
</UL><B> cmdlineoff
</B>(USHORT)<!-- lm: 0x11 7 -->
<UL> Command line offset in the segment
addressed by environmentsel.<!-- lm: 0x2 4 -->
</UL><B> dataseglen</B> (USHORT)
<!-- lm: 0x11 7 -->
<UL>Length of data segment in bytes.<!-- lm: 0x2 4 -->
</UL><B> stacksize
</B>(USHORT)<!-- lm: 0x11 7 -->
<UL> Stack size in bytes.<!-- lm: 0x2 4 -->
</UL><B> heapsize
</B>(USHORT)<!-- lm: 0x11 7 -->
<UL> Heap size in bytes.<!-- lm: 0x2 4 -->
</UL><B> hmodule
</B>(HMODULE)<!-- lm: 0x11 7 -->
<UL> Module handle.<!-- lm: 0x2 4 -->
</UL><B> dssel
</B>(SEL)<!-- lm: 0x11 7 -->
<UL> Data segment selector.<!-- lm: 0x2 1 -->
</UL><B> rc
</B>(USHORT) - return<!-- lm: 0x11 4 -->
<UL> Return code description is:
<!-- lm: 0x2 4 -->
<P>
<LI><!-- lm: 0x2 14 -->NO_ERROR<!-- lm: 0x2 1 -->
</UL><B>Remarks</B>
<P>
Items of general interest are kept in the global information segment. Items
of information specific to a particular process are kept in the local information
segment.  This information can be directly read<!-- entering slot 72 -->
by the application program.  Both of these segments are defined as read-only
segments.  The application program cannot modify this data.
<P>
Assuming n1, n2, and n3 are the maximum number of full-screen sessions,
VIO-windowable sessions, and Presentation Manager sessions, the first 0
through (n1-1) session numbers are assigned to full-screen sessions.  The
next n2 session numbers are assigned to VIO-windowable sessions, and the
next n3 session numbers are assigned to Presentation Manager sessions. Session
numbers in the range (n1+n2+n3) through 255 are reserved.  Applications
should use (n1+n2+n3-1) as an upper boundary. Applications should not assume
that all session numbers starting with (n1+n2) and higher are Presentation
Manager sessions.
<P>
The application program must be careful when referencing the date or time
fields in the global information segment.  A timer interrupt can be received
by the system in between the instructions that read the individual fields,
changing the data in these fields. For example, if the time is currently
23:59:59 on Tuesday, 6/2/87, the program can read the hours field (23).
A timer interrupt can now be received, changing the time to 00:00:00 on
Wednesday, 6/3/87.  The program reads the rest of the time field (0 minutes)
and the date field.  The program would then think the current time and date
is 23:00:00 on Wednesday, 6/3/87, which is incorrect.
<P>
The application program should read all time and date fields it uses as
quickly as possible.  It can then compare the least significant time field
it uses (milliseconds, hundredths, seconds, or minutes) against the current
value in the global information segment.  If the value has not changed,
the rest of the information is valid.  If the value has changed, the program
time or date information should be read again, as the information is updated
while the program reads it.

<P><HR>

<A HREF="057_L2_DosGetHugeShift.html">[Back: DosGetHugeShift]</A> <BR>
<A HREF="059_L2_DosGetMachineMode.html">[Next: DosGetMachineMode]</A> 
</BODY>
</HTML>
