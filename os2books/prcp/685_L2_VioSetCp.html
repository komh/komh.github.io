<HTML>
<HEAD>
<META HTTP-EQUIV="CONTENT-TYPE" CONTENT="TEXT/HTML; CHARSET=UTF-8">
<TITLE>VioSetCp</TITLE>
<STYLE>
PRE {
  FONT-FAMILY: Consolas, "Lucida Console", "Courier New", Courier, MONOSPACE;
}
</STYLE>
</HEAD>
<BODY>
<H1>VioSetCp</H1><!-- entering slot 739 -->Bindings:  <A HREF="729_L2H_VioSetCp.html">C</A>,
<A HREF="773_L2H_VioSetCp.html">MASM</A>
<BR>

<P>
This call allows a process to set the code page used to display text data
on the screen for the specified handle.<!-- lm: 0x2 1 -->
<UL>
<P>
VioSetCp<!-- lm: 0x2 13 -->
<UL> (Reserved, CodePageID, VioHandle)<!-- lm: 0x2 1 -->
</UL><!-- lm: 0x2 1 -->
<P>
<B>Reserved</B> (USHORT) - input<!-- lm: 0x11 4 -->
<UL> Reserved word of
0s.<!-- lm: 0x2 1 -->
</UL><B> CodePageID</B> (USHORT) - input<!-- lm: 0x11 4 -->
<UL> The
CodePageID must be either 0, -1, -2, or have been specified on the CONFIG.SYS
CODEPAGE = statement. A value of 0000 indicates that the code page is to
be set to the default ROM code page provided by the hardware. A value of
-1 enables the user font codepage if user fonts have previously been set
with <A HREF="688_L2_VioSetFont.html">VioSetFont</A>. A value of -2 disables
the user font and re-enables the prepared system codepage or ROM codepage
that was active before the user font was enabled.
<P>
If the code page ID is not 0, -1, -2, or does not match one of the ID's
on the CODEPAGE = statement, an error results. Refer to IBM Operating System/2
Command Reference for a complete description of CODEPAGE.<!-- lm: 0x2 1 -->
</UL><B> VioHandle
</B>(HVIO) - input<!-- lm: 0x11 4 -->
<UL> This must be zero unless the
caller is a Presentation Manager application, in which case it must be the
value returned by VioGetPs.<!-- lm: 0x2 1 -->
</UL><B> rc</B> (USHORT) -
return<!-- lm: 0x11 4 -->
<UL> Return code descriptions are:<!-- lm: 0x2 4 -->
<P>
<LI><!-- lm: 0x2 14 -->NO_ERROR<!-- lm: 0x2 4 --> 355<!-- lm: 0x2 14 -->
<UL> ERROR_VIO_MODE
<!-- lm: 0x2 4 -->
</UL>436<!-- lm: 0x2 14 -->
<UL> ERROR_VIO_INVALID_HANDLE<!-- lm: 0x2 4 -->
</UL>465<!-- lm: 0x2 14 -->
<UL> ERROR_VIO_DETACHED<!-- lm: 0x2 4 -->
</UL>469<!-- lm: 0x2 14 -->
<UL> ERROR_VIO_BAD_CP<!-- lm: 0x2 4 -->
</UL>470<!-- lm: 0x2 14 -->
<UL> ERROR_VIO_NO_CP<!-- lm: 0x2 4 -->
</UL>471<!-- lm: 0x2 14 -->
<UL> ERROR_VIO_NA_CP<!-- lm: 0x2 1 -->
</UL><B>Remarks</B>
<P>
VioSetCp can be used to enable and disable the user font code page as well
as the prepared system code pages.  If a prepared system code page or the
ROM code page is specified, any previously set code page is disabled and
the specified code page is enabled.
<P>
Specifying the special code page of -1 enables the user font code page if
user fonts have previously been set.  Specifying the special code page of
-2 disables the user font code page and re-enables the prepared system code
page or ROM code page that was active before the user font code page was
enabled.
<P>

<BR>
<B>PM Considerations</B>
<P>
Valid CodePageID values are 0 or one that was specified on the CONFIG.SYS

<BR>
CODEPAGE = statement; -1 and -2 are not valid for PM.
<P>
This call can be used to set an EBCDIC code page for Advanced VIO.  For
a full-screen or Vio-windowed application, this function causes the displayed
characters to be reinterpreted immediately in the new code page.  For a
Presentation Manager application, the characters in the base font are reinterpreted
in the new code page only when other events cause the characters to be repainted.
 This function has no effect on displayed characters that use a font other
than the base font.

<P><HR>

<A HREF="684_L2_VioSetAnsi.html">[Back: VioSetAnsi]</A> <BR>
<A HREF="686_L2_VioSetCurPos.html">[Next: VioSetCurPos]</A> 
</BODY>
</HTML>
