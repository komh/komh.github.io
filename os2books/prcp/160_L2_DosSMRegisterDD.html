<HTML>
<HEAD>
<META HTTP-EQUIV="CONTENT-TYPE" CONTENT="TEXT/HTML; CHARSET=UTF-8">
<TITLE>DosSMRegisterDD</TITLE>
</HEAD>
<BODY>
<H1>DosSMRegisterDD</H1><!-- entering slot 196 -->Bindings:  <A HREF="335_L2H_DosSMRegisterDD.html">C</A>,
<A HREF="510_L2H_DosSMRegisterDD.html">MASM</A>
<BR>

<P>
Allows a device driver to register itself with the Session Manager.<!-- lm: 0x2 1 -->
<UL>
<P>
DosSMRegisterDD<!-- lm: 0x2 22 -->
<UL> (RegisterData)<!-- lm: 0x2 1 -->
</UL><!-- lm: 0x2 1 -->
<P>
<B>RegisterData</B> (PREGISTERDATA) - input<!-- lm: 0x11 4 -->
<UL> Address
of the structure containing the RegisterData necessary for this call.<!-- lm: 0x2 4 -->
<P>
<B>Length</B> (USHORT)<!-- lm: 0x11 7 -->
<UL> Length of the data structure
in bytes including Length itself.  Length is 8 for OS/2 version 1.2.<!-- lm: 0x2 4 -->
</UL><B> Notification
</B>(USHORT)<!-- lm: 0x11 7 -->
<UL> Bit map that informs the session manager
when to issue the notification IOCTL to the device driver.  The bits of
this word are defined as follows:<!-- lm: 0x2 7 -->
<P>
Bit<!-- lm: 0x2 17 -->
<UL> Description<!-- lm: 0x2 7 -->
</UL>15-4<!-- lm: 0x2 17 -->
<UL> Reserved and must be set to zero.<!-- lm: 0x2 7 -->
</UL>3<!-- lm: 0x2 17 -->
<UL> Session termination notification.  Action
= 8<!-- lm: 0x2 7 -->
</UL>2<!-- lm: 0x2 17 -->
<UL> Post-Session restore notification.  Action
= 4<!-- lm: 0x2 7 -->
</UL>1<!-- lm: 0x2 17 -->
<UL> Post-Session save notification.  Action =
2<!-- lm: 0x2 7 -->
</UL>0<!-- lm: 0x2 17 -->
<UL> Pre-Session save notification.  Action =
1<!-- lm: 0x2 4 -->
</UL>  <!-- lm: 0x11 7 -->
<UL> Action is the unsigned
integer in the Action field of the notification IOCTL.  This tells the device
driver what is happening. Notice that the integers correspond to bits 0
to 3 being set.<!-- lm: 0x2 4 -->
</UL><B> DDName</B> (ULONG)<!-- lm: 0x11 7 -->
<UL> Address
of the device name, as an ASCIIZ string (ie. SCREEN$, KBD$, etc.).<!-- lm: 0x2 1 -->
</UL><B> rc
</B>(USHORT) - return<!-- lm: 0x11 4 -->
<UL> Return code descriptions are:
<!-- lm: 0x2 4 -->
<P>
418<!-- lm: 0x2 14 -->
<UL> ERROR_SMG_INVALID_CALL<!-- lm: 0x2 4 -->
</UL>461<!-- lm: 0x2 14 -->
<UL> ERROR_SMG_INVALID_DATA_LENGTH<!-- lm: 0x2 4 -->
</UL>515<!-- lm: 0x2 14 -->
<UL> ERROR_SMG_TOO_MANY_DDS<!-- lm: 0x2 4 -->
</UL>516<!-- lm: 0x2 14 -->
<UL> ERROR_SMG_INVALID_NOTIFICATION<!-- lm: 0x2 1 -->
</UL><B>Remarks</B>
<P>
The Session Manger calls the registered device driver during a session switch,
based on the specific form of notifications required.
<P>
The notification IOCTL passed to the device driver has the following format:
<!-- lm: 0x2 1 -->
<P>
Size<!-- lm: 0x2 11 -->
<UL> Definition<!-- lm: 0x2 1 -->
</UL>WORD<!-- lm: 0x2 11 -->
<UL> DevIOCtl packet length, including the
length itself<!-- lm: 0x2 1 -->
</UL>WORD<!-- lm: 0x2 11 -->
<UL> Screen switch notification type<!-- lm: 0x2 1 -->
</UL>WORD<!-- lm: 0x2 11 -->
<UL> Incoming session number<!-- lm: 0x2 1 -->
</UL>WORD<!-- lm: 0x2 11 -->
<UL> Outgoing session number.<!-- lm: 0x2 1 -->
</UL>
<P>
The device driver passes a bit map that informs the session manager when
the device driver needs to be called. The possible phases are:<!-- lm: 0x2 1 -->
<P>
Before a session save After a session save (before a restore)
<BR>
After a session restore
<BR>
After a session termination.<!-- lm: 0x2 1 -->
<BR>

<P>
The device drivers must issue this API only during their initialization
phase.  After the session manager has been initialized, it rejects all further
calls to this API, returning ERROR_SMG_INVALID_CALL.

<P><HR>

<A HREF="159_L2_DosSleep.html">[Back: DosSleep]</A> <BR>
<A HREF="161_L2_DosStartSession.html">[Next: DosStartSession]</A> 
</BODY>
</HTML>
