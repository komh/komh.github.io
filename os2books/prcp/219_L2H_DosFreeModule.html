<HTMLHIDDEN>
<HEAD>
<META HTTP-EQUIV="CONTENT-TYPE" CONTENT="TEXT/HTML; CHARSET=UTF-8">
<TITLE>DosFreeModule</TITLE>
<STYLE>
PRE {
  FONT-FAMILY: Consolas, "Lucida Console", "Courier New", Courier, MONOSPACE;
}
</STYLE>
</HEAD>
<BODY>
<H1>DosFreeModule</H1><!-- entering slot 262 -->
<PRE>#define INCL_DOSMODULEMGR

USHORT  rc = DosFreeModule(ModuleHandle);

HMODULE          ModuleHandle;  /* Module handle */

USHORT           rc;            /* return code */
</PRE>

<P>
<B>Example</B>
<P>
This example tries to load module ABCD. The system searches LIBPATH.  If
unsuccessful, the system tries to to load the module from the program's
directory (in case the user forgot to update LIBPATH).
<PRE>#define INCL_DOSMODULEMGR

#define MODULE_NAME "abcd"
#define FULL_MODULE_NAME "\\nifty\\abcd.dll"

CHAR    LoadError[100];
HMODULE ModuleHandle;
USHORT  rc;

   if (DosLoadModule(LoadError,                /* Object name buffer */
                     sizeof(LoadError),        /* Length of object name
                                                   buffer */
                     MODULE_NAME,              /* Module name string */
                     &amp;ModuleHandle) == 2)      /* Module handle */
      rc = DosLoadModule(LoadError,            /* Object name buffer */
                         sizeof(LoadError),    /* Length of object name
                                                   buffer */
                         FULL_MODULE_NAME,     /* Module name string */
                         &amp;ModuleHandle);       /* Module handle */
   rc = DosFreeModule(ModuleHandle);           /* Module handle */
</PRE>


<P><HR>

<A HREF="218_L2H_DosFlagProcess.html">[Back: DosFlagProcess]</A> <BR>
<A HREF="220_L2H_DosFreeResource.html">[Next: DosFreeResource]</A> 
</BODY>
</HTML>
