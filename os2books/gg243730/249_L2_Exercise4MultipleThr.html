<HTML>
<HEAD>
<META HTTP-EQUIV="CONTENT-TYPE" CONTENT="TEXT/HTML; CHARSET=UTF-8">
<TITLE>Exercise 4 - Multiple Threads</TITLE>
<STYLE>
PRE {
  FONT-FAMILY: Consolas, "Lucida Console", "Courier New", Courier, MONOSPACE;
}
</STYLE>
</HEAD>
<BODY>
<H1>Exercise 4 - Multiple Threads</H1><!-- entering slot 277 -->
<P>
This exercise demonstrates that an OS/2 program can start a very large number
of threads (up to a maximum of 4096, minus those threads the system has
already started). The program makes use of C Set/2<I> _beginthread function</I>.

<P>
In this exercise, the student is required to run the memory lab program:

<PRE>           <B>MEMLAB4.exe</B>

Syntax: MEMLAB4 &lt;number of threads&gt;
</PRE>

<P>
If number of threads is not entered, ten (10) is assumed.
<P>
This program does the following:<!-- lm: 0x2 0 -->
<P>
 <LI><LI><!-- lm: 0x2 4 -->Starts the specified number of threads.
<P>
Each thread is very simple; it merely issues a DosSleep() function call
and an occasional write to screen.  This is in order that all threads may
start within a reasonable time frame.
<P>
For practical reasons, do not try to start more than 200 threads.<!-- lm: 0x2 0 -->
<P>
 <LI><LI><!-- lm: 0x2 4 -->When all the threads are started, the program
waits for keyboard input.
<P>
At this time we suggest you issue the<I> PSTAT</I> command from an OS/2
Command Prompt.  Use the "\C" option.  This displays a list of all processes
and threads open in the system. You can also see the number of threads in
use for system functions.<!-- lm: 0x2 0 -->
<P>
 <LI><LI><!-- lm: 0x2 4 -->When the program receives a keystroke, it sets
a flag to request the threads to terminate.  When all started threads have
terminated, the program exits.<!-- lm: 0x2 0 -->
<BR>

<P>
The program listing is shown in <A HREF="251_L3_SourceCodeMEMLAB4C.html">Source
Code MEMLAB4.C</A>.
<P>
<B>If you are able to do the exercise </B> Please do so now. If not, refer
to the following explanation.<!-- lm: 0x2 0 -->
<P>

<P>
The following error message may be generated:
<P>
<B>DosCreateThread error = 164.</B>
<P>
This typically occurs when the maximum allowed number of threads specified
in CONFIG.SYS is less than the number of threads requested.
<P>
<B>Note:  </B> Remember that the specified number of threads in the CONFIG.SYS
file includes threads used by the operating system.  This amounts to approximately
22 threads.
<P>
If the required number of threads cannot be started, check the CONFIG.SYS
file.  This file contains a specification for the maximum number of threads
allowed in the system.  Increase the threads command to:<B> THREADS = 4095</B>,
and re-IPL the system.

<P><HR>

<A HREF="248_L3_SampleInputFileforME.html">[Back: Sample Input File for MEMLAB3.EXE]</A> <BR>
<A HREF="250_L2_ExpectedResultsFromE.html">[Next: Expected Results From Exercise 4]</A> 
</BODY>
</HTML>
