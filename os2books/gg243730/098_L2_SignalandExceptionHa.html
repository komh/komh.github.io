<HTML>
<HEAD>
<META HTTP-EQUIV="CONTENT-TYPE" CONTENT="TEXT/HTML; CHARSET=UTF-8">
<TITLE>Signal and Exception Handling</TITLE>
</HEAD>
<BODY>
<H1>Signal and Exception Handling</H1><!-- entering slot 106 -->
<P>
Under previous versions of OS/2, signals were dispatched from a number of
sources and were used to interrupt executing processes.  These signals included
Ctrl-C, Ctrl-Break, and signals generated by the<B> DosKillProcess()</B> function
call.
<P>
Under OS/2 Version 2.0, signal handling has been merged with exception handling
to provide a general, portable mechanism for handling all such events.  OS/2
Version 2.0 provides four new system functions for exception handling on
a per-thread basis:<!-- lm: 0x2 0 -->
<P>
<LI><!-- lm: 0x2 2 --><B>DosRaiseException()</B><!-- lm: 0x2 0 -->
<P>
<LI><!-- lm: 0x2 2 --><B>DosSetExceptionHandler()</B><!-- lm: 0x2 0 -->
<P>
<LI><!-- lm: 0x2 2 --><B>DosUnsetExceptionHandler()</B><!-- lm: 0x2 0 -->
<P>
<LI><!-- lm: 0x2 2 --><B>DosUnwindException()</B>.<!-- lm: 0x2 0 -->
<BR>

<P>
The<B> DosSetSignalExceptionFocus()</B> function is used to allow 32-bit
applications to inform the operating system that they are to be the focus
for Ctrl+Break and Ctrl-C signals.  However, these signals are dispatched
and treated as exceptions.
<P>
Applications may register their own routines using the<B> DosSetExceptionHandler()
</B>function to handle specific types of exceptions, including general protection
exceptions which could not be trapped by applications under previous versions
of OS/2.  These exception handlers may be written in high-level languages
such as "C"; they are not required to be written in assembly language, as
was the case with previous versions of OS/2.
<P>
One significant difference in exception handling between OS/2 Version 2.0
and previous versions of OS/2 is the ability, under Version 2.0, to handle
general protection exceptions within the application.  Under previous versions,
such exceptions invariably resulted in application termination with a Trap
000D error; with Version 2.0 however, an application may recover or at least
terminate in an orderly manner.
<P>
The generalized exception-handling approach has several advantages:<!-- lm: 0x2 0 -->
<P>
<LI><!-- lm: 0x2 2 -->Exception handlers may be chained and/or nested, and
each handler may decide whether or not to pass an exception to subsequent
handlers.<!-- lm: 0x2 0 -->
<P>
<LI><!-- lm: 0x2 2 -->Exception handlers under OS/2 Version 2.0 may be written
entirely in a high-level programming language; assembly language routines
are not required. This reduces the dependence on the Intel 80386 architecture,
and facilitates porting applications to other operating system and hardware
platforms.<!-- lm: 0x2 0 -->
<BR>

<P>
Note that OS/2 Version 2.0 does not allow applications to register an exception
handler for a "coprocessor not found" exception.  Instead, the operating
system itself traps such exceptions and provides transparent floating-point
emulation on a per-thread basis.
<P>
Note that OS/2 Version 2.0 provides its own exception handlers within the
service layers for all 32-bit system functions.  These exception handlers
allow the service routines to recover from page fault exceptions and general
protection exceptions encountered due to bad pointers in applications' function
calls.  The function call returns an ERROR_BAD_PARAMETER code rather than
a Trap 000D or Trap 000E code, thereby allowing the application to more
easily recover from the error. This recoverability represents a significant
enhancement over previous versions of OS/2, since it allows easier debugging
and more flexible pointer handling, without the necessity for application-registered
exception handlers to process these exceptions.
<P>
Exception handling within applications is described in detail in<I> OS/2
Version 2.0 - Volume 4:  Application Development</I>. The reader will also
find programming examples of other topics, covered in this chapter, in that
volume.

<P><HR>

<A HREF="097_L2_InterruptHandling.html">[Back: Interrupt Handling]</A> <BR>
<A HREF="099_L2_ThreadManagement.html">[Next: Thread Management]</A> 
</BODY>
</HTML>
