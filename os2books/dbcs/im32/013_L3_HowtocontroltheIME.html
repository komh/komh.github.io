<HTML>
<HEAD>
<TITLE>How to control the IME</TITLE>
</HEAD>
<BODY>
<H1>How to control the IME</H1><!-- entering slot 18 -->
<P>
IME is associated with IM Instance. To control the IME, application needs
a handle of the IM Instance.
<P>
There is a sample.
<PRE>ULONG ConvertStringSample(HWND hwnd, PSZ pSrcString,
                          PCANDIDATELISTHEADER pBuffer PULONG pulBufLen, ULONG ulFlag)
{
        HIMI himi, *pprehimi;

        rc = ImCreateInstance(&amp;himi);
        if(rc == NO_ERROR) {

                rc = ImAssociateInstance(hwnd, himi,pprehimi);
                if(rc == NO_ERROR) {

                        rc = ImGetInstance(hwnd, &amp;himi);
                        if(rc == NO_ERROR) {

                                rc = ImConvertString(himi,
                                                           pSrcString,
                                                           pBuffer,
                                             pulBufLen,
                                                   ulFlag);

                                ImReleaseInstance(hwnd, himi);
                        }
                }
        ImDestroyInstance(himi);


        }

        return rc;
}
</PRE>


<P><HR>

<A HREF="012_L2_Overview.html">[Back: Overview]</A> <BR>
<A HREF="014_L2_APIs.html">[Next: APIs]</A> 
</BODY>
</HTML>
