<HTML>
<HEAD>
<META HTTP-EQUIV="CONTENT-TYPE" CONTENT="TEXT/HTML; CHARSET=UTF-8">
<TITLE>ImQueryIMEProperty</TITLE>
<STYLE>
PRE {
  FONT-FAMILY: Consolas, "Lucida Console", "Courier New", Courier, MONOSPACE;
}
</STYLE>
</HEAD>
<BODY>
<H1>ImQueryIMEProperty</H1><!-- entering slot 44 -->
<P>
ImQueryIMEProperty
<P>
Applications can get a property and capabilities of IME.<!-- lm: 0x2 6 -->
<UL>
<P>
<B>Format:</B>
<PRE>APIRET APIENTRY ImQueryIMEProperty(HIMI HIMI, ULONG ulIndex, PULONG pulProp)
</PRE>
<!-- lm: 0x2 6 -->
<P>
<B>Parameters:</B><!-- lm: 0x2 6 -->
<P>
hIMI(input)<!-- lm: 0x2 31 -->
<UL> - a handle of a IM Instance<!-- lm: 0x2 6 -->
</UL> ulIndex(input)
<!-- lm: 0x2 31 -->
<UL>- type of property information to query
<PRE>┌──────────────────────────────┬──────────────────────────────────────────────────┐
│Type                          │Description                                       │
├──────────────────────────────┼──────────────────────────────────────────────────┤
│QIP_PROPERTY                  │Property information                              │
├──────────────────────────────┼──────────────────────────────────────────────────┤
│QIP_INPUTMODE                 │Input mode capabilities                           │
├──────────────────────────────┼──────────────────────────────────────────────────┤
│QIP_CONVERSIONMODE            │Conversion mode capabilities                      │
├──────────────────────────────┼──────────────────────────────────────────────────┤
│QIP_UI                        │User interface capabilities                       │
├──────────────────────────────┼──────────────────────────────────────────────────┤
│QIP_SETCONVSTR                │Conversion string capabilities                    │
├──────────────────────────────┼──────────────────────────────────────────────────┤
│QIP_SELECT                    │Selection inheritance capabilities                │
└──────────────────────────────┴──────────────────────────────────────────────────┘
</PRE>
<!-- lm: 0x2 6 -->
</UL>pulProp(output)<!-- lm: 0x2 31 -->
<UL> - property
informationwhich depends on the above types.
<P>
When ulIndex is QIP_PROPERTY,
<PRE>┌──────────────────────────────┬──────────────────────────────────────────────────┐
│Type                          │Description                                       │
├──────────────────────────────┼──────────────────────────────────────────────────┤
│PRP_SPECIALUI                 │If it's set, IME has a special user interface, so │
│                              │application should not draw in IME window.        │
├──────────────────────────────┼──────────────────────────────────────────────────┤
│PRP_UNICODE                   │If it's set, strings for the IM Instance have     │
│                              │UNICODE characters.                               │
├──────────────────────────────┼──────────────────────────────────────────────────┤
│PRP_FORCEPOSITION             │If it's set, IME has capability to set a          │
│                              │conversion window position by                     │
│                              │ImSetConversionWindowPos with CPS_FORCE style.    │
└──────────────────────────────┴──────────────────────────────────────────────────┘
</PRE>

<P>
When ulindex is QIP_INPUTMODE or QIP_CONVERSIONMODE, this output means supported
input mode or conversion mode, which is defined in ImQueryIMMode section.

<P>
When ulIndex is QIP_UI,
<PRE>┌──────────────────────────────┬────────────────────────────────────────┐
│Type                          │Description                             │
├──────────────────────────────┼────────────────────────────────────────┤
│UIC_270                       │Supports text escapement values of 0 and│
│                              │270                                     │
├──────────────────────────────┼────────────────────────────────────────┤
│UIC_ANGLE90                   │Supports text escapement values of 0,   │
│                              │90, 180, and 270                        │
├──────────────────────────────┼────────────────────────────────────────┤
│UIC_ANGLEANY                  │Supports any text escapement value      │
└──────────────────────────────┴────────────────────────────────────────┘
</PRE>

<P>
When ulIndex is QIP_SETCONVSTR,
<PRE>┌──────────────────────────────┬──────────────────────────────────────────────────┐
│Type                          │Description                                       │
├──────────────────────────────┼──────────────────────────────────────────────────┤
│SCSC_CONVSTR                  │Can create a conversion string, when using        │
│                              │ImSetConversionString with SCS_STRING.            │
├──────────────────────────────┼──────────────────────────────────────────────────┤
│SCSC_MAKEREAD                 │Can create a reading string from a conversion     │
│                              │string, when using ImSetConversionString with     │
│                              │SCS_STRING                                        │
└──────────────────────────────┴──────────────────────────────────────────────────┘
</PRE>

<P>
When ulIndex is QIP_SELECT,
<PRE>┌──────────────────────────────┬────────────────────────────────────────┐
│Type                          │Description                             │
├──────────────────────────────┼────────────────────────────────────────┤
│SLC_INPUTMODE                 │Inherits input mode when a new IME is   │
│                              │selected.                               │
├──────────────────────────────┼────────────────────────────────────────┤
│SLC_CONVERSIONMODE            │Inherits conversion mode when a new IME │
│                              │is selected.                            │
└──────────────────────────────┴────────────────────────────────────────┘
</PRE>
<!-- lm: 0x2 6 --><!-- lm: 0x2 6 -->
</UL><B>Return:</B>
<P>
 Zero is successful. Others are errors.<!-- lm: 0x2 1 -->
</UL>

<P><HR>

<A HREF="038_L3_ImQueryIMEList.html">[Back: ImQueryIMEList]</A> <BR>
<A HREF="040_L3_ImQueryIMMode.html">[Next: ImQueryIMMode]</A> 
</BODY>
</HTML>
