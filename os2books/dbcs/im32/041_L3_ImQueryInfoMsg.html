<HTML>
<HEAD>
<META HTTP-EQUIV="CONTENT-TYPE" CONTENT="TEXT/HTML; CHARSET=UTF-8">
<TITLE>ImQueryInfoMsg</TITLE>
</HEAD>
<BODY>
<H1>ImQueryInfoMsg</H1><!-- entering slot 46 -->
<P>
ImQueryInfoMsg
<P>
Applications can get error messages from IME.<!-- lm: 0x2 6 -->
<UL>
<P>
<B>Format:</B>
<PRE>APIRET APIENTRY ImQueryInfoMsg(HIMI hIMI, ULONG ulIndex, PSZ pBuf,
                      PULONG pulBufLen)
                      </PRE>
 <!-- lm: 0x2 6 -->
<P>
<B>Parameters:</B><!-- lm: 0x2 6 -->
<P>
hIMI(input)<!-- lm: 0x2 31 -->
<UL> - a handle of a IM Instance<!-- lm: 0x2 6 -->
</UL> ulIndex(input)
<!-- lm: 0x2 31 -->
<UL>- type of message to get
<PRE>┌──────────────────────────────┬──────────────────────────────────────────────────┐
│Type                          │Description                                       │
├──────────────────────────────┼──────────────────────────────────────────────────┤
│IMR_INFOMSG_ERRLEVEL          │Error Level                                       │
├──────────────────────────────┼──────────────────────────────────────────────────┤
│IMR_INFOMSG_ERRINDEX          │Error index                                       │
├──────────────────────────────┼──────────────────────────────────────────────────┤
│IMR_INFOMSG_ERRTITLE          │Error Title                                       │
├──────────────────────────────┼──────────────────────────────────────────────────┤
│IMR_INFOMSG_ERRSTR            │Error message string                              │
├──────────────────────────────┼──────────────────────────────────────────────────┤
│IMR_INFOMSG_PRIVATE           │IME private message                               │
└──────────────────────────────┴──────────────────────────────────────────────────┘
</PRE>
<!-- lm: 0x2 6 -->
</UL>pBuf(output)<!-- lm: 0x2 31 -->
<UL> - a pointer
to a message string when ulIndex is IMR_INFOMSG_ERRTITLE, IMR_INFOMSG_ERRSTR
or IMR_INFOMSG_PRIVATE. When ulIndex is IMR_INFOMSG_ERRLEVEL or IMR_INFOMSG_ERRINDEX,
this is reserved 0.<!-- lm: 0x2 6 -->
</UL> pulBufLen(input/output)<!-- lm: 0x2 31 -->
<UL> -
(input)size, in bytes, of the string buffer when ulIndex is
<BR>
IMR_INFOMSG_ERRTITLE, IMR_INFOMSG_ERRSTR or IMR_INFOMSG_PRIVATE.
<BR>
 (output) actual size of the string. When 0 is input in ulBufLen,
<BR>
 this receives size of the needed message string buffer.
<BR>
 When ulIndex is IMR_INFOMSG_ERRLEVEL or IMR_INFOMSG_ERRINDEX, this will
be one of the following values.
<BR>

<P>
When ulIndex is IMR_INFOMSG_ERRLEVEL,
<PRE>┌──────────────────────────────┬──────────────────────────────────────────────────┐
│Type                          │Description                                       │
├──────────────────────────────┼──────────────────────────────────────────────────┤
│IM_ERRLEVEL_ERROR             │Error. IME may not be able to continue.           │
├──────────────────────────────┼──────────────────────────────────────────────────┤
│IM_ERRLEVEL_FATAL             │Fatal error. IME cannot continue. Data may be     │
│                              │lost.                                             │
├──────────────────────────────┼──────────────────────────────────────────────────┤
│IM_ERRLEVEL_INFORMATION       │No error, but some information for users.         │
├──────────────────────────────┼──────────────────────────────────────────────────┤
│IM_ERRLEVEL_NONE              │No error. Clear the previous message, if it's     │
│                              │still on the screen.                              │
├──────────────────────────────┼──────────────────────────────────────────────────┤
│IM_ERRLEVEL_WARNING           │Warning for an unexpected input or other result.  │
├──────────────────────────────┼──────────────────────────────────────────────────┤
│IM_ERRLEVEL_HELP              │Show help message.                                │
└──────────────────────────────┴──────────────────────────────────────────────────┘
</PRE>

<P>
When ulIndex is IMR_INFOMSG_ERRINDEX, 
<PRE>┌──────────────────────────────┬──────────────────────────────────────────────────┐
│Type                          │Description                                       │
├──────────────────────────────┼──────────────────────────────────────────────────┤
│IM_INFOID_UNSAVABLE           │The dictionary or some data cannot be saved.      │
├──────────────────────────────┼──────────────────────────────────────────────────┤
│IM_INFOID_NOCONVERT           │IME cannot convert.                               │
├──────────────────────────────┼──────────────────────────────────────────────────┤
│IM_INFOID_NODICTIONARY        │IME cannot find the dictionary or the dictionary  │
│                              │is invalid format.                                │
├──────────────────────────────┼──────────────────────────────────────────────────┤
│IM_INFOID_NOMODULE            │IME cannot find modules needed.                   │
├──────────────────────────────┼──────────────────────────────────────────────────┤
│IM_INFOID_INVALIDREADING      │Reading confliction                               │
├──────────────────────────────┼──────────────────────────────────────────────────┤
│IM_INFOID_TOOMANYSTROKES      │Too many strokes for a character or a clause      │
├──────────────────────────────┼──────────────────────────────────────────────────┤
│IM_INFOID_TYPINGERROR         │Typing error. IME cannot handle.                  │
├──────────────────────────────┼──────────────────────────────────────────────────┤
│IM_INFOID_UNDEFINED           │Unknown error.                                    │
├──────────────────────────────┼──────────────────────────────────────────────────┤
│IM_INFOID_INPUTREADING        │IME accepts reading character input.              │
├──────────────────────────────┼──────────────────────────────────────────────────┤
│IM_INFOID_INPUTRADICAL        │IME accepts radical character input.              │
├──────────────────────────────┼──────────────────────────────────────────────────┤
│IM_INFOID_INPUTCODE           │IME accepts character code input                  │
├──────────────────────────────┼──────────────────────────────────────────────────┤
│IM_INFOID_SELECTCANDIDATE     │IME accepts candidate string selection            │
├──────────────────────────────┼──────────────────────────────────────────────────┤
│IM_INFOID_REVERSECONVERSION   │Information about reverse conversion is available.│
└──────────────────────────────┴──────────────────────────────────────────────────┘
</PRE>
<!-- lm: 0x2 6 --><!-- lm: 0x2 6 -->
</UL><B>Return:</B>
<P>
 Zero is successful. Others are errors. ERROR_BUFFER_OVERFLOW<!-- lm: 0x2 1 -->
</UL>

<P><HR>

<A HREF="040_L3_ImQueryIMMode.html">[Back: ImQueryIMMode]</A> <BR>
<A HREF="042_L3_ImQueryMsgQueuePrope.html">[Next: ImQueryMsgQueueProperty]</A> 
</BODY>
</HTML>
