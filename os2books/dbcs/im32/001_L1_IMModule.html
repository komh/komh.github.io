<HTML>
<HEAD>
<META HTTP-EQUIV="CONTENT-TYPE" CONTENT="TEXT/HTML; CHARSET=UTF-8">
<TITLE>IM Module</TITLE>
</HEAD>
<BODY>
<H1>IM Module</H1><!-- entering slot 1 -->
<P>
The following figure describes the position of IM module.<!-- Unable to decode bitmap format --><IMG SRC="001_L1_IMModule_0.gif" WIDTH=609 HEIGHT=412><!-- lm: 0x2 2 -->
<UL>
<P>
 <LI><LI><!-- lm: 0x2 6 -->KBD DD generates KBD event and pass the KBD event
to PMWIN.<!-- lm: 0x2 2 -->
<BR>
 <LI><LI><!-- lm: 0x2 6 -->PMWIN pass KBD event to IM. PMWIN notifies some
events (focus change, codepage change, etc.) to IM.<!-- lm: 0x2 2 -->
<BR>
 <LI><LI><!-- lm: 0x2 6 -->IM pass KBD event to IME.  IM notifies some event
(input mode change, etc.) to IME by ImeNotifyEvent (IME_NE_KEYEVENT).<!-- lm: 0x2 2 -->
<BR>
 <LI><LI><!-- lm: 0x2 6 -->IME requests IM to display some IM information
(conversion string, input mode, candidate window, etc.) by ImRequestEvent.
 IME informs IM that some result string is generated by ImRequestEvent.
<!-- lm: 0x2 2 -->
<BR>
 <LI><LI><!-- lm: 0x2 6 -->IM informs the change of IM status to the application
window procedure.<!-- lm: 0x2 2 -->
<BR>
 <LI><LI><!-- lm: 0x2 6 -->An application may pass back the information
to IM via WinDefWindowProc.<!-- lm: 0x2 2 -->
<BR>
 <LI><LI><!-- lm: 0x2 6 -->IM requests Part Class to display the IM status
information.<!-- lm: 0x2 2 -->
<BR>
 <LI><LI><!-- lm: 0x2 6 -->IM requests PMWIN to change translation table.
 IM returns the result string to PMWIN.<!-- lm: 0x2 2 -->
<BR>
 <LI><LI><!-- lm: 0x2 6 -->PMWIN pass KBD event and result string to an
application.<!-- lm: 0x2 2 -->
<BR>
10.<!-- lm: 0x2 6 -->
<UL>An application can control IM. An application
can request string conversion By ImXxx.<!-- lm: 0x2 1 -->
</UL>
<P>
At the IM input model, all key event is processed in the application thread
context.  Application
<P>
There are three levels in the IM support level of the application.<!-- lm: 0x2 3 -->
<UL>
<P>
<LI><!-- lm: 0x2 6 -->Level 1 Application<!-- lm: 0x2 1 -->
</UL> The application
does not know the IM. The application does not communicate with any IM module.
When the application may use the system control window class (ex. single
edit field), the user can perform on-the-spot-conversion on the  window.
<!-- lm: 0x2 3 -->
<UL>
<P>
<LI><!-- lm: 0x2 6 -->Level 2 Application<!-- lm: 0x2 1 -->
</UL> The application
provides the information of the conversion to the IM system. The applcation
can specify the position and font information of the conversion window.
The application can control the IM mode such as IM mode on/off.<!-- lm: 0x2 3 -->
<UL>
<P>
<LI><!-- lm: 0x2 6 -->Level 3 Application<!-- lm: 0x2 1 -->
</UL> The application
can control the IM system such as the level 2 applcation. Additionally the
applcation gets the information of the conversion from the IM system. The
application can display the conversion string in the application window
by getting the conversion information from the IM system. The application
can get the result string from the IM system by using IM API, not from PMWIN's
WinGetMsg. The application can convert the string without the IME's displaying
by ImConvertString API.<!-- lm: 0x2 1 -->
<BR>

<BR>
PMWIN<!-- lm: 0x2 6 -->
<UL>
<P>
PMWIN gives the keyboard event to IM module. IM module gives back the translated
characters to PMWIN when IME generates the translated characters from the
keyboard event given by PMWIN. Finally PMWIN gives the keyboard event and
the translated characters to the Application by returning of WinGetMsg.
 
<BR>
KBD DD
<P>
KBD DD generates the keyboard event from the keyboard hardware interrupt.
The keyboard event is queued into the PMWIN system queue. 
<BR>
Part Class
<P>
The IME vendor can provide the unique user interface.  When the IME provides
the name of IME window at ImeInitialize, the system (IM window) forwards
the messages related to user interface to the IME window. The IME window
can dispatch the messages to the  IME unique Part Class window. The system
provides the some default Part Classes. The IME can use the default Part
Class if IME does not need the unique user interface. The detail is described
in "Default IM Classes" section. 
<BR>
IME
<P>
The IME generates the translated characters from the keyboard events. When
the IME needs to display the candidate string, the IME should request the
system to generate the user interface messages for the IME window in order
that the application can interc ept the user interface messages.
<P>
The IME receives the key event conforming to PM SPEC. The key event has
the IME virtual key as the additional information. The IME virtual keys
are defined to all keys including the alphabet keys. 
<BR>
IM
<P>
The IM system is the extension module of PMWIN for the DBCS conversion support.
The IM system gets the keyboard event from PMWIN. The IM system pass the
keyboard event to the current IME. The IM system provides  the helper IM
API for the IME module. 
<P>
 The IM syetm is described as following figure:<!-- Unable to decode bitmap format --><IMG SRC="001_L1_IMModule_1.gif" WIDTH=646 HEIGHT=605>
<P>
The IM module can be decomposed into following:<!-- lm: 0x2 2 -->
</UL>
1.<!-- lm: 0x2 6 -->
<UL>IM Interface (API)<!-- lm: 0x2 1 -->
</UL> The
IM interface has the external API. The IM interface dispatches the API to
other components.<!-- lm: 0x2 2 -->
<UL>
<P>
 <LI><LI><!-- lm: 0x2 6 -->Message Manager<!-- lm: 0x2 1 -->
</UL> The Message
Manager translates the WM_IMECONTROL message to the IM APIs. <!-- lm: 0x2 2 -->
<UL>
<P>
 <LI><LI><!-- lm: 0x2 6 -->Instance Manager<!-- lm: 0x2 1 -->
</UL> This
manages IM instance and IM Part instance. <!-- lm: 0x2 2 -->
<UL>
<P>
 <LI><LI><!-- lm: 0x2 6 -->KBD Resource Manager<!-- lm: 0x2 1 -->
</UL> The
KBD Resource Manager manages the translation tables. The KBD Resource Manager
handles the keyboard event and requests PMWIN to change the translation
table. <!-- lm: 0x2 2 -->
<UL>
<P>
 <LI><LI><!-- lm: 0x2 6 -->IME Manager<!-- lm: 0x2 1 -->
</UL> This is the
interface component to IME. This component calls the APIs exported by the
IME module. The IME Manager manages the list of the installed IMEs. <!-- lm: 0x2 2 -->
<UL>
<P>
 <LI><LI><!-- lm: 0x2 6 -->Display Service Manager<!-- lm: 0x2 1 -->
</UL> The
Display Server Manager manages the address of the display handler per IM
instance. <!-- lm: 0x2 2 -->
<UL>
<P>
 <LI><LI><!-- lm: 0x2 6 -->IM Window<!-- lm: 0x2 1 -->
</UL> The IM window
is the interface window to the application. The application can send WM_IMECONTROL
message to the IM window in order to control the IME. The IM window gets
back the IM related messages from the application when the application calls
ImIsIMEM essage or WinDefWindowProc. <!-- lm: 0x2 2 -->
<UL>
<P>
 <LI><LI><!-- lm: 0x2 6 -->Default IM Classes<!-- lm: 0x2 1 -->
</UL> The
IM system provides the following pre-defined IM window classes.<!-- lm: 0x2 8 -->
<UL>
<P>
<LI><!-- lm: 0x2 11 -->Default IME Window Class<!-- lm: 0x2 8 -->
<BR>
<LI><!-- lm: 0x2 11 -->WC_IME_CONVERSION<!-- lm: 0x2 8 -->
<BR>
<LI><!-- lm: 0x2 11 -->WC_IME_STATUS<!-- lm: 0x2 8 -->
<BR>
<LI><!-- lm: 0x2 11 -->WC_IME_CANDIDATE<!-- lm: 0x2 8 -->
<BR>
<LI><!-- lm: 0x2 11 -->WC_IME_INFOMSG<!-- lm: 0x2 8 -->
<BR>
<LI><!-- lm: 0x2 11 -->WC_IME_REGWORD<!-- lm: 0x2 1 -->
</UL>The function detail of the default IM Classes is described in "32 bit
Input Method Editor Interface" section.<!-- lm: 0x2 6 -->
<UL><!-- lm: 0x2 2 -->
</UL>
9.<!-- lm: 0x2 6 -->
<UL><!-- entering slot 2 -->Installation/Registration<!-- lm: 0x2 1 -->
</UL>ThismanagesIMEregistration
.InorderthataIMEcanbeusedatOS / 2system ,theIMEmustbeinstalledintoOS / 2system
.<!-- lm: 0x2 1 --> 

<P><HR>

<A HREF="000_L1_Preface.html">[Back: Preface]</A> <BR>
<A HREF="002_L1_ControlFlow.html">[Next: Control Flow]</A> 
</BODY>
</HTML>
