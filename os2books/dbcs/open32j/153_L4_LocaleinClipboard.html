<HTML>
<HEAD>
<META HTTP-EQUIV="CONTENT-TYPE" CONTENT="TEXT/HTML; CHARSET=UTF-8">
<TITLE>Locale in Clipboard</TITLE>
<STYLE>
PRE {
  FONT-FAMILY: Consolas, "Lucida Console", "Courier New", Courier, MONOSPACE;
}
</STYLE>
</HEAD>
<BODY>
<H1>Locale in Clipboard</H1><!-- entering slot 161 -->
<P>
Locale in Clipboard
<P>
Windows 95 supports<I> CF_LOCALE</I> format as a standard clipboard format.
 Using this format, an application program can associate a locale ID (LCID)
to any clipboard text (CF_TEXT, CF_OEMTEXT, CF_UNICODETEXT).  Among these
text formats, only CF_TEXT is always associated with a certain LCID.  This
means that even if an application program closes the clipboard without setting
a LCID, the operating system automatically associates a LCID to the text.
 In this case, the operating system chooses the current input locale (HKL
of the the current thread) as the associated LCID.
<P>
A LCID associated with clipboard text will be used for the following purposes
by application programs.  This means that the operating system does not
perform any conversion regarding the associated LCID.<!-- lm: 0x2 12 -->
<UL>
<P>
<LI><LI><!-- lm: 0x2 16 -->Retrieves ANSI codepage from the LCID and then
retrieves the corresponding character set of the font to display / print
the clipboard text with.<!-- lm: 0x2 12 -->
<P>
<LI><LI><!-- lm: 0x2 16 -->Retrieves ANSI codepage from the LCID and convert
the clipboard text to / from Unicode.<!-- lm: 0x2 12 -->
<P>
<LI><LI><!-- lm: 0x2 16 -->Perform locale-sensitive operations such as CompareString
on the clipboard text with the LCID.<!-- lm: 0x2 11 --><!-- lm: 0x2 6 --><!-- lm: 0x2 1 -->
</UL>
<P>
On the other hand, OS/2 does not support locale as the standard system object.
 An OS/2 application program cannot specify a locale in any OS/2 APIs, except
for ULS APIs.  Clipboard APIs are not the exceptions.  So, Open32 supports
the CF_LOCALE format by mapping it to an non-standard clipboard format internally.

<P>
There is a minor incompatibility on OS/2 in using LCID with clipboard text.
 Clipboard on OS/2 is shared among OS/2 application programs, Open32 applications
programs, and WIN-OS/2 application programs.  Clipboard text associated
with a LCID is generated only by Open32 application programs.  This means
that clipboard text in CF_TEXT format from an OS/2 or WIN-OS/2 application
program is never associated with a LCID.  Therefore, clipboard text from
OS/2 or WIN-OS/2 application program is not always processed correctly even
if the receiver of the clipboard text (Open32 application program) is fully
locale-aware.

<P><HR>

<A HREF="152_L4_NeutralLanguage.html">[Back: Neutral Language]</A> <BR>
<A HREF="154_L4_DDEML.html">[Next: DDEML]</A> 
</BODY>
</HTML>
