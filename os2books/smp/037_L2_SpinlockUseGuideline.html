<HTML>
<HEAD>
<TITLE>Spinlock Use Guidelines</TITLE>
</HEAD>
<BODY>
<H1>Spinlock Use Guidelines</H1><!-- entering slot 38 -->
<P>
Here are some guidelines on using spinlocks to protect critical resources.
<!-- lm: 0x2 0 -->
<P>
o<!-- lm: 0x2 2 -->
<UL>Define spinlocks only for critical resources. A
read only I/O port is not a critical resource. A set of read only I/O ports
that must all be read before a decision is made IS a critical resource.
<!-- lm: 0x2 0 -->
</UL>o<!-- lm: 0x2 2 -->
<UL>Do not define too many spinlocks.
<!-- lm: 0x2 0 -->
</UL>o<!-- lm: 0x2 2 -->
<UL>Use spinlocks for VERY SHORT
durations only. As a general rule, calls should be avoided while owning
a spinlock.<!-- lm: 0x2 0 -->
</UL> o<!-- lm: 0x2 2 -->
<UL>Leave interrupts
disabled after locking a spinlock. This prevents interrupts on the same
processor and possible deadlock.<!-- lm: 0x2 0 -->
</UL> o<!-- lm: 0x2 2 -->
<UL>Be
careful to not make any calls that may try to lock a spinlock that is already
locked. ADDs, when making asynchronous callbacks, can be reentered at their
IORB entry point.<!-- lm: 0x2 0 -->
</UL> o<!-- lm: 0x2 2 -->
<UL>Be aware
that DevHelp_Block called with spinlocks locked will unlock them. When the
block wakes up spinlocks must be reacquired.<!-- lm: 0x2 0 -->
</UL> o<!-- lm: 0x2 2 -->
<UL>Never
make a call that could block while owning a spinlock. For example, some
DevHelp calls can block.<!-- lm: 0x2 0 -->
</UL>

<P><HR>

<A HREF="036_L2_PropertiesofSpinlock.html">[Back: Properties of Spinlocks]</A> <BR>
<A HREF="038_L1_DeviceDriversInOS2fo.html">[Next: Device Drivers In OS/2 for SMP V2.11]</A> 
</BODY>
</HTML>
