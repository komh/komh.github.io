<HTML>
<HEAD>
<META HTTP-EQUIV="CONTENT-TYPE" CONTENT="TEXT/HTML; CHARSET=UTF-8">
<TITLE>How do I query all records in a container - tree view?</TITLE>
<STYLE>
PRE {
  FONT-FAMILY: Consolas, "Lucida Console", "Courier New", Courier, MONOSPACE;
}
</STYLE>
</HEAD>
<BODY>
<H1>How do I query all records in a container - tree view?</H1><!-- entering slot 67 -->
<P>
The following code works for querying all records in a tree structure but

<PRE> USHORT usParentCmd = CMA_FIRST, usChildCmd;
 PUSERREC purParent = NULL, purChild;

 for( ; ; )
 {
    purParent = (PUSERREC) WinSendMsg( hwndCnr, CM_QUERYRECORD,
                                       MPFROMP( purParent ),
                                       MPFROM2SHORT( usParentCmd, CMA_ITEMORDER ) );
    if( !purParent )
       break;

    DoWhatever( purParent );

    usChildCmd = CMA_FIRSTCHILD;
    purChild = NULL;
    for( ; ; )
    {
       purChild = (PUSERREC) WinSendMsg( hwndCnr, CM_QUERYRECORD,
                                         MPFROMP( purChild ),
                                         MPFROM2SHORT( usChildCmd, CMA_ITEMORDER ));
       if( !purChild )
          break;

       DoWhatever( purChild );
       usChildCmd = CMA_NEXT;
    }

    usCmdParent = CMA_NEXT;
 }
</PRE>

<P>
Credit:  Rick Fishman 

<P><HR>

<A HREF="055_L3_HowdoIsortacontainer.html">[Back: How do I sort a container control?]</A> <BR>
<A HREF="057_L2_Icantgetdifferentcol.html">[Next: I can't get different colors in text control windows]</A> 
</BODY>
</HTML>
