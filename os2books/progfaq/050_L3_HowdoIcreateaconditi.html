<HTML>
<HEAD>
<META HTTP-EQUIV="CONTENT-TYPE" CONTENT="TEXT/HTML; CHARSET=UTF-8">
<TITLE>How do I create a conditional cascade menu?</TITLE>
<STYLE>
PRE {
  FONT-FAMILY: Consolas, "Lucida Console", "Courier New", Courier, MONOSPACE;
}
</STYLE>
</HEAD>
<BODY>
<H1>How do I create a conditional cascade menu?</H1><!-- entering slot 61 -->
<P>
The following works for me to set a submenu as a conditional-cascade menu,
then set it's default id (hwndMenu is the hwnd of the top-level menu):
<PRE>   MENUITEM mi;

   WinSendMsg( hwndMenu, MM_QUERYITEM,
               MPFROM2SHORT( idSubMenu, TRUE ), &amp;mi );

   // Set the MS_CONDITIONALCASCADE bit for the submenu.

   WinSetWindowBits( mi.hwndSubMenu, QWL_STYLE, MS_CONDITIONALCASCADE,
                     MS_CONDITIONALCASCADE );

   // Set cascade menu default

   WinSendMsg( mi.hwndSubMenu, MM_SETDEFAULTITEMID,
               MPFROMSHORT( idDefaultItem ), NULL );
</PRE>

<P>
Then I do this to query the default item:
<PRE> MENUITEM mi;

 WinSendMsg( hwndMenu, MM_QUERYITEM, MPFROM2SHORT( idSubMenu, TRUE ),
             &amp;mi );

 id = (USHORT) WinSendMsg( mi.hwndSubMenu,
                           MM_QUERYDEFAULTITEMID, NULL, NULL );
</PRE>

<P>
Credit:  Rick Fishman 

<P><HR>

<A HREF="049_L3_HowdoImakeadynamical.html">[Back: How do I make a dynamically changing menu?]</A> <BR>
<A HREF="051_L3_HowdoIremoveaseparat.html">[Next: How do I remove a separator from a menu?]</A> 
</BODY>
</HTML>
