<HTML XPOS=LEFT YPOS=BOTTOM WIDTH=100% HEIGHT=100%>
<HEAD>
<META HTTP-EQUIV="CONTENT-TYPE" CONTENT="TEXT/HTML; CHARSET=UTF-8">
<!-- extra bytes: 03 00 44 01 00 08 00 11 64 00 64 00 --><TITLE>Examples</TITLE>
</HEAD>
<BODY>
<H1>Examples</H1><!-- entering slot 27 -->
<P>
Four sample filter rules are shown here.  Each of them is explained in detail
below.
<BR>

<PRE>deny    0.0.0.0 0.0.0.0  0.0.0.0 0.0.0.0  tcp  any 0  eq 80   non-secure  local  both  l=no   f=no
permit  0.0.0.0 0.0.0.0  0.0.0.0 0.0.0.0  tcp  any 0  eq 80   secure      local  both  l=yes  f=no
deny    0.0.0.0 0.0.0.0  0.0.0.0 0.0.0.0  udp  any 0  eq 161  both        both   both  l=yes
permit  0.0.0.0 0.0.0.0  0.0.0.0 0.0.0.0  all  any 0  any 0   both        both   both
</PRE>
 
<P>
Rule 1<!-- lm: 0x2 4 -->
<UL><!-- lm: 0x2 4 -->
<P>
action<!-- lm: 0x2 28 -->
<UL> = <A HREF="058_L0_.html">deny</A><!-- lm: 0x2 4 -->
</UL>srcip<!-- lm: 0x2 28 -->
<UL> = <A HREF="059_L0_.html">0.0.0.0</A><!-- lm: 0x2 4 -->
</UL>srcmask<!-- lm: 0x2 28 -->
<UL> = <A HREF="060_L0_.html">0.0.0.0</A><!-- lm: 0x2 4 -->
</UL>destip<!-- lm: 0x2 28 -->
<UL> = <A HREF="061_L0_.html">0.0.0.0</A><!-- lm: 0x2 4 -->
</UL>destmask<!-- lm: 0x2 28 -->
<UL> = <A HREF="062_L0_.html">0.0.0.0</A><!-- lm: 0x2 4 -->
</UL>protocol<!-- lm: 0x2 28 -->
<UL> = <A HREF="063_L0_.html">tcp</A><!-- lm: 0x2 4 -->
</UL>srcopcode/srcport<!-- lm: 0x2 28 -->
<UL> = <A HREF="064_L0_.html">any
0</A><!-- lm: 0x2 4 -->
</UL>destopcode/destport<!-- lm: 0x2 28 -->
<UL> = <A HREF="065_L0_.html">eq
80</A><!-- lm: 0x2 4 -->
</UL>interface<!-- lm: 0x2 28 -->
<UL> = <A HREF="066_L0_.html">non-secure
</A><!-- lm: 0x2 4 -->
</UL>routing<!-- lm: 0x2 28 -->
<UL> = <A HREF="067_L0_.html">local</A><!-- lm: 0x2 4 -->
</UL>direction<!-- lm: 0x2 28 -->
<UL> = <A HREF="068_L0_.html">both</A><!-- lm: 0x2 4 -->
</UL>log<!-- lm: 0x2 28 -->
<UL> = <A HREF="069_L0_.html">l=no</A><!-- lm: 0x2 4 -->
</UL>fragment<!-- lm: 0x2 28 -->
<UL> = <A HREF="070_L0_.html">f=no</A><!-- lm: 0x2 4 -->
</UL><!-- lm: 0x2 1 -->
</UL>This rule blocks all TCP packets coming in
and going out on any non-secure interface, destined for port 80, with an
endpoint on the local system.
<P>
Port 80 is the standard HTTPD port, so this rule most likely intended to
block a web server from either receiving or sending data on a non-secure
interface.
<P>
 
<P>
Rule 2
<P>
This rule is identical to Rule 1, with three exceptions: it permits traffic
instead of denying it; it applies to secure interfaces rather than non-secure
interfaces; and it logs all traffic that it matches.
<P>
Without that last difference (the<B> l=yes</B> parameter), this rule would
be unnecessary, because Rule 4 permits all traffic which has no other matching
rule anyway.
<P>
So the only real purpose of this rule is to log web traffic to/from the
secure network.
<P>
 
<P>
Rule 3<!-- lm: 0x2 4 -->
<UL><!-- lm: 0x2 4 -->
<P>
action<!-- lm: 0x2 28 -->
<UL> = <A HREF="071_L0_.html">deny</A><!-- lm: 0x2 4 -->
</UL>srcip<!-- lm: 0x2 28 -->
<UL> = <A HREF="072_L0_.html">0.0.0.0</A><!-- lm: 0x2 4 -->
</UL>srcmask<!-- lm: 0x2 28 -->
<UL> = <A HREF="073_L0_.html">0.0.0.0</A><!-- lm: 0x2 4 -->
</UL>destip<!-- lm: 0x2 28 -->
<UL> = <A HREF="074_L0_.html">0.0.0.0</A><!-- lm: 0x2 4 -->
</UL>destmask<!-- lm: 0x2 28 -->
<UL> = <A HREF="075_L0_.html">0.0.0.0</A><!-- lm: 0x2 4 -->
</UL>protocol<!-- lm: 0x2 28 -->
<UL> = <A HREF="076_L0_.html">udp</A><!-- lm: 0x2 4 -->
</UL>srcopcode/srcport<!-- lm: 0x2 28 -->
<UL> = <A HREF="077_L0_.html">any
0</A><!-- lm: 0x2 4 -->
</UL>destopcode/destport<!-- lm: 0x2 28 -->
<UL> = <A HREF="078_L0_.html">eq
161</A><!-- lm: 0x2 4 -->
</UL>interface<!-- lm: 0x2 28 -->
<UL> = <A HREF="079_L0_.html">both</A><!-- lm: 0x2 4 -->
</UL>routing<!-- lm: 0x2 28 -->
<UL> = <A HREF="080_L0_.html">both</A><!-- lm: 0x2 4 -->
</UL>direction<!-- lm: 0x2 28 -->
<UL> = <A HREF="081_L0_.html">both</A><!-- lm: 0x2 4 -->
</UL>log<!-- lm: 0x2 28 -->
<UL> = <A HREF="082_L0_.html">l=yes</A><!-- lm: 0x2 4 -->
</UL><!-- lm: 0x2 1 -->
</UL>This rule blocks all UDP packets with an endpoint
on either the local system or any other system for which we route traffic,
which uses any interface, and which would connect on port 161 at its final
destination.  It would also generate a log entry for any such attempt.
<P>
If this system is the gateway for a secure network, then such traffic would
be prevented from either entering or leaving that network.
<P>
Port 161 is used by the SNMP Trap-PDU message type, which use UDP, so this
rule is presumably intended to block SNMP traps.
<P>
 
<P>
Rule 4
<P>
This rule simply permits everything.  It should be placed at the end of
the file, so that it only applies to traffic which has not been filtered
by a previous rule. Any rule placed below this one would be meaningless.

<P>
Using this rule creates a policy of 'permit by default'; leaving this rule
out would cause the firewall to fall back to the standard 'deny by default'
policy. 
<P>
   

<P><HR>

<A HREF="026_L2_Secureinterfaces.html">[Back: Secure interfaces]</A> <BR>
<A HREF="028_L1_Logging.html">[Next: Logging]</A> 
</BODY>
</HTML>
