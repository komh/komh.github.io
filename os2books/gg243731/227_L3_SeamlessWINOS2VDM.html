<HTML>
<HEAD>
<META HTTP-EQUIV="CONTENT-TYPE" CONTENT="TEXT/HTML; CHARSET=UTF-8">
<TITLE>"Seamless" WIN-OS/2 VDM</TITLE>
</HEAD>
<BODY>
<H1>"Seamless" WIN-OS/2 VDM</H1><!-- entering slot 259 -->
<P>
OS/2 Version 2.0 does not allow a "seamless" WIN-OS/2 VDM to be started
from a DOS or OS/2 command prompt, nor is there any programmed interface
for starting a "seamless" WIN-OS/2 VDM application from a Presentation Manager
application.  In addition, a SAVDM or MAVDM cannot be switched to a "seamless"
WIN-OS/2 VDM once the virtual DOS machine is running.
<P>
The "seamless" WIN-OS/2 VDM execution mode allows Windows applications to
run from the Workplace Shell desktop in a manner that is virtually indistinguishable
from other OS/2 and DOS applications.  Double clicking a "seamless" WIN-OS/2
VDM application icon will cause that application to be run in a window on
the Workplace Shell desktop. This single application "seamless" WIN-OS/2
VDM environment will be a separate Windows VDM, where the Program Manager
is not visible.
<P>
In order to be perceived as a compatible part of the Workplace Shell environment,
the "seamless" WIN-OS/2 VDM application's execution must be controllable
in the same manner as the execution of other OS/2 and DOS applications.
This has several implications:<!-- lm: 0x2 0 -->
<P>
<LI><!-- lm: 0x2 2 -->The name of each active "seamless" WIN-OS/2 VDM application
will be included in the Workplace Shell Task List.<!-- lm: 0x2 0 -->
<P>
<LI><!-- lm: 0x2 2 -->Each "seamless" WIN-OS/2 VDM supports an appropriate
context menu.<!-- lm: 0x2 0 -->
<P>
<LI><!-- lm: 0x2 2 -->The user is able to cycle through all open Workplace
Shell windows in the standard<I> Alt-Esc</I> manner.<!-- lm: 0x2 0 -->
<P>
<LI><!-- lm: 0x2 2 -->The minimize/hide icons on Windows applications function
consistently with other such icons on the Workplace Shell desktop.<!-- lm: 0x2 0 -->
<P>
<LI><!-- lm: 0x2 2 -->The window controls on a "seamless" WIN-OS/2 VDM window
operate in the same fashion as analogous Workplace Shell controls. The display
style of the window controls on a "seamless" WIN-OS/2 VDM window will be
"Windows-style" however.<!-- lm: 0x2 0 -->
<P>
<LI><!-- lm: 0x2 2 -->When a "seamless" WIN-OS/2 VDM Windows application
terminates, its Workplace Shell window is also terminated.<!-- lm: 0x2 0 -->
<BR>

<P>
This approach allows the appearance of a Windows application executing in
a "seamless" WIN-OS/2 VDM to conform as closely as possible to that seen
when running in a native DOS/Windows environment, while its behavior is
as close as possible to that of a normal Presentation Manager/Workplace
Shell application.
<P>
<B>If You can't get a "Seamless" WIN-OS/2 VDM to Work</B>
<P>
Starting a Windows application requires a number of configuration options
to be correctly completed prior to starting the application.  Failure to
do so may result in the application failing to start.  This is typically
due to one of three problems:<!-- lm: 0x2 0 -->
<P>
 <LI><LI><!-- lm: 0x2 4 -->Failures that are due to the configuration of
the overall OS/2 V2.0 system.<!-- lm: 0x2 0 -->
<P>
 <LI><LI><!-- lm: 0x2 4 -->Failures that are due to the configuration of
the overall Windows environment.<!-- lm: 0x2 0 -->
<P>
 <LI><LI><!-- lm: 0x2 4 -->Failures that are due to the nature of a particular
Windows  application.<!-- lm: 0x2 0 -->
<BR>

<P>
The first two classes result from not being "seamless capable"; that is,
some part of the system's configuration is not set up properly for "seamless"
WIN-OS/2 VDM operation.  For example:<!-- lm: 0x2 0 -->
<P>
<LI><!-- lm: 0x2 2 -->An OS/2 V2.0 video device driver other than the "seamless"
<B>VGA</B> driver is installed.<!-- lm: 0x2 0 -->
<P>
<LI><!-- lm: 0x2 2 -->VWIN.SYS is not installed, due to the following line
being missing in CONFIG.SYS:               DEVICE=C:\OS2\MDOS\VWIN.SYS<!-- lm: 0x2 0 -->
<P>
<LI><!-- lm: 0x2 2 -->The Windows video device driver referenced by the
SDISPLAY.DRV= statement in SYSTEM.INI file does not point to the "seamless"
Windows VGA device driver.  The correct entry in the<I> SYSTEM.INI</I> is:
              SDISPLAY=SWINVGA.DRV<!-- lm: 0x2 0 -->
<BR>

<P>
The third class arises because the "seamless" execution environment will
be a SAVDM that runs in standard mode only.  This means that real mode Windows
applications will not be able to run in "seamless" WIN-OS/2 VDM ("seamless"
VDMs).  The Workplace Shell is able to gracefully handle the initiation
of real mode Windows applications, because it can determine the mode of
a Windows application from its program header. <!-- entering slot 260 --> Such
Windows applications will be automatically initiated in full-screen SAVDMs.

<P>
In addition, groups of applications which depend on the sharing of global
Windows memory will not be able to run in a "seamless" WIN-OS/2 VDM, unless
it is possible to manually initiate one application in the set and then
have that application programmatically spawn the rest of the applications
in the set. In theory, this situation should never occur because the casual
sharing of Windows global memory is expressly against the Microsoft guidelines
for Windows system programming.  However, if there are applications that
depend on such sharing, the user will have to explicitly know to run them
in a full-screen MAVDM.

<P><HR>

<A HREF="226_L3_MAVDM.html">[Back: MAVDM]</A> <BR>
<A HREF="228_L2_WindowsEnvironmentSe.html">[Next: Windows Environment Settings]</A> 
</BODY>
</HTML>
