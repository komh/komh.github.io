<HTML>
<HEAD>
<META HTTP-EQUIV="CONTENT-TYPE" CONTENT="TEXT/HTML; CHARSET=UTF-8">
<TITLE>Methods of Execution</TITLE>
</HEAD>
<BODY>
<H1>Methods of Execution</H1><!-- entering slot 244 -->
<P>
Windows applications may be run under OS/2 Version 2.0 in six ways:<!-- lm: 0x2 0 -->
<P>
<LI><!-- lm: 0x2 2 -->The original licensed<B> Windows V3.0</B> or<B> Windows
V2.x</B> may be started in a VDM, and will allow Windows V3.0 and Windows
V2.x, and its applications, to be run in real mode.<!-- lm: 0x2 0 -->
<P>
<LI><!-- lm: 0x2 2 -->A <A HREF="451_L2_SingleApplicationVDM.html"><B>Single
Application VDM</B> (<B>SAVDM</B>)</A> may be started, for a single Windows
application. The icon supplied with the Windows application will be defined
within the Workplace Shell desktop.<!-- lm: 0x2 0 -->
<P>
<LI><!-- lm: 0x2 2 -->A <A HREF="428_L2_MultipleApplicationV.html"><B>Multiple
Application VDM</B> (<B>MAVDM</B>)</A> may be started, which activates the
Windows Program Manager, allowing the user to access a number of Windows
applications.<!-- lm: 0x2 0 -->
<P>
<LI><!-- lm: 0x2 2 -->A <A HREF="447_L2_segment.html"><B>Separate "seamless"
WIN-OS/2 VDM</B></A> may be used, which is basically a SAVDM running in
its own window under the Workplace Shell.  See "Seamless" WIN-OS/2 VDM below
for further information.<!-- lm: 0x2 0 -->
<P>
<LI><!-- lm: 0x2 2 -->A <A HREF="447_L2_segment.html"><B>common "seamless"
WIN-OS/2 VDM</B></A> may be used, which is a special kind of MAVDM. WIN-OS/2
will start all "seamless" WIN-OS/2 VDMs in a single session, but in separate
windows running under the Workplace Shell.  See Common "Seamless" WIN-OS/2
VDM below for further information.<!-- lm: 0x2 0 -->
<P>
<LI><!-- lm: 0x2 2 -->A <A HREF="447_L2_segment.html"><B>separate "seamless"
WIN-OS/2 VDM</B></A> may be used, and the<B> WIN-OS/2 Program Manager</B> may
be launched from there. This will allow to launch other Windows applications
from there and therefore, this would actually be a MAVDM running in its
own window under the Workplace Shell. Every Windows application launched
from there would run in its own window under the Workplace Shell but share
the same WIN-OS/2 kernel.<!-- lm: 0x2 0 -->
<BR>

<P>
No license of Windows V3.0 or Windows V2.x is necessary to run Windows applications,
as the Windows environment is an implementation of Windows V3.0 and Windows
V2.x within OS/2 V2.0 (WIN-OS/2) itself.  Multiple instances of any of the
above methods may be started in the same system.
<P>
However, note that in the current release, "seamless" WIN-OS/2 VDMs and
common "seamless" WIN-OS/2 VDMs may only be started on machines with VGA
graphics.  Seamless execution of Windows applications is not supported using
other graphics modes.
<P>
The following applications are started (iconized) when the first VDM (either
SAVDM or MAVDM) is started:<!-- lm: 0x2 0 -->
<P>
<LI><!-- lm: 0x2 2 -->Modified Windows Clipboard Viewer Program<!-- lm: 0x2 0 -->
<P>
<LI><!-- lm: 0x2 2 -->DDE Server/Agent Application<!-- lm: 0x2 0 -->
<P>
<LI><!-- lm: 0x2 2 -->Presentation Manager icon<!-- lm: 0x2 0 -->
<P>
<LI><!-- lm: 0x2 2 -->Task Manager (no icon)<!-- lm: 0x2 0 -->
<P>
<LI><!-- lm: 0x2 2 -->Windows Program Manager (not visible in a SAVDM)<!-- lm: 0x2 0 -->
<P>
<LI><!-- lm: 0x2 2 -->Clock (MAVDM only)<!-- lm: 0x2 0 -->
<P>
<LI><!-- lm: 0x2 2 -->Windows Control Panel (MAVDM only).<!-- lm: 0x2 0 -->
<BR>

<P>
Each of these methods is described in the following sections.
<P>
<B>Single Application VDM (SAVDM)</B>
<P>
A SAVDM is the recommended way of running Windows applications under  OS/2
Version 2.0 in a non-VGA system, such as a PS/2 with an XGA or 8514/A display
adapter, because seamless execution is only supported with VGA graphics.
Using a SAVDM is also recommended if the user wishes to run Windows applications
in<I> real mode</I> (seamless execution is supported only in Windows standard
mode).
<P>
Since the Windows application runs in a self-contained Windows environment
in its own VDM, it is fully protected from other applications, and the system
is protected from it.  This means that if the application crashes for any
reason, it only affects its own VDM, and thus only that one application.
 Other Windows or DOS applications running in other VDMs are not affected,
nor are OS/2 applications.  This represents a significant improvement in
reliability over DOS/Windows, in which a failure in one Windows application
may bring down the entire Windows system or corrupt the data areas of other
Windows programs, since all Windows applications and Windows itself share
the same address space.
<P>
<A HREF="042_L2_SingleWindowsApplica.html">Figure "Single Windows Application
Running under OS/2 Version 2.0"</A>
<P>
Also, by running in SAVDMs, Windows applications are timesliced more effectively
than in a MAVDM or native DOS/Windows environment, since each application
is under the control of OS/2's scheduler and its pre-emptive multitasking.
 In a MAVDM environment, all Windows applications are still subject to the
cooperative multitasking under Windows itself.
<P>
<B><I>Ctrl-Esc</B></I> is the key combination used to display the Windows
"Window List".
<P>
<B><I>Alt-Esc</B></I> is the key combination used to switch to the next
session as defined in the Workplace Shell.
<P>
The SAVDM provides a simple approach to Presentation Manager integration.
 The application is loaded from the Workplace Shell in a very similar way
to a DOS application, and the user may easily switch back to Presentation
Manager, as well as share data<!-- entering slot 245 --> via clipboard or
DDE with other Windows or Presentation Manager  applications. The icon displayed
on the Workplace Shell desktop is the application's own Windows icon.
<P>
Each SAVDM will indicate the Windows execution mode based on the file type
specified in the EXE header of the Windows application.<I> Real mode</I> will
be indicated for Windows applications written for versions of Windows prior
to 3.0. <I> Auto-Select</I> (real or standard mode) is selected by default
for Windows 3.0 applications, based on processor type.
<P>
<B>Multiple Application VDM (MAVDM)</B>
<P>
The MAVDM is almost identical to running Windows 3.0 on a DOS-based machine.
The MAVDM uses the Windows 3.0 Program Manager to start multiple Windows
applications within the same VDM, running on a separate Windows desktop.
It therefore provides maximum "look and feel" compatibility for the DOS/Windows
user migrating to OS/2 Version 2.0.
<P>
Note that the use of a MAVDM or the common "seamless" WIN-OS/2 VDM  is a
requirement where Windows applications must communicate with one another
via shared memory.
<P>
<B><I>Ctrl-Esc</B></I> is used within the VDM to display the Windows "Window
List".
<P>
<B><I>Alt-Esc</B></I> is used to switch to the next session defined in the
Workplace Shell.
<P>
For a MAVDM, the Workplace Shell icon will represent the MAVDM itself, rather
than the applications executing within the VDM.  Terminating an application
within the VDM will not terminate the VDM itself.  The user must select
<I>Exit Windows</I> in the Windows Program Manager to terminate the VDM,
or close the VDM from the Workplace Shell.
<P>
In the MAVDM and the common "seamless" WIN-OS/2 VDM environment, all Windows
applications are still subject to the cooperative multitasking of Windows
itself.  Since several Windows applications are typically loaded in the
same VDM, the MAVDM environment shares some of the pitfalls of DOS/Windows
in terms of robustness.  If one Windows application crashes within a MAVDM,
 it may cause all the applications within that VDM to fail.  However, the
effect is<I> only</I> within that VDM; other VDMs running DOS or Windows
applications, and other processes executing under OS/2 Version 2.0, are
not affected and continue execution.  So even here there are benefits from
running Windows applications under OS/2, for greater resilience from system
crashes.  Furthermore, the MAVDM environment provides additional error checking
and handling over that provided by Windows 3.0 itself.
<P>
<B>"Seamless" WIN-OS/2 VDM</B>
<P>
One of the goals of OS/2 2.0 is to be the integrating platform of choice;
that is, to provide a desktop environment from which all types of applications:
<!-- lm: 0x2 0 -->
<P>
<LI><!-- lm: 0x2 2 -->16-bit OS/2<!-- lm: 0x2 0 -->
<BR>
<LI><!-- lm: 0x2 2 -->32-bit OS/2<!-- lm: 0x2 0 -->
<BR>
<LI><!-- lm: 0x2 2 -->DOS<!-- lm: 0x2 0 -->
<BR>
<LI><!-- lm: 0x2 2 -->Windows<!-- lm: 0x2 0 -->
<BR>

<P>
may be executed in a uniform manner.  Although OS/2 V2.0 is able to support
Windows applications effectively in SAVDMs, the additional ability to launch
a Windows application from a Workplace Shell object, and execute it on the
OS/2 desktop along with Presentation Manager and DOS applications, achieves
the goal of creating an environment that is explicitly simple and uniform
enough that the end user need not be concerned with the implicit differences
between the types of applications that need to be executed in it.  OS/2
V2.0 will concern itself with the differences and<B> "seamlessly"</B> accommodate
the applications.  This level of support extends not only to execution but
to installation and configuration of the application as well.
<P>
<A HREF="043_L2_SingleWindowsApplica.html">Figure "Single Windows Application(s)
Running "Seamless" on the OS/2 Version 2.0 Desktop"</A>
<P>
The appearance of Windows applications on the Workplace Shell desktop requires
that the Windows video device driver and the Presentation Manager video
device driver communicate and coordinate their access of the video hardware.
 Each device driver effectively "owns" its area of the<!-- entering slot 246 --> screen.
 Allowing the Windows display device driver to directly access the video
hardware avoids the more cumbersome process of a complete task switch.  However,
this hardware access poses integrity problems in the areas of simultaneous
access of hardware, rectangle invalidation handling, window management,
and the exchange of window state information between Presentation Manager
and seamless VDMs supported by separate video device drivers.
<P>
To address these problems, a high performance virtual device driver named
(VWIN.SYS), capable of interprocess communication, was created.  This VDD
serializes the simultaneous accesses to the hardware, oversees the exchange
of window state information between Presentation Manager and seamless VDMs,
and establishes the addressability of Presentation Manager resources (either
directly or indirectly) by the Windows display device driver.
<P>
When the system is initialized, the Presentation Manager display driver
calls the VWIN.SYS driver, and passes a pointer to an array of structures
that specify the protocol required to enable the Windows device driver to
access Presentation Manager resources.  To prevent a seamless Windows application
from hanging the entire Workplace Shell desktop, the Windows video device
driver and the Presentation Manager video device driver together implement
and monitor a VDM "heartbeat" or counter.  This counter is stored in the
Presentation Manager display driver's data area and is made available to
the Windows display driver.
<P>
The "heartbeat" counter information is made available to the Windows DD
to indicate that hardware access is in progress by the Windows DD. The "heartbeat"
counter is incremented by the Windows DD prior to the video hardware access.
If a Windows application is locking up the Workplace Shell desktop, it is
the responsibility of VWIN.SYS to identify the current owner of the semaphore,
terminate the VDM and tell the Presentation Manager DD to clean up.
<P>
In the event that the Presentation Manager display device driver requests
hardware resources and the time interval allotted for this access to occur
is exceeded, then:<!-- lm: 0x2 0 -->
<P>
 <LI><LI><!-- lm: 0x2 4 -->If it is the first request, the Presentation
Manager display driver records the heartbeat value, process ID and thread
ID of the process in control of the hardware, and raises an internal flag.
<!-- lm: 0x2 0 -->
<P>
 <LI><LI><!-- lm: 0x2 4 -->If it is the second request, and the heartbeat
value, PID and TID have not changed, the Presentation Manager display driver
calls the Windows display driver before clearing the flag, and passes it
the PID and TID.<!-- lm: 0x2 3 -->
<UL>
<P>
<LI><!-- lm: 0x2 5 -->It is the responsibility of the Windows driver to
use the PID and TID to identify the process that is monopolizing the hardware
resources and inform the Presentation Manager driver.<!-- lm: 0x2 3 -->
<P>
<LI><!-- lm: 0x2 5 -->If it is an active, seamless VDM, WIN-OS/2 will terminate
the VDM and inform the Presentation Manager driver to clean up.<!-- lm: 0x2 3 -->
<P>
<LI><!-- lm: 0x2 5 -->If the PID and TID are invalid, the Windows driver
will inform the Presentation Manager driver to clean up.<!-- lm: 0x2 3 -->
<P>
<LI><!-- lm: 0x2 5 -->If the PID and TID belong to a Presentation Manager
application, the Windows driver will tell the Presentation Manager driver
to attempt access again.<!-- lm: 0x2 4 -->
<UL><!-- lm: 0x2 0 -->
</UL>
<P>
This algorithm is relatively simple but not totally fail-safe.  It is quite
possible to create a serialization mechanism that would safeguard the Workplace
Shell desktop to a greater degree.  However, when one considers the remoteness
of the possibility of its failure (which requires a bogus PID or TID), the
costs, in terms of a performance impact, would far outweigh the benefits
incurred.
<P>
Some important points about "seamless" WIN-OS/2 VDMs:<!-- lm: 0x2 0 -->
<P>
<LI><!-- lm: 0x2 2 -->Note that the use of a MAVDM or a common "seamless"
WIN-OS/2 VDM  is a requirement where Windows applications must communicate
with one another via shared memory.<!-- lm: 0x2 0 -->
<P>
<LI><!-- lm: 0x2 2 -->Only standard mode is supported in this mode of operation.
<!-- lm: 0x2 0 -->
<P>
<LI><!-- lm: 0x2 2 -->Presentation Manager must provide extensive support
for this implementation of WIN-OS/2.  Basically, Presentation Manager supports
a "black hole" and allows the WIN-OS/2 kernel to control it.  A modified
WIN-OS/2 and Presentation Manager display device driver is built<!-- entering slot 247 --> into
OS/2 Version 2.0 to support this mechanism.<!-- lm: 0x2 0 -->
<P>
<LI><!-- lm: 0x2 2 -->The "seamless" WIN-OS/2 VDM is only supported if OS/2
is configured for VGA mode, because only the Windows VGA display device
driver is supported.  This means that, on an 8514 or XGA equipped system,
the Presentation Manager display device driver must be configured in VGA
mode to be able to run Windows applications in a "seamless" WIN-OS/2 VDM.
 If the user selects a higher resolution display device driver such as XGA,
Windows applications may only run in a SAVDM or MAVDM environment.
<P>
<B>Notes: </B><!-- lm: 0x2 3 -->
<UL>
<P>
 <LI><LI><!-- lm: 0x2 7 -->Over time, more display device drivers will be
enhanced to support this seamless mode of WIN-OS/2.  Once available, installed
and configured appropriately, WIN-OS/2 will provide seamless execution on
other supported graphics modes.<!-- lm: 0x2 3 -->
<P>
 <LI><LI><!-- lm: 0x2 7 -->Readers should check the<I> ReadMe</I> file in
the<I> Information</I> folder for the latest information on this subject.
 Information in this folder explains how to reconfigure the system to have
seamless WIN-OS/2 support as well as high resolution MAVDM and/or SAVDM
sessions.<!-- lm: 0x2 2 --><!-- lm: 0x2 0 -->
</UL> <!-- lm: 0x2 2 -->
<UL>A
VDD (VWIN.SYS) provides the necessary services to the Windows kernel and
Presentation Manager.<!-- lm: 0x2 0 -->
</UL>
<P>
As shown in <A HREF="044_L2_ImplementationofSeam.html">Figure "Implementation
of "Seamless" WIN-OS/2 VDM in OS/2 Version 2.0"</A> PMVIOP.DLL contains
a PMShield routine which is responsible for maintaining the entire Workplace
Shell desktop, including the "black holes" which correspond to and are maintained
by each "seamless" WIN-OS/2 VDM.
<P>
WinShield is the Windows VDM's counterpart of PMShield.  The Workplace Shell
desktop windowing state must be maintained in its entirety by this component.
WinShield registers a service routine with VWIN.SYS, giving it the ability
to post a message to PMShield whenever the Workplace Shell desktop state
changes.
<P>
Upon creation of the first "seamless" WIN-OS/2 VDM, PMShield spawns three
dedicated threads under the Workplace Shell to specifically service its
"seamless" WIN-OS/2 VDM clients:<!-- lm: 0x2 0 -->
<P>
<LI><!-- lm: 0x2 2 -->Thread 1 is the<I> IPC Read Thread</I>, which normally
suspends itself within VWIN.SYS, waiting for window-related events to occur
in the "seamless" WIN-OS/2 VDM. The typical events sent by the WinShield
are Create, Move, Size, Show Activate, etc. These events are duplicated
by PMShield on the Workplace Shell desktop for the purpose of tracking the
"black hole" windows.<!-- lm: 0x2 0 -->
<P>
<LI><!-- lm: 0x2 2 -->Thread 2 is the<I> Control Windows Procedure Thread
</I>that the PMShield registers with PMWIN.DLL.  This thread handles all
relevant events that alter the state of the Workplace Shell desktop.  Once
in control, this thread will broadcast all Workplace Shell desktop initiated
events asynchronously to all VDMs by calling VWIN.SYS.  This causes a previously
registered WinShield routine to be dispatched, giving it an opportunity
to post an asynchronous message to itself.<!-- lm: 0x2 0 -->
<P>
<LI><!-- lm: 0x2 2 -->Thread 3 is the<I> Error Handling Thread</I>. All
non-fatal errors on all "seamless" WIN-OS/2 VDM related operations will
be reported through this mechanism where a Presentation Manager dialog box
will pop up explaining to the user what went wrong.<!-- lm: 0x2 0 -->
<P>
On successful creation of a "seamless" WIN-OS/2 VDM, the Presentation Manager
<I>Session Start</I> thread will notify VVGA.SYS to allow the started VDM
to access the video hardware directly.
<P>
<B>Common "Seamless" WIN-OS/2 VDM</B>
<P>
There is no visible<!-- entering slot 248 --> difference between Windows
applications running in a "seamless" WIN-OS/2 VDM and those running in a
common "seamless" WIN-OS/2 VDM.  The technical differences between them
are described in the following paragraphs. Everything else discussed in
the above section ."Seamless" WIN-OS/2 VDM is common to both.
<P>
To reduce the system resource usage in a low memory environment, users are
given the option to start all "Seamless" WIN-OS/2 applications in the same
VDM.  This also helps to reduce startup time for Windows applications, and
reduces the swap file space required.  By default, Windows applications
migrated from a DOS/Windows system at OS/2 installation time are migrated
to a common "seamless" WIN-OS/2 VDM.  The user has the option of prestarting
one or more Windows applications in the common "seamless" WIN-OS/2 VDM by
using the<I> Startup</I> folder in the Workplace Shell.
<P>
There is only one common "seamless" WIN-OS/2 VDM in the system.  If the
system is not currently configured to run "seamless" WIN-OS/2 VDMs, any
Windows  application which is defined for common "seamless" WIN-OS/2 VDM
will be loaded and run in a fullscreen SAVDM.
<P>
By default, only the first Windows program launched from the Workplace Shell
as a "seamless" WIN-OS/2 VDM will create a new VDM.  Any subsequent Windows
programs will share this environment, in exactly the same way as in a MAVDM
full-screen session.  This is known as the<I> common "seamless"</I> WIN-OS/2
environment.
<P>
However, the user may wish to protect these Windows programs from each other,
and to maximize the timeslicing efficiency of Windows applications. This
can be done by checking the<I> Separate session</I> option on the<I> Session
</I>page of the<I> Settings</I> notebook for any Windows program object
under the Workplace Shell. That procedure would activate a "normal" "seamless"
WIN-OS/2 VDM session.
<P>
The Workplace Shell Window List will contain an entry for the common "seamless"
WIN-OS/2 VDM itself, in addition to an entry for each Windows program running
in this VDM  This provides also a mechanism for terminating this VDM from
the Workplace Shell desktop, along with all the active Windows applications
in it.  As the user has a visual representation of the "contents" of the
common "seamless" WIN-OS/2 VDM, the user knows which applications will be
terminated if the<I> Close</I> option is chosen.  If the common "seamless"
WIN-OS/2 VDM hangs because one of the Windows programs is not behaving properly,
the<I> Close</I> option on the entry for the common "seamless" WIN-OS/2
VDM will close down the entire VDM, including all Windows programs running
in it.  This behavior is similar to that of a MAVDM.
<P>
In the MAVDM and the common "seamless" WIN-OS/2 VDM environment, all those
Windows applications are still subject to the cooperative multitasking under
Windows itself.  Since several Windows applications are loaded in the same
VDM, the common "seamless" WIN-OS/2 VDM shares the same pitfalls as does
the MAVDM. If one Windows application crashes within a common "seamless"
WIN-OS/2 VDM, it may cause all the applications within that VDM to fail.
 However, as in a MAVDM, the effect is<I> only</I> within that VDM; other
VDMs running DOS or Windows applications, and other processes executing
under OS/2 Version 2.0, are not affected and continue execution.  So even
here there are additional benefits running Windows applications seamlessly
under OS/2.  Furthermore, as for the MAVDM environment, enhancements are
made to provide additional error checking and handling for the common "seamless"
WIN-OS/2 VDM.
<P>
A number of restrictions apply to the use of a common "seamless" WIN-OS/2
VDM. These are as follows:<!-- lm: 0x2 0 -->
<P>
<LI><!-- lm: 0x2 2 -->The DOS settings which will be in effect for the common
"seamless" WIN-OS/2 VDM will be those which are defined by the<I> first
</I>Windows program to start in this VDM. Changes to the settings for any
subsequent Windows program in that VDM will<I> not</I> affect the actual
settings of the common "seamless" WIN-OS/2 VDM. To make this obvious to
the user, the<I> WIN-OS/2 Settings</I> button on the<I> Session</I> page
of the<I> Settings</I> notebook is grayed for all Windows applications running
in the common "seamless" WIN-OS/2 VDM once it is active.  This implies that
WIN-OS/2 settings cannot be viewed or changed once this VDM is started.
<!-- lm: 0x2 0 -->
<P>
<LI><!-- lm: 0x2 2 -->The DPMI limit for the common "seamless" WIN-OS/2
VDM is higher than when defined for "seamless" WIN-OS/2 VDM, since multiple
applications are<!-- entering slot 249 --> likely to require more DPMI memory.
<!-- lm: 0x2 0 -->
<P>
<LI><!-- lm: 0x2 2 -->Each Windows program running in the common "seamless"
WIN-OS/2 VDM will have the same HAPP application handle), PID (process ID),
and SGID (screen group ID). Any action taken on one of these values will
cause that action against the entire VDM and not against only a specific
instance inside the common "seamless" WIN-OS/2 VDM. For example, if a WinTerminateApp()
call is issued, which uses the HAPP as input, then all applications running
within the common "seamless" WIN-OS/2 VDM will be terminated.  The user
will be warned by a dialog that multiple Windows applications will be ended.
<!-- lm: 0x2 0 -->
<BR>


<P><HR>

<A HREF="216_L3_SupportedComponents.html">[Back: Supported Components]</A> <BR>
<A HREF="218_L2_InstallingWINOS2Supp.html">[Next: Installing WIN-OS/2 Support Under OS/2 Version 2.0]</A> 
</BODY>
</HTML>
