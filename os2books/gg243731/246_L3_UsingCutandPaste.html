<HTML>
<HEAD>
<META HTTP-EQUIV="CONTENT-TYPE" CONTENT="TEXT/HTML; CHARSET=UTF-8">
<TITLE>Using Cut and Paste</TITLE>
</HEAD>
<BODY>
<H1>Using Cut and Paste</H1><!-- entering slot 281 -->
<P>
The following three scenarios describe the clipboard functions:<!-- lm: 0x2 0 -->
<P>
 <LI><LI><!-- lm: 0x2 4 -->Cut and Paste from a Windows Application in a
VDM to another application in a separate VDM;<I> Public</I> is deselected.
<!-- lm: 0x2 0 -->
<P>
 <LI><LI><!-- lm: 0x2 4 -->Cut and Paste between two Windows applications
within the same VDM (MAVDM).<!-- lm: 0x2 0 -->
<P>
 <LI><LI><!-- lm: 0x2 4 -->Cut and Paste between the OS/2 and Windows environments.
Cut and Paste within the OS/2 environment remains essentially unchanged.
<!-- lm: 0x2 0 -->
<BR>

<P>
<B>Scenario 1 - Cut/Paste Between Independent WIN-OS/2 Sessions</B><!-- lm: 0x2 0 -->
<P>
 <LI><LI><!-- lm: 0x2 4 -->Cut the data into the local Windows VDM clipboard.
<!-- lm: 0x2 0 -->
<P>
 <LI><LI><!-- lm: 0x2 4 -->Select<I> Export</I> from the clipboard pull-down
menu. The data is copied into the external clipboard.<!-- lm: 0x2 0 -->
<P>
 <LI><LI><!-- lm: 0x2 4 -->Select the VDM containing the destination Windows
application.<!-- lm: 0x2 0 -->
<P>
 <LI><LI><!-- lm: 0x2 4 -->Select<I> Import</I> from the clipboard pull-down
menu. The data is copied from the external clipboard into the local clipboard
of the receiving VDM.<!-- lm: 0x2 0 -->
<P>
 <LI><LI><!-- lm: 0x2 4 -->Paste the data into the destination Windows application.
<!-- lm: 0x2 0 -->
<BR>

<P>
<B>Note:  </B> Steps 2 and 4 above are not necessary if the clipboard is
public in the source and destination VDM.
<P>
<B>Scenario 2 - Cut/Paste Within A MAVDM</B><!-- lm: 0x2 0 -->
<P>
 <LI><LI><!-- lm: 0x2 4 -->Cut the data into the Windows VDM clipboard<!-- lm: 0x2 0 -->
<P>
 <LI><LI><!-- lm: 0x2 4 -->Paste the data from the clipboard into the destination
application.<!-- lm: 0x2 0 -->
<BR>

<P>
<B>Scenario 3 - Cut/Paste Between OS/2 And WIN-OS/2</B>
<P>
The OS/2 V2.0 clipboard is activated upon loading the operating system.
 A new OS/2 utility named CLIPVIEW.EXE is located in the OS2\APPS\ directory,
and has been provided to support the extended clipboard functions. CLIPVIEW.EXE
must be started in order to view and transfer the contents of the OS/2 V2.0
clipboard.
<P>
With the exception of the<I> File</I> option of the Windows clipboard, the
same pull-down menus are provided. The<I> Render</I> option is the same
as the<I> Display</I> option in the Windows clipboard. <I> Render</I> will
display the contents of the clipboard in a number of different formats.
 Because the contents of the clipboard are stored in separate areas in memory,
it is possible to view both the ASCII (text) and graphics contents of the
clipboard.
<P>
<B>Note:  </B> An application may or may not clear the entire contents of
the clipboard, prior to copying data to it.  For example, the system editor
will always erase the entire Presentation Manager clipboard, and therefore
any public Windows clipboard as well, before it copies its text data into
it.  On the other hand, some of the Presentation Manager applications do
not behave that way. They will only override the specific data areas which
are copied into the clipboard and leave the other ones in the clipboard
unchanged.<!-- lm: 0x2 0 -->
<P>

<P>
The global Windows VDM clipboard is visible to the Presentation Manager
clipboard. CLIPVIEW.EXE has been enhanced to perform the following two activities:
<!-- lm: 0x2 0 -->
<P>
 <LI><LI><!-- lm: 0x2 4 -->Update the Presentation Manager clipboard when
changes are made to the global VDM Clipboard<!-- lm: 0x2 0 -->
<P>
 <LI><LI><!-- lm: 0x2 4 -->Update the global Windows VDM clipboard when
changes are made to the Presentation Manager clipboard.<!-- lm: 0x2 0 -->
<BR>

<P>
The Presentation Manager clipboard server application is registered as "clipboard
viewer" to receive notification of clipboard updates.  This ensures that
the following messages are forwarded to the clipboard server, so that when
updates are made to the Presentation Manager clipboard, messages are sent
to the Presentation Manager CLIPVIEW.EXE.<!-- lm: 0x2 0 -->
<P>
<LI><!-- lm: 0x2 2 --><B><I>WM_DESTROYCLIPBOARD:</B></I> Signals that the
contents of the clipboard are being destroyed<!-- lm: 0x2 0 -->
<P>
<LI><!-- lm: 0x2 2 --><B><I>WM_DRAWCLIPBOARD:</B></I> Signals an application
to notify the next application in the chain of a change to the clipboard
<!-- lm: 0x2 0 -->
<P>
<LI><!-- lm: 0x2 2 --><B><I>WM_HSCROLLCLIPBOARD:</B></I> Requests horizontal
scrolling of the clipboard contents<!-- lm: 0x2 0 -->
<P>
<LI><!-- lm: 0x2 2 --><B><I>WM_PAINTCLIPBOARD:</B></I> Requests painting
of the contents of the clipboard<!-- lm: 0x2 0 -->
<P>
<LI><!-- lm: 0x2 2 --><B><I>WM_RENDERALLFMTS:</B></I> Notifies the owner
of the clipboard that it must render clipboard data in all possible formats
<!-- lm: 0x2 0 -->
<P>
<LI><!-- lm: 0x2 2 --><B><I>WM-RENDERFMT:</B></I> Notifies the clipboard
owner that it must format the last data copied to the clipboard<!-- lm: 0x2 0 -->
<P>
<LI><!-- lm: 0x2 2 --><B><I>WM_SIZECLIPBOARD:</B></I> Notifies the clipboard
 owner that the clipboard application's window size has changed<!-- lm: 0x2 0 -->
<P>
<LI><!-- lm: 0x2 2 --><B><I>WM_VSCROLLCLIPBOARD:</B></I> Requests vertical
scrolling of the clipboard contents.<!-- lm: 0x2 0 -->
<BR>

<P>
<B>Note:  </B> No changes have been made to the Presentation Manager API
functions to accommodate this design.  Presentation Manager applications
will not notice any difference; there appears to be just one (Presentation
Manager) clipboard as it always used to be.  The same is true for Windows
applications as well.<!-- lm: 0x2 0 -->
<P>

<P>
Data formats are translated from Presentation Manager to Windows formats
and vice versa, as<!-- entering slot 282 --> required. This translation
is performed when data is placed in the global clipboard. The following
data formats will be translated between Presentation Manager and Windows:
<!-- lm: 0x2 0 -->
<P>
<B>Windows DIB bitmaps:</B><!-- lm: 0x12 21 -->
<UL> The Windows device-independent
bitmaps are translated to/from OS/2 Presentation Manager bitmaps.<!-- lm: 0x2 0 -->
</UL><B> Windows
bitmaps:</B><!-- lm: 0x12 21 -->
<UL> This translated pre-Windows 3.0 formatted
bitmaps to OS/2 Presentation Manager bitmaps.
<P>
<B>Note:  </B> This is a one way only translation.<!-- lm: 0x2 0 -->
</UL><B> Windows
Metafiles:</B><!-- lm: 0x12 21 -->
<UL> Windows metafiles are first internally
converted to the Windows DIB format by the Windows clipboard viewer, before
being forwarded to the global clipboard.<!-- lm: 0x2 0 -->
</UL><B> PM Metafiles:
</B><!-- lm: 0x12 21 -->
<UL>PM metafiles are first internally converted
to the PM bitmap format by the PM clipboard viewer, before being forwarded
to the global clipboard.<!-- lm: 0x2 0 -->
</UL><B> Text:</B><!-- lm: 0x12 21 -->
<UL> ASCII
text will be translated in both directions.  If the sending and receiving
environment are using a different codepage, the appropriate codepage translation
will take place.<!-- lm: 0x2 0 -->
</UL>

<P><HR>

<A HREF="245_L3_WINOS2ClipboardSuppo.html">[Back: WIN-OS/2 Clipboard Support]</A> <BR>
<A HREF="247_L2_DynamicDataExchange.html">[Next: Dynamic Data Exchange]</A> 
</BODY>
</HTML>
