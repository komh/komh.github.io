<HTML>
<HEAD>
<META HTTP-EQUIV="CONTENT-TYPE" CONTENT="TEXT/HTML; CHARSET=UTF-8">
<TITLE>Virtual DMA Device Driver</TITLE>
</HEAD>
<BODY>
<H1>Virtual DMA Device Driver</H1><!-- entering slot 163 -->
<P>
The PC AT has eight DMA channels, each of which can be hard-wired to a slave
device on the bus.  Assignments, therefore, cannot change unless the device
adapter is reconfigured by changing jumpers.  Because of this one-to-one
relationship, there is no separate device driver for the DMA controller.
 Each device requiring DMA services programs the corresponding DMA channel
directly in its device driver, as though the DMA channel were part of its
own hardware.
<P>
In the PS/2,<I> virtual DMA channels</I> may also be assigned; two of the
eight channels, channels 0 and 4, are virtual channels which can be dynamically
assigned to any device.  These channels can, therefore, be multiplexed to
service more than one device.  ABIOS serializes channel accesses to avoid
contention.
<P>
Device drivers for hardware devices access the DMA channels directly, with
no device driver required for the DMA controller itself. OS/2 Version 2.0,
therefore, does not use a physical device driver for DMA access.  The virtual
DMA device driver VDMA.SYS supports access to DMA ports from DOS applications
in virtual machines.
<P>
VDMA consists of port trap handlers which ignore IN/OUT commands.  The supported
DMA services are:<!-- lm: 0x2 0 -->
<P>
<LI><!-- lm: 0x2 2 -->Memory address and page address registers for all
DMA channels<!-- lm: 0x2 0 -->
<P>
<LI><!-- lm: 0x2 2 -->Transfer count registers for all DMA channels<!-- lm: 0x2 0 -->
<P>
<LI><!-- lm: 0x2 2 -->Status registers<!-- lm: 0x2 0 -->
<P>
<LI><!-- lm: 0x2 2 -->Mask registers<!-- lm: 0x2 0 -->
<P>
<LI><!-- lm: 0x2 2 -->Mode registers<!-- lm: 0x2 0 -->
<P>
<LI><!-- lm: 0x2 2 -->Byte pointer flip flop port<!-- lm: 0x2 0 -->
<P>
<LI><!-- lm: 0x2 2 -->Extended function/execute ports (for PS/2 only)<!-- lm: 0x2 0 -->
<P>
<LI><!-- lm: 0x2 2 -->Master clear ports<!-- lm: 0x2 0 -->
<P>
<LI><!-- lm: 0x2 2 -->Command register (for PC/AT only)<!-- lm: 0x2 0 -->
<P>
<LI><!-- lm: 0x2 2 -->Write request register (for PC/AT only).<!-- lm: 0x2 0 -->
<BR>

<P>
Note that VDMA<I> does not</I> support direct access to the DMA controller
by DOS applications.

<P><HR>

<A HREF="154_L3_VirtualCMOSDeviceDri.html">[Back: Virtual CMOS Device Driver]</A> <BR>
<A HREF="156_L3_VirtualDiskDeviceDri.html">[Next: Virtual Disk Device Driver]</A> 
</BODY>
</HTML>
