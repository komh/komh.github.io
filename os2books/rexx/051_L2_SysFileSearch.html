<HTML>
<HEAD>
<META HTTP-EQUIV="CONTENT-TYPE" CONTENT="TEXT/HTML; CHARSET=UTF-8">
<TITLE>SysFileSearch</TITLE>
<STYLE>
PRE {
  FONT-FAMILY: Consolas, "Lucida Console", "Courier New", Courier, MONOSPACE;
}
</STYLE>
</HEAD>
<BODY>
<H1>SysFileSearch</H1><!-- entering slot 51 --><!-- lm: 0x2 1 -->
<UL>
<P>
Function:<!-- lm: 0x2 11 -->
<UL> SysFileSearch<!-- lm: 0x2 1 -->
</UL> Syntax:
<!-- lm: 0x2 11 -->
<UL>call SysFileSearch target, file, stem, [options]
<!-- lm: 0x2 11 -->
<P>
<B>target</B><!-- lm: 0x2 26 -->
<UL> The string to search for.<!-- lm: 0x2 11 -->
</UL><B> file
</B><!-- lm: 0x2 26 -->
<UL>The file to search.<!-- lm: 0x2 11 -->
</UL><B> stem
</B><!-- lm: 0x2 26 -->
<UL>The name of the stem variable to place the results.

<P>
<B>┴╓: </B> stem.0 contains the number of lines found.<!-- lm: 0x2 11 -->
</UL><B> options
</B><!-- lm: 0x2 26 -->
<UL>Any logical combination of the following:<!-- lm: 0x2 26 -->
<P>
C<!-- lm: 0x2 41 -->
<UL> Case sensitive search.<!-- lm: 0x2 26 -->
</UL> N
<!-- lm: 0x2 41 -->
<UL>Give line numbers when reporting hits.
<P>
<B>┴╓: </B> Default is case insensitive without line numbers.<!-- lm: 0x2 26 --><!-- lm: 0x2 11 --><!-- lm: 0x2 1 -->
</UL> Purpose:
<!-- lm: 0x2 11 -->
<UL>Finds all lines in specified file which contain
a specified target string, and places said lines in a stem variable.<!-- lm: 0x2 1 -->
</UL> RC:
<!-- lm: 0x2 11 -->
<UL>Return Codes<!-- lm: 0x2 11 -->
<P>
<LI><!-- lm: 0x2 26 -->Successful.<!-- lm: 0x2 11 -->
<P>
<LI><!-- lm: 0x2 26 -->Error.  Not enough memory.<!-- lm: 0x2 11 -->
<P>
<LI><!-- lm: 0x2 26 -->Error.  Error opening file.<!-- lm: 0x2 11 -->
<PRE>Examples:

 /* Find DEVICE statements in CONFIG.SYS */
 call SysFileSearch 'DEVICE', 'C:\CONFIG.SYS', 'file.'
 do i=1 to file.0
  say file.i
 end

 /* Output */
 DEVICE=C:\OS2\DOS.SYS
 DEVICE=C:\OS2\PMDD.SYS
 DEVICE=C:\OS2\COM02.SYS
 SET VIDEO_DEVICES=VIO_IBM8514A
 SET VIO_IBM8514A=DEVICE(BVHVGA,BVH8514A)
 DEVICE=C:\OS2\POINTDD.SYS
 DEVICE=C:\OS2\MSPS202.SYS
 DEVICE=C:\OS2\MOUSE.SYS TYPE=MSPS2$


 /* Find DEVICE statements in CONFIG.SYS (along with */
 /* line nums) */
 call SysFileSearch 'DEVICE', 'C:\CONFIG.SYS', 'file.', 'N'
 do i=1 to file.0
  say file.i
 end

 /* Output */
 20 DEVICE=C:\OS2\DOS.SYS
 21 DEVICE=C:\OS2\PMDD.SYS
 22 DEVICE=C:\OS2\COM02.SYS
 33 SET VIDEO_DEVICES=VIO_IBM8514A
 34 SET VIO_IBM8514A=DEVICE(BVHVGA,BVH8514A)
 40 DEVICE=C:\OS2\POINTDD.SYS
 41 DEVICE=C:\OS2\MSPS202.SYS
 42 DEVICE=C:\OS2\MOUSE.SYS TYPE=MSPS2$
<!-- lm: 0x2 1 -->
</UL></PRE>


<P><HR>

<A HREF="050_L2_SysFileTree.html">[Back: SysFileTree]</A> <BR>
<A HREF="052_L2_SysGetEA.html">[Next: SysGetEA]</A> 
</BODY>
</HTML>
