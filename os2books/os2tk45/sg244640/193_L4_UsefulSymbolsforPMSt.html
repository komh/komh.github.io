<HTML>
<HEAD>
<META HTTP-EQUIV="CONTENT-TYPE" CONTENT="TEXT/HTML; CHARSET=UTF-8">
<TITLE>Useful Symbols for PM Structures</TITLE>
</HEAD>
<BODY>
<H1>Useful Symbols for PM Structures</H1><!-- entering slot 284 -->
<P>
The following list is a small selection of global symbols from<B> PMMERGE.SYM
</B>that will be of help in locating the structures associated with message
handling: <!-- lm: 0x2 1 -->
<UL>
<P>
<B>pmsemaphores</B><!-- lm: 0x11 11 -->
<UL> This is the label for the table
of <A HREF="160_L6_PMSEMGRESEM.html">PMSEM and GRESEM</A> semaphore structures.
Offset +0x20 is the location of the User Semaphore. If this is owned and
not released within the time-out period after Cltrl-Esc has been hit, then
the<B> Application Not Responding to Messages</B> reports the semaphore
owner as the culprit. <!-- lm: 0x2 1 -->
</UL><B> pmqSyslock</B><!-- lm: 0x11 11 -->
<UL> The
<B>PMQ</B> of the thread that has locked the system queue.
<P>
This is the first place to look when investigating a hang in a PM application.
The system uses this to name a<I> bad</I> application when the<B> Application
Not Responding to Messages</B> dialog appears. <!-- lm: 0x2 1 -->
</UL><B> pmqFocus
</B><!-- lm: 0x11 11 -->
<UL>The<B> PMQ</B> of the window that has the focus.

<P>
if<B> pmqSyslock</B> is zero, the system uses this as a second choice for
the<I> bad</I> application when the<B> Application Not Responding to Messages
</B>dialog appears. <!-- lm: 0x2 1 -->
</UL><B> pmqKeyWake</B><!-- lm: 0x11 11 -->
<UL> The
<B>PMQ</B> of the current keyboard event receiver. <!-- lm: 0x2 1 -->
</UL><B> pmqMouseWake
</B><!-- lm: 0x11 11 -->
<UL>The<B> PMQ</B> of the current mouse event receiver.
 <!-- lm: 0x2 1 -->
</UL><B>pmqEventWake</B><!-- lm: 0x11 11 -->
<UL> The
<B>PMQ</B> of the current miscellaneous event receiver. <!-- lm: 0x2 1 -->
</UL><B> pwndFocus
</B><!-- lm: 0x11 11 -->
<UL>The<B> PWND</B> of the window currently in
focus. <!-- lm: 0x2 1 -->
</UL><B> pmqShutdown</B><!-- lm: 0x11 11 -->
<UL> The
<B>PMQ</B> of the thread sent a<B> WM_QUIT</B> and being waited on to terminte.
If Shutdown doesn't complete, then this could be a good place to start investigation
of the problem. <!-- lm: 0x2 1 -->
</UL><B> pmqCapture</B><!-- lm: 0x11 11 -->
<UL> The
<B>PMQ</B> of the thread that has the mouse captured. <!-- lm: 0x2 1 -->
</UL><B> pwndCapture
</B><!-- lm: 0x11 11 -->
<UL>The<B> PWND</B> of the window associated with
mouse capture. <!-- lm: 0x2 1 -->
</UL><B> pwndSysModal</B><!-- lm: 0x11 11 -->
<UL> The
<B>PWND</B> of the System Modal window. <!-- lm: 0x2 1 -->
</UL><B> pmqVisLock
</B><!-- lm: 0x11 11 -->
<UL>The<B> PMQ</B> that has visible regions locked.
 <!-- lm: 0x2 1 -->
</UL><B>pmqTrack</B><!-- lm: 0x11 11 -->
<UL> The<B> PMQ
</B>of the thread currently in<B> WinTrackRect</B>. <!-- lm: 0x2 1 -->
</UL><B> pmqLockUpdate
</B><!-- lm: 0x11 11 -->
<UL>The<B> PMQ</B> of the thread that has update
locked. <!-- lm: 0x2 1 -->
</UL><B> pHandleTable</B><!-- lm: 0x11 11 -->
<UL> The
address of the handle table. <!-- lm: 0x2 1 -->
</UL><B> pSysqueue</B><!-- lm: 0x11 11 -->
<UL> The
<B>MQ</B> of the system input queue.
<P>
The system queue is headed by a partial<B> MQ</B> since it does not require
the fields to support a receive list. <!-- lm: 0x2 1 -->
</UL><B> pmqShell
</B><!-- lm: 0x11 11 -->
<UL>The<B> PMQ</B> of the 1st thread of the 1st
Shell Process.
<P>
This thread is responsible for starting and re-starting the Workplace Shell.
 <!-- lm: 0x2 1 -->
</UL><B>pmqShell2</B><!-- lm: 0x11 11 -->
<UL> The<B> PMQ
</B>of the 1st thread of the 2nd Shell or Workplace Shell Process.
<P>
This thread is the main thread of the desktop PM application. <!-- lm: 0x2 1 -->
</UL><B> paAABRegs
</B><!-- lm: 0x11 11 -->
<UL>The address of the application anchor block
registers (<B>AAB</B>).
<P>
<B>AAB</B>  registers are allocated for each PM application message thread.
 This is located in thread local memory, which implies that it is correct
only for the current thread context.  The Thread Local Memory Area is saved
in the <A HREF="3345_L0_.html">TCB</A>  and restored when the thread is
made current.  Since the<B> TCB</B>  may be located in System storage under
any context then a thread's<B> PMQ</B>  may be found in any context from
its<B> TCB</B>. <!-- lm: 0x2 1 -->
</UL><B> pwndObject</B><!-- lm: 0x11 11 -->
<UL> The
<B>PWND</B> of the Object Window.
<P>
This is the parent or owner of all non-display windows. <!-- lm: 0x2 1 -->
</UL><B> pwndDesktop
</B><!-- lm: 0x11 11 -->
<UL>The<B> PWND</B> of the Desktop Window.
<P>
This is the parent of owner of all displayable windows. <!-- lm: 0x2 1 -->
</UL><B> SleepPMQ+nnn
</B><!-- lm: 0x11 11 -->
<UL>When a thread is blocked at approximately offset
+0x155 into<B> SleepPMQ</B> then it is waiting on the message queue semaphore
for new messages or responses to outstanding sent messages. Offset +0x30
from the current stack pointer usually contains the<B> PMQ</B> for the current
thread. <!-- lm: 0x2 1 -->
</UL><B> pmqList</B><!-- lm: 0x11 11 -->
<UL> All
<B>MQs</B> are chained on a single linked master list from offset +0x0 of
the MQ.  The current head of the master list is pointed to by<B> pmqList</B>.
 <!-- lm: 0x2 1 -->
</UL><B>psmsList</B><!-- lm: 0x11 11 -->
<UL> All<B> SMSs
</B> are chained on a single linked master list from offset +0x0 of the
<B><!-- entering slot 285 -->SMS</B>.  The current head of the master list
is pointed to by<B> psmsList</B>. <!-- lm: 0x2 1 -->
</UL><B> qhpsBadApp
</B><!-- lm: 0x11 11 -->
<UL>This is the label of the<B> QHPSTRUCT</B> saved
the first time a time-out occurs after Ctrl-Esc has been hit and the<B> Application
Not Responding to Messages</B> dialog appears. <!-- lm: 0x2 1 -->
</UL><B> fBadAppDialog
</B><!-- lm: 0x11 11 -->
<UL>A Boolean that indicates when the<B> Application
Not Responding to Messages</B> dialog has been displayed.<!-- lm: 0x2 1 -->
</UL> 

<P><HR>

<A HREF="192_L5_ApplicationNotRespon.html">[Back: Application Not Responding to Messages Logic]</A> <BR>
<A HREF="194_L4_UsefulPMStructures.html">[Next: Useful PM Structures]</A> 
</BODY>
</HTML>
