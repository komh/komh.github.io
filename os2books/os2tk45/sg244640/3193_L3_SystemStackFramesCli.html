<HTML>
<HEAD>
<TITLE>System Stack Frames Client Register Information</TITLE>
</HEAD>
<BODY>
<H1>System Stack Frames Client Register Information</H1><!-- entering slot 3470 --> 
<P>
<!-- lm: 0x2 1 -->
<UL>
<P>
<B>Pointers</B><!-- lm: 0x11 11 -->
<UL> TCB field<B> TCB_pcriFrameType
</B>points to the CRI. <!-- lm: 0x2 1 -->
</UL><B> Locations</B><!-- lm: 0x11 11 -->
<UL><B> _criISF
</B>locates the Interrupt Stack Frame CRI.
<P>
<B>_criTSF</B> locates the Trap Stack Frame CRI.
<P>
<B>_criVSF</B> locates the VDM Stack Frame CRI.
<P>
<B>_criSEF</B> locates the System Entry Stack Frame CRI.
<P>
<B>_criPASCALSEF</B> locates the PASCAL System Entry Stack Frame CRI.
<P>
<B>_criSSF</B> locates the SCI Stack Frame CRI.
<P>
<B>_criDHF</B> locates the Device Help Stack Frame CRI.
<P>
<B>fpoldstack</B> contains a 32-bit far pointer to the ISF built by the
Interrupt Router at interrupt time. <!-- lm: 0x2 1 -->
</UL><B> VM Owner
</B><!-- lm: 0x11 11 -->
<UL><B>os2krnl (0xffaa)</B><!-- lm: 0x2 1 -->
</UL> 
<P>
<B><A HREF="3252_L0_.html">Format</A></B> 
<P>
<B>CRI</B> Client Register Information
<PRE>зддддддддддддддддддддбддддддбддддддбддддбдддддддддддддддддддддддддддддддддддддддд©Ё<I>Field Name</I>          Ё<I>Offset</I>Ё<I>Length</I>Ё<I>Type</I>Ё<I>Description</I>                             Ё
цддддддддддддддддддддеддддддеддддддеддддедддддддддддддддддддддддддддддддддддддддд╢
Ёcri_ulSize          Ё+0    Ё4     ЁD   Ёsize of stack frame                     Ё
цддддддддддддддддддддеддддддеддддддеддддедддддддддддддддддддддддддддддддддддддддд╢
Ёcri_eax             Ё+4    Ё4     ЁS   Ёeax rip                                 Ё
цддддддддддддддддддддеддддддеддддддеддддедддддддддддддддддддддддддддддддддддддддд╢
Ёcri_ebx             Ё+8    Ё4     ЁS   Ёebx rip                                 Ё
цддддддддддддддддддддеддддддеддддддеддддедддддддддддддддддддддддддддддддддддддддд╢
Ёcri_ecx             Ё+c    Ё4     ЁS   Ёecx rip                                 Ё
цддддддддддддддддддддеддддддеддддддеддддедддддддддддддддддддддддддддддддддддддддд╢
Ёcri_edx             Ё+10   Ё4     ЁS   Ёedx rip                                 Ё
цддддддддддддддддддддеддддддеддддддеддддедддддддддддддддддддддддддддддддддддддддд╢
Ёcri_ebp             Ё+14   Ё4     ЁS   Ёebp rip                                 Ё
цддддддддддддддддддддеддддддеддддддеддддедддддддддддддддддддддддддддддддддддддддд╢
Ёcri_esi             Ё+18   Ё4     ЁS   Ёesi rip                                 Ё
цддддддддддддддддддддеддддддеддддддеддддедддддддддддддддддддддддддддддддддддддддд╢
Ёcri_edi             Ё+1c   Ё4     ЁS   Ёedi rip                                 Ё
цддддддддддддддддддддеддддддеддддддеддддедддддддддддддддддддддддддддддддддддддддд╢
Ёcri_ds              Ё+20   Ё4     ЁS   Ёds rip                                  Ё
цддддддддддддддддддддеддддддеддддддеддддедддддддддддддддддддддддддддддддддддддддд╢
Ёcri_es              Ё+24   Ё4     ЁS   Ёes rip                                  Ё
цддддддддддддддддддддеддддддеддддддеддддедддддддддддддддддддддддддддддддддддддддд╢
Ёcri_fs              Ё+28   Ё4     ЁS   Ёfs rip                                  Ё
цддддддддддддддддддддеддддддеддддддеддддедддддддддддддддддддддддддддддддддддддддд╢
Ёcri_gs              Ё+2c   Ё4     ЁS   Ёgs rip                                  Ё
цддддддддддддддддддддеддддддеддддддеддддедддддддддддддддддддддддддддддддддддддддд╢
Ёcri_cs              Ё+30   Ё4     ЁS   Ёcs rip                                  Ё
цддддддддддддддддддддеддддддеддддддеддддедддддддддддддддддддддддддддддддддддддддд╢
Ёcri_eip             Ё+34   Ё4     ЁS   Ёeip rip                                 Ё
цддддддддддддддддддддеддддддеддддддеддддедддддддддддддддддддддддддддддддддддддддд╢
Ёcri_eflag           Ё+38   Ё4     ЁS   Ёeflag rip                               Ё
цддддддддддддддддддддеддддддеддддддеддддедддддддддддддддддддддддддддддддддддддддд╢
Ёcri_ss              Ё+3c   Ё4     ЁS   Ёss rip                                  Ё
цддддддддддддддддддддеддддддеддддддеддддедддддддддддддддддддддддддддддддддддддддд╢
Ёcri_esp             Ё+40   Ё4     ЁS   Ёesp rip                                 Ё
цддддддддддддддддддддеддддддеддддддеддддедддддддддддддддддддддддддддддддддддддддд╢
Ёcri_cbargs          Ё+44   Ё4     ЁS   Ёcbargs rip                              Ё
цддддддддддддддддддддеддддддеддддддеддддедддддддддддддддддддддддддддддддддддддддд╢
Ёcri_trapnum         Ё+48   Ё4     ЁS   Ёtrapnum rip                             Ё
цддддддддддддддддддддеддддддеддддддеддддедддддддддддддддддддддддддддддддддддддддд╢
Ёcri_errcode         Ё+4c   Ё4     ЁS   Ёerrcode rip                             Ё
цддддддддддддддддддддеддддддеддддддеддддедддддддддддддддддддддддддддддддддддддддд╢
Ёcri_pfnRebuild      Ё+50   Ё4     ЁD   Ё                                        Ё
цддддддддддддддддддддеддддддеддддддеддддедддддддддддддддддддддддддддддддддддддддд╢
Ёcri_pfpfnKernelExit Ё+54   Ё4     ЁD   Ё                                        Ё
юддддддддддддддддддддаддддддаддддддаддддадддддддддддддддддддддддддддддддддддддддды
</PRE>
 
<P>
<B>RIP</B> Register Information Packet
<PRE>зддддддддддддддддддддбддддддбддддддбддддбдддддддддддддддддддддддддддддддддддддддд©
Ё<I>Field Name</I>          Ё<I>Offset</I>Ё<I>Length</I>Ё<I>Type</I>Ё<I>Description</I>                             Ё
цддддддддддддддддддддеддддддеддддддеддддедддддддддддддддддддддддддддддддддддддддд╢
Ёrip_flags           Ё+0    Ё2     ЁW   ЁFlags                                   Ё
цддддддддддддддддддддеддддддеддддддеддддедддддддддддддддддддддддддддддддддддддддд╢
Ёrip_offset          Ё+2    Ё4     ЁW   ЁOffset of register into stack frame     Ё
юддддддддддддддддддддаддддддаддддддаддддадддддддддддддддддддддддддддддддддддддддды
</PRE>
 
<P>
<B>rip_flags</B> flag definitions:
<PRE>здддддддддддддддддддбддддддддбдддддддддддддддддддддддддддддддддддд©
ЁName               ЁBit MaskЁDescription                         Ё
цдддддддддддддддддддеддддддддедддддддддддддддддддддддддддддддддддд╢
ЁKM_RIP_INVALID     Ё0x0001  Ёinvalid register                    Ё
цдддддддддддддддддддеддддддддедддддддддддддддддддддддддддддддддддд╢
ЁKM_RIP_INVALID_SET Ё0x0002  Ёinvalid register to set             Ё
цдддддддддддддддддддеддддддддедддддддддддддддддддддддддддддддддддд╢
ЁKM_RIP_WORD        Ё0x0004  Ёword register                       Ё
цдддддддддддддддддддеддддддддедддддддддддддддддддддддддддддддддддд╢
ЁKM_RIP_TSD_RELATIVEЁ0x0008  Ёrip_offset relative to TSD beginningЁ
цдддддддддддддддддддеддддддддедддддддддддддддддддддддддддддддддддд╢
ЁKM_RIP_C32         Ё0x0010  Ё32-bit C style call                 Ё
юдддддддддддддддддддаддддддддадддддддддддддддддддддддддддддддддддды
</PRE>
 
<P>
<B>ISF</B> Interrupt Manager Stack Frame 
<P>
This is what the stack frame looks like when the system is entered thru
the interrupt manager during a hardware interrupt.  For a hardware interrupt
in a VDM context, the stack frame always needs to be a "VSF" type so the
stack frame base is adjusted by ISF_VSF_START. The points the stack frame
base to "isf_edi" in the regular interrupt frame.  The interrupt stack frame
has also been padded (ISF_STACK_PAD) between the general registers (EDI
to EAX) and the hardware pushed registers (EIP to SS) with a dummy trap
number and error code to look like the VSF stack frame.
<PRE>зддддддддддддддддддддбддддддбддддддбддддбдддддддддддддддддддддддддддддд©
Ё<I>Field Name</I>          Ё<I>Offset</I>Ё<I>Length</I>Ё<I>Type</I>Ё<I>Description</I>                   Ё
цддддддддддддддддддддеддддддеддддддеддддедддддддддддддддддддддддддддддд╢
Ёisf_CurrIntLevel    Ё+0    Ё4     ЁD   Ё                              Ё
цддддддддддддддддддддеддддддеддддддеддддедддддддддддддддддддддддддддддд╢
Ёisf_gs              Ё+4    Ё2     ЁW   Ё                              Ё
цддддддддддддддддддддеддддддеддддддеддддедддддддддддддддддддддддддддддд╢
Ёisf_padgs           Ё+6    Ё2     ЁW   Ё                              Ё
цддддддддддддддддддддеддддддеддддддеддддедддддддддддддддддддддддддддддд╢
Ёisf_fs              Ё+8    Ё2     ЁW   Ё                              Ё
цддддддддддддддддддддеддддддеддддддеддддедддддддддддддддддддддддддддддд╢
Ёisf_padfs           Ё+a    Ё2     ЁW   Ё                              Ё
цддддддддддддддддддддеддддддеддддддеддддедддддддддддддддддддддддддддддд╢
Ёisf_es              Ё+c    Ё2     ЁW   Ё                              Ё
цддддддддддддддддддддеддддддеддддддеддддедддддддддддддддддддддддддддддд╢
Ёisf_pades           Ё+e    Ё2     ЁW   Ё                              Ё
цддддддддддддддддддддеддддддеддддддеддддедддддддддддддддддддддддддддддд╢
Ёisf_ds              Ё+10   Ё2     ЁW   Ё                              Ё
цддддддддддддддддддддеддддддеддддддеддддедддддддддддддддддддддддддддддд╢
Ёisf_padds           Ё+12   Ё2     ЁW   Ё                              Ё
цддддддддддддддддддддеддддддеддддддеддддедддддддддддддддддддддддддддддд╢
Ёisf_edi             Ё+14   Ё4     ЁD   Ёstart of VDM stack frame      Ё
цддддддддддддддддддддеддддддеддддддеддддедддддддддддддддддддддддддддддд╢
Ёisf_esi             Ё+18   Ё4     ЁD   Ё                              Ё
цддддддддддддддддддддеддддддеддддддеддддедддддддддддддддддддддддддддддд╢
Ёisf_ebp             Ё+1c   Ё4     ЁD   Ё                              Ё
цддддддддддддддддддддеддддддеддддддеддддедддддддддддддддддддддддддддддд╢
Ёisf_padesp          Ё+20   Ё4     ЁD   Ё                              Ё
цддддддддддддддддддддеддддддеддддддеддддедддддддддддддддддддддддддддддд╢
Ёisf_ebx             Ё+24   Ё4     ЁD   Ё                              Ё
цддддддддддддддддддддеддддддеддддддеддддедддддддддддддддддддддддддддддд╢
Ёisf_edx             Ё+28   Ё4     ЁD   Ё                              Ё
цддддддддддддддддддддеддддддеддддддеддддедддддддддддддддддддддддддддддд╢
Ёisf_ecx             Ё+2c   Ё4     ЁD   Ё                              Ё
цддддддддддддддддддддеддддддеддддддеддддедддддддддддддддддддддддддддддд╢
Ёisf_eax             Ё+30   Ё4     ЁD   Ё                              Ё
цддддддддддддддддддддеддддддеддддддеддддедддддддддддддддддддддддддддддд╢
Ёisf_pad             Ё+34   Ё8     ЁB   Ё                              Ё
цддддддддддддддддддддеддддддеддддддеддддедддддддддддддддддддддддддддддд╢
Ёisf_eip             Ё+3c   Ё4     ЁD   Ё                              Ё
цддддддддддддддддддддеддддддеддддддеддддедддддддддддддддддддддддддддддд╢
Ёisf_cs              Ё+40   Ё2     ЁW   Ё                              Ё
цддддддддддддддддддддеддддддеддддддеддддедддддддддддддддддддддддддддддд╢
Ёisf_padcs           Ё+42   Ё2     ЁW   Ё                              Ё
цддддддддддддддддддддеддддддеддддддеддддедддддддддддддддддддддддддддддд╢
Ёisf_eflag           Ё+44   Ё4     ЁD   Ё                              Ё
цддддддддддддддддддддеддддддеддддддеддддедддддддддддддддддддддддддддддд╢
Ёisf_esp             Ё+48   Ё4     ЁD   Ё                              Ё
цддддддддддддддддддддеддддддеддддддеддддедддддддддддддддддддддддддддддд╢
Ёisf_ss              Ё+4c   Ё2     ЁW   Ё                              Ё
цддддддддддддддддддддеддддддеддддддеддддедддддддддддддддддддддддддддддд╢
Ёisf_padss           Ё+4e   Ё2     ЁW   Ё                              Ё
юддддддддддддддддддддаддддддаддддддаддддадддддддддддддддддддддддддддддды
</PRE>
 
<P>
<B>TSF</B> Trap or Exception Stack Frame 
<P>
This is what the stack frame looks like when the system is entered thru
a 386<!-- entering slot 3471 --> exception (from protected mode).
<PRE>зддддддддддддддддддддбддддддбддддддбддддбдддддддддддд©
Ё<I>Field Name</I>          Ё<I>Offset</I>Ё<I>Length</I>Ё<I>Type</I>Ё<I>Description</I> Ё
цддддддддддддддддддддеддддддеддддддеддддедддддддддддд╢
Ёtsf_edi             Ё+0    Ё4     ЁD   Ё            Ё
цддддддддддддддддддддеддддддеддддддеддддедддддддддддд╢
Ёtsf_esi             Ё+4    Ё4     ЁD   Ё            Ё
цддддддддддддддддддддеддддддеддддддеддддедддддддддддд╢
Ёtsf_ebp             Ё+8    Ё4     ЁD   Ё            Ё
цддддддддддддддддддддеддддддеддддддеддддедддддддддддд╢
Ёtsf_padesp          Ё+c    Ё4     ЁD   Ё            Ё
цддддддддддддддддддддеддддддеддддддеддддедддддддддддд╢
Ёtsf_ebx             Ё+10   Ё4     ЁD   Ё            Ё
цддддддддддддддддддддеддддддеддддддеддддедддддддддддд╢
Ёtsf_edx             Ё+14   Ё4     ЁD   Ё            Ё
цддддддддддддддддддддеддддддеддддддеддддедддддддддддд╢
Ёtsf_ecx             Ё+18   Ё4     ЁD   Ё            Ё
цддддддддддддддддддддеддддддеддддддеддддедддддддддддд╢
Ёtsf_eax             Ё+1c   Ё4     ЁD   Ё            Ё
цддддддддддддддддддддеддддддеддддддеддддедддддддддддд╢
Ёtsf_gs              Ё+20   Ё2     ЁW   Ё            Ё
цддддддддддддддддддддеддддддеддддддеддддедддддддддддд╢
Ёtsf_padgs           Ё+22   Ё2     ЁW   Ё            Ё
цддддддддддддддддддддеддддддеддддддеддддедддддддддддд╢
Ёtsf_fs              Ё+24   Ё2     ЁW   Ё            Ё
цддддддддддддддддддддеддддддеддддддеддддедддддддддддд╢
Ёtsf_padfs           Ё+26   Ё2     ЁW   Ё            Ё
цддддддддддддддддддддеддддддеддддддеддддедддддддддддд╢
Ёtsf_es              Ё+28   Ё2     ЁW   Ё            Ё
цддддддддддддддддддддеддддддеддддддеддддедддддддддддд╢
Ёtsf_pades           Ё+2a   Ё2     ЁW   Ё            Ё
цддддддддддддддддддддеддддддеддддддеддддедддддддддддд╢
Ёtsf_ds              Ё+2c   Ё2     ЁW   Ё            Ё
цддддддддддддддддддддеддддддеддддддеддддедддддддддддд╢
Ёtsf_padds           Ё+2e   Ё2     ЁW   Ё            Ё
цддддддддддддддддддддеддддддеддддддеддддедддддддддддд╢
Ёtsf_trapnum         Ё+30   Ё4     ЁD   Ё            Ё
цддддддддддддддддддддеддддддеддддддеддддедддддддддддд╢
Ёtsf_errcode         Ё+34   Ё4     ЁD   Ё            Ё
цддддддддддддддддддддеддддддеддддддеддддедддддддддддд╢
Ёtsf_eip             Ё+38   Ё4     ЁD   Ё            Ё
цддддддддддддддддддддеддддддеддддддеддддедддддддддддд╢
Ёtsf_cs              Ё+3c   Ё2     ЁW   Ё            Ё
цддддддддддддддддддддеддддддеддддддеддддедддддддддддд╢
Ёtsf_padcs           Ё+3e   Ё2     ЁW   Ё            Ё
цддддддддддддддддддддеддддддеддддддеддддедддддддддддд╢
Ёtsf_eflag           Ё+40   Ё4     ЁD   Ё            Ё
цддддддддддддддддддддеддддддеддддддеддддедддддддддддд╢
Ёtsf_esp             Ё+44   Ё4     ЁD   Ё            Ё
цддддддддддддддддддддеддддддеддддддеддддедддддддддддд╢
Ёtsf_ss              Ё+48   Ё2     ЁW   Ё            Ё
цддддддддддддддддддддеддддддеддддддеддддедддддддддддд╢
Ёtsf_padss           Ё+4a   Ё2     ЁW   Ё            Ё
юддддддддддддддддддддаддддддаддддддаддддадддддддддддды
</PRE>
 
<P>
<B>KSF</B> Kernel Stack Frame 
<P>
This is what the stack frame looks like when the system is re-entered from
ring 0. This is frame used for handling exception while already in kernel
mode. 
<PRE>зддддддддддддддддддддбддддддбддддддбддддбдддддддддддд©
Ё<I>Field Name</I>          Ё<I>Offset</I>Ё<I>Length</I>Ё<I>Type</I>Ё<I>Description</I> Ё
цддддддддддддддддддддеддддддеддддддеддддедддддддддддд╢
Ёksf_edi             Ё+0    Ё4     ЁD   Ё            Ё
цддддддддддддддддддддеддддддеддддддеддддедддддддддддд╢
Ёksf_esi             Ё+4    Ё4     ЁD   Ё            Ё
цддддддддддддддддддддеддддддеддддддеддддедддддддддддд╢
Ёksf_ebp             Ё+8    Ё4     ЁD   Ё            Ё
цддддддддддддддддддддеддддддеддддддеддддедддддддддддд╢
Ёksf_padesp          Ё+c    Ё4     ЁD   Ё            Ё
цддддддддддддддддддддеддддддеддддддеддддедддддддддддд╢
Ёksf_ebx             Ё+10   Ё4     ЁD   Ё            Ё
цддддддддддддддддддддеддддддеддддддеддддедддддддддддд╢
Ёksf_edx             Ё+14   Ё4     ЁD   Ё            Ё
цддддддддддддддддддддеддддддеддддддеддддедддддддддддд╢
Ёksf_ecx             Ё+18   Ё4     ЁD   Ё            Ё
цддддддддддддддддддддеддддддеддддддеддддедддддддддддд╢
Ёksf_eax             Ё+1c   Ё4     ЁD   Ё            Ё
цддддддддддддддддддддеддддддеддддддеддддедддддддддддд╢
Ёksf_gs              Ё+20   Ё2     ЁW   Ё            Ё
цддддддддддддддддддддеддддддеддддддеддддедддддддддддд╢
Ёksf_padgs           Ё+22   Ё2     ЁW   Ё            Ё
цддддддддддддддддддддеддддддеддддддеддддедддддддддддд╢
Ёksf_fs              Ё+24   Ё2     ЁW   Ё            Ё
цддддддддддддддддддддеддддддеддддддеддддедддддддддддд╢
Ёksf_padfs           Ё+26   Ё2     ЁW   Ё            Ё
цддддддддддддддддддддеддддддеддддддеддддедддддддддддд╢
Ёksf_es              Ё+28   Ё2     ЁW   Ё            Ё
цддддддддддддддддддддеддддддеддддддеддддедддддддддддд╢
Ёksf_pades           Ё+2a   Ё2     ЁW   Ё            Ё
цддддддддддддддддддддеддддддеддддддеддддедддддддддддд╢
Ёksf_ds              Ё+2c   Ё2     ЁW   Ё            Ё
цддддддддддддддддддддеддддддеддддддеддддедддддддддддд╢
Ёksf_padds           Ё+2e   Ё2     ЁW   Ё            Ё
цддддддддддддддддддддеддддддеддддддеддддедддддддддддд╢
Ёksf_trapnum         Ё+30   Ё4     ЁD   Ё            Ё
цддддддддддддддддддддеддддддеддддддеддддедддддддддддд╢
Ёksf_errcode         Ё+34   Ё4     ЁD   Ё            Ё
цддддддддддддддддддддеддддддеддддддеддддедддддддддддд╢
Ёksf_eip             Ё+38   Ё4     ЁD   Ё            Ё
цддддддддддддддддддддеддддддеддддддеддддедддддддддддд╢
Ёksf_cs              Ё+3c   Ё2     ЁW   Ё            Ё
цддддддддддддддддддддеддддддеддддддеддддедддддддддддд╢
Ёksf_padcs           Ё+3e   Ё2     ЁW   Ё            Ё
цддддддддддддддддддддеддддддеддддддеддддедддддддддддд╢
Ёksf_eflag           Ё+40   Ё4     ЁD   Ё            Ё
юддддддддддддддддддддаддддддаддддддаддддадддддддддддды
</PRE>
 
<P>
<B>VSF</B> VDM Process Stack Frame
<P>
This is what the stack frame looks like when the system is entered from
a VDM thru a exception, software or hardware interrupt.  Most of the 8086
emulation code uses this stack frame directly for performance.  For hardware
interrupts taken in a VDM (in either V86 mode or protected mode), the interrupt
stack frame (see ISF) is adjusted to look like this frame. 
<P>
The alternate stack frame holds the real or protected mode sensitive registers
for the other mode.  So when the VDM is in protected mode, the last V86
mode segment registers and CS:EIP, SS:ESP can be accessed, etc.  Two things
happen with we mode switch:  1) the alternate register set is exchanged
with the regular set (vsf_eip to vsf_padgs is the exchanged with vsf_alteip
to vsf_altpadgs), 2) the TSS's ESP0 value is changed to the appropriate
place in the VSF structure.  For V86 mode, ESP0 points to the begining of
the segment registers (vsf_gs/vsf_padgs) and for protected mode ESP0 points
to the SS register (vsf_ss/vsf_padss).  For protected mode entry, the segments
registers are stored in vsf_ds to vsf_gs explictly.  This makes the V86
mode and protected mode stack frames the same for VDDs and the MVDM kernel
code. 
<PRE>зддддддддддддддддддддбддддддбддддддбддддбдддддддддддд©
Ё<I>Field Name</I>          Ё<I>Offset</I>Ё<I>Length</I>Ё<I>Type</I>Ё<I>Description</I> Ё
цддддддддддддддддддддеддддддеддддддеддддедддддддддддд╢
Ёvsf_edi             Ё+0    Ё4     ЁD   Ё            Ё
цддддддддддддддддддддеддддддеддддддеддддедддддддддддд╢
Ёvsf_esi             Ё+4    Ё4     ЁD   Ё            Ё
цддддддддддддддддддддеддддддеддддддеддддедддддддддддд╢
Ёvsf_ebp             Ё+8    Ё4     ЁD   Ё            Ё
цддддддддддддддддддддеддддддеддддддеддддедддддддддддд╢
Ёvsf_padesp          Ё+c    Ё4     ЁD   Ё            Ё
цддддддддддддддддддддеддддддеддддддеддддедддддддддддд╢
Ёvsf_ebx             Ё+10   Ё4     ЁD   Ё            Ё
цддддддддддддддддддддеддддддеддддддеддддедддддддддддд╢
Ёvsf_edx             Ё+14   Ё4     ЁD   Ё            Ё
цддддддддддддддддддддеддддддеддддддеддддедддддддддддд╢
Ёvsf_ecx             Ё+18   Ё4     ЁD   Ё            Ё
цддддддддддддддддддддеддддддеддддддеддддедддддддддддд╢
Ёvsf_eax             Ё+1c   Ё4     ЁD   Ё            Ё
цддддддддддддддддддддеддддддеддддддеддддедддддддддддд╢
Ёvsf_trapnum         Ё+20   Ё4     ЁD   Ё            Ё
цддддддддддддддддддддеддддддеддддддеддддедддддддддддд╢
Ёvsf_errcode         Ё+24   Ё4     ЁD   Ё            Ё
цддддддддддддддддддддеддддддеддддддеддддедддддддддддд╢
Ёvsf_eip             Ё+28   Ё4     ЁD   Ё            Ё
цддддддддддддддддддддеддддддеддддддеддддедддддддддддд╢
Ёvsf_cs              Ё+2c   Ё2     ЁW   Ё            Ё
цддддддддддддддддддддеддддддеддддддеддддедддддддддддд╢
Ёvsf_padcs           Ё+2e   Ё2     ЁW   Ё            Ё
цддддддддддддддддддддеддддддеддддддеддддедддддддддддд╢
Ёvsf_eflag           Ё+30   Ё4     ЁD   Ё            Ё
цддддддддддддддддддддеддддддеддддддеддддедддддддддддд╢
Ёvsf_esp             Ё+34   Ё4     ЁD   Ё            Ё
цддддддддддддддддддддеддддддеддддддеддддедддддддддддд╢
Ёvsf_ss              Ё+38   Ё2     ЁW   Ё            Ё
цддддддддддддддддддддеддддддеддддддеддддедддддддддддд╢
Ёvsf_padss           Ё+3a   Ё2     ЁW   Ё            Ё
цддддддддддддддддддддеддддддеддддддеддддедддддддддддд╢
Ёvsf_es              Ё+3c   Ё2     ЁW   Ё            Ё
цддддддддддддддддддддеддддддеддддддеддддедддддддддддд╢
Ёvsf_pades           Ё+3e   Ё2     ЁW   Ё            Ё
цддддддддддддддддддддеддддддеддддддеддддедддддддддддд╢
Ёvsf_ds              Ё+40   Ё2     ЁW   Ё            Ё
цддддддддддддддддддддеддддддеддддддеддддедддддддддддд╢
Ёvsf_padds           Ё+42   Ё2     ЁW   Ё            Ё
цддддддддддддддддддддеддддддеддддддеддддедддддддддддд╢
Ёvsf_fs              Ё+44   Ё2     ЁW   Ё            Ё
цддддддддддддддддддддеддддддеддддддеддддедддддддддддд╢
Ёvsf_padfs           Ё+46   Ё2     ЁW   Ё            Ё
цддддддддддддддддддддеддддддеддддддеддддедддддддддддд╢
Ёvsf_gs              Ё+48   Ё2     ЁW   Ё            Ё
цддддддддддддддддддддеддддддеддддддеддддедддддддддддд╢
Ёvsf_padgs           Ё+4a   Ё2     ЁW   Ё            Ё
цддддддддддддддддддддеддддддеддддддеддддедддддддддддд╢
Ёvsf_alteip          Ё+4c   Ё4     ЁD   Ё            Ё
цддддддддддддддддддддеддддддеддддддеддддедддддддддддд╢
Ёvsf_altcs           Ё+50   Ё2     ЁW   Ё            Ё
цддддддддддддддддддддеддддддеддддддеддддедддддддддддд╢
Ёvsf_altpadcs        Ё+52   Ё2     ЁW   Ё            Ё
цддддддддддддддддддддеддддддеддддддеддддедддддддддддд╢
Ёvsf_alteflag        Ё+54   Ё4     ЁD   Ё            Ё
цддддддддддддддддддддеддддддеддддддеддддедддддддддддд╢
Ёvsf_altesp          Ё+58   Ё4     ЁD   Ё            Ё
цддддддддддддддддддддеддддддеддддддеддддедддддддддддд╢
Ёvsf_altss           Ё+5c   Ё2     ЁW   Ё            Ё
цддддддддддддддддддддеддддддеддддддеддддедддддддддддд╢
Ёvsf_altpadss        Ё+5e   Ё2     ЁW   Ё            Ё
цддддддддддддддддддддеддддддеддддддеддддедддддддддддд╢
Ёvsf_altes           Ё+60   Ё2     ЁW   Ё            Ё
цддддддддддддддддддддеддддддеддддддеддддедддддддддддд╢
Ёvsf_altpades        Ё+62   Ё2     ЁW   Ё            Ё
цддддддддддддддддддддеддддддеддддддеддддедддддддддддд╢
Ёvsf_altds           Ё+64   Ё2     ЁW   Ё            Ё
цддддддддддддддддддддеддддддеддддддеддддедддддддддддд╢
Ёvsf_altpadds        Ё+66   Ё2     ЁW   Ё            Ё
цддддддддддддддддддддеддддддеддддддеддддедддддддддддд╢
Ёvsf_altfs           Ё+68   Ё2     ЁW   Ё            Ё
цддддддддддддддддддддеддддддеддддддеддддедддддддддддд╢
Ёvsf_altpadfs        Ё+6a   Ё2     ЁW   Ё            Ё
цддддддддддддддддддддеддддддеддддддеддддедддддддддддд╢
Ёvsf_altgs           Ё+6c   Ё2     ЁW   Ё            Ё
цддддддддддддддддддддеддддддеддддддеддддедддддддддддд╢
Ёvsf_altpadgs        Ё+6e   Ё2     ЁW   Ё            Ё
юддддддддддддддддддддаддддддаддддддаддддадддддддддддды
</PRE>
 
<P>
<B>SEF</B> System Entry Stack Frame 
<P>
This is the frame put on the by the call gate system entry function (KMEnterKmodeCallGate
or KMEnterKmodeAPI32). 
<P>
This frame is used for:<!-- lm: 0x2 3 -->
<UL>
<P>
<LI><!-- lm: 0x2 6 --><!-- entering slot 3472 -->32-bit C APIs, with C callable
workers (criSEF)<!-- lm: 0x2 3 -->
<P>
<LI><!-- lm: 0x2 6 -->16-bit PASCAL APIs, with C callable workers  (criPASCALSEF)
<!-- lm: 0x2 1 -->
</UL> 
<PRE>зддддддддддддддддддддбддддддбддддддбддддбдддддддддддд©Ё<I>Field Name</I>          Ё<I>Offset</I>Ё<I>Length</I>Ё<I>Type</I>Ё<I>Description</I> Ё
цддддддддддддддддддддеддддддеддддддеддддедддддддддддд╢
Ёsef_edi             Ё+0    Ё4     ЁD   Ё            Ё
цддддддддддддддддддддеддддддеддддддеддддедддддддддддд╢
Ёsef_esi             Ё+4    Ё4     ЁD   Ё            Ё
цддддддддддддддддддддеддддддеддддддеддддедддддддддддд╢
Ёsef_ebp             Ё+8    Ё4     ЁD   Ё            Ё
цддддддддддддддддддддеддддддеддддддеддддедддддддддддд╢
Ёsef_padesp          Ё+c    Ё4     ЁD   Ё            Ё
цддддддддддддддддддддеддддддеддддддеддддедддддддддддд╢
Ёsef_ebx             Ё+10   Ё4     ЁD   Ё            Ё
цддддддддддддддддддддеддддддеддддддеддддедддддддддддд╢
Ёsef_edx             Ё+14   Ё4     ЁD   Ё            Ё
цддддддддддддддддддддеддддддеддддддеддддедддддддддддд╢
Ёsef_ecx             Ё+18   Ё4     ЁD   Ё            Ё
цддддддддддддддддддддеддддддеддддддеддддедддддддддддд╢
Ёsef_eax             Ё+1c   Ё4     ЁD   Ё            Ё
цддддддддддддддддддддеддддддеддддддеддддедддддддддддд╢
Ёsef_gs              Ё+20   Ё2     ЁW   Ё            Ё
цддддддддддддддддддддеддддддеддддддеддддедддддддддддд╢
Ёsef_padgs           Ё+22   Ё2     ЁW   Ё            Ё
цддддддддддддддддддддеддддддеддддддеддддедддддддддддд╢
Ёsef_fs              Ё+24   Ё2     ЁW   Ё            Ё
цддддддддддддддддддддеддддддеддддддеддддедддддддддддд╢
Ёsef_padfs           Ё+26   Ё2     ЁW   Ё            Ё
цддддддддддддддддддддеддддддеддддддеддддедддддддддддд╢
Ёsef_es              Ё+28   Ё2     ЁW   Ё            Ё
цддддддддддддддддддддеддддддеддддддеддддедддддддддддд╢
Ёsef_pades           Ё+2a   Ё2     ЁW   Ё            Ё
цддддддддддддддддддддеддддддеддддддеддддедддддддддддд╢
Ёsef_ds              Ё+2c   Ё2     ЁW   Ё            Ё
цддддддддддддддддддддеддддддеддддддеддддедддддддддддд╢
Ёsef_padds           Ё+2e   Ё2     ЁW   Ё            Ё
цддддддддддддддддддддеддддддеддддддеддддедддддддддддд╢
Ёsef_retaddr         Ё+30   Ё4     ЁD   Ё            Ё
цддддддддддддддддддддеддддддеддддддеддддедддддддддддд╢
Ёsef_cbargs          Ё+34   Ё4     ЁD   Ё            Ё
цддддддддддддддддддддеддддддеддддддеддддедддддддддддд╢
Ёsef_eflag           Ё+38   Ё4     ЁD   Ё            Ё
цддддддддддддддддддддеддддддеддддддеддддедддддддддддд╢
Ёsef_eip             Ё+3c   Ё4     ЁD   Ё            Ё
цддддддддддддддддддддеддддддеддддддеддддедддддддддддд╢
Ёsef_cs              Ё+40   Ё2     ЁW   Ё            Ё
цддддддддддддддддддддеддддддеддддддеддддедддддддддддд╢
Ёsef_padcs           Ё+42   Ё2     ЁW   Ё            Ё
юддддддддддддддддддддаддддддаддддддаддддадддддддддддды
</PRE>
 
<P>
<B>SCI</B> System Call Interpreter Call Gate Stack Frame 
<P>
This is what the stack frame looks like when the system is entered thru
SCI via call gate using the KMEnterKmodeSCI function. 
<PRE>зддддддддддддддддддддбддддддбддддддбддддбдддддддддддддддддддддддддддддддддддддддд©
Ё<I>Field Name</I>          Ё<I>Offset</I>Ё<I>Length</I>Ё<I>Type</I>Ё<I>Description</I>                             Ё
цддддддддддддддддддддеддддддеддддддеддддедддддддддддддддддддддддддддддддддддддддд╢
Ёssf_edi             Ё+0    Ё4     ЁD   Ё                                        Ё
цддддддддддддддддддддеддддддеддддддеддддедддддддддддддддддддддддддддддддддддддддд╢
Ёssf_esi             Ё+4    Ё4     ЁD   Ё                                        Ё
цддддддддддддддддддддеддддддеддддддеддддедддддддддддддддддддддддддддддддддддддддд╢
Ёssf_ebp             Ё+8    Ё4     ЁD   Ё                                        Ё
цддддддддддддддддддддеддддддеддддддеддддедддддддддддддддддддддддддддддддддддддддд╢
Ёssf_padesp          Ё+c    Ё4     ЁD   Ё                                        Ё
цддддддддддддддддддддеддддддеддддддеддддедддддддддддддддддддддддддддддддддддддддд╢
Ёssf_ebx             Ё+10   Ё4     ЁD   Ё                                        Ё
цддддддддддддддддддддеддддддеддддддеддддедддддддддддддддддддддддддддддддддддддддд╢
Ёssf_edx             Ё+14   Ё4     ЁD   Ё                                        Ё
цддддддддддддддддддддеддддддеддддддеддддедддддддддддддддддддддддддддддддддддддддд╢
Ёssf_ecx             Ё+18   Ё4     ЁD   Ё                                        Ё
цддддддддддддддддддддеддддддеддддддеддддедддддддддддддддддддддддддддддддддддддддд╢
Ёssf_eax             Ё+1c   Ё4     ЁD   Ё                                        Ё
цддддддддддддддддддддеддддддеддддддеддддедддддддддддддддддддддддддддддддддддддддд╢
Ёssf_gs              Ё+20   Ё2     ЁW   Ё                                        Ё
цддддддддддддддддддддеддддддеддддддеддддедддддддддддддддддддддддддддддддддддддддд╢
Ёssf_padgs           Ё+22   Ё2     ЁW   Ё                                        Ё
цддддддддддддддддддддеддддддеддддддеддддедддддддддддддддддддддддддддддддддддддддд╢
Ёssf_fs              Ё+24   Ё2     ЁW   Ё                                        Ё
цддддддддддддддддддддеддддддеддддддеддддедддддддддддддддддддддддддддддддддддддддд╢
Ёssf_padfs           Ё+26   Ё2     ЁW   Ё                                        Ё
цддддддддддддддддддддеддддддеддддддеддддедддддддддддддддддддддддддддддддддддддддд╢
Ёssf_es              Ё+28   Ё2     ЁW   Ё                                        Ё
цддддддддддддддддддддеддддддеддддддеддддедддддддддддддддддддддддддддддддддддддддд╢
Ёssf_pades           Ё+2a   Ё2     ЁW   Ё                                        Ё
цддддддддддддддддддддеддддддеддддддеддддедддддддддддддддддддддддддддддддддддддддд╢
Ёssf_ds              Ё+2c   Ё2     ЁW   Ё                                        Ё
цддддддддддддддддддддеддддддеддддддеддддедддддддддддддддддддддддддддддддддддддддд╢
Ёssf_padds           Ё+2e   Ё2     ЁW   Ё                                        Ё
цддддддддддддддддддддеддддддеддддддеддддедддддддддддддддддддддддддддддддддддддддд╢
Ёssf_thopadr         Ё+30   Ё4     ЁD   Ё                                        Ё
цддддддддддддддддддддеддддддеддддддеддддедддддддддддддддддддддддддддддддддддддддд╢
Ёssf_cbargs          Ё+34   Ё4     ЁD   ЁThe Most Significant Bit of cbargs in anЁ
Ё                    Ё      Ё      Ё    ЁSCI stack frame is used to denote that aЁ
Ё                    Ё      Ё      Ё    Ё16 bit callgate is being used with the  Ё
Ё                    Ё      Ё      Ё    ЁSCI mechanism. Used by Dynamic API's.   Ё
цддддддддддддддддддддеддддддеддддддеддддедддддддддддддддддддддддддддддддддддддддд╢
Ёssf_sciret          Ё+38   Ё2     ЁW   Ё                                        Ё
цддддддддддддддддддддеддддддеддддддеддддедддддддддддддддддддддддддддддддддддддддд╢
Ёssf_eflag           Ё+3a   Ё4     ЁD   Ё                                        Ё
цддддддддддддддддддддеддддддеддддддеддддедддддддддддддддддддддддддддддддддддддддд╢
Ёssf_eip             Ё+3e   Ё4     ЁD   Ё                                        Ё
цддддддддддддддддддддеддддддеддддддеддддедддддддддддддддддддддддддддддддддддддддд╢
Ёssf_cs              Ё+42   Ё2     ЁW   Ё                                        Ё
цддддддддддддддддддддеддддддеддддддеддддедддддддддддддддддддддддддддддддддддддддд╢
Ёssf_padcs           Ё+42   Ё2     ЁW   Ё                                        Ё
юддддддддддддддддддддаддддддаддддддаддддадддддддддддддддддддддддддддддддддддддддды
</PRE>
 
<P>
<B>DHF</B> Device Help Stack Frame 
<PRE>зддддддддддддддддддддбддддддбддддддбддддбдддддддддддд©
Ё<I>Field Name</I>          Ё<I>Offset</I>Ё<I>Length</I>Ё<I>Type</I>Ё<I>Description</I> Ё
цддддддддддддддддддддеддддддеддддддеддддедддддддддддд╢
Ёdhf_edi             Ё+0    Ё4     ЁD   Ё            Ё
цддддддддддддддддддддеддддддеддддддеддддедддддддддддд╢
Ёdhf_esi             Ё+4    Ё4     ЁD   Ё            Ё
цддддддддддддддддддддеддддддеддддддеддддедддддддддддд╢
Ёdhf_ebp             Ё+8    Ё4     ЁD   Ё            Ё
цддддддддддддддддддддеддддддеддддддеддддедддддддддддд╢
Ёdhf_padesp          Ё+c    Ё4     ЁD   Ё            Ё
цддддддддддддддддддддеддддддеддддддеддддедддддддддддд╢
Ёdhf_ebx             Ё+10   Ё4     ЁD   Ё            Ё
цддддддддддддддддддддеддддддеддддддеддддедддддддддддд╢
Ёdhf_edx             Ё+14   Ё4     ЁD   Ё            Ё
цддддддддддддддддддддеддддддеддддддеддддедддддддддддд╢
Ёdhf_ecx             Ё+18   Ё4     ЁD   Ё            Ё
цддддддддддддддддддддеддддддеддддддеддддедддддддддддд╢
Ёdhf_eax             Ё+1c   Ё4     ЁD   Ё            Ё
цддддддддддддддддддддеддддддеддддддеддддедддддддддддд╢
Ёdhf_gs              Ё+20   Ё2     ЁW   Ё            Ё
цддддддддддддддддддддеддддддеддддддеддддедддддддддддд╢
Ёdhf_padgs           Ё+22   Ё2     ЁW   Ё            Ё
цддддддддддддддддддддеддддддеддддддеддддедддддддддддд╢
Ёdhf_fs              Ё+24   Ё2     ЁW   Ё            Ё
цддддддддддддддддддддеддддддеддддддеддддедддддддддддд╢
Ёdhf_padfs           Ё+26   Ё2     ЁW   Ё            Ё
цддддддддддддддддддддеддддддеддддддеддддедддддддддддд╢
Ёdhf_es              Ё+28   Ё2     ЁW   Ё            Ё
цддддддддддддддддддддеддддддеддддддеддддедддддддддддд╢
Ёdhf_pades           Ё+2a   Ё2     ЁW   Ё            Ё
цддддддддддддддддддддеддддддеддддддеддддедддддддддддд╢
Ёdhf_ds              Ё+2c   Ё2     ЁW   Ё            Ё
цддддддддддддддддддддеддддддеддддддеддддедддддддддддд╢
Ёdhf_padds           Ё+2e   Ё2     ЁW   Ё            Ё
цддддддддддддддддддддеддддддеддддддеддддедддддддддддд╢
Ёdhf_eflag           Ё+30   Ё4     ЁD   Ё            Ё
цддддддддддддддддддддеддддддеддддддеддддедддддддддддд╢
Ёdhf_scratch         Ё+34   Ё4     ЁD   Ё            Ё
цддддддддддддддддддддеддддддеддддддеддддедддддддддддд╢
Ёdhf_eip             Ё+38   Ё4     ЁD   Ё            Ё
цддддддддддддддддддддеддддддеддддддеддддедддддддддддд╢
Ёdhf_cs              Ё+3c   Ё2     ЁW   Ё            Ё
цддддддддддддддддддддеддддддеддддддеддддедддддддддддд╢
Ёdhf_padcs           Ё+3e   Ё4     ЁD   Ё            Ё
юддддддддддддддддддддаддддддаддддддаддддадддддддддддды
</PRE>
 
<P>
<B>TF</B> Hardware Exception Trap Stack Frame 
<P>
Stack frame for the trap manager before we go into kernel mode. 
<PRE>зддддддддддддддддддддбддддддбддддддбддддбдддддддддддд©
Ё<I>Field Name</I>          Ё<I>Offset</I>Ё<I>Length</I>Ё<I>Type</I>Ё<I>Description</I> Ё
цддддддддддддддддддддеддддддеддддддеддддедддддддддддд╢
Ёtf_trapnum          Ё+0    Ё4     ЁD   Ё            Ё
цддддддддддддддддддддеддддддеддддддеддддедддддддддддд╢
Ёtf_errcode          Ё+4    Ё4     ЁD   Ё            Ё
цддддддддддддддддддддеддддддеддддддеддддедддддддддддд╢
Ёtf_eip              Ё+8    Ё4     ЁD   Ё            Ё
цддддддддддддддддддддеддддддеддддддеддддедддддддддддд╢
Ёtf_cs               Ё+c    Ё2     ЁW   Ё            Ё
цддддддддддддддддддддеддддддеддддддеддддедддддддддддд╢
Ёtf_padcs            Ё+e    Ё2     ЁW   Ё            Ё
цддддддддддддддддддддеддддддеддддддеддддедддддддддддд╢
Ёtf_eflags           Ё+10   Ё4     ЁD   Ё            Ё
цддддддддддддддддддддеддддддеддддддеддддедддддддддддд╢
Ёtf_esp              Ё+14   Ё4     ЁD   Ё            Ё
цддддддддддддддддддддеддддддеддддддеддддедддддддддддд╢
Ёtf_ss               Ё+18   Ё2     ЁW   Ё            Ё
цддддддддддддддддддддеддддддеддддддеддддедддддддддддд╢
Ёtf_padss            Ё+1a   Ё2     ЁW   Ё            Ё
юддддддддддддддддддддаддддддаддддддаддддадддддддддддды
</PRE>


<P><HR>

<A HREF="3192_L3_ThreadInformationBlo.html">[Back: Thread Information Block]</A> <BR>
<A HREF="3194_L3_ExitListEntryDataStr.html">[Next: Exit List Entry Data Structure]</A> 
</BODY>
</HTML>
