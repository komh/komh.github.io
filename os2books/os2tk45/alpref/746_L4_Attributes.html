<HTML>
<HEAD>
<TITLE>Attributes</TITLE>
</HEAD>
<BODY>
<H1>Attributes</H1><!-- entering slot 751 -->
<P>
The optional fields in the<I> Attributes</I> argument control how the procedure
is defined.<!-- lm: 0x2 1 -->
<UL>
<P>
<B>Syntax</B><!-- lm: 0x2 11 -->
<UL>
<P>

<PRE>[<I>Distance</I>] [<I>Language</I>] [<I>Visibility</I>]
</PRE>
<!-- lm: 0x2 1 -->
</UL><B>Remarks</B><!-- lm: 0x2 11 -->
<UL>
<P>
The various<I> Attribute</I> fields are defined as follows:<!-- lm: 0x2 11 -->
<P>
<B><I>Distance</B></I><!-- lm: 0x12 28 -->
<UL> Determines the type of<B> CALL
</B>instruction that should be used to invoke the procedure, and the type
of<B> RET</B> instruction generated by the assembler.  The default is<B> NEAR
</B>if no <A HREF="784_L3_MODELDefineProgramMe.html">.MODEL</A> directive
has been specified, or if the model has been set to<B> TINY</B>,<B> SMALL</B>,
<B>COMPACT</B>, or<B> FLAT</B>.  The default is<B> FAR</B> if the model
has been set to<B> LARGE</B>,<B> MEDIUM</B>, or<B> HUGE</B>.  If the programmer
is using segments with mixed address sizes (<B>USE16</B> and<B> USE32</B>)
on a 32-bit processor, then the<B> NEAR16</B>,<B> FAR16</B>,<B> NEAR32</B>,
and<B> FAR32</B> keywords may also be used.<!-- lm: 0x2 11 -->
</UL><B><I> Language
</B></I><!-- lm: 0x12 28 -->
<UL>Determines the calling convention used
by the procedure, and the naming convention used when writing the procedure
name to the object file.  The calling convention defines the layout of the
stack frame upon entry to the procedure and how the stack frame is destroyed
upon procedure exit.  See the section on <A HREF="169_L4_LabelName.html"><I>LabelName</I></A><I>s
</I>for more information on language naming conventions.
<P>
With the<B> BASIC</B>,<B> FORTRAN</B>, and<B> PASCAL</B> calling conventions,
the called procedure expects arguments to be pushed on the stack from left
to right, causing the rightmost parameter to be at the lowest stack address
and closest in proximity to the<I> frame pointer</I> (the BP or EBP register).
 With this arrangement, the called procedure always knows the exact amount
of stack space used by the parameters, and is responsible for removing them
from the stack with a<B> RET</B><B><I> Constant</B></I> instruction when
the procedure exits.  Such procedures are unable to accept a variable number
of arguments.
<P>
With the<B> C</B>,<B> STDCALL</B>,<B> SYSCALL</B>, and<B> OPTLINK</B> calling
conventions, the called procedure expects arguments to be pushed on the
stack from right to left, causing the leftmost parameter to be at the lowest
stack address and closest in proximity to the<I> frame pointer</I> (the
BP or EBP register).  With this arrangement, the calling procedure is free
to push additional arguments on the stack, and is responsible for restoring
the stack after the called procedure returns (<B>STDCALL</B> requires the
called procedure to restore the stack if a fixed number of arguments is
being passed).
<P>
With the<B> OPTLINK</B> 32-bit calling convention (as defined by the IBM
VisualAge C/C++ Compiler environment), up to three parameters will be passed
in machine registers to the called procedure, provided they not larger than
a DWORD in size.  The EAX, EDX, and ECX registers (respectively) are used
for this purpose.  Stack space for the parameters is still allocated, but
the parameter values are not actually copied onto the stack.  Refer to the
documentation for the IBM VisualAge C++ compiler for more information on
the<B> OPTLINK</B> calling convention.<!-- lm: 0x2 11 -->
</UL><B><I> Visibility
</B></I><!-- lm: 0x12 28 -->
<UL>Determines if the procedure name is written
to the object file as a global identifier, allowing it to be referenced
by other modules.  The allowable values are<B> PRIVATE</B>,<B> PUBLIC</B>,
and<B> EXPORT</B>.  If operating in <A HREF="111_L5_SvSetVersionBehavior.html">M510
</A>mode and no <A HREF="784_L3_MODELDefineProgramMe.html">.MODEL</A> directive
with a <A HREF="137_L3_LanguageNames.html"><I>Language-Name</I></A> has
been specified, then the default visibility is<B> PRIVATE</B>.  In all other
situations, the default visibility is<B> PUBLIC</B> unless the default has
been overridden by an <A HREF="802_L3_OPTIONModifyDefaultB.html">OPTION
LANGUAGE</A> directive.
<P>
When the<B> PRIVATE</B> keyword is used, the procedure name is visible only
within the defining module at assembly-time.  When the visibility is<B> PUBLIC</B>,
the procedure name is made visible to other modules at link-time.  The same
is true of<B> EXPORT</B> visibility, but in this case the assembler<!-- entering slot 752 --> emits
a special record into the object file that causes the linker to also make
the symbol visible as an exported entry point in the executable module,
allowing it be called by other modules at program run-time.<!-- lm: 0x2 11 --><!-- lm: 0x2 1 -->
</UL>

<P><HR>

<A HREF="745_L3_PROCIdentifyCodeProc.html">[Back: PROC (Identify Code Procedure)]</A> <BR>
<A HREF="747_L4_RegisterList.html">[Next: Register List]</A> 
</BODY>
</HTML>
