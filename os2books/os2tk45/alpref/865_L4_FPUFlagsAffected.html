<HTML>
<HEAD>
<TITLE>FPU Flags Affected</TITLE>
</HEAD>
<BODY>
<H1>FPU Flags Affected</H1><!-- entering slot 879 -->
<P>
The floating-point instruction pages have a section called "FPU Flags Affected,"
which tells how each instruction can affect the four condition code bits
of the FPU status word. These pages contain a condition code information
table similar to the following:
<PRE>ÚÄÄÂÄÄÂÄÄÂÄÄ¿
³C0³C1³C2³C3³
ÃÄÄÅÄÄÅÄÄÅÄÄ´
³? ³* ³? ³? ³
ÀÄÄÁÄÄÁÄÄÁÄÄÙ
</PRE>

<P>
The first row of the table lists the names of the floating-point condition
code flags.  The entries in the second row are filled in according to how
the flag is affected by the instruction:
<PRE>ÚÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
³VALUE   ³MEANING                         ³
ÃÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
³&lt;blank&gt; ³Instruction does not affect flag³
ÃÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
³0       ³Instruction clears the flag     ³
ÃÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
³1       ³Instruction sets the flag       ³
ÃÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
³?       ³Instruction's effect on the flag³
³        ³is undefined                    ³
ÃÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
³*       ³Instruction modifies the flag   ³
³        ³(either sets or clears depending³
³        ³on operands)                    ³
ÀÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ
</PRE>

<P>
The four FPU condition code bits (C0, C1, C2, and C3) are similar to the
flags in a CPU; the processor updates these bits to reflect the outcome
of arithmetic operations.  The effect of these instructions on the condition
code bits is summarized in the following table:
<P>
<B>Condition Code Interpretation</B> ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄ¿
<BR>
³ INSTRUCTION       ³    C0   ³   C3   ³   C2   ³   C1   ³
<BR>
ÃÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄ´
<BR>
³ FCOM, FCOMP, FCOMPP,   ³  Result of Comparison  ³ Operands  ³ Zero or
  ³
<BR>
³ FTST, FUCOMPP, FICOM,  ³              ³ is not   ³ O/U#    ³
<BR>
³ FICOMP          ³              ³ Comparable ³       ³
<BR>
ÃÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄ´
<BR>
³ FXAM           ³       Operand class       ³ Sign or   ³
<BR>
³             ³                    ³ O/U#    ³
<BR>
ÃÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄ´
<BR>
³ FPREM, FPREM1      ³    Q2   ³   Q1   ³ 0=reduction³ Q0 or O/U# ³
<BR>
³             ³       ³       ³  complete  ³       ³
<BR>
³             ³       ³       ³       ³       ³
<BR>
³             ³       ³       ³ 1=reduction³       ³
<BR>
³             ³       ³       ³ incomplete ³       ³
<BR>
ÃÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄ´
<BR>
³ FIST, FBSTP, FRINDINT,  ³        UNDEFINED        ³ Roundup or ³
<BR>
³ FST, FSTP, FADD, FMUL,  ³                    ³ O/U#    ³
<BR>
³ FDIV, FDIVR, FSUB,    ³                    ³       ³
<BR>
³ FSUBR, FSCALE, FSQRT,  ³                    ³       ³
<BR>
³ FPATAN, F2XM1, FYL2X,  ³                    ³       ³
<BR>
³ FYL2XP1         ³                    ³       ³
<BR>
ÃÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄ´
<BR>
³ FPTAN, FSIN, FCOS,    ³     UNDEFINED     ³ 0=reduction³ Roundup or ³

<BR>
³ FSINCOS         ³              ³ complete  ³ O/U#    ³
<BR>
³             ³              ³       ³ (UNDEFINED ³
<BR>
³             ³              ³ 1=reduction³ if C2=1)  ³
<BR>
³             ³              ³ incomplete ³       ³
<BR>
ÃÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄ´
<BR>
³ FCHS, FABS, FXCH,    ³        UNDEFINED        ³ Zero or   ³
<BR>
³ FINCSTP, FDECSTP, Con-  ³                    ³ O/U#    ³
<BR>
³ stant Loads, FXTRACT,  ³                    ³       ³
<BR>
³ FLD, FILD, FBLD, FSTP  ³                    ³       ³
<BR>
³ (ext. real)       ³                    ³       ³
<BR>
ÃÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄ´
<BR>
³ FLDENV, FRSTOR      ³       Each bit loaded from memory       ³
<BR>
ÃÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
<BR>
³ FLDCW, FSTENV, FSTCW,  ³            UNDEFINED           ³
<BR>
³ FSTSW, FCLEX       ³                           ³
<BR>
ÃÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄ´
<BR>
³ FINIT, FSAVE       ³   Zero   ³   Zero   ³   Zero   ³   Zero   ³
<BR>
ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÙ
<BR>

<P>
<B>NOTES:</B><!-- lm: 0x2 1 -->
<UL>
<P>
<B>O/U#</B><!-- lm: 0x2 15 -->
<UL> When both IE and SF bits of status word
are set, this bit distinguishes between stack overflow (C1=1) and underflow
(C1=0).<!-- lm: 0x2 1 -->
</UL><B> Reduction</B><!-- lm: 0x2 15 -->
<UL> If
FPREM and FPREM1 produces a remainder that is less than the modulus, reduction
is complete.  When reduction is incomplete the value at the top of the stack
is a parial remainder, which can be used as input to further reduction.
 For FPTAN, FSIN, FCOS and FSINCOS, the reduction bit is set if the operand
at the top of the stack is too large.  In this case, the original operand
remains at the top of the stack.<!-- lm: 0x2 1 -->
</UL><B> Roundup</B><!-- lm: 0x2 15 -->
<UL> When
the PE bit of the status word is set, this bit indicates whether the last
rounding in the instruction<!-- entering slot 880 --> was upward.<!-- lm: 0x2 1 -->
</UL><B> UNDEFINED
</B><!-- lm: 0x2 15 -->
<UL>Do not rely on any specific value in these bits.
<!-- lm: 0x2 1 -->
</UL>
<P>
The condition code bits are used primarily for conditional branching.  The
FSTSW AX instruction stores the FPU status word directly into the AX register,
allowing these condition codes to be inspected efficiently.  The SAHF instruction
can copy C3 - C0 directly to the CPU's flag bits to simplify conditional
branching.  The following table shows the mapping of these bits to the CPU
flag bits.
<PRE>ÚÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄ¿³FPU FLAG    ³IU FLAG     ³
ÃÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄ´
³C0          ³CF          ³
ÃÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄ´
³C1          ³(None)      ³
ÃÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄ´
³C2          ³PF          ³
ÃÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄ´
³C3          ³ZF          ³
ÀÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÙ
</PRE>


<P><HR>

<A HREF="864_L4_FlagsAffected.html">[Back: Flags Affected]</A> <BR>
<A HREF="866_L4_NumericExceptions.html">[Next: Numeric Exceptions]</A> 
</BODY>
</HTML>
