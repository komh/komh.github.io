<HTML>
<HEAD>
<META HTTP-EQUIV="CONTENT-TYPE" CONTENT="TEXT/HTML; CHARSET=UTF-8">
<TITLE>Connection Level 1</TITLE>
<STYLE>
PRE {
  FONT-FAMILY: Consolas, "Lucida Console", "Courier New", Courier, MONOSPACE;
}
</STYLE>
</HEAD>
<BODY>
<H1>Connection Level 1</H1><!-- entering slot 181 -->
<PRE> 
struct connection_info_1 {
  unsigned short                 coni1_id;
  unsigned short                 coni1_type;
  unsigned short                 coni1_num_opens;
  unsigned short                 coni1_num_users;
  unsigned long                  coni1_time;
  unsigned char LSFAR * LSPTR    coni1_username;
  unsigned char LSFAR * LSPTR    coni1_netname;
};
</PRE>

<P>
where:<!-- lm: 0x2 3 -->
<UL>
<P>
<LI><!-- lm: 0x2 6 -->The first field in this data structure is identical
to that in the previous level.<!-- lm: 0x2 3 -->
<P>
<LI><!-- lm: 0x2 6 --><I>coni1_type</I> indicates the type of connection
made from the local device name to the shared resource. The SHARES.H header
file defines the following types of connection: ┌──────────────────────┬───────┬───────────────────────────────────────────────┐
<BR>
│ SYMBOLIC CONSTANT   │ VALUE │ MEANING                    │
<BR>
├──────────────────────┼───────┼───────────────────────────────────────────────┤
<BR>
│ STYPE_DISKTREE    │ 0   │ Disk connection                │
<BR>
├──────────────────────┼───────┼───────────────────────────────────────────────┤
<BR>
│ STYPE_PRINTQ     │ 1   │ Spooler queue connection            │
<BR>
├──────────────────────┼───────┼───────────────────────────────────────────────┤
<BR>
│ STYPE_DEVICE     │ 2   │ Serial device connection            │
<BR>
├──────────────────────┼───────┼───────────────────────────────────────────────┤
<BR>
│ STYPE_IPC       │ 3   │ Interprocess communication (IPC) connection  │

<BR>
└──────────────────────┴───────┴───────────────────────────────────────────────┘
<BR>
<!-- lm: 0x2 3 -->
<P>
<LI><!-- lm: 0x2 6 --><I>coni1_num_opens</I> indicates the number of files
that currently are open as a result of the connection.<!-- lm: 0x2 3 -->
<P>
<LI><!-- lm: 0x2 6 --><I>coni1_num_users</I> indicates the number of users
on the connection.<!-- lm: 0x2 3 -->
<P>
<LI><!-- lm: 0x2 6 --><I>coni1_time</I> indicates the number of seconds
the connection has been established.<!-- lm: 0x2 3 -->
<P>
<LI><!-- lm: 0x2 6 --><I>coni1_username</I> points to an ASCIIZ string indicating
the user that made the connection.<!-- lm: 0x2 3 -->
<P>
<LI><!-- lm: 0x2 6 --><I>coni1_netname</I> points to an ASCIIZ string indicating
(1) the netname of the shared resource of the server, or (2) the computer
name of the requester, depending on which name was specified as the<I> qualifier
</I>parameter of the NetConnectionEnum API. The type of name supplied to
<I>coni1_netname</I> is the inverse of the type supplied to the<I> qualifier
</I>parameter.<!-- lm: 0x2 1 -->
</UL>

<P><HR>

<A HREF="144_L3_ConnectionLevel0.html">[Back: Connection Level 0]</A> <BR>
<A HREF="146_L3_RelatedInformation.html">[Next: Related Information]</A> 
</BODY>
</HTML>
