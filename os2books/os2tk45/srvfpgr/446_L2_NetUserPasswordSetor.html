<HTML>
<HEAD>
<META HTTP-EQUIV="CONTENT-TYPE" CONTENT="TEXT/HTML; CHARSET=UTF-8">
<TITLE>NetUserPasswordSet or Net32UserPasswordSet</TITLE>
</HEAD>
<BODY>
<H1>NetUserPasswordSet or Net32UserPasswordSet</H1><!-- entering slot 587 -->NetUserPasswordSet or Net32UserPasswordSet
<P>
The NetUserPasswordSet API changes a user's password.<!-- lm: 0x2 1 -->
<UL>
<P>
Restrictions
<P>
<!-- lm: 0x2 10 -->
<UL><B>LAN Server and OS/2 Warp Server Only</B>
<P>
This API can be called from DLS and OS/2 workstations, but only DLS workstations
can issue this call to a remote LAN Server workstation.  DLS workstations
can issue this call locally only if the Peer service is started. This API
does not have any access authority requirements.<!-- lm: 0x2 1 -->
</UL> Syntax

<P>
<!-- lm: 0x2 10 -->
<UL>
<PRE>#include &lt;netcons.h&gt;
#include &lt;access.h&gt;
#include &lt;lsdeerr.h&gt;    /* DSS only */
 
NetUserPasswordSet(<I>pszTarget</I>, <I>pszUserID</I>,
                   <I>pszOldPassword</I>, <I>pszNewPassword</I>);      /* 16 bit */
 
Net32UserPasswordSet(<I>pszTarget</I>, <I>pszUserID</I>,
                   <I>pszOldPassword</I>, <I>pszNewPassword</I>, <I>pStatusbuf</I>);  /* 32 bit */
</PRE>
<!-- lm: 0x2 1 -->
</UL>Parameters
<P>
<!-- lm: 0x2 10 -->
<UL>
<P>
See <A HREF="021_L2_CommonParameterDefin.html">Common Parameter Definitions
</A>for descriptions of parameters not defined here.<!-- lm: 0x2 10 -->
<P>
<I>pszOldPassword</I><!-- lm: 0x12 20 -->
<UL> (unsigned char LSFAR *) points
to an ASCIIZ string specifying the user's current password.<!-- lm: 0x2 10 -->
</UL><I> pszNewPassword
</I><!-- lm: 0x12 20 -->
<UL>(unsigned char LSFAR *) points to an ASCIIZ
string specifying a new password for the user.<!-- lm: 0x2 10 -->
</UL><!-- lm: 0x2 1 -->
</UL>Return Codes
<P>
<!-- lm: 0x2 10 -->
<UL>
<P>
The following table lists the return codes most significant to this API.
 (See <A HREF="462_L1_APIReturnCodes.html">API Return Codes</A> for a complete
list of return codes.) ┌─────────────────────────────┬───────┬────────────────────────────────────────┐│SYMBOLICCONSTANT
    │VALUE│MEANING                │
<BR>
├─────────────────────────────┼───────┼────────────────────────────────────────┤
<BR>
│ NERR_Success         │ 0   │ No errors were encountered.       │
<BR>
├─────────────────────────────┼───────┼────────────────────────────────────────┤
<BR>
│ ERROR_NOT_SUPPORTED     │ 50   │ This request is not supported by the
 │
<BR>
│               │    │ network.                │
<BR>
├─────────────────────────────┼───────┼────────────────────────────────────────┤
<BR>
│ ERROR_BAD_NETPATH      │ 53   │ The network path cannot be found.    │
<BR>
├─────────────────────────────┼───────┼────────────────────────────────────────┤
<BR>
│ ERROR_INVALID_PASSWORD    │ 86   │ The specified password is not valid.
 │
<BR>
├─────────────────────────────┼───────┼────────────────────────────────────────┤
<BR>
│ NERR_NetNotStarted      │ 2102  │ The redirector NETWKSTA.200 has not
  │
<BR>
│               │    │ been started.              │
<BR>
├─────────────────────────────┼───────┼────────────────────────────────────────┤
<BR>
│ NERR_RemoteOnly       │ 2106  │ This operation is not supported on   │

<BR>
│               │    │ workstations.              │
<BR>
├─────────────────────────────┼───────┼────────────────────────────────────────┤
<BR>
│ NERR_WkstaNotStarted     │ 2138  │ The Requester service has not been
  │
<BR>
│               │    │ started.                │
<BR>
├─────────────────────────────┼───────┼────────────────────────────────────────┤
<BR>
│ NERR_InternalError      │ 2140  │ An internal error has occurred.     │
<BR>
├─────────────────────────────┼───────┼────────────────────────────────────────┤
<BR>
│ NERR_BadTransactConfig    │ 2141  │ The server is not configured for 
 │
<BR>
│               │    │ transactions.              │
<BR>
├─────────────────────────────┼───────┼────────────────────────────────────────┤
<BR>
│ NERR_InvalidAPI       │ 2142  │ The requested API is not supported on
 │
<BR>
│               │    │ the remote server.           │
<BR>
├─────────────────────────────┼───────┼────────────────────────────────────────┤
<BR>
│ NERR_BadPassword       │ 2203  │ The specified password is not valid.
 │
<BR>
├─────────────────────────────┼───────┼────────────────────────────────────────┤
<BR>
│ NERR_UserNotFound      │ 2221  │ The user name cannot be found.     │

<BR>
├─────────────────────────────┼───────┼────────────────────────────────────────┤
<BR>
│ NERR_NotPrimary       │ 2226  │ The UAS database is replicant and does
│
<BR>
│               │    │ not allow updates.           │
<BR>
├─────────────────────────────┼───────┼────────────────────────────────────────┤
<BR>
│ NERR_ACFNotLoaded      │ 2227  │ The UAS database has not been started.
│
<BR>
├─────────────────────────────┼───────┼────────────────────────────────────────┤
<BR>
│ NERR_ACFNoRoom        │ 2228  │ There are too many names in the access
│
<BR>
│               │    │ control file.              │
<BR>
├─────────────────────────────┼───────┼────────────────────────────────────────┤
<BR>
│ NERR_ACFFileIOFail      │ 2229  │ An error was encountered in accessing
 │
<BR>
│               │    │ the accounts database.         │
<BR>
├─────────────────────────────┼───────┼────────────────────────────────────────┤
<BR>
│ NERR_AccountExpired     │ 2239  │ The user account has expired.      │
<BR>
├─────────────────────────────┼───────┼────────────────────────────────────────┤
<BR>
│ NERR_PasswordCantChange   │ 2243  │ This password cannot change.      │

<BR>
├─────────────────────────────┼───────┼────────────────────────────────────────┤
<BR>
│ NERR_PasswordHistConflict  │ 2244  │ This password cannot be used now.
   │
<BR>
├─────────────────────────────┼───────┼────────────────────────────────────────┤
<BR>
│ NERR_PasswordTooShort    │ 2245  │ The password is shorter than required.
│
<BR>
├─────────────────────────────┼───────┼────────────────────────────────────────┤
<BR>
│ NERR_PasswordTooRecent    │ 2246  │ The password is too recent to change.
 │
<BR>
├─────────────────────────────┼───────┼────────────────────────────────────────┤
<BR>
│ NERR_InvalidDatabase     │ 2247  │ The UAS database file is damaged. 
 │
<BR>
├─────────────────────────────┼───────┼────────────────────────────────────────┤
<BR>
│ NERR_InvalidComputer     │ 2351  │ The specified computer name is not
  │
<BR>
│               │    │ valid.                 │
<BR>
├─────────────────────────────┼───────┼────────────────────────────────────────┤
<BR>
│ NERR_CanNotGrowUASFile    │ 2456  │ It is not possible to enlarge the
UAS  │
<BR>
│               │    │ file.                  │
<BR>
├─────────────────────────────┼───────┼────────────────────────────────────────┤
<BR>
│ NERR_DCEError        │ 7500  │ DCE error status returned.       │
<BR>
├─────────────────────────────┼───────┼────────────────────────────────────────┤
<BR>
│ NERR_DCEErrorLogged     │ 7501  │ DCE error status has been<!-- entering slot 588 --> logged.
   │
<BR>
├─────────────────────────────┼───────┼────────────────────────────────────────┤
<BR>
│ NERR_AuthTicketExpired    │ 7511  │ The user's DCE authorization ticket
  │
<BR>
│               │    │ has expired.              │
<BR>
├─────────────────────────────┼───────┼────────────────────────────────────────┤
<BR>
│ NERR_RegistryNotFound    │ 7512  │ Unable to contact the DCE security
  │
<BR>
│               │    │ registry.                │
<BR>
├─────────────────────────────┼───────┼────────────────────────────────────────┤
<BR>
│ NERR_UserNotInResdom     │ 7513  │ The user is not a member of the speci-
│
<BR>
│               │    │ fied resource domain.          │
<BR>
└─────────────────────────────┴───────┴────────────────────────────────────────┘
<BR>

<P>
Other codes could be returned from the following functions:<!-- lm: 0x2 12 -->
<UL>
<P>
<LI><!-- lm: 0x2 15 -->DosAllocSeg<!-- lm: 0x2 12 -->
<BR>
<LI><!-- lm: 0x2 15 -->DosChgFilePtr<!-- lm: 0x2 12 -->
<BR>
<LI><!-- lm: 0x2 15 -->DosDevIOCtl<!-- lm: 0x2 12 -->
<BR>
<LI><!-- lm: 0x2 15 -->DosFsCtl<!-- lm: 0x2 12 -->
<BR>
<LI><!-- lm: 0x2 15 -->DosGetShrSeg<!-- lm: 0x2 12 -->
<BR>
<LI><!-- lm: 0x2 15 -->DosNewSize<!-- lm: 0x2 12 -->
<BR>
<LI><!-- lm: 0x2 15 -->DosQFileInfo<!-- lm: 0x2 12 -->
<BR>
<LI><!-- lm: 0x2 15 -->DosRead<!-- lm: 0x2 12 -->
<BR>
<LI><!-- lm: 0x2 15 -->DosWrite<!-- lm: 0x2 10 -->
</UL><!-- lm: 0x2 1 -->
</UL>Remarks
<P>
<!-- lm: 0x2 10 -->
<UL>
<P>
Passwords are case-sensitive.
<P>
The password is set to<I> pszNewPassword</I> only if all of the following
are true:<!-- lm: 0x2 12 -->
<UL>
<P>
<LI><!-- lm: 0x2 15 --><I>pszOldPassword</I> matches the current password
for the user.<!-- lm: 0x2 12 -->
<P>
<LI><!-- lm: 0x2 15 --><I>pszNewPassword</I> is not the same as the current
password.<!-- lm: 0x2 12 -->
<P>
<LI><!-- lm: 0x2 15 --><I>pszNewPassword</I> is not the same as any of the
historic passwords tracked by<I> usrmod0_password_hist_len</I> field in
the user_modals_info_0 data structure.<!-- lm: 0x2 10 -->
</UL>This call allows users to change their own passwords without administrator
privilege. Password update restrictions apply.
<P>
A user with administrator privilege who does not know the old password still
can change a user's password by using NetUserSetInfo instead of this API.

<P>
With a call to the domain controller of a single system image (SSI) domain
to which the user currently is logged on, NetUserPasswordSet also sets the
current default password of the requester. This allows the user to connect
to all servers in the domain, because the new password should replicate
rapidly throughout the domain.
<P>
<B>Special Server Actions</B>
<P>
When used remotely, a call to the NetUserPasswordSet API still succeeds
when the user's current password has expired. If the password for an account
has expired but the account otherwise could log on, the server permits a
NetUserPasswordSet call to succeed.<!-- lm: 0x2 1 -->
</UL> Related Information

<P>
<!-- lm: 0x2 10 -->
<UL>
<P>
For information about setting a password, see <A HREF="449_L2_NetUserSetInfoorNet3.html">User
- NetUserSetInfo</A>.

<P><HR>

<A HREF="445_L2_NetUserModalsSetorNe.html">[Back: NetUserModalsSet or Net32UserModalsSet]</A> <BR>
<A HREF="447_L2_NetUserSetAppSelorNe.html">[Next: NetUserSetAppSel or Net32UserSetAppSel]</A> 
</BODY>
</HTML>
