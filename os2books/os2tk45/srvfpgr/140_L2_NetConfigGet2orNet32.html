<HTML>
<HEAD>
<META HTTP-EQUIV="CONTENT-TYPE" CONTENT="TEXT/HTML; CHARSET=UTF-8">
<TITLE>NetConfigGet2 or Net32ConfigGet2</TITLE>
<STYLE>
PRE {
  FONT-FAMILY: Consolas, "Lucida Console", "Courier New", Courier, MONOSPACE;
}
</STYLE>
</HEAD>
<BODY>
<H1>NetConfigGet2 or Net32ConfigGet2</H1><!-- entering slot 174 -->NetConfigGet2 or Net32ConfigGet2
<P>
The NetConfigGet2 API retrieves one specified parameter value from the IBMLAN.INI
file of the local computer or a remote server.
<P>
The NetConfigGet2 API replaces the NetConfigGet API, which is now obsolete.

<P>
NetConfigGet2 returns the value (ASCIIZ string) for a single parameter of
a specified component in<I> buf</I>. This string is the entire value content
of the IBMLAN.INI line for the specified parameter, which is all text to
the right of the equals sign (=). Leading and trailing spaces are stripped
from this text. No other processing is performed on it.<!-- lm: 0x2 1 -->
<UL>
<P>
Restrictions
<P>
<!-- lm: 0x2 10 -->
<UL>
<P>

<P>
This API can be called from DLS and OS/2 workstations. (A local call on
a DLS workstation retrieves information from the local NETWORK.INI file.)
Administrative authority is required to call this API at a remote server.
<!-- lm: 0x2 1 -->
</UL>Syntax
<P>
<!-- lm: 0x2 10 -->
<UL>
<PRE>#include &lt;netcons.h&gt;
#include &lt;config.h&gt;
 
NetConfigGet2(<I>pszServername</I>, <I>reserved</I>, <I>component</I>,
              <I>parameter</I>, <I>buf</I>, <I>usBuflen</I>,
               <I>pusBytesReturned</I>);            /* 16 bit */
 
Net32ConfigGet2(<I>pszServername</I>, <I>reserved</I>, <I>component</I>,
              <I>parameter</I>, <I>buf</I>, <I>ulBuflen</I>,
               <I>pulBytesAvail</I>);            /* 32 bit */
</PRE>
<!-- lm: 0x2 1 -->
</UL>Parameters
<P>
<!-- lm: 0x2 10 -->
<UL>
<P>
See <A HREF="021_L2_CommonParameterDefin.html">Common Parameter Definitions
</A>for descriptions of parameters not defined here.<!-- lm: 0x2 10 -->
<P>
<I>reserved</I><!-- lm: 0x12 20 -->
<UL> (const unsigned char LSFAR *) must
be NULL.<!-- lm: 0x2 10 -->
</UL><I> component</I><!-- lm: 0x12 20 -->
<UL> (const
unsigned char LSFAR *) points to an ASCIIZ string specifying the name of
the component to be searched.<!-- lm: 0x2 10 -->
</UL><I> parameter</I><!-- lm: 0x12 20 -->
<UL> (const
unsigned char LSFAR *) points to an ASCIIZ string specifying the parameter
for which a value is to be returned.<!-- lm: 0x2 10 -->
</UL><!-- lm: 0x2 1 -->
</UL>Return Codes
<P>
<!-- lm: 0x2 10 -->
<UL>
<P>
The following table lists the return codes most significant to this API.
 (See <A HREF="462_L1_APIReturnCodes.html">API Return Codes</A> for a complete
list of return codes.) ┌─────────────────────────────┬───────┬────────────────────────────────────────┐│SYMBOLICCONSTANT
    │VALUE│MEANING                │
<BR>
├─────────────────────────────┼───────┼────────────────────────────────────────┤
<BR>
│ NERR_Success         │ 0   │ No errors were encountered.       │
<BR>
├─────────────────────────────┼───────┼────────────────────────────────────────┤
<BR>
│ ERROR_FILE_NOT_FOUND     │ 2   │ The file was not found.         │
<BR>
├─────────────────────────────┼───────┼────────────────────────────────────────┤
<BR>
│ ERROR_PATH_NOT_FOUND     │ 3   │ The path was not found.         │
<BR>
├─────────────────────────────┼───────┼────────────────────────────────────────┤
<BR>
│ ERROR_ACCESS_DENIED     │ 5   │ Administrator privilege is required.  │

<BR>
├─────────────────────────────┼───────┼────────────────────────────────────────┤
<BR>
│ ERROR_SHARING_VIOLATION   │ 32   │ A sharing violation occurred.      │
<BR>
├─────────────────────────────┼───────┼────────────────────────────────────────┤
<BR>
│ ERROR_BAD_NETPATH      │ 53   │ The network path cannot be found.    │
<BR>
├─────────────────────────────┼───────┼────────────────────────────────────────┤
<BR>
│ ERROR_NETWORK_ACCESS_DENIED │ 65   │ Network access is denied.        │
<BR>
├─────────────────────────────┼───────┼────────────────────────────────────────┤
<BR>
│ ERROR_INVALID_PARAMETER   │ 87   │ At least one parameter value is not
  │
<BR>
│               │    │ valid.                 │
<BR>
├─────────────────────────────┼───────┼────────────────────────────────────────┤
<BR>
│ ERROR_MORE_DATA       │ 234  │ Additional data is available, but the  │
<BR>
│               │    │ buffer is too small.          │
<BR>
├─────────────────────────────┼───────┼────────────────────────────────────────┤
<BR>
│ NERR_NetNotStarted      │ 2102  │ The redirector NETWKSTA.200 has not
  │
<BR>
│               │    │ been started.              │
<BR>
├─────────────────────────────┼───────┼────────────────────────────────────────┤
<BR>
│ NERR_BufTooSmall       │ 2123  │ The buffer is too small for fixed-   │

<BR>
│               │    │ length data.              │
<BR>
├─────────────────────────────┼───────┼────────────────────────────────────────┤
<BR>
│ NERR_InternalError      │ 2140  │ An internal error has occurred.     │
<BR>
├─────────────────────────────┼───────┼────────────────────────────────────────┤
<BR>
│ NERR_BadTransactConfig    │ 2141  │ The server is not configured for 
 │
<BR>
│               │    │ transactions.              │
<BR>
├─────────────────────────────┼───────┼────────────────────────────────────────┤
<BR>
│ NERR_InvalidAPI       │ 2142  │ The requested API is not supported on
 │
<BR>
│               │    │ the remote server.           │
<BR>
├─────────────────────────────┼───────┼────────────────────────────────────────┤
<BR>
│ NERR_CfgCompNotFound     │ 2146  │ The program could not find the speci-
 │
<BR>
│               │    │ fied component in the IBMLAN.INI file. │
<BR>
├─────────────────────────────┼───────┼────────────────────────────────────────┤
<BR>
│ NERR_CfgParamNotFound    │ 2147  │ The program could not find the speci-
 │
<BR>
│               │    │ fied parameter in the IBMLAN.INI file. │
<BR>
├─────────────────────────────┼───────┼────────────────────────────────────────┤
<BR>
│ NERR_InvalidComputer     │ 2351  │ The specified computer name is not
  │
<BR>
│               │    │ valid.                 │
<BR>
└─────────────────────────────┴───────┴────────────────────────────────────────┘
<BR>

<P>
Other codes could be returned from the following functions<!-- entering slot 175 --> :
<!-- lm: 0x2 12 -->
<UL>
<P>
<LI><!-- lm: 0x2 15 -->DosChgFilePtr<!-- lm: 0x2 12 -->
<BR>
<LI><!-- lm: 0x2 15 -->DosDuphandle<!-- lm: 0x2 12 -->
<BR>
<LI><!-- lm: 0x2 15 -->DosFsCtl<!-- lm: 0x2 12 -->
<BR>
<LI><!-- lm: 0x2 15 -->DosGetShrSeg<!-- lm: 0x2 12 -->
<BR>
<LI><!-- lm: 0x2 15 -->DosOpen<!-- lm: 0x2 12 -->
<BR>
<LI><!-- lm: 0x2 15 -->DosRead<!-- lm: 0x2 10 -->
</UL>

<P><HR>

<A HREF="139_L2_RelatedInformation.html">[Back: Related Information]</A> <BR>
<A HREF="141_L2_NetConfigGetAll2orNe.html">[Next: NetConfigGetAll2 or Net32ConfigGetAll2]</A> 
</BODY>
</HTML>
