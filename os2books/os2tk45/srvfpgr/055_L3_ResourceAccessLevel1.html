<HTML>
<HEAD>
<META HTTP-EQUIV="CONTENT-TYPE" CONTENT="TEXT/HTML; CHARSET=UTF-8">
<TITLE>Resource Access Level 1</TITLE>
</HEAD>
<BODY>
<H1>Resource Access Level 1</H1><!-- entering slot 63 -->
<PRE>struct access_info_1 {
    unsigned char LSFAR * LSPTR  acc1_resource_name;
    short                        acc1_attr;
    short                        acc1_count;
};
</PRE>

<P>
where:<!-- lm: 0x2 3 -->
<UL>
<P>
<LI><!-- lm: 0x2 6 -->The first field in this data structure is identical
to that in the previous level.<!-- lm: 0x2 3 -->
<P>
<LI><!-- lm: 0x2 6 --><I>acc1_attr</I> specifies the attributes of<I> acc1_resource_name.
</I>The bits of<I> acc1_attr</I> are defined as follows: ┌───────┬──────────────────────────────────────────────────────────────────────┐
<BR>
│ BIT  │ MEANING                                │
<BR>
├───────┼──────────────────────────────────────────────────────────────────────┤
<BR>
│ 0   │ Audit all.  When this bit is set, all access attempts are audited.
 │
<BR>
│    │ No other bits in the field can be set.  It is an error to set any
  │
<BR>
│    │ other bits when bit 0 is set.  When bit 0 is cleared, the remaining
 │
<BR>
│    │ bits are defined as described in this table.             │
<BR>
├───────┼──────────────────────────────────────────────────────────────────────┤
<BR>
│ 1-3  │ Reserved with a value of 0.                      │
<BR>
├───────┼──────────────────────────────────────────────────────────────────────┤
<BR>
│ 4   │ If 1, audit successful file opens.                  │
<BR>
├───────┼──────────────────────────────────────────────────────────────────────┤
<BR>
│ 5   │ If 1, audit successful file writes and successful directory creates.
│
<BR>
├───────┼──────────────────────────────────────────────────────────────────────┤
<BR>
│ 6   │ If 1, audit successful file deletes or truncates and successful
   │
<BR>
│    │ directory deletes.                          │
<BR>
├───────┼──────────────────────────────────────────────────────────────────────┤
<BR>
│ 7   │ If 1, audit successful file and directory access control profile
  │
<BR>
│    │ changes.                               │
<BR>
├───────┼──────────────────────────────────────────────────────────────────────┤
<BR>
│ 8   │ If 1, audit failed file opens.                    │
<BR>
├───────┼──────────────────────────────────────────────────────────────────────┤
<BR>
│ 9   │ If 1, audit failed file writes and failed directory creates.   
│
<BR>
├───────┼──────────────────────────────────────────────────────────────────────┤
<BR>
│ 10   │ If 1, audit failed file deletes or truncates and failed directory
  │
<BR>
│    │ deletes.                               │
<BR>
├───────┼──────────────────────────────────────────────────────────────────────┤
<BR>
│ 11   │ If 1, audit failed file and directory access control profile  
 │
<BR>
│    │ changes.                               │
<BR>
├───────┼──────────────────────────────────────────────────────────────────────┤
<BR>
│ 12-15 │ Reserved with a value of 0.                      │
<BR>
├───────┴──────────────────────────────────────────────────────────────────────┤
<BR>
│ NOTES:                                    │
<BR>
│                                        │
<BR>
│   Other resources that can be accessed across the network, including 
 │
<BR>
│   spooler queues, serial device queues, and pipes, are audited using the
 │
<BR>
│   FOR FILES bits.                              │
<BR>
│                                        │
<BR>
│   A value of 0 for the acc1_attr word means there is no auditing of  
 │
<BR>
│   resource accesses.  A value of 1 means audit everything.  Other values
 │
<BR>
│   indicate the auditing of specific accesses.                │
<BR>
│                                        │
<BR>
│   When write auditing is enabled, the write audit record is generated
when │
<BR>
│   the file is opened successfully for write.  Only one write audit record
 │
<BR>
│   is produced for each open instance of the file.  If both write and open
 │
<BR>
│   auditing are enabled, two audit records can be produced.         │
<BR>
│                                        │
<BR>
│   File size changes (including truncation) are audited under the control
 │
<BR>
│   of auditing bits 5 and 9.  Thus, access that is controlled with the
   │
<BR>
│   ACCESS_WRITE permission bits is audited by way of auditing bits 5 and
9. │
<BR>
│                                        │
<BR>
│   Bit 3 is used in conjunction with bit 4 to allow the auditor to deter-
 │
<BR>
│   mine the duration of access.  However, because this information is not
 │
<BR>
│   required, the generation of the close audit is optional.         │
<BR>
└──────────────────────────────────────────────────────────────────────────────┘
<BR>
<!-- lm: 0x2 3 -->
<P>
<LI><!-- lm: 0x2 6 --><I>acc1_count</I> specifies the number of<I> access_list
</I>data structures following the<I> access_info_1</I> data structure.<!-- lm: 0x2 1 -->
</UL>
<P>
In addition, the<I> access_info_1</I> data structure can be followed by
0-64<I> access_list</I> data structures. These structures define resource
permissions for individual users or groups.

<P><HR>

<A HREF="054_L3_ResourceAccessLevel0.html">[Back: Resource Access Level 0]</A> <BR>
<A HREF="056_L2_UserAccessListDataSt.html">[Next: User Access List Data Structure]</A> 
</BODY>
</HTML>
