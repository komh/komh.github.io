<HTML>
<HEAD>
<TITLE>Use Level 1</TITLE>
</HEAD>
<BODY>
<H1>Use Level 1</H1><!-- entering slot 528 -->
<PRE> 
struct use_info_1 {
   unsigned char                   ui1_local[DEVLEN+1];
   unsigned char                   ui1_pad_1;
   unsigned char LSFAR * LSPTR     ui1_remote;
   unsigned char LSFAR * LSPTR     ui1_password;
   unsigned short                  ui1_status;
   short                           ui1_asg_type;
   unsigned short                  ui1_refcount;
   unsigned short                  ui1_usecount;
};
</PRE>

<P>
where:<!-- lm: 0x2 3 -->
<UL>
<P>
<LI><!-- lm: 0x2 6 -->The first two fields in this data structure are identical
to those in the previous level.<!-- lm: 0x2 3 -->
<P>
<LI><!-- lm: 0x2 6 --><I>ui1_remote</I> points to an ASCIIZ string specifying
the UNC name of the remote resource being accessed. The string must be in
the form \\<I>servername</I>\<I>netname</I>.<!-- lm: 0x2 3 -->
<P>
<LI><!-- lm: 0x2 6 --><I>ui1_password</I> points to an ASCIIZ string containing
the password needed to establish a session between a specific requester
and server.  This field is used only by NetUseAdd.<!-- lm: 0x2 3 -->
<P>
<LI><!-- lm: 0x2 6 --><I>ui1_status</I> specifies the status of the connection.
The following values for<I> ui1_status</I> are defined in the USE.H header
file: 旼컴컴컴컴컴컴컴컴컴컫컴컴컴컫컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴커
<BR>
 SYMBOLIC CONSTANT   VALUE  MEANING                     
<BR>
쳐컴컴컴컴컴컴컴컴컴컵컴컴컴컵컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴캑
<BR>
 USE_OK        0    Connection valid.                
<BR>
쳐컴컴컴컴컴컴컴컴컴컵컴컴컴컵컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴캑
<BR>
 USE_PAUSED      1    Paused by local requester.            
<BR>
쳐컴컴컴컴컴컴컴컴컴컵컴컴컴컵컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴캑
<BR>
 USE_SESSLOST     2    Session removed.                 
<BR>
쳐컴컴컴컴컴컴컴컴컴컵컴컴컴컵컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴캑
<BR>
 USE_DISCONN      2    Connection disconnected.             
<BR>
쳐컴컴컴컴컴컴컴컴컴컵컴컴컴컵컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴캑
<BR>
 USE_NETERR      3    Network error.                  
<BR>
쳐컴컴컴컴컴컴컴컴컴컵컴컴컴컵컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴캑
<BR>
 USE_CONN       4    Connection being made.              
<BR>
쳐컴컴컴컴컴컴컴컴컴컵컴컴컴컵컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴캑
<BR>
 USE_RECONN      5    Reconnecting.                  
<BR>
읕컴컴컴컴컴컴컴컴컴컨컴컴컴컨컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴켸
<BR>
<!-- lm: 0x2 3 -->
<P>
<LI><!-- lm: 0x2 6 --><I>ui1_asg_type</I> specifies the type of remote resource
being accessed. The following types of resources are defined in USE.H: 旼컴컴컴컴컴컴컴컴컴컫컴컴컴컫컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴커
<BR>
 SYMBOLIC CONSTANT   VALUE  MEANING                     
<BR>
쳐컴컴컴컴컴컴컴컴컴컵컴컴컴컵컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴캑
<BR>
 USE_WILDCARD     -1    Matches the type of the share of the server.
  
<BR>
                (Wildcards are used only when ui1_local is a   
<BR>
                null string.)                  
<BR>
쳐컴컴컴컴컴컴컴컴컴컵컴컴컴컵컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴캑
<BR>
 USE_DISKDEV      0    Disk device.                   
<BR>
쳐컴컴컴컴컴컴컴컴컴컵컴컴컴컵컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴캑
<BR>
 USE_SPOOLDEV     1    Spooled printer.                 
<BR>
쳐컴컴컴컴컴컴컴컴컴컵컴컴컴컵컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴캑
<BR>
 USE_CHARDEV      2    Serial device.                  
<BR>
쳐컴컴컴컴컴컴컴컴컴컵컴컴컴컵컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴캑
<BR>
 USE_IPC        3    Interprocess communication (IPC).        
<BR>
읕컴컴컴컴컴컴컴컴컴컨컴컴컴컨컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴켸
<BR>

<P>
To establish a connection with a null local device, set the<I> asg_type
</I>field to USE_WILDCARD (-1). To establish a connection that maps a local
device to the resource, use one of the other four values defined in the
previous table.<!-- lm: 0x2 3 -->
<P>
<LI><!-- lm: 0x2 6 --><I>ui1_refcount</I> indicates the number of files,
directories, and other processes that are open on the remote resource.<!-- lm: 0x2 3 -->
<P>
<LI><!-- lm: 0x2 6 --><I>ui1_usecount</I> indicates the number of explicit
connections (redirection of a local device name) or implicit UNC connections
(redirection of a null local device name) that are established with the
resource.
<P>
If both an explicit and an implicit connection exist between a requester
and a resource, the<I> usecount</I> of the server is 1 and the<I> usecount
</I>of the requester is 2.<!-- lm: 0x2 1 -->
</UL>

<P><HR>

<A HREF="405_L3_UseLevel0.html">[Back: Use Level 0]</A> <BR>
<A HREF="407_L2_NetUseAddorNet32UseA.html">[Next: NetUseAdd or Net32UseAdd]</A> 
</BODY>
</HTML>
