<HTML>
<HEAD>
<META HTTP-EQUIV="CONTENT-TYPE" CONTENT="TEXT/HTML; CHARSET=UTF-8">
<TITLE>Stopping a Service</TITLE>
<STYLE>
PRE {
  FONT-FAMILY: Consolas, "Lucida Console", "Courier New", Courier, MONOSPACE;
}
</STYLE>
</HEAD>
<BODY>
<H1>Stopping a Service</H1><!-- entering slot 470 -->
<P>
When a service is no longer needed, either the application using it or the
service itself should call the NetServiceControl API and specify the appropriate
shutdown opcode.  After receiving a shutdown opcode, a service must again
call the NetServiceStatus API to declare SERVICE_UNINSTALL_PENDING status
and then perform any other necessary tasks, such as closing open resources.
 The final step is to call the OS/2 DosExit API.  Immediately before doing
this, the service again must change its status, this time to SERVICE_UNINSTALLED.

<P>
For an application to disable a service from processing any further requests,
the service:<!-- lm: 0x2 2 -->
<UL>
<P>
 <LI><LI><!-- lm: 0x2 6 -->Calls the NetServiceStatus API to set a SERVICE_UNINSTALL_PENDING
state<!-- lm: 0x2 2 -->
<P>
 <LI><LI><!-- lm: 0x2 6 -->Runs a cleanup routine, closing any open resources
<!-- lm: 0x2 2 -->
<P>
 <LI><LI><!-- lm: 0x2 6 -->Notifies the LAN Server software that it has
been removed by calling the NetServiceStatus API and setting a SERVICE_UNINSTALLED
state<!-- lm: 0x2 2 -->
<P>
 <LI><LI><!-- lm: 0x2 6 -->Ends program execution<!-- lm: 0x2 1 -->
</UL>
<P>
To obtain information about services started, an application calls the NetServiceEnum
API.  To query the state of a service, retrieving its status and code information,
an application calls the NetServiceStatus API.
<P>
For information about the default LAN Server services and the functions
used to control services, see <A HREF="353_L2_ServicesProvidedwith.html">Services
Provided with LAN Server</A>.

<P><HR>

<A HREF="360_L3_StartingaService.html">[Back: Starting a Service]</A> <BR>
<A HREF="362_L3_TimeHintsforStarting.html">[Next: Time Hints for Starting and Stopping a Service]</A> 
</BODY>
</HTML>
