<HTML>
<HEAD>
<META HTTP-EQUIV="CONTENT-TYPE" CONTENT="TEXT/HTML; CHARSET=UTF-8">
<TITLE>NetMessageBufferSend or Net32MessageBufferSend</TITLE>
<STYLE>
PRE {
  FONT-FAMILY: Consolas, "Lucida Console", "Courier New", Courier, MONOSPACE;
}
</STYLE>
</HEAD>
<BODY>
<H1>NetMessageBufferSend or Net32MessageBufferSend</H1><!-- entering slot 284 -->NetMessageBufferSend or Net32MessageBufferSend

<P>
The NetMessageBufferSend API sends a buffer of information to a registered
messaging name.<!-- lm: 0x2 1 -->
<UL>
<P>
Restrictions
<P>
<!-- lm: 0x2 10 -->
<UL>
<P>
This API can be called from DLS and OS/2 workstations. This API requires
the caller to have either administrator authority or<B> P</B> permission
to the parent directory. However, no access authority is required for local
execution.<!-- lm: 0x2 1 -->
</UL> Syntax
<P>
<!-- lm: 0x2 10 -->
<UL>
<PRE>#include &lt;netcons.h&gt;
#include &lt;message.h&gt;
 
NetMessageBufferSend(<I>pszServername</I>, <I>name</I>,
                       <I>buf</I>, <I>usBuflen</I>);  /* 16 bit */
 
Net32MessageBufferSend(<I>pszServername</I>, <I>name</I>,
                       <I>buf</I>, <I>ulBuflen</I>);  /* 32 bit */
</PRE>
<!-- lm: 0x2 1 -->
</UL>Parameters
<P>
<!-- lm: 0x2 10 -->
<UL>
<P>
See <A HREF="021_L2_CommonParameterDefin.html">Common Parameter Definitions
</A>for descriptions of parameters not defined here.<!-- lm: 0x2 10 -->
<P>
<I>name</I><!-- lm: 0x12 20 -->
<UL> (unsigned char LSFAR *) points to an
ASCIIZ string containing the name of the user or application to receive
the message.  To broadcast a message to all requesters on the LAN, have
<I>name</I> point to an asterisk (wildcard).  To broadcast a message to
all users on a domain, have<I> name</I> point to a domain name followed
by an asterisk (*). The<I> name</I> parameter cannot be null.<!-- lm: 0x2 10 -->
</UL><I> buf
</I><!-- lm: 0x12 20 -->
<UL>(unsigned char LSFAR *) points to the ASCIIZ
message to be sent.<!-- lm: 0x2 10 -->
</UL><!-- lm: 0x2 1 -->
</UL>Return Codes
<P>
<!-- lm: 0x2 10 -->
<UL>
<P>
The following table lists the return codes most significant to this API.
 (See <A HREF="462_L1_APIReturnCodes.html">API Return Codes</A> for a complete
list of return codes.) ┌─────────────────────────────┬───────┬────────────────────────────────────────┐│SYMBOLICCONSTANT
    │VALUE│MEANING                │
<BR>
├─────────────────────────────┼───────┼────────────────────────────────────────┤
<BR>
│ NERR_Success         │ 0   │ No errors were encountered.       │
<BR>
├─────────────────────────────┼───────┼────────────────────────────────────────┤
<BR>
│ ERROR_ACCESS_DENIED     │ 5   │ Administrator privilege is required.  │

<BR>
├─────────────────────────────┼───────┼────────────────────────────────────────┤
<BR>
│ ERROR_NOT_ENOUGH_MEMORY   │ 8   │ Sufficient memory is not available.
  │
<BR>
├─────────────────────────────┼───────┼────────────────────────────────────────┤
<BR>
│ ERROR_REM_NOT_LIST      │ 51   │ This remote computer is not listening.
│
<BR>
├─────────────────────────────┼───────┼────────────────────────────────────────┤
<BR>
│ ERROR_INVALID_PARAMETER   │ 87   │ At least one parameter value is not
  │
<BR>
│               │    │ valid.                 │
<BR>
├─────────────────────────────┼───────┼────────────────────────────────────────┤
<BR>
│ ERROR_INVALID_LEVEL     │ 124  │ The sLevel parameter is not valid.   │

<BR>
├─────────────────────────────┼───────┼────────────────────────────────────────┤
<BR>
│ NERR_NetNotStarted      │ 2102  │ The redirector NETWKSTA.200 has not
  │
<BR>
│               │    │ been started.              │
<BR>
├─────────────────────────────┼───────┼────────────────────────────────────────┤
<BR>
│ NERR_ShareMem        │ 2104  │ An internal error occurred-the network
│
<BR>
│               │    │ cannot access a shared memory segment. │
<BR>
├─────────────────────────────┼───────┼────────────────────────────────────────┤
<BR>
│ NERR_NoNetworkResource    │ 2105  │ A network resource shortage occurred.
 │
<BR>
├─────────────────────────────┼───────┼────────────────────────────────────────┤
<BR>
│ NERR_BufTooSmall       │ 2123  │ The buffer is too small for fixed-   │

<BR>
│               │    │ length data.              │
<BR>
├─────────────────────────────┼───────┼────────────────────────────────────────┤
<BR>
│ NERR_RemoteErr        │ 2127  │ A remote API error has occurred.    │

<BR>
├─────────────────────────────┼───────┼────────────────────────────────────────┤
<BR>
│ NERR_OS2IoctlError      │ 2134  │ An internal error occurred when     │
<BR>
│               │    │ calling the workstation driver.     │
<BR>
├─────────────────────────────┼───────┼────────────────────────────────────────┤
<BR>
│ NERR_NetworkError      │ 2136  │ A general network error has occurred.
 │
<BR>
├─────────────────────────────┼───────┼────────────────────────────────────────┤
<BR>
│ NERR_WkstaNotStarted     │ 2138  │ The Requester service has not been
  │
<BR>
│               │    │ started.                │
<BR>
├─────────────────────────────┼───────┼────────────────────────────────────────┤
<BR>
│ NERR_BrowserNotStarted    │ 2139  │ The requested information is not 
 │
<BR>
│               │    │ available.               │
<BR>
├─────────────────────────────┼───────┼────────────────────────────────────────┤
<BR>
│ NERR_InternalError      │ 2140  │ An internal error has occurred.     │
<BR>
├─────────────────────────────┼───────┼────────────────────────────────────────┤
<BR>
│ NERR_BadTransactConfig    │ 2141  │ The server is not configured for 
 │
<BR>
│               │    │ transactions.              │
<BR>
├─────────────────────────────┼───────┼────────────────────────────────────────┤
<BR>
│ NERR_NoComputerName     │ 2270  │ A computer name has not been config-
 │
<BR>
│               │    │ ured.                  │
<BR>
├─────────────────────────────┼───────┼────────────────────────────────────────┤
<BR>
│ NERR_NameNotFound      │ 2273  │ The message alias cannot be found on
 │
<BR>
│               │    │ the local area network.         │
<BR>
├─────────────────────────────┼───────┼────────────────────────────────────────┤
<BR>
│ NERR_AlreadyExists      │ 2276  │ This message alias already exists  
│
<BR>
│               │    │ locally.                │
<BR>
├─────────────────────────────┼───────┼────────────────────────────────────────┤
<BR>
│ NERR_TooManyNames      │ 2277  │ The maximum number of<!-- entering slot 285 --> added
message   │
<BR>
│               │    │ aliases has been exceeded.       │
<BR>
├─────────────────────────────┼───────┼────────────────────────────────────────┤
<BR>
│ NERR_PausedRemote      │ 2281  │ The message has been sent, but the   │

<BR>
│               │    │ reception is currently paused.     │
<BR>
├─────────────────────────────┼───────┼────────────────────────────────────────┤
<BR>
│ NERR_BadReceive       │ 2282  │ The message was sent but not received.
│
<BR>
├─────────────────────────────┼───────┼────────────────────────────────────────┤
<BR>
│ NERR_NotLocalName      │ 2285  │ The name is not on the local computer.
│
<BR>
├─────────────────────────────┼───────┼────────────────────────────────────────┤
<BR>
│ NERR_TruncatedBroadcast   │ 2289  │ The broadcast message was truncated.
 │
<BR>
├─────────────────────────────┼───────┼────────────────────────────────────────┤
<BR>
│ NERR_DuplicateName      │ 2297  │ A duplicate message alias exists on
  │
<BR>
│               │    │ the local area network.         │
<BR>
├─────────────────────────────┼───────┼────────────────────────────────────────┤
<BR>
│ NERR_InvalidComputer     │ 2351  │ The specified computer name is not
  │
<BR>
│               │    │ valid.                 │
<BR>
└─────────────────────────────┴───────┴────────────────────────────────────────┘
<BR>

<P>
Other codes could be returned from the following functions:<!-- lm: 0x2 12 -->
<UL>
<P>
<LI><!-- lm: 0x2 15 -->DosFsRamSemClear<!-- lm: 0x2 12 -->
<BR>
<LI><!-- lm: 0x2 15 -->DosFreeSeg<!-- lm: 0x2 12 -->
<BR>
<LI><!-- lm: 0x2 15 -->DosFsCtl<!-- lm: 0x2 12 -->
<BR>
<LI><!-- lm: 0x2 15 -->DosGetShrSeg<!-- lm: 0x2 12 -->
<BR>
<LI><!-- lm: 0x2 15 -->DosSemClear<!-- lm: 0x2 12 -->
<BR>
<LI><!-- lm: 0x2 15 -->DosMailslot<!-- lm: 0x2 10 -->
</UL><!-- lm: 0x2 1 -->
</UL>Remarks
<P>
<!-- lm: 0x2 10 -->
<UL>
<P>
For broadcast messages to the physical network, where<I> name</I> points
to "*" or to "domain (*)", the message can be no longer than 128 bytes (and
is not guaranteed to be delivered). For messages sent to all message names
on a domain, the limit is 128 bytes.  Otherwise, the message can be any
length, provided it does not exceed the maximum receivable message size
for that computer, which is set with the<I> sizmessbuf</I> parameter in
the IBMLAN.INI file. The total size of<I> sizmessbuf</I> can be divided
among different messages in its heap, if messages are arriving at the same
time.  This reduces the actual size of any single message that can be received.
In addition, the<I> sizmessbuf</I> parameter can accept only limited values.

<P>
NetMessageBufferSend does not require the Messenger service to be started
on a local computer.<!-- lm: 0x2 1 -->
</UL> Related Information
<P>
<!-- lm: 0x2 10 -->
<UL>
<P>
For information about:<!-- lm: 0x2 12 -->
<UL>
<P>
<LI><!-- lm: 0x2 15 -->Adding a user to a message table, see <A HREF="225_L2_NetMessageNameAddorN.html">Message
- NetMessageNameAdd</A>.<!-- lm: 0x2 12 -->
<P>
<LI><!-- lm: 0x2 15 -->Using the Messenger service, see <A HREF="351_L1_ServicesCategory.html">Services
Category</A>.<!-- lm: 0x2 12 -->
<P>
<LI><!-- lm: 0x2 15 -->Sending a message file to a user, see <A HREF="222_L2_NetMessageFileSendor.html">Message
- NetMessageFileSend</A>.<!-- lm: 0x2 12 -->
<P>
<LI><!-- lm: 0x2 15 -->Setting the<I> sizmessbuf</I> parameter of a server
in the IBMLAN.INI file, see the<I> LAN Server Network Administrator Reference
Volume 2: Performance Tuning</I>.<!-- lm: 0x2 10 -->
</UL>

<P><HR>

<A HREF="220_L3_RelatedInformation.html">[Back: Related Information]</A> <BR>
<A HREF="222_L2_NetMessageFileSendor.html">[Next: NetMessageFileSend or Net32MessageFileSend]</A> 
</BODY>
</HTML>
