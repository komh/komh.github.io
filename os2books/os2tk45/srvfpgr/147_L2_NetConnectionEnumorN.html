<HTML>
<HEAD>
<META HTTP-EQUIV="CONTENT-TYPE" CONTENT="TEXT/HTML; CHARSET=UTF-8">
<TITLE>NetConnectionEnum or Net32ConnectionEnum</TITLE>
</HEAD>
<BODY>
<H1>NetConnectionEnum or Net32ConnectionEnum</H1><!-- entering slot 183 -->NetConnectionEnum or Net32ConnectionEnum
<P>
The NetConnectionEnum API lists (1) the connections made to a shared resource
of a server or (2) all connections established from a particular computer
to a server.<!-- lm: 0x2 1 -->
<UL>
<P>
Restrictions
<P>
<!-- lm: 0x2 10 -->
<UL>
<P>
This API can be called from DLS and OS/2 workstations, but DLS workstations
can issue this call only to a remote LAN Server workstation. A call to this
API can be issued only to an OS/2 LAN Server workstation.<!-- lm: 0x2 1 -->
</UL> Syntax

<P>
<!-- lm: 0x2 10 -->
<UL>
<PRE>#include &lt;netcons.h&gt;
#include &lt;shares.h&gt;
 
NetConnectionEnum(<I>pszServername</I>, <I>qualifier</I>, <I>sLevel</I>, <I>buf</I>,
      <I>usBuflen</I>, <I>pusEntriesReturned</I>, <I>pusEntriesAvail</I>);    /* 16 bit */
 
Net32ConnectionEnum(<I>pszServername</I>, <I>qualifier</I>, <I>ulLevel</I>, <I>buf</I>,
      <I>ulBuflen</I>, <I>pulEntriesReturned</I>, <I>pulEntriesAvail</I>);    /* 32 bit */
</PRE>
<!-- lm: 0x2 1 -->
</UL>Parameters
<P>
<!-- lm: 0x2 10 -->
<UL>
<P>
See <A HREF="021_L2_CommonParameterDefin.html">Common Parameter Definitions
</A>for descriptions of parameters not defined here.<!-- lm: 0x2 10 -->
<P>
<I>qualifier</I><!-- lm: 0x12 20 -->
<UL> (const unsigned char LSFAR *)
points to an ASCIIZ string specifying either (1) the netname of the shared
resource whose connections are to be listed, or (2) the client name of the
requester whose connections to the shared resource are to be listed. This
value cannot be a null pointer or string.<!-- lm: 0x2 10 -->
</UL><I> sLevel
</I>or<I> ulLevel</I><!-- lm: 0x12 20 -->
<UL> (16-bit short or 32-bit unsigned
long) can be 0 or 1, specifying which data structure to use, as described
in <A HREF="144_L3_ConnectionLevel0.html">Connection Level 0</A> and <A HREF="145_L3_ConnectionLevel1.html">Connection
Level 1</A>.<!-- lm: 0x2 10 -->
</UL><!-- lm: 0x2 1 -->
</UL>Return Codes
<P>
<!-- lm: 0x2 10 -->
<UL>
<P>
The following table lists the return codes most significant to this API.
 (See <A HREF="462_L1_APIReturnCodes.html">API Return Codes</A> for a complete
list of return codes.) ┌───────────────────────────┬───────┬──────────────────────────────────────────┐│SYMBOLICCONSTANT
   │VALUE│MEANING                 │
<BR>
├───────────────────────────┼───────┼──────────────────────────────────────────┤
<BR>
│ NERR_Success        │ 0   │ No errors were encountered.        │
<BR>
├───────────────────────────┼───────┼──────────────────────────────────────────┤
<BR>
│ ERROR_ACCESS_DENIED    │ 5   │ Administrator privilege is required.   │

<BR>
├───────────────────────────┼───────┼──────────────────────────────────────────┤
<BR>
│ ERROR_BAD_NETPATH     │ 53   │ The network path cannot be found.     │
<BR>
├───────────────────────────┼───────┼──────────────────────────────────────────┤
<BR>
│ ERROR_NETWORK_ACCESS_DENIE│ 65   │ Network access is denied.         │
<BR>
├───────────────────────────┼───────┼──────────────────────────────────────────┤
<BR>
│ ERROR_INVALID_PARAMETER  │ 87   │ At least one parameter value is not
   │
<BR>
│              │    │ valid.                  │
<BR>
├───────────────────────────┼───────┼──────────────────────────────────────────┤
<BR>
│ ERROR_INVALID_LEVEL    │ 124  │ The sLevel parameter is not valid.    │

<BR>
├───────────────────────────┼───────┼──────────────────────────────────────────┤
<BR>
│ ERROR_MORE_DATA      │ 234  │ Additional data is available, but the   │
<BR>
│              │    │ buffer is too small.           │
<BR>
├───────────────────────────┼───────┼──────────────────────────────────────────┤
<BR>
│ NERR_NetNotStarted     │ 2102  │ The redirector NETWKSTA.200 has not been
│
<BR>
│              │    │ started.                 │
<BR>
├───────────────────────────┼───────┼──────────────────────────────────────────┤
<BR>
│ NERR_RemoteOnly      │ 2106  │ This operation is not supported on work-
│
<BR>
│              │    │ stations.                 │
<BR>
├───────────────────────────┼───────┼──────────────────────────────────────────┤
<BR>
│ NERR_ServerNotStarted   │ 2114  │ The Server service has not been started.
│
<BR>
├───────────────────────────┼───────┼──────────────────────────────────────────┤
<BR>
│ NERR_WkstaNotStarted    │ 2138  │ The Requester service has not been 
 │
<BR>
│              │    │ started.                 │
<BR>
├───────────────────────────┼───────┼──────────────────────────────────────────┤
<BR>
│ NERR_InternalError     │ 2140  │ An internal error has occurred.      │
<BR>
├───────────────────────────┼───────┼──────────────────────────────────────────┤
<BR>
│ NERR_BadTransactConfig   │ 2141  │ The server is not configured for trans-
 │
<BR>
│              │    │ actions.                 │
<BR>
├───────────────────────────┼───────┼──────────────────────────────────────────┤
<BR>
│ NERR_NetNameNotFound    │ 2310  │ This shared resource does not exist.
  │
<BR>
├───────────────────────────┼───────┼──────────────────────────────────────────┤
<BR>
│ NERR_ClientNameNotFound  │ 2312  │ A session does not exist with that
com-  │
<BR>
│              │    │ puter name.                │
<BR>
├───────────────────────────┼───────┼──────────────────────────────────────────┤
<BR>
│ NERR_InvalidComputer    │ 2351  │ The specified computer name is not 
 │
<BR>
│              │    │ valid.                  │
<BR>
└───────────────────────────┴───────┴──────────────────────────────────────────┘
<BR>

<P>
Other codes could be returned from the following functions:<!-- lm: 0x2 12 -->
<UL>
<P>
<LI><!-- lm: 0x2 15 -->DosFsCtl<!-- lm: 0x2 12 -->
<BR>
<LI><!-- lm: 0x2 15 -->DosGetShrSeg<!-- lm: 0x2 10 -->
</UL><!-- lm: 0x2 1 -->
</UL><!-- entering slot 184 -->Remarks
<P>
<!-- lm: 0x2 10 -->
<UL>
<P>
If you call this API with the buffer length parameter equal to zero, the
API returns a value for total entries available. This technique is useful
if you do not know the exact buffer size required.
<P>
If<I> qualifier</I> specifies a requester, NetConnectionEnum returns a list
of all connections made between the requester and the specified server during
the current session.
<P>
If<I> qualifier</I> specifies a shared resource, NetConnectionEnum returns
a list of all connections made to the shared resource.<!-- lm: 0x2 1 -->
</UL> Related
Information
<P>
<!-- lm: 0x2 10 -->
<UL>
<P>
For information about:<!-- lm: 0x2 12 -->
<UL>
<P>
<LI><!-- lm: 0x2 15 -->Listing all available servers, see <A HREF="348_L2_NetServerEnum2orNet3.html">Server
- NetServerEnum2</A>.<!-- lm: 0x2 12 --> <!-- lm: 0x2 15 -->
<UL>Listing
sessions on a server, see <A HREF="381_L2_NetSessionEnumorNet3.html">Session
- NetSessionEnum</A>.<!-- lm: 0x2 10 -->
</UL><!-- lm: 0x2 1 -->

<P><HR>

<A HREF="146_L3_RelatedInformation.html">[Back: Related Information]</A> <BR>
<A HREF="148_L1_DLSSpecificAPIs.html">[Next: DLS-Specific APIs]</A> 
</BODY>
</HTML>
