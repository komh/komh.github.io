<HTML>
<HEAD>
<TITLE>Opening an MCD</TITLE>
</HEAD>
<BODY>
<H1>Opening an MCD</H1><!-- entering slot 15 -->
<P>
MCI_OPEN is the first message received by the MCD. This message instructs
the driver to create and initialize an instance of a particular device.
 The MCD must allocate and initialize the instance structure.  Note that
the MCI_OPEN message does not make the instances active.
<P>
Because the MDM needs to pass additional information to the drivers, the
open structure for MCDs is different from the MCI_OPEN_PARMS structure.
 In addition, the MCDs need to return information to the MDM.  If the application
requests a NOTIFY on the MCI_OPEN message, the MCD sends back the open NOTIFY
on the MCIDRV_RESTORE message.  This is transparent to the application.
The MCD does not receive any of the following flags on an MCI_OPEN:<!-- lm: 0x2 3 -->
<UL>
<P>
<LI><!-- lm: 0x2 6 -->MCI_OPEN_ALIAS<!-- lm: 0x2 3 -->
<BR>
<LI><!-- lm: 0x2 6 -->MCI_NOTIFY<!-- lm: 0x2 3 -->
<BR>
<LI><!-- lm: 0x2 6 -->MCI_OPEN_TYPE_ID<!-- lm: 0x2 1 -->
</UL>
<P>
On the MCI_OPEN message,<I> pParam2</I> points to the MMDRV_OPEN_PARM structure
located in the MMDRVOS2.H file.  This structure contains information for
the MCD.
<PRE>旼컴컴컴컴컴컴컴컴컴컴컴컫컴컴컴컴쩡컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴커쿑ield                   쿔n/Out  쿏escription                               
쳐컴컴컴컴컴컴컴컴컴컴컴컵컴컴컴컴탠컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴캑
쿓WND hwndCallback       쿔n      쿥indow handle used for mciDriverNotify.   
쳐컴컴컴컴컴컴컴컴컴컴컴컵컴컴컴컴탠컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴캑
쿢SHORT  usDeviceID      쿔n      쿏evice ID assigned to this instance.  This
                                쿯ield is filled in by MDM.                
쳐컴컴컴컴컴컴컴컴컴컴컴컵컴컴컴컴탠컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴캑
쿢SHORT  usDeviceType    쿔n      쿏evice type number for this instance.     
쳐컴컴컴컴컴컴컴컴컴컴컴컵컴컴컴컴탠컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴캑
쿢SHORT  usDeviceOrd     쿔n      쿏evice ordinal number for this instance.  
쳐컴컴컴컴컴컴컴컴컴컴컴컵컴컴컴컴탠컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴캑
쿛VOID  pInstance        쿔nOut   쿛ointer to instance structure initialized 
                                쿫y driver.  The driver fills in this      
                                쿾arameter.                                
쳐컴컴컴컴컴컴컴컴컴컴컴컵컴컴컴컴탠컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴캑
쿎HAR   szDevDLLName[260]쿔n      쿎haracter string containing               
                                쿭evice-specific DLL name to call for the  
                                쿽pen.                                     
쳐컴컴컴컴컴컴컴컴컴컴컴컵컴컴컴컴탠컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴캑
쿛SZ  pszElementName     쿔n      쿟ypically a file name.  If OPEN_PLAYLIST  
                                쿶s specified, this is a pointer to a      
                                쿺emory playlist.  If OPEN_MMIO is         
                                퀂pecified, this is a MMIO handle.         
쳐컴컴컴컴컴컴컴컴컴컴컴컵컴컴컴컴탠컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴캑
쿢SHORT usDevParmLen     쿔n      쿏evice parameters data block length.      
쳐컴컴컴컴컴컴컴컴컴컴컴컵컴컴컴컴탠컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴캑
쿛VOID  pDevParm         쿔n      쿏evice parameters data block. This data is
                                퀅nique to each type of device and is      
                                퀁etrieved from the MMPM2.INI file. (for   
                                쿮xample, LVD  "PORT=COM1 SPEED=9600N71"). 
쳐컴컴컴컴컴컴컴컴컴컴컴컵컴컴컴컴탠컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴캑
쿢SHORT                  쿔nOut   쿙umber of resource units this instance    
퀅sResourceUnitsRequired         퀁equires. See <A HREF="056_L2_ResourceUnitsandClas.html">Resource Units and Classes</A>. 
쳐컴컴컴컴컴컴컴컴컴컴컴컵컴컴컴컴탠컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴캑
쿢SHORT  usResourceClass 쿔nOut   쿝esource class this instance belongs to.  
                                쿞ee <A HREF="056_L2_ResourceUnitsandClas.html">Resource Units and Classes</A>.           
쳐컴컴컴컴컴컴컴컴컴컴컴컵컴컴컴컴탠컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴캑
쿢SHORT                  쿔nOut   쿝esource priority for this instance.      
퀅sResourcePriority                                                        
쳐컴컴컴컴컴컴컴컴컴컴컴컵컴컴컴컴탠컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴캑
쿢LONG ulParam2          쿔n      쿛ointer to MCI_OPEN structure.            
읕컴컴컴컴컴컴컴컴컴컴컴컨컴컴컴컴좔컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴켸
</PRE>


<P><HR>

<A HREF="014_L3_RequiredCommandMessa.html">[Back: Required Command Messages]</A> <BR>
<A HREF="016_L3_SubsystemMessages.html">[Next: Subsystem Messages]</A> 
</BODY>
</HTML>
