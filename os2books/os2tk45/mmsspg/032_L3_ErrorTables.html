<HTML>
<HEAD>
<TITLE>Error Tables</TITLE>
</HEAD>
<BODY>
<H1>Error Tables</H1><!-- entering slot 37 -->
<P>
In addition to custom command tables, MCDs can have custom error tables.
 Error tables are represented as resources to the driver.  They are created
using the RCDATA type of resource.  By default, custom driver error tables
are associated with the MCDTABLE and VSDTABLE DLLs specified in the MMPM2.INI
file.  The resource number is the device type number + MMERROR_TABLE_BASE.
 For example, the following example shows an RCDATA value of 506.  This
consists of:<!-- lm: 0x2 3 -->
<UL>
<P>
<LI><!-- lm: 0x2 6 -->A value of 500 from MMERROR_TABLE_BASE located in
the MCIDRV.H file<!-- lm: 0x2 3 -->
<P>
<LI><!-- lm: 0x2 6 -->A value of 6 from the device type you are supporting
(for example, MCI_DEVTYPE_OTHER located in the MCIOS2.H file).<!-- lm: 0x2 1 -->
</UL>
<P>
As an alternate, you can add a #define statement in your header file to
define the RCDATA value.  For example:
<PRE>#define MMERR_TABLE_MY_DEVICE  MMERROR_TABLE_BASE + MCI_DEVTYPE_OTHER</PRE>

<P>
MDM attempts to use these tables whenever mciGetErrorString is called with
an error generated by that driver.  If the custom error table resource does
not exist, then MDM uses its default error table.  The error table is a
resource.
<P>
Error tables are composed of a set of ULONG strings with a special end-of-table
identifier as shown in the following example.
<PRE>RCDATA        506
BEGIN

MCIERR_INVALID_DEVICE_NAME,        "Invalid Device Name given"
MCIERR_SUCCESS,                    "MMPM Command completed successfully"
MCIERR_INVALID_DEVICE_ID,          "Invalid device ID given"
MCIERR_UNRECOGNIZED_KEYWORD,       "Unrecognized keyword"
MCIERR_UNRECOGNIZED_COMMAND,       "Unrecognized command"
MCIERR_HARDWARE,                   "Hardware error"
MCIERR_OUT_OF_MEMORY,              "System out of memory"
     .
     .
     .
MCIERR_MSG_TABLE_END               ""
END
</PRE>

<P>
<B>Note: </B> If a device does not use a basic command, the MCD can return
MCIERR_UNSUPPORTED_FUNCTION.  If a device supports the command, but not
all of the options, it can return MCIERR_UNSUPPORTED_FLAG.<!-- lm: 0x2 1 -->
<P>


<P><HR>

<A HREF="031_L3_ParsingaCommandList.html">[Back: Parsing a Command List]</A> <BR>
<A HREF="033_L2_DeviceStates.html">[Next: Device States]</A> 
</BODY>
</HTML>
