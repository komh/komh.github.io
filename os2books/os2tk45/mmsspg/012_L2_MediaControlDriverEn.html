<HTML>
<HEAD>
<META HTTP-EQUIV="CONTENT-TYPE" CONTENT="TEXT/HTML; CHARSET=UTF-8">
<TITLE>Media Control Driver Entry Point</TITLE>
</HEAD>
<BODY>
<H1>Media Control Driver Entry Point</H1><!-- entering slot 12 -->
<P>
All MCDs have commands passed to them in the same way, regardless of whether
they support streaming or nonstreaming devices.  Applications call either
the mciSendCommand or mciSendString functions to pass commands to the entry
point, mciDriverEntry.  In addition, some commands are generated by the
MDM itself.  These are the commands for saving and restoring an instance.

<P>
The following table shows the parameters associated with mciDriverEntry.

<PRE>┌─────────────────────────┬───────────────────────────────────┐
│Parameters               │Description                        │
├─────────────────────────┼───────────────────────────────────┤
│PVOID <I>pInstance</I>          │Pointer to instance structure of   │
│                         │driver.                            │
├─────────────────────────┼───────────────────────────────────┤
│USHORT <I>usMessage</I>         │The requested action to be         │
│                         │performed.                         │
├─────────────────────────┼───────────────────────────────────┤
│ULONG <I>ulParam1</I>           │Flag for the message.  This flag is│
│                         │defined separately for each        │
│                         │message.                           │
├─────────────────────────┼───────────────────────────────────┤
│PVOID <I>pParam2</I>            │Second data parameter, whose       │
│                         │interpretation is dependent on the │
│                         │message.                           │
├─────────────────────────┼───────────────────────────────────┤
│USHORT <I>usUserParm</I>        │User parameter returned on         │
│                         │notification message.              │
└─────────────────────────┴───────────────────────────────────┘
</PRE>

<P>
The function of mciDriverEntry is to switch, based on the message, and perform
the appropriate task.  An example of a message is MCI_OPEN.
<P>
Your driver must be able to handle messages in the following fashion:<!-- lm: 0x2 2 -->
<UL>
<P>
 <LI><LI><!-- lm: 0x2 6 -->Your driver must handle all the required messages.
<!-- lm: 0x2 2 -->
<P>
 <LI><LI><!-- lm: 0x2 6 -->Your driver must handle device-type messages
for its particular class of device.
<P>
For example, if you are writing an MCD for a videodisc player, you must
parse the videodisc-specific messages.<!-- lm: 0x2 2 -->
<P>
 <LI><LI><!-- lm: 0x2 6 -->Your driver must handle messages that are specific
to the device your driver supports. Suppose your driver controls a device
that is one of the following device types:<!-- lm: 0x2 11 -->
<UL>
<P>
CD-ROM/XA<!-- lm: 0x2 11 -->
<BR>
CD Audio<!-- lm: 0x2 11 -->
<BR>
Wave Audio<!-- lm: 0x2 11 -->
<BR>
Sequencer<!-- lm: 0x2 11 -->
<BR>
Digital Video<!-- lm: 0x2 11 -->
<BR>
Amp Mixer<!-- lm: 0x2 11 -->
<BR>
Videodisc<!-- lm: 0x2 6 -->
</UL> MDM has already defined device-type messages
for these devices, which means a command table exists for each of these
device types. If you want to support device-specific messages, you must
create a device-specific command table.<!-- lm: 0x2 1 -->
</UL>
<P>
If your driver is for a device type other than the device types listed,
you must create a command table that includes both the device-type messages
and the device-specific messages.

<P><HR>

<A HREF="011_L2_MediaControlDriverAr.html">[Back: Media Control Driver Architecture]</A> <BR>
<A HREF="013_L2_TypesofCommandMessag.html">[Next: Types of Command Messages]</A> 
</BODY>
</HTML>
