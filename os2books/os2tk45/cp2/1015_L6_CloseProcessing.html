<HTML>
<HEAD>
<META HTTP-EQUIV="CONTENT-TYPE" CONTENT="TEXT/HTML; CHARSET=UTF-8">
<TITLE>Close Processing</TITLE>
<STYLE>
PRE {
  FONT-FAMILY: Consolas, "Lucida Console", "Courier New", Courier, MONOSPACE;
}
</STYLE>
</HEAD>
<BODY>
<H1>Close Processing</H1><!-- entering slot 1043 -->
<P>
An application should never close an open handle to a COM port while there
are requests still pending for that handle. If a request has not completed,
it might be waiting for timeout processing. IOCtls are used to determine,
and change, the current timeout processing.
<P>
A<I> Last Level Close</I> occurs when the port is no longer open (from another
open without a close). When a Last Level Close occurs, the physical device
driver does some special processing:<!-- lm: 0x2 3 -->
<UL>
<P>
<LI><!-- lm: 0x2 6 -->Clears the receive and transmit queues<!-- lm: 0x2 3 -->
<BR>
<LI><!-- lm: 0x2 6 -->Turns break OFF, if it is currently transmitting a
break<!-- lm: 0x2 3 -->
<BR>
<LI><!-- lm: 0x2 6 -->Clears any character waiting to be transmitted immediately,
if it cannot be transmitted If it can be transmitted, the physical device
driver makes sure that it is given to the transmit hardware<!-- lm: 0x2 3 -->
<BR>
<LI><!-- lm: 0x2 6 -->Attempts to automatically transmit an XON (if possible),
if currently enabled for Automatic Receive Flow Control (XON/XOFF), and
the last character that the physical device driver automatically transmitted
was an XOFF<!-- lm: 0x2 3 -->
<BR>
<LI><!-- lm: 0x2 6 -->Waits until all the data in the transmit hardware
has been physically transmitted<!-- lm: 0x2 3 -->
<BR>
<LI><!-- lm: 0x2 6 -->Relinquishes the interrupt level<!-- lm: 0x2 3 -->
<BR>
<LI><!-- lm: 0x2 6 -->Turns DTR and RTS OFF, if they are not already OFF.
The physical device driver first waits the specified number of character
times<!-- lm: 0x2 3 -->
<BR>
<LI><!-- lm: 0x2 6 -->Relinquishes the Logical ID for the device (on PS/2
machines)<!-- lm: 0x2 1 -->
</UL>

<P><HR>

<A HREF="1014_L6_OpenProcessing.html">[Back: Open Processing]</A> <BR>
<A HREF="1016_L6_ReadProcessing.html">[Next: Read Processing]</A> 
</BODY>
</HTML>
