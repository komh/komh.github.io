<HTML>
<HEAD>
<META HTTP-EQUIV="CONTENT-TYPE" CONTENT="TEXT/HTML; CHARSET=UTF-8">
<TITLE>DLL Initialization and Termination</TITLE>
</HEAD>
<BODY>
<H1>DLL Initialization and Termination</H1><!-- entering slot 803 -->
<P>
A DLL is initialized and terminated by the default _DLL_InitTerm function.
 When a process gains access to the DLL, this function initializes the necessary
environment for the DLL, including storage, semaphores, and variables.  When
the process frees its access to the DLL, the _DLL_InitTerm function terminates
the DLL environment created for that process.  The _DLL_InitTerm function
is called automatically when you link to the DLL.
<P>
The _DLL_InitTerm function can be executed once when the DLL is first loaded
into memory, or it can be executed each time a new process first accesses
the DLL.  The LIBRARY statement in the module-definition file is used to
specify when the _DLL_InitTerm function is to be executed.  Following is
a list of of the available options for the LIBRARY statement.<!-- lm: 0x2 1 -->
<UL>
<P>
Options<!-- lm: 0x2 21 -->
<UL> Result<!-- lm: 0x2 1 -->
</UL> INITINSTANCE
<!-- lm: 0x2 21 -->
<UL>The _DLL_InitTerm function is called the first time
the DLL is loaded for each process that accesses the DLL.<!-- lm: 0x2 1 -->
</UL> INITGLOBAL
<!-- lm: 0x2 21 -->
<UL>The _DLL_InitTerm function is called only the very
first time the DLL is loaded.  This is the default.<!-- lm: 0x2 1 -->
</UL> TERMINSTANCE
<!-- lm: 0x2 21 -->
<UL>The _DLL_InitTerm function is called the last time
the DLL is freed for each process that accesses the DLL.<!-- lm: 0x2 1 -->
</UL>As an example, the following statement, identifies the executable file
as a DLL and specifies that SAMPLE03 is the name of the DLL:
<PRE>LIBRARY SAMPLE03 INITINSTANCE TERMINSTANCE

</PRE>

<P>
It also specifies that the _DLL_InitTerm function is to be called the first
time the DLL is loaded for each process that calls the DLL and the last
time the DLL is freed for each process that calls the DLL.
<P>
When OS/2 starts executing a DLL, it sets the CPU registers to known values,
but only for 16-bit DLLs.  All 32-bit DLLs are called with a stack frame,
like all other API calls.
<P>
Initialization/termination functions can be written in a high-level language.
 For more information on writing your own initialization/termination function,
see <A HREF="798_L3_CreatinganInitializa.html">Creating an Initialization/Termination
Function</A>.
<P>


<P><HR>

<A HREF="788_L2_DLLData.html">[Back: DLL Data]</A> <BR>
<A HREF="790_L2_BuildingDLLs.html">[Next: Building DLLs]</A> 
</BODY>
</HTML>
