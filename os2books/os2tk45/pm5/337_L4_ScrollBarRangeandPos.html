<HTML>
<HEAD>
<META HTTP-EQUIV="CONTENT-TYPE" CONTENT="TEXT/HTML; CHARSET=UTF-8">
<TITLE>Scroll-Bar Range and Position</TITLE>
</HEAD>
<BODY>
<H1>Scroll-Bar Range and Position</H1><!-- entering slot 337 -->
<P>
Every scroll bar has a range and a slider position.  The range specifies
the minimum and maximum values for the slider position.  As the user moves
the slider in a scroll bar, the scroll bar reports the slider position as
an integer in this range.  If the slider position is the minimum value,
the slider is at the top of a vertical scroll bar or at the left end of
a horizontal scroll bar.  If the slider position is the maximum value, the
slider is at the bottom or right end of the vertical or horizontal scroll
bar, respectively.
<P>
An application can adjust the range to convenient integers by using SBM_SETSCROLLBAR
or WM_SETWINDOWPARAMS, or by using the SBCDATA structure during creation
of the scroll bar. This enables you to easily translate the slider position
into a value that corresponds to the data being scrolled.  For example,
an application attempting to display 100 lines of text (numbered 0 to 99)
in a window that can show only 20 lines at a time could set the vertical
scroll-bar range from 0-99, permitting any line to be the top line, and
requiring blank lines to fill the viewing area when there are not sufficient
lines of information to fill the area (lines 80-99). More likely, the range
would be set to 0-79, so that only the first 80 lines could be the top line;
this guarantees that there would always be 20 lines of text to fill the
window.
<P>
The current settings can be obtained using SBM_QUERYRANGE or WM_QUERYWINDOWPARAMS.

<P>
To establish a useful relationship between the scroll-bar range and the
data, an application must adjust the range whenever the data or the size
of the window changes.  This means the application should adjust the range
as part of processing WM_SIZE messages.
<P>
An application must move the slider in a scroll bar.  Although the user
requests scrolling in a scroll bar, the scroll bar does not update the slider
position.  Instead, it passes the request to the owner window, which scrolls
the data and updates the slider position using the SBM_SETPOS message.  The
application controls the slider movement and can move the slider in the
increments best suited for the data being scrolled.
<P>
An application can retrieve the current slider position of a scroll bar
by sending the SBM_QUERYPOS message to the scroll bar.
<P>
If a scroll bar is a descendant of a frame window, its position relative
to its parent can change when the position of the frame window changes.
 Frame windows draw scroll bars relative to the upper-left corner of the
frame window (rather than the lower-left corner).  The frame window can
adjust the<I> y</I> coordinate of the scroll-bar position, which would be
desirable if the scroll bar is a child of the frame window, but would be
undesirable if the scroll bar is not a child window.

<P><HR>

<A HREF="336_L4_ScrollBarStyles.html">[Back: Scroll-Bar Styles]</A> <BR>
<A HREF="338_L4_ScrollBarSliderSize.html">[Next: Scroll-Bar Slider Size]</A> 
</BODY>
</HTML>
