<HTML>
<HEAD>
<META HTTP-EQUIV="CONTENT-TYPE" CONTENT="TEXT/HTML; CHARSET=UTF-8">
<TITLE>Template Format</TITLE>
</HEAD>
<BODY>
<H1>Template Format</H1><!-- entering slot 540 -->
<P>
A menu template has the following format:<!-- lm: 0x2 1 -->
<UL>
<P>
Length<B> (USHORT)</B><!-- lm: 0x11 4 -->
<UL> The length of the menu template.
<!-- lm: 0x2 1 -->
</UL>Version<B> (USHORT)</B><!-- lm: 0x11 4 -->
<UL> The
template version. Versions 0 and 1 are valid.<!-- lm: 0x2 1 -->
</UL> Code
page<B> (USHORT)</B><!-- lm: 0x11 4 -->
<UL> The identifier of the code
page used for the text items within the menu (but not any submenus, which
each have their own code pages).<!-- lm: 0x2 1 -->
</UL> Item offset<B> (USHORT)
</B><!-- lm: 0x11 4 -->
<UL>The offset of the items from the start of the
template, in bytes.<!-- lm: 0x2 1 -->
</UL> Count<B> (USHORT)</B><!-- lm: 0x11 4 -->
<UL> The
count of menu items.<!-- lm: 0x2 1 -->
</UL> Presentation parameters offset
<B>(USHORT)</B><!-- lm: 0x11 4 -->
<UL> Offset of presentation parameters
from the start of the template, in bytes. This field is only present for
version 1 of the template.<!-- lm: 0x2 1 -->
</UL> Menu Items<!-- lm: 0x11 4 -->
<UL> A
variable-sized array of menu items as follows:<!-- lm: 0x2 4 -->
<P>
Style<B> (USHORT)</B><!-- lm: 0x11 12 -->
<UL> Menu item styles (MIS_*;
see<A><!-- external link: 1D 71 C6 52 --> Menu Item Styles</A>) combined
with the logical-OR operator.<!-- lm: 0x2 4 -->
</UL> Attributes<B> (USHORT)
</B><!-- lm: 0x11 12 -->
<UL>Menu item attributes (MIA_*; see<A><!-- external link: 1D 72 C6 52 --> Menu
Item Attributes</A>) combined with the logical-OR operator.<!-- lm: 0x2 4 -->
</UL> Item
<B>(USHORT)</B><!-- lm: 0x11 12 -->
<UL> An application-provided identifier
for the menu item.<!-- lm: 0x2 4 -->
</UL> Variable data<!-- lm: 0x11 12 -->
<UL> Following
the identifier is a variable data structure whose format depends upon the
value of<B> Style</B>:<!-- lm: 0x2 12 -->
<P>
MIS_TEXT<!-- lm: 0x11 20 -->
<UL><!-- lm: 0x2 20 -->
<P>
Text<B> (PSZ)</B><!-- lm: 0x11 28 -->
<UL> Null-terminated text string.
<!-- lm: 0x2 20 --><!-- lm: 0x2 12 -->
</UL>MIS_SUBMENU<!-- lm: 0x11 20 -->
<UL> A
menu template structure.<!-- lm: 0x2 12 -->
</UL> MIS_BITMAP<!-- lm: 0x11 20 -->
<UL><!-- lm: 0x2 20 -->
<P>
Text<B> (PCH)</B><!-- lm: 0x11 28 -->
<UL> Null-terminated text string.

<P>
For MIS_BITMAP menu items, the item text string can be used to derive the
resource identifier from which a bit map is loaded. There are three instances:
<!-- lm: 0x2 30 -->
<UL>
<P>
<LI><!-- lm: 0x2 33 -->The first byte is null; that is, no resource is defined
and it is assumed that the application subsequently provides a bit-map handle
for the item.<!-- lm: 0x2 30 -->
<P>
<LI><!-- lm: 0x2 33 -->The first byte is 0xFF, the second byte is the low
byte of the resource identifier, and the third byte is the high byte of
the resource identifier.<!-- lm: 0x2 30 -->
<P>
<LI><!-- lm: 0x2 33 -->The first character is "#", and subsequent characters
make up the decimal text representation of the resource identifier.<!-- lm: 0x2 28 -->
</UL> The
resource is assumed to reside in the resource file of the current process.

<P>
If the string is empty or does not follow the format above, no resource
is loaded.<!-- lm: 0x2 20 --><!-- lm: 0x2 12 --><!-- lm: 0x2 4 --><!-- lm: 0x2 1 -->
</UL>

<P><HR>

<A HREF="521_L6_MenuTemplate.html">[Back: Menu Template]</A> <BR>
<A HREF="523_L5_STRINGTABLEStatement.html">[Next: STRINGTABLE Statement]</A> 
</BODY>
</HTML>
