<HTML>
<HEAD>
<META HTTP-EQUIV="CONTENT-TYPE" CONTENT="TEXT/HTML; CHARSET=UTF-8">
<TITLE>High-Level Service API</TITLE>
</HEAD>
<BODY>
<H1>High-Level Service API</H1><!-- entering slot 344 -->
<P>
This section describes audio-enabling macros and the high-level service
routines designed to simplify writing macros. The service routines are valuable
for many applications and are needed for information presentation facility
(IPF) support.
<P>
The five functions (high-level service API) are: mciPlayFile, mciRecordAudioFile,
mciPlayResource, mmioFindElement, and mmioRemoveElement.  These functions
are located in MCIAPI.DLL. Define INCL_MACHDR and include OS2ME.H in any
source that needs access to the high-level service API. The<I> OS/2 Multimedia
Programming Reference</I> provides a detailed description of these functions.

<P>
<B>Note: </B> These functions are also provided as 16-bit functions. The
16-bit functions include "16" in the function name as follows:<!-- lm: 0x2 3 -->
<UL>
<P>
<LI><!-- lm: 0x2 6 -->mci16PlayFile<!-- lm: 0x2 3 -->
<BR>
<LI><!-- lm: 0x2 6 -->mci16PlayResource<!-- lm: 0x2 3 -->
<BR>
<LI><!-- lm: 0x2 6 -->mci16RecordAudioFile<!-- lm: 0x2 3 -->
<BR>
<LI><!-- lm: 0x2 6 -->mmio16FindElement<!-- lm: 0x2 3 -->
<BR>
<LI><!-- lm: 0x2 6 -->mmio16RemoveElement<!-- lm: 0x2 1 -->
</UL><!-- lm: 0x2 1 -->
<P>

<P>
The mciPlayFile function plays a multimedia file or waveaudio bundle element
without displaying a device control panel. The mciPlayResource function
operates much the same as mciPlayFile, except that it plays the multimedia
object that is stored in a program resource and is intended for IPF support,
not audio macros.  The function loads the resource using DosGetResource,
creates a MMIO memory file, and opens the default device to play the memory
file.
<P>
The mciRecordAudioFile function provides a very simple recorder window allowing
the recording of audio annotations.  The mciRecordAudioFile function does
not return until the recording is complete and the window is closed. This
function creates the file if it does not exist. The mciRecordAudioFile records
digital audio data from the microphone input of the default waveaudio device.
When the file is initially created the settings are PCM, 11 kHz, mono, and
the default sample size of the audio adapter in use. All play and record
operations are performed from beginning to end.
<P>
The mmioRemoveElement function removes an element from a compound file and
the mmioFindElement function enumerates elements in a compound file. For
more information on the compound file structure, see <A HREF="214_L2_RIFFCompoundFileOver.html">RIFF
Compound File Overview</A>.

<P><HR>

<A HREF="324_L2_VOID.html">[Back: VOID]</A> <BR>
<A HREF="326_L2_CreatinganAudioEnabl.html">[Next: Creating an Audio-Enabled Macro for an Application]</A> 
</BODY>
</HTML>
