<HTML>
<HEAD>
<META HTTP-EQUIV="CONTENT-TYPE" CONTENT="TEXT/HTML; CHARSET=UTF-8">
<TITLE>Creating a Secondary Window</TITLE>
<STYLE>
PRE {
  FONT-FAMILY: Consolas, "Lucida Console", "Courier New", Courier, MONOSPACE;
}
</STYLE>
</HEAD>
<BODY>
<H1>Creating a Secondary Window</H1><!-- entering slot 182 -->
<P>
WinLoadSecondaryWindow and WinSecondaryWindow create secondary windows from
dialog templates in a resource file. WinSecondaryWindow creates a modal
window and supports the processing and destruction of the modal dialog window.
WinSecondaryWindow is equivalent to the the following code sequence.
<PRE>hwndSW = WinLoadSecondaryWindow(...);
usResult = WinProcessSecondaryWindow(hwndSW);
WinDestroySecondaryWindow(hwndSW);
</PRE>

<P>
WinSecondaryWindow and WinProcessSecondaryWindow functions do not return
until WinDismissSecondaryWindow is called. If your secondary window procedure
handles WM_COMMAND messages, it must call WinDismissSecondaryWindow after
calling the WinSecondaryWindow or the WinProcessSecondaryWindow function.
 Optionally, your window procedure can pass WM_COMMAND messages to WinDefSecondaryWindowProc,
which calls WinDismissSecondaryWindow.
<P>
WinDismissSecondaryWindow hides the secondary window and returns a result
code for a WM_COMMAND message, causing WinSecondaryWindow and WinProcessSecondaryWindow
to return. For example, if the user selects the<B> OK</B> button, your window
procedure passes the DID_OK code with WinDismissSecondaryWindow. Although
the secondary window is hidden, it still exists. In the case of WinProcessSecondaryWindow,
the window procedure must call WinDestroySecondaryWindow. Before WinSecondaryWindow
returns, it destroys the secondary window.

<P><HR>

<A HREF="167_L3_CompatibilitywithPMD.html">[Back: Compatibility with PM Dialog Window Functions]</A> <BR>
<A HREF="169_L3_ModelessSecondaryWin.html">[Next: Modeless Secondary Window]</A> 
</BODY>
</HTML>
