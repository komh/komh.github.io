<HTML>
<HEAD>
<TITLE>Program Flow</TITLE>
</HEAD>
<BODY>
<H1>Program Flow</H1><!-- entering slot 258 -->
<P>
The following figure illustrates the interaction between the audio, text,
and caption file with the Caption Creation Utility program. Source code
for the Caption Creation Utility is located in the \TOOLKIT\SAMPLES\MM\CAPTION
subdirectory.
<P>
<!-- Unable to decode bitmap format --><IMG SRC="242_L3_ProgramFlow_14.gif" WIDTH=638 HEIGHT=344>
<P>
<!-- lm: 0x2 1 -->
<UL>
<P>
<LI><LI><LI><!-- lm: 0x2 8 -->Select an audio file and a corresponding text
file to synchronize with the selected audio file. For example, you might
want to synchronize the text of a poem with an audio file of someone reading
the poem. When you open a text file, the first line of text appears at the
bottom of the text window. The first line of the text file selected in the
example shown in the previous figure is "Welcome to MMPM/2's sample captioning
system."<!-- lm: 0x2 1 -->
<P>
<LI><LI><LI><!-- lm: 0x2 8 -->In order to begin the synchronization process,
you must select<B> Start timing</B>. The audio file begins to play and<B> Advance
line</B> becomes enabled.<!-- lm: 0x2 1 -->
<P>
<LI><LI><LI><!-- lm: 0x2 8 -->Select<B> Advance line</B> to scroll to the
next line of text. The next line of text is scrolled and appears in the
text window.<!-- lm: 0x2 1 -->
<P>
<LI><LI><LI><!-- lm: 0x2 8 -->When you select<B> Advance line</B>, the Caption
Creation Utility program passes the device ID, the MCI_STATUS command with
the MCI_STATUS_ITEM flag, and the MCI_STATUS_PARMS data structure with the
<I>ulItem</I> field set to MCI_STATUS_POSITION to the Media Device Manager
(MDM). Upon return, the<I> ulReturn</I> field of the MCI_STATUS_PARMS data
structure contains the current position of the device in MMTIME units.<!-- lm: 0x2 1 -->
<P>
<LI><LI><LI><!-- lm: 0x2 8 -->When the Caption Creation Utility program
receives the position value, it writes the time value and the line of text
to the caption file. The caption file contains the same text as the text
file, but each line in the caption file is preceded by the time in the audio
file when that line of text should be displayed.<!-- lm: 0x2 1 -->
<BR>


<P><HR>

<A HREF="241_L2_CAPTIONCaptionCreati.html">[Back: CAPTION - Caption Creation Utility]</A> <BR>
<A HREF="243_L2_CAPSAMPandCAPDLL.html">[Next: CAPSAMP and CAPDLL]</A> 
</BODY>
</HTML>
