<HTML>
<HEAD>
<TITLE>Opening or Creating a RIFF Compound File</TITLE>
</HEAD>
<BODY>
<H1>Opening or Creating a RIFF Compound File</H1><!-- entering slot 233 -->
<P>
To perform I/O procedures on a new or existing RIFF compound file, an application
issues the mmioCFOpen function.  This function constructs a CTOC in memory
for a RIFF compound file.  Specify the<I> pmmiocfinfo</I> parameter to identify
a pointer to a user-supplied CTOC header structure containing optional header
information.  The<I> pmmiocfinfo</I> parameter can be NULL if the default
values of the fields are sufficient.  You can also specify the<I> pmmioinfo
</I>parameter, which identifies a pointer to a user-supplied info structure
containing optional open information that is passed to mmioOpen.
<P>
The<I> ulFlags</I> options for mmioCFOpen include the following.
<PRE>旼컴컴컴컴컴컴컴컴컴컫컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴커
쿑lag                쿏escription                                  
쳐컴컴컴컴컴컴컴컴컴컵컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴캑
쿘MIO_READ           쿚pens a file for reading only (default).     
쳐컴컴컴컴컴컴컴컴컴컵컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴캑
쿘MIO_WRITE          쿚pens a file for writing only.               
쳐컴컴컴컴컴컴컴컴컴컵컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴캑
쿘MIO_READWRITE      쿚pens a file for both reading and writing.   
쳐컴컴컴컴컴컴컴컴컴컵컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴캑
쿘MIO_CREATE         쿎reates a new file.                          
쳐컴컴컴컴컴컴컴컴컴컵컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴캑
쿘MIO_EXCLUSIVE      쿚pens a file with exclusive mode, denying    
                    쿽ther processes both read and write access to
                    퀃he file.                                    
쳐컴컴컴컴컴컴컴컴컴컵컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴캑
쿘MIO_DENYWRITE      쿚pens a file and denies other processes write
                    쿪ccess to the file.                          
쳐컴컴컴컴컴컴컴컴컴컵컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴캑
쿘MIO_DENYREAD       쿚pens a file and denies other processes read 
                    쿪ccess to the file.                          
쳐컴컴컴컴컴컴컴컴컴컵컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴캑
쿘MIO_DENYNONE       쿚pens a file without denying other processes 
                    퀁ead or write access to the file.            
읕컴컴컴컴컴컴컴컴컴컨컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴켸
</PRE>

<P>
If the file does not exist, an error is returned unless you specified the
MMIO_CREATE option.  If the file exists but is not a RIFF compound file,
the system returns an error, regardless of whether or not you specified
MMIO_CREATE.
<P>
The access and sharing flags are maintained only within the set of compound
file (CF) functions.  If the RIFF compound file or elements are accessed
without using the CF functions, the access and sharing modes are unpredictable.
 An mmioOpen function with a fully qualified element name is considered
a CF function since it internally calls mmioCFOpen, thus the flags are predictable
in that case.

<P><HR>

<A HREF="216_L3_TheMMCFINFOStructure.html">[Back: The MMCFINFO Structure]</A> <BR>
<A HREF="218_L3_ClosingaRIFFCompound.html">[Next: Closing a RIFF Compound File]</A> 
</BODY>
</HTML>
