<HTML>
<HEAD>
<META HTTP-EQUIV="CONTENT-TYPE" CONTENT="TEXT/HTML; CHARSET=UTF-8">
<TITLE>Program Flow</TITLE>
</HEAD>
<BODY>
<H1>Program Flow</H1><!-- entering slot 271 -->
<P>
The following diagram depicts the MCISpy application implementation model.
The stub or proxy DLL replaces the true MDM.DLL, which is renamed to MCI.DLL.
The proxy MDM exports the same APIs at the same ordinals as the true MDM.
The proxy MDM has forwarder entries into the MCI.DLL for the API workers.
That is, the proxy exports and also imports the same APIs from the true
MDM.
<PRE>                  ┌────────────────┐
                  │ Shared Memory  │
                  │  (Named)       │
                  ├────────────────┤                     ┌──────────────┐
 Exported APIs    │                │                     │ True MDM     │
                  │ Stub or        │                     │ containing   │
 mciSendCommand() │ Proxy          │ Forwarder entry     │ the API      │
 ─────────────────┤ MDM.DLL        ├────────────────────&gt;┤ workers is   │
 mciSendString()  │                │ Forwarder entry     │ renamed to   │
 ─────────────────┤ Maintain Open  ├────────────────────&gt;┤ MCI.DLL.     │
 mdmDriverNotify()│ Device Ids     │ Forwarder entry     │              │
 ─────────────────┤                ├────────────────────&gt;┤              │
                  │ Notify Spy     │                     │              │
                  │ Application    │                     │              │
                  └────────────────┘                     └──────────────┘
                  ┌────────────────┐
                  │ Shared Memory  │
                  │  (Named)       │
                  ├────────────────┤
                  │ MCISpy         │
                  │ Sample Program │
                  └────────────────┘
</PRE>


<P><HR>

<A HREF="254_L2_MCISPYMCISpySample.html">[Back: MCISPY - MCISpy Sample]</A> <BR>
<A HREF="256_L2_MCISTRNGMediaControl.html">[Next: MCISTRNG - Media Control Interface String Test Sample]</A> 
</BODY>
</HTML>
