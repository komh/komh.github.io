<HTML>
<HEAD>
<TITLE>Program Flow</TITLE>
</HEAD>
<BODY>
<H1>Program Flow</H1><!-- entering slot 271 -->
<P>
The following diagram depicts the MCISpy application implementation model.
The stub or proxy DLL replaces the true MDM.DLL, which is renamed to MCI.DLL.
The proxy MDM exports the same APIs at the same ordinals as the true MDM.
The proxy MDM has forwarder entries into the MCI.DLL for the API workers.
That is, the proxy exports and also imports the same APIs from the true
MDM.
<PRE>                  ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
                  ³ Shared Memory  ³
                  ³  (Named)       ³
                  ÃÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´                     ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
 Exported APIs    ³                ³                     ³ True MDM     ³
                  ³ Stub or        ³                     ³ containing   ³
 mciSendCommand() ³ Proxy          ³ Forwarder entry     ³ the API      ³
 ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´ MDM.DLL        ÃÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ&gt;´ workers is   ³
 mciSendString()  ³                ³ Forwarder entry     ³ renamed to   ³
 ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´ Maintain Open  ÃÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ&gt;´ MCI.DLL.     ³
 mdmDriverNotify()³ Device Ids     ³ Forwarder entry     ³              ³
 ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´                ÃÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ&gt;´              ³
                  ³ Notify Spy     ³                     ³              ³
                  ³ Application    ³                     ³              ³
                  ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ                     ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ
                  ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
                  ³ Shared Memory  ³
                  ³  (Named)       ³
                  ÃÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
                  ³ MCISpy         ³
                  ³ Sample Program ³
                  ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ
</PRE>


<P><HR>

<A HREF="254_L2_MCISPYMCISpySample.html">[Back: MCISPY - MCISpy Sample]</A> <BR>
<A HREF="256_L2_MCISTRNGMediaControl.html">[Next: MCISTRNG - Media Control Interface String Test Sample]</A> 
</BODY>
</HTML>
