<HTML>
<HEAD>
<META HTTP-EQUIV="CONTENT-TYPE" CONTENT="TEXT/HTML; CHARSET=UTF-8">
<TITLE>Defining Folders</TITLE>
<STYLE>
PRE {
  FONT-FAMILY: Consolas, "Lucida Console", "Courier New", Courier, MONOSPACE;
}
</STYLE>
</HEAD>
<BODY>
<H1>Defining Folders</H1><!-- entering slot 294 -->
<P>
Use the following structure to define a folder.  Refer to the TLKBASE.SCR
file located in the \TOOLKIT\SAMPLES\MM\SHORTCF subdirectory for an example.

<PRE>WPObject =
 (
 WPClassName = "WPFolder"
 WPTitle = "<I>title</I>"
 WPSetupString = "ICONFILE=$(DEST)<I>icon</I>;OBJECTID=&lt;<I>folderobjid</I>&gt;"
 WPLocation = "&lt;<I>parentfolderobjid</I>&gt;"
 WPFlags = 0
 )
</PRE>
<!-- lm: 0x2 1 -->
<UL>
<P>
<I>title</I><!-- lm: 0x2 20 -->
<UL> Specifies the folder title to be displayed
below the object.<!-- lm: 0x2 1 -->
</UL><I> icon</I><!-- lm: 0x2 20 -->
<UL> Specifies
the name of the icon to displayed on the desktop.<!-- lm: 0x2 1 -->
</UL><I> folderobjid
</I><!-- lm: 0x2 20 -->
<UL>Specifies the OS/2 unique object ID that is
used to find this folder. This is used by the installation program to determine
if this folder exists or not.  It is also used in the<I> WPLocation</I> field
of other<I> WPObject</I> definitions.<!-- lm: 0x2 1 -->
</UL><I> parentfolderobjid
</I><!-- lm: 0x2 20 -->
<UL>Specifies the folder object ID of the folder
in which this folder is to be placed.  For example, "&lt;WP_DESKTOP&gt;"
is the object ID for the Workplace Shell desktop folder.<!-- lm: 0x2 1 -->
</UL> WPFlags
= 0<!-- lm: 0x2 20 -->
<UL> Specifies creation control.  These flags are
also documented under WinCreateObject in the<I> OS/2 Presentation Manager
Programming Reference</I>. already exist. Possible values include:<!-- lm: 0x2 22 -->
<UL>
<P>
<LI><!-- lm: 0x2 25 --><LI><LI>CO_FAILIFEXISTS) - The folder is to be replaced
if it exists, or added if it does not already exist.<!-- lm: 0x2 22 -->
<BR>
<LI><!-- lm: 0x2 25 --><LI><LI>CO_REPLACEIFEXISTS) - The folder is to be
replaced if it exists, or added if it does not already exist.<!-- lm: 0x2 22 -->
<BR>
<LI><!-- lm: 0x2 25 --><LI><LI>CO_UPDATEIFEXISTS) - The folder is to be
updated with the values supplied if it exists, or added using values supplied
and defaults if it does not already exist.<!-- lm: 0x2 20 --><!-- lm: 0x2 1 -->
</UL>
<P>
In the following example, a folder called Multimedia Presentation Manager
Toolkit/2 will be added to the desktop.
<PRE>WPObject =    (
    WPClassName   = "WPFolder"
    WPTitle       = "Multimedia Presentation\nManager Toolkit/2"
    WPSetupString = "ICONFILE=$(DEST)MMTOOLKT.ICO;OBJECTID=&lt;MMPMTLK&gt;"
    WPLocation    = "&lt;WP_DESKTOP&gt;"
    WPFlags = 2L
    )
</PRE>

<P>
<B>Defining Programs</B>
<P>
Use the following structure to define a program that is to be added to a
folder.  Refer to the TLKSTRN.SCR file located in the \TOOLKIT\SAMPLES\MM\SHORTCF
subdirectory for an example.
<PRE>WPObject =
(
WPClassName   = "WPProgram"
WPTitle       = "<I>title</I>"
WPSetupString = "EXENAME=<I>path file</I>;STARTUPDIR=<I>dir</I>;PROGTYPE=PM;
     ICONFILE=$(DEST)<I>icon</I>; [ASSOCTYPE=<I>type</I>;]
     [ASSOCFILTER=<I>filter</I>;] OBJECTID=&lt;<I>pgmobjid</I>&gt;"
WPLocation    = "&lt;<I>parentfolderobjid</I>&gt;"
WPFlags = 0
)
</PRE>

<P>
<B>Note: </B> The program setup information (WPSetupString) must be on one
line, not two as shown in the previous figure.<!-- lm: 0x2 1 -->
<P>
<!-- lm: 0x2 1 -->
<P>
<I>title</I><!-- lm: 0x2 18 -->
<UL> Specifies the title to be displayed
below the object in the parent folder.<!-- lm: 0x2 1 -->
</UL><I> path</I><!-- lm: 0x2 18 -->
<UL> Specifies
a supported macro or the full path for the EXE file.<!-- lm: 0x2 1 -->
</UL><I> icon
</I><!-- lm: 0x2 18 -->
<UL>Specifies the name of the icon to be displayed
on the desktop.<!-- lm: 0x2 1 -->
</UL><I> file</I><!-- lm: 0x2 18 -->
<UL> Specifies
the EXE file name.<!-- lm: 0x2 1 -->
</UL><I> dir</I><!-- lm: 0x2 18 -->
<UL> Specifies
the full path of the startup directory or the macro $(DIR)<I>#</I> (where
<I>#</I> is a defined destination directory in CONTROL.SCR).<!-- lm: 0x2 1 -->
</UL><I> type
</I><!-- lm: 0x2 18 -->
<UL>Specifies one or more association types such
as "Waveform."  Multiple values are separated by commas.<!-- lm: 0x2 1 -->
</UL><I> filter
</I><!-- lm: 0x2 18 -->
<UL>Specifies one or more association filter types
such as "*.WAV." Multiple values are separated by commas.<!-- lm: 0x2 1 -->
</UL><I> pgmobjid
</I><!-- lm: 0x2 18 -->
<UL>Specifies the OS/2 unique object ID that is
used to find this program.  This is used by the installation program to
determine if this program exists in the parent folder.  It is not used in
the<I> WPLocation</I> field of any<I> WPObject</I> definition.<!-- lm: 0x2 1 -->
</UL><I> parentfolderobjid
</I><!-- lm: 0x2 18 -->
<UL>Specifies the folder object ID of the folder
in which this program is to be placed.<!-- lm: 0x2 1 -->
</UL> WPFlags =
0<!-- lm: 0x2 18 -->
<UL> Specifies that the program is to be added to the
folder only if it does not already exist.<!-- lm: 0x2 1 -->
</UL>

<P><HR>

<A HREF="274_L3_INIChangeControlFile.html">[Back: INI Change Control Files]</A> <BR>
<A HREF="276_L1_CaptionDLL.html">[Next: Caption DLL]</A> 
</BODY>
</HTML>
