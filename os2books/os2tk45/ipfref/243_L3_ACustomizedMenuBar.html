<HTML>
<HEAD>
<META HTTP-EQUIV="CONTENT-TYPE" CONTENT="TEXT/HTML; CHARSET=UTF-8">
<TITLE>A Customized Menu Bar</TITLE>
<STYLE>
PRE {
  FONT-FAMILY: Consolas, "Lucida Console", "Courier New", Courier, MONOSPACE;
}
</STYLE>
</HEAD>
<BODY>
<H1>A Customized Menu Bar</H1><!-- entering slot 255 -->
<P>
A Help menu bar template is shipped with the<I> IBM Developer</I>. The template
is in the HMTAILOR.RC file.  Included in the template is the Help menu pull-down.
 You can customize the menu bar by adding pull-downs and choices to the
Help menu bar template.
<P>
When a menu bar or pull-down choice you have added is selected by the application
user, IPF sends the HM_ACTIONBAR_COMMAND message to the currently active
application window.  The low-order word of<I> param1</I> contains the command
value of the selected item. The command values of the actions added by the
application must be between hex 7F00 and hex 7FFF for its commands.
<P>
The accelerator table maps function keys to commands on help windows.  This
table is also contained in the HMTAILOR.RC file. If you add a choice to
the menu bar that maps to a key on the keyboard, you must also add an entry
to the accelerator table for that choice. IPF functions depend on the entries
that already exist in the system accelerator table.  They must not be altered.
The command value specified in the accelerator table entry must be the same
command value that was specified for the associated action in the menu bar
template.
<P>
If the HMTAILOR.RC file is changed, you must compile it using the resource
compiler and attach it to the executable file. If the executable file is
a DLL, you must call DosLoadModule to load it before calling WinCreateHelpInstance.
Identify the handle to IPF in the hmodAccelActionBarModule field in the
initialization structure. When this field is 0, IPF uses the default menu
bar.
<P>
The HMTAILOR.RC file includes the HMTAILOR.H file.
<P>
<B>Note: </B> When modifying the menu bar, define IDM_HM_MENU and IDD_COVERPAGE_HM_ACCEL
in your help header (.H) file. Also, add the IDs in the idActionBar and
idAccelTable fields in the HELPINIT structure.<!-- lm: 0x2 1 -->
<UL>
<P>


<P><HR>

<A HREF="242_L3_CommandEntryField.html">[Back: Command Entry Field]</A> <BR>
<A HREF="244_L1_CustomizingIPFwithCo.html">[Next: Customizing IPF with Communication Objects]</A> 
</BODY>
</HTML>
