<HTML XPOS=30% YPOS=TOP WIDTH=70% HEIGHT=100%HIDDEN>
<HEAD>
<!-- extra bytes: 03 00 14 1E 00 04 00 11 46 00 64 00 --><TITLE>WinCancelShutdown - Remarks</TITLE>
</HEAD>
<BODY>
<H1>WinCancelShutdown - Remarks</H1><!-- entering slot 110 -->
<P>
On a system shutdown, each message queue normally posts a<A><!-- external link: 1D 97 C7 FC --> WM_QUIT
</A>message. An application can then handle this message in one of the three
ways:<!-- lm: 0x2 3 -->
<UL>
<P>
<LI><!-- lm: 0x2 6 -->Destroy its message queue using WinDestroyMsgQueue
(<I>hmq</I>).<!-- lm: 0x2 3 -->
<P>
<LI><!-- lm: 0x2 6 -->Call WinCancelShutdown (<I>hmq</I>, TRUE) to prevent
the current thread's event queue from receiving the<A><!-- external link: 1D 97 C7 FC --> WM_QUIT
</A>messages when the system is shut down. This does not stop other threads
from receiving this message.<!-- lm: 0x2 3 -->
<P>
<LI><!-- lm: 0x2 6 -->Call WinCancelShutdown (<I>hmq</I>, FALSE) to remove
all pending<A><!-- external link: 1D 97 C7 FC --> WM_QUIT</A> messages from
the current thread's event queue but allow future<A><!-- external link: 1D 97 C7 FC --> WM_QUIT
</A>messages to be posted.<!-- lm: 0x2 1 -->
</UL>
<P>
Either way, the system can proceed to the next queue.

<P><HR>

<A HREF="109_L2H_WinCancelShutdownPar.html">[Back: WinCancelShutdown - Parameters]</A> <BR>
<A HREF="111_L2H_WinCancelShutdownRel.html">[Next: WinCancelShutdown - Related Functions]</A> 
</BODY>
</HTML>
