<HTML XPOS=30% YPOS=TOP WIDTH=70% HEIGHT=100%HIDDEN>
<HEAD>
<META HTTP-EQUIV="CONTENT-TYPE" CONTENT="TEXT/HTML; CHARSET=UTF-8">
<!-- extra bytes: 03 00 14 1E 00 04 00 11 46 00 64 00 --><TITLE>WinDdeInitiate - Example Code</TITLE>
<STYLE>
PRE {
  FONT-FAMILY: Consolas, "Lucida Console", "Courier New", Courier, MONOSPACE;
}
</STYLE>
</HEAD>
<BODY>
<H1>WinDdeInitiate - Example Code</H1><!-- entering slot 459 -->
<P>
This example uses WinDdeInitiate to initiate-during the creation of a client
window-a dynamic data exchange (DDE) conversation with any available server
applications, asking that the server applications respond for each topic
they can support. It also allocates the shared memory that will be used
once the conversation is established.
<PRE>#define INCL_WINDDE             /* Window DDE Functions         */
#define INCL_DOSMEMMGR          /* Memory Manager values        */
#include &lt;os2.h&gt;

BOOL  fSuccess;         /* success indicator                    */
HWND  hwndClient;       /* client window                        */
char  pszAppName[15]="";/* server application                   */
char  pszTopicName[15]="";/* topic                              */
CONVCONTEXT Context;
PDDESTRUCT  pddeData;   /* DDE structure                        */

case WM_CREATE:
     /* issue DDE initialize call */
     fSuccess = WinDdeInitiate(hwndClient, pszAppName,
                               pszTopicName, &amp;Context);

     /* allocate shared memory for conversation data */
     DosAllocSharedMem((PVOID)pddeData,"DDESHAREMEM",
                       sizeof(DDESTRUCT) + 50,
                       PAG_READ | PAG_WRITE | PAG_COMMIT |
                       OBJ_GIVEABLE | OBJ_GETTABLE);
</PRE>


<P><HR>

<A HREF="458_L2H_WinDdeInitiateRelate.html">[Back: WinDdeInitiate - Related Messages]</A> <BR>
<A HREF="460_L2H_WinDdeInitiateTopics.html">[Next: WinDdeInitiate - Topics]</A> 
</BODY>
</HTML>
