<HTML XPOS=30% YPOS=TOP WIDTH=70% HEIGHT=100%HIDDEN>
<HEAD>
<META HTTP-EQUIV="CONTENT-TYPE" CONTENT="TEXT/HTML; CHARSET=UTF-8">
<!-- extra bytes: 03 00 14 1E 00 04 00 11 46 00 64 00 --><TITLE>WinPopupMenu - Parameters</TITLE>
<STYLE>
PRE {
  FONT-FAMILY: Consolas, "Lucida Console", "Courier New", Courier, MONOSPACE;
}
</STYLE>
</HEAD>
<BODY>
<H1>WinPopupMenu - Parameters</H1><!-- entering slot 1698 --><!-- lm: 0x2 1 -->
<UL>
<P>
<B>hwndParent</B> (<A><!-- external link: 1D 1C C8 54 -->HWND</A>) - input
<!-- lm: 0x11 4 -->
<UL>Parent-window handle.<!-- lm: 0x2 1 -->
</UL><!-- lm: 0x2 1 -->
<P>
<B>hwndOwner</B> (<A><!-- external link: 1D 1C C8 54 -->HWND</A>) - input
<!-- lm: 0x11 4 -->
<UL>Owner-window handle.
<P>
The owner window receives all the notification messages generated by the
pop-up menu.<!-- lm: 0x2 1 -->
</UL><!-- lm: 0x2 1 -->
<P>
<B>hwndMenu</B> (<A><!-- external link: 1D 1C C8 54 -->HWND</A>) - input
<!-- lm: 0x11 4 -->
<UL>Pop-up menu-window handle.
<P>
The pop-up menu must have been created, by use of either the <A HREF="327_L2_WinCreateMenu.html">WinCreateMenu
</A>or <A HREF="1419_L2_WinLoadMenu.html">WinLoadMenu</A> functions.<!-- lm: 0x2 1 -->
</UL><!-- lm: 0x2 1 -->
<P>
<B>x</B> (<A><!-- external link: 1D 23 C8 7B -->LONG</A>) - input<!-- lm: 0x11 4 -->
<UL> x-coordinate
of the pop-up menu position.
<P>
The value is in window coordinates relative to the origin of the parent
window.
<P>
The x-coordinate of the origin of the pop-up menu can be affected, if either
of the PU_POSITIONONITEM or PU_HCONSTRAIN values of the<I> fs</I> parameter
is also set.<!-- lm: 0x2 1 -->
</UL><!-- lm: 0x2 1 -->
<P>
<B>y</B> (<A><!-- external link: 1D 23 C8 7B -->LONG</A>) - input<!-- lm: 0x11 4 -->
<UL> y-coordinate
of the pop-up menu position.
<P>
The value is in window coordinates relative to the origin of the parent
window.
<P>
The y-coordinate of the origin of the pop-up menu can be affected, if either
of the PU_POSITIONONITEM or PU_VCONSTRAIN values of the<I> fs</I> parameter
is also set.<!-- lm: 0x2 1 -->
</UL><!-- lm: 0x2 1 -->
<P>
<B>idItem</B> (<A><!-- external link: 1D 23 C8 7B -->LONG</A>) - input<!-- lm: 0x11 4 -->
<UL> Item
identity.
<P>
This is used if either the PU_POSITIONONITEM or PU_SELECTITEM of the<I> fs
</I>parameter is also set. It must be greater or equal to 0 and less or
equal to 0xFFFF.<!-- lm: 0x2 1 -->
</UL><!-- lm: 0x2 1 -->
<P>
<B>fs</B> (<A><!-- external link: 1D 84 C8 D5 -->ULONG</A>) - input<!-- lm: 0x11 4 -->
<UL> Options.
<!-- lm: 0x2 4 -->
<P>
<B>Position</B><!-- lm: 0x11 13 -->
<UL> Pop-up menu position.<!-- lm: 0x2 13 -->
<P>
PU_POSITIONONITEM<!-- lm: 0x11 21 -->
<UL> Position the pop-up menu so that
the item identified by the<I> idItem</I> parameter of the top-level menu
specified by the<I> hwndMenu</I> parameter lies directly under the<I> x
</I>\<I> y</I> coordinates.
<P>
The position of the pop-up menu can be affected, if either the PU_HCONSTRAIN
or or PU_VCONSTRAIN values of the<I> fs</I> parameter is also set.
<P>
This value also causes the pop-up menu item identified by the<I> idItem
</I>to be selected.<!-- lm: 0x2 13 --><!-- lm: 0x2 4 -->
</UL><B> Restrain
</B><!-- lm: 0x11 13 -->
<UL>Pop-up menu position constraints.
<P>
These options allow the application to ensure that the pop-up menu is visible
on the desktop.<!-- lm: 0x2 13 -->
<P>
PU_HCONSTRAIN<!-- lm: 0x11 21 -->
<UL> Constrain the pop-up menu so that
its width is wholly visible on the desktop.
<P>
If necessary the position of the pop-up menu will be adjusted so that its
left edge is coincident with the left edge of the desktop or that its right
edge is coincident with the right edge of the desktop.<!-- lm: 0x2 13 -->
</UL> PU_VCONSTRAIN
<!-- lm: 0x11 21 -->
<UL>Constrain the pop-up menu so that its height is
wholly visible on the desktop.
<P>
If necessary the position of the pop-up menu will be adjusted so that its
top edge is coincident with the top edge of the desktop or that its bottom
edge is coincident with the bottom edge of the desktop.<!-- lm: 0x2 13 --><!-- lm: 0x2 4 -->
</UL><B> InitialState
</B><!-- lm: 0x11 13 -->
<UL>Initial input state of the pop-up menu.
<P>
This allows the user interaction which caused the application to summon
the pop-up menu to be carried through as the initial user interaction with
the pop-up menu.
<P>
For example, this permits the application to support the user interface
in which mouse button 1 can be depressed to cause the pop-up menu to be
presented and held down while moving the mouse over the menu in order to
select another menu item and then released to dismiss the menu.
<P>
Only one of the following values can be selected:<!-- lm: 0x2 13 -->
<P>
PU_MOUSEBUTTON1DOWN<!-- lm: 0x11 21 -->
<UL> The pop-up menu is initialized
with mouse button 1 depressed.<!-- lm: 0x2 13 -->
</UL> PU_MOUSEBUTTON2DOWN
<!-- lm: 0x11 21 -->
<UL>The pop-up menu is initialized with mouse button
2 depressed.<!-- lm: 0x2 13 -->
</UL> PU_MOUSEBUTTON3DOWN<!-- lm: 0x11 21 -->
<UL> The
pop-up menu is initialized with mouse button 3 depressed.<!-- lm: 0x2 13 -->
</UL> PU_NONE
<!-- lm: 0x11 21 -->
<UL>The pop-up menu is to be presented uninfluenced
by the user interaction which caused it to be summoned.
<P>
This is the default value.<!-- lm: 0x2 13 --><!-- lm: 0x2 4 -->
</UL><B> Select
</B><!-- lm: 0x11 13 -->
<UL>Item selection.<!-- lm: 0x2 13 -->
<P>
PU_SELECTITEM<!-- lm: 0x11 21 -->
<UL> The item identified by<I> idItem
</I>is to be selected. This is only valid if PU_NONE is set in the<I> InitialState
</I>parameter.
<P>
If the identified item is in a submenu of the pop-up menu, then all the
previous submenus in the menu hierarchy are presented with the correct path
to the identified item.<!-- lm: 0x2 13 --><!-- lm: 0x2 4 -->
</UL><B> Usage
</B><!-- lm: 0x11 13 -->
<UL>Input device usage.
<P>
The window procedure controlling the pop-up menu must be informed of which
input devices are available for interaction with the pop-up menu.
<P>
These options are independent to those of the<I> InitialState</I> parameter.
Therefore, if an application indicates in the<I> InitialState</I> parameter
that the pop-up menu is to be initialized with a particular user interaction,
then the mechanism which permits that user interaction would usually be
specified in this parameter. In this way the user's expectation, that once
a device has been employed for the manipulation of the pop-up menu then
that device can continue to be used for that purpose, is fulfilled.
<P>
It is valid to specify a user interaction as an initialization of the pop-up
menu by an input mechanism which is not identified as available for interaction
with the pop-up menu. This implies that the user cannot necessarily complete
the interaction with the pop-up menu with that input mechanism.
<P>
For example, if a pop-up menu is initialized with a mouse button depressed
but that mouse button is not identified as available for manipulating the
pop-up menu, then that mouse button can manipulate the pop-up menu until
it is released. Assuming that the pop-up menu is not dismissed when that
mouse button is released, then the mouse button cannot be used for further
interaction with the pop-up menu, since it is not identified as available
for that use.
<P>
The following list shows the input device valid for interaction with the
pop-up menu with each option:<!-- lm: 0x2 13 -->
<P>
PU_KEYBOARD<!-- lm: 0x11 21 -->
<UL> The keyboard.<!-- lm: 0x2 13 -->
</UL>PU_MOUSEBUTTON1<!-- lm: 0x11 21 -->
<UL> Mouse button 1.<!-- lm: 0x2 13 -->
</UL>PU_MOUSEBUTTON2<!-- lm: 0x11 21 -->
<UL> Mouse button 2.<!-- lm: 0x2 13 -->
</UL>PU_MOUSEBUTTON3<!-- lm: 0x11 21 -->
<UL> Mouse button 3.<!-- lm: 0x2 13 --><!-- lm: 0x2 4 --><!-- lm: 0x2 1 -->
</UL><!-- lm: 0x2 1 -->
<P>
<B>rc</B> (<A><!-- external link: 1D C7 C7 1D -->BOOL</A>) - returns<!-- lm: 0x11 4 -->
<UL> Pop-up
menu invoked indicator.
<P>
This function returns as<!-- entering slot 1699 --> soon as the pop-up menu
has been invoked, which might be before the user has completed interacting
with the pop-up menu.<!-- lm: 0x2 4 -->
<P>
TRUE<!-- lm: 0x11 12 -->
<UL> Pop-up menu successfully invoked<!-- lm: 0x2 4 -->
</UL>FALSE<!-- lm: 0x11 12 -->
<UL> Pop-up menu not successfully invoked.
<!-- lm: 0x2 4 --><!-- lm: 0x2 1 -->
</UL>

<P><HR>

<A HREF="1696_L2H_WinPopupMenuReturnVa.html">[Back: WinPopupMenu Return Value - rc]</A> <BR>
<A HREF="1698_L2H_WinPopupMenuRemarks.html">[Next: WinPopupMenu - Remarks]</A> 
</BODY>
</HTML>
