<HTML XPOS=30% YPOS=TOP WIDTH=70% HEIGHT=100%HIDDEN>
<HEAD>
<!-- extra bytes: 03 00 14 1E 00 04 00 11 46 00 64 00 --><TITLE>WinGetLastError - Remarks</TITLE>
</HEAD>
<BODY>
<H1>WinGetLastError - Remarks</H1><!-- entering slot 1047 -->
<P>
Returns the last nonzero error code, and sets the error code to zero.
<P>
The current error code is reset to zero.
<P>
In multiple thread applications where there are multiple anchor blocks,
errors are stored in the anchor block created by the <A HREF="1148_L2_WinInitialize.html">WinInitialize
</A>function of the thread invoking a call. The last error for the process
and thread on which this function call is made will be returned.
<P>
The returned error code is a 32-bit quantity. The high order 16 bits is
a severity code. The low order 16 bits is the error code.
<P>
The severity codes are defined as follows:
<PRE>
#define SEVERITY_NOERROR            0x0000
#define SEVERITY_WARNING            0x0004
#define SEVERITY_ERROR              0x0008
#define SEVERITY_SEVERE             0x000C
#define SEVERITY_UNRECOVERABLE      0x0010

</PRE>

<P>
Error codes are described in
<P>
Two macros have been defined to simplify extracting severity codes and error
codes from the returned ERRORID value.
<PRE>
/* Extract severity from an errorid */
#define ERRORIDSEV(errid)              (HIUSHORT(errid))

/* Extract error number from an errorid */
#define ERRORIDERROR(errid)            (LOUSHORT(errid))

</PRE>


<P><HR>

<A HREF="1045_L2H_WinGetLastErrorParam.html">[Back: WinGetLastError - Parameters]</A> <BR>
<A HREF="1047_L2H_WinGetLastErrorRelat.html">[Next: WinGetLastError - Related Functions]</A> 
</BODY>
</HTML>
