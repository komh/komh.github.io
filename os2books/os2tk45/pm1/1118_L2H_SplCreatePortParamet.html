<HTML XPOS=30% YPOS=TOP WIDTH=70% HEIGHT=100%HIDDEN>
<HEAD>
<!-- extra bytes: 03 00 14 1E 00 04 00 11 46 00 64 00 --><TITLE>SplCreatePort - Parameters</TITLE>
</HEAD>
<BODY>
<H1>SplCreatePort - Parameters</H1><!-- entering slot 1129 --><!-- lm: 0x2 1 -->
<UL>
<P>
<B>pszComputerName</B> (<A><!-- external link: 1D 5E C8 70 -->PSZ</A>) -
input<!-- lm: 0x11 4 -->
<UL> Name of computer where port is to be installed.

<P>
A NULL string is used for installing a port on the local machine. This parameter
currently must be NULL.<!-- lm: 0x2 1 -->
</UL><!-- lm: 0x2 1 -->
<P>
<B>pszPortName</B> (<A><!-- external link: 1D 5E C8 70 -->PSZ</A>) - input
<!-- lm: 0x11 4 -->
<UL>Name of printer port to install.
<P>
This port, virtual or regular, must not already exist. Following is an example
of a port name:  LPT5<!-- lm: 0x2 1 -->
</UL><!-- lm: 0x2 1 -->
<P>
<B>pszPortDriver</B> (<A><!-- external link: 1D 5E C8 70 -->PSZ</A>) - input
<!-- lm: 0x11 4 -->
<UL>Name of the port driver assigned to this port.
<P>
If not NULL, this field must specify an installed port driver; it is case-sensitive.
Following is an example of a port driver:  PARALLEL<!-- lm: 0x2 1 -->
</UL><!-- lm: 0x2 1 -->
<P>
<B>ulVersion</B> (<A><!-- external link: 1D 84 C8 97 -->ULONG</A>) - input
<!-- lm: 0x11 4 -->
<UL>Version of port to create.
<P>
Values are as follows:<!-- lm: 0x2 4 -->
<P>
SPLPORT_VERSION_REGULAR - 0<!-- lm: 0x11 19 -->
<UL> Creates normal printer
port that can be connected to a print queue. This port will remain after
a reboot.<!-- lm: 0x2 4 -->
</UL> SPLPORT_VERSION_VIRTUAL - 1<!-- lm: 0x11 19 -->
<UL> Creates
a virtual printer port that can only be used for querying and setting. This
port exists only until the spooler is disabled or the machine is rebooted.
<!-- lm: 0x2 4 --><!-- lm: 0x2 1 -->
</UL><!-- lm: 0x2 1 -->
<P>
<B>pBuf</B> (<A><!-- external link: 1D 5F C8 74 -->PVOID</A>) - input<!-- lm: 0x11 4 -->
<UL> Port-driver-specific
buffer.
<P>
If SPLPORT_VERSION_VIRTUAL is set, this is a port-driver-specific buffer
that contains information necessary for the port driver to set up a virtual
connection to the printer. There cannot be any imbedded pointers in this
buffer. This buffer wil be passed to the port driver with the BIDI_ADD_VIRTUAL_PORT
command.<!-- lm: 0x2 1 -->
</UL><!-- lm: 0x2 1 -->
<P>
<B>cbBuf</B> (<A><!-- external link: 1D 84 C8 97 -->ULONG</A>) - input<!-- lm: 0x11 4 -->
<UL> Length
of the data in<I> pBuf,</I> in bytes.<!-- lm: 0x2 1 -->
</UL><!-- lm: 0x2 1 -->
<P>
<B>rc</B> (<A><!-- external link: 1D 84 C8 97 -->ULONG</A>) - returns<!-- lm: 0x11 4 -->
<UL> Return
codes.
<P>
<!-- lm: 0x2 4 -->
<P>
<LI><!-- lm: 0x2 19 -->Success<!-- lm: 0x2 4 --><!-- lm: 0x2 4 -->
<P>
ERROR_DEVICE_IN_USE(99)<!-- lm: 0x11 19 -->
<UL> Port name is already defined.
<!-- lm: 0x2 4 -->
</UL>ERROR_FILE_NOT_FOUND(2)<!-- lm: 0x11 19 -->
<UL> Port
driver name is not valid.<!-- lm: 0x2 4 -->
</UL> ERROR_INVALID_LEVEL(124)
<!-- lm: 0x11 19 -->
<UL><I>ulVersion</I> is not 0 or 1.<!-- lm: 0x2 4 -->
</UL> ERROR_INVALID_PARAMETER(87)
<!-- lm: 0x11 19 -->
<UL>An invalid buffer was given.<!-- lm: 0x2 4 -->
</UL> ERROR_NOT_ENOUGH_MEMORY(8)
<!-- lm: 0x11 19 -->
<UL>Not enough memory to satisfy request.<!-- lm: 0x2 4 -->
</UL> ERROR_NOT_SUPPORTED(50)
<!-- lm: 0x11 19 -->
<UL><I>pszComputerName</I> is not supported, or the
port driver does not support the virtual port.<!-- lm: 0x2 4 -->
</UL> PMERR_SPL_SPOOLER_NOT_INSTALLED(0x4009)
<!-- lm: 0x11 19 -->
<UL>Spooler not enabled; virtual ports require spooler
to be enabled.<!-- lm: 0x2 4 --><!-- lm: 0x2 1 -->
</UL>

<P><HR>

<A HREF="1117_L2H_SplCreatePortReturnV.html">[Back: SplCreatePort Return Value - rc]</A> <BR>
<A HREF="1119_L2H_SplCreatePortRemarks.html">[Next: SplCreatePort - Remarks]</A> 
</BODY>
</HTML>
