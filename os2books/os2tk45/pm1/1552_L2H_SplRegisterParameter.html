<HTML XPOS=30% YPOS=TOP WIDTH=70% HEIGHT=100%HIDDEN>
<HEAD>
<!-- extra bytes: 03 00 14 1E 00 04 00 11 46 00 64 00 --><TITLE>SplRegister - Parameters</TITLE>
</HEAD>
<BODY>
<H1>SplRegister - Parameters</H1><!-- entering slot 1564 --><!-- lm: 0x2 1 -->
<UL>
<P>
<B>pszComputerName</B> (<A><!-- external link: 1D 5E C8 BA -->PSZ</A>) -
input<!-- lm: 0x11 4 -->
<UL> Printer server name to register for alert
notification.
<P>
The field is used by an application running on a client machine to register
for alerts on a print server. To register locally, this field must be NULL.
<!-- lm: 0x2 1 -->
</UL><!-- lm: 0x2 1 -->
<P>
<B>pszName</B> (<A><!-- external link: 1D 5E C8 BA -->PSZ</A>) - input<!-- lm: 0x11 4 -->
<UL> Case-sensitive
name of printer port to register for alerts.
<P>
This value can be a virtual port name.<!-- lm: 0x2 1 -->
</UL><!-- lm: 0x2 1 -->
<P>
<B>hwndNotify</B> (<A><!-- external link: 1D 1C C8 70 -->HWND</A>) - input
<!-- lm: 0x11 4 -->
<UL>Window handle to get notify messages.
<P>
The message posted is as follows:
<PRE>Message ID is WM_SPOOLER_ALERT(0x00d8)</PRE>

<P>
<B>MP1</B> will define the type of alert as follows:
<PRE>/* Alert type - SHORT1FROMMP(MP1) bits 0-7 */
#define SPLMSG_SPECIAL_ALERT          0x00FC
#define SPLMSG_EXTENDED_ALERT         0x00FD
#define SPLMSG_CORE_ALERT_MASK        0x00FF

/* Extended alert type - SHORT1FROMMP(MP1) bits 8-15 */
#define SPLMSG_EXTENDED_TYPE_MASK     0xFF00

</PRE>

<P>
If the object type is SPLMSG_EXTENDED_ALERT, then this is an extended alert.
The extended alert category is SHORT2FROMMP(MP1). The type of alert in the
given extended alert category is SHORT1FROMMP(MP1) bits 8-15. This limits
the notification given to applications registered for extended alerts to
only the specific categories that are 0xFFFF or less and to only category
types that are 0xFF or less.
<P>
If the object type is SPLMSG_SPECIAL_ALERT, then this is a special alert
generated by the spooler and SHORT2FROMMP(MP1) will contain one of the following
messages:<!-- lm: 0x2 4 -->
<P>
SPLMSG_CONNECTION_LOST - 0x0002<!-- lm: 0x11 19 -->
<UL> Connection to computer
terminated; all alerts disabled for given computer.<!-- lm: 0x2 4 -->
</UL> SPLMSG_PORT_TERMINATED
- 0x0003<!-- lm: 0x11 19 -->
<UL> Registration terminated for port.<!-- lm: 0x2 4 -->
</UL> SPLMSG_SPOOLER_DISABLED
- 0x0001<!-- lm: 0x11 19 -->
<UL> Spooler disabled; all alerts for given
computer are disabled.<!-- lm: 0x2 4 -->
</UL> If the object type is less
than SPLMSG_SPECIAL_ALERT(0xFC), then this is a core alert. The specific
core alert posted will be: SHORT1FROMMP(MP1) bits 0-7(SPLMSG_CORE_ALERT_MASK)
<BR>

<P>
If the core alert is PRTALERT_TYPE_PAGE_PRINTED(9), then SHORT1FROMMP(MP1)
bits 8-15(SPLMSG_PAGE_PRINTED_MASK) will be the page number printed. If
the page number is above 255, the value hex 'FF' will be put in this byte
field.
<P>
If the core alert is<B> not</B> PRTALERT_TYPE_PAGE_PRINTED(9), then SHORT1FROMMP(MP1)
bits 8-15(SPLMSG_CORE_SEVERITY_MASK) will be the severity of the alert.
SHORT2FROMMP(MP1) will be the spooler job ID if this is a core alert for
a print job.
<P>
The core alert type will be one of the following:<!-- lm: 0x2 9 -->
<UL>
<P>
Value<!-- lm: 0x2 19 -->
<UL> Description<!-- lm: 0x2 4 -->
</UL> 1<!-- lm: 0x2 19 -->
<UL> PRTALERT_TYPE_INPUT

<BR>
Input alert (Example: out of paper).<!-- lm: 0x2 4 -->
</UL> 2<!-- lm: 0x2 19 -->
<UL> PRTALERT_TYPE_OUTPUT

<BR>
Output alert (Example: output bin full).<!-- lm: 0x2 4 -->
</UL> 3<!-- lm: 0x2 19 -->
<UL> PRTALERT_TYPE_JAM

<BR>
Paper jam alert.<!-- lm: 0x2 4 -->
</UL> 4<!-- lm: 0x2 19 -->
<UL> PRTALERT_TYPE_OPERATOR

<BR>
Operator intervention required (Example: print ribbon jam).<!-- lm: 0x2 4 -->
</UL> 5
<!-- lm: 0x2 19 -->
<UL>PRTALERT_TYPE_CONFIG_CHANGE
<BR>
Configuration changed (Example: cartridge removed).<!-- lm: 0x2 4 -->
</UL> 6
<!-- lm: 0x2 19 -->
<UL>PRTALERT_TYPE_SUPPLIES Supplies alert (Example:
out of toner).<!-- lm: 0x2 4 -->
</UL> 7<!-- lm: 0x2 19 -->
<UL> PRTALERT_TYPE_JOB_START

<BR>
Job started printing.<!-- lm: 0x2 4 -->
</UL> 8<!-- lm: 0x2 19 -->
<UL> PRTALERT_TYPE_JOB_STACKED

<BR>
Job completed and stacked.<!-- lm: 0x2 4 -->
</UL> 9<!-- lm: 0x2 19 -->
<UL> PRTALERT_TYPE_PAGE_PRINTED

<BR>
Page printed.<!-- lm: 0x2 4 -->
</UL> 10<!-- lm: 0x2 19 -->
<UL> PRTALERT_TYPE_JOB_CANCELLED

<BR>
Job cancelled inside printer.<!-- lm: 0x2 4 -->
</UL> 11<!-- lm: 0x2 19 -->
<UL> PRTALERT_TYPE_JOB_HELD

<BR>
Job held inside printer.<!-- lm: 0x2 4 -->
</UL> 12<!-- lm: 0x2 19 -->
<UL> PRTALERT_TYPE_COVER_OPEN

<BR>
Cover or panel open.<!-- lm: 0x2 4 -->
</UL> 13<!-- lm: 0x2 19 -->
<UL> PRTALERT_TYPE_POWER_ON

<BR>
Printer powered on.<!-- lm: 0x2 4 -->
</UL> 14<!-- lm: 0x2 19 -->
<UL> PRTALERT_TYPE_RESET

<BR>
Printer reset.<!-- lm: 0x2 4 -->
</UL> 15<!-- lm: 0x2 19 -->
<UL> PRTALERT_TYPE_ONLINE

<BR>
Printer now online.<!-- lm: 0x2 4 -->
</UL> 16<!-- lm: 0x2 19 -->
<UL> PRTALERT_TYPE_OFFLINE

<BR>
Printer now offline.<!-- lm: 0x2 4 -->
</UL> 17<!-- lm: 0x2 19 -->
<UL> PRTALERT_TYPE_TIMED_ALERT

<BR>
Timed alert.<!-- lm: 0x2 4 -->
</UL> 18<!-- lm: 0x2 19 -->
<UL> PRTALERT_TYPE_COMMUNICATION_PROBLEM

<BR>
Communication problem.<!-- lm: 0x2 4 -->
</UL> 19<!-- lm: 0x2 19 -->
<UL> PRTALERT_TYPE_COMM_STATUS_CHANGED

<BR>
Communication status changed.<!-- entering slot 1565 --> BIDI_Q_PORT should
be issued to get current state.<!-- lm: 0x2 4 -->
</UL> 0xFF<!-- lm: 0x2 19 -->
<UL> PRTALERT_TYPE_OTHER

<BR>
Other alert type (0xFFFFFFFF).<!-- lm: 0x2 4 -->
</UL> The severity of the
problem will be one of the following:<!-- lm: 0x2 9 -->
<UL>
<P>
Value<!-- lm: 0x2 19 -->
<UL> Description<!-- lm: 0x2 4 -->
</UL> 00<!-- lm: 0x2 19 -->
<UL> PRTALERT_SEV_INFORMATIONAL
<!-- lm: 0x2 4 -->
</UL>01<!-- lm: 0x2 19 -->
<UL> PRTALERT_SEV_WARNING
<!-- lm: 0x2 4 -->
</UL>02<!-- lm: 0x2 19 -->
<UL> PRTALERT_SEV_ERROR
<BR>
Printing stopped due to error.<!-- lm: 0x2 4 -->
</UL> 03<!-- lm: 0x2 19 -->
<UL> PRTALERT_SEV_SERVICE

<BR>
Service is required.<!-- lm: 0x2 4 -->
</UL> 04 - FD<!-- lm: 0x2 19 -->
<UL> Reserved
<!-- lm: 0x2 4 -->
</UL>FE<!-- lm: 0x2 19 -->
<UL> PRTALERT_SEV_OTHER
<BR>
Other (0xFE)<!-- lm: 0x2 4 -->
</UL> FF<!-- lm: 0x2 19 -->
<UL> PRTALERT_SEV_UNKNOWN

<BR>
Unknown (0xFF)<!-- lm: 0x2 4 -->
</UL><B> MP2</B> contents are as follows:
SHORT1FROMMP(MP1) is the atomized print server name.
<BR>
If the notification is from the local spooler, this value will be zero.
<BR>

<BR>
SHORT2FROMMP(MP2) is the atomized print queue name when the
<BR>
message involves a print job (alert values 7 - 11);
<BR>
otherwise, it will be the atomized printer port name, if applicable.
<BR>
<!-- lm: 0x2 1 -->
</UL><!-- lm: 0x2 1 -->
<P>
<B>ulCategory</B> (<A><!-- external link: 1D 84 C8 E7 -->ULONG</A>) - input
<!-- lm: 0x11 4 -->
<UL>Category of alert to register.
<P>
This value can be the core alert category or an extended alert category
as defined below:<!-- lm: 0x2 4 -->
<P>
PRTALERT_CATEGORY_CORE - 0x00000001<!-- lm: 0x11 19 -->
<UL> Core alert
category<!-- lm: 0x2 4 -->
</UL> PRTALERT_CATEGORY_EXTENDED - 0x0000D000
<!-- lm: 0x11 19 -->
<UL>Beginning of the extended alert categories. Protocol
converters should limit the category range to between 0x0000D000 and 0x0000DFFFF.
<!-- lm: 0x2 4 -->
</UL>PRTALERT_CATEGORY_EXT_MAX - 0x0000DFFF<!-- lm: 0x11 19 -->
<UL> End
of the extended alert categories.<!-- lm: 0x2 4 -->
</UL> If the protocol
converter does not support the given category, ERROR_INVALID_CATEGORY(117)
is returned.<!-- lm: 0x2 1 -->
</UL><!-- lm: 0x2 1 -->
<P>
<B>ulType</B> (<A><!-- external link: 1D 84 C8 E7 -->ULONG</A>) - input
<!-- lm: 0x11 4 -->
<UL>Type of alert to enable for the given category.

<P>
If the category is PRTALERT_CATEGORY_CORE, this is a bit-field that defines
the additional core alerts to enable. The core alerts corresponding to the
bits set in the<I> ulType</I> field will be enabled, in addition to any
currently enabled core alerts. If the protocol converter does not understand
one of the bits that are set, ERROR_INVALID_FLAG_NUMBER(186) should be returned.

<P>
If the printer is not capable of setting one of the core alerts whose bit
is set, and if any core alerts can be enabled, a Success return code should
be returned.
<P>
If the category is<B> not</B> PRTALERT_CATEGORY_CORE, then this is a value
that defines the specific extended alert to enable.
<P>
Bit defintions for core alerts are as follows:<!-- lm: 0x2 9 -->
<UL>
<P>
Bit<!-- lm: 0x2 19 -->
<UL> Description<!-- lm: 0x2 4 -->
</UL> 0<!-- lm: 0x2 19 -->
<UL> PRTALERT_CORE_INPUT
- 0x00000001 Input alert (Example: out of paper).<!-- lm: 0x2 4 -->
</UL> 1
<!-- lm: 0x2 19 -->
<UL>PRTALERT_CORE_OUTPUT - 0x00000002
<BR>
Output alert (Example: output bin is full).<!-- lm: 0x2 4 -->
</UL> 2<!-- lm: 0x2 19 -->
<UL> PRTALERT_CORE_JAM
- 0x00000004
<BR>
Paper jam alert.<!-- lm: 0x2 4 -->
</UL> 3<!-- lm: 0x2 19 -->
<UL> PRTALERT_CORE_OPERATOR
- 0x00000008
<BR>
Operator intervention required (Example: print ribbon jam).<!-- lm: 0x2 4 -->
</UL> 4
<!-- lm: 0x2 19 -->
<UL>PRTALERT_CORE_CONFIG_CHANGE - 0x00000010
<BR>
Configuration changed (Example: cartridge removed).<!-- lm: 0x2 4 -->
</UL> 5
<!-- lm: 0x2 19 -->
<UL>PRTALERT_CORE_SUPPLIES - 0x00000020
<BR>
Supplies alert (Example: out of toner).<!-- lm: 0x2 4 -->
</UL> 6<!-- lm: 0x2 19 -->
<UL> PRTALERT_CORE_JOB_START
- 0x00000040
<BR>
Job started printing.<!-- lm: 0x2 4 -->
</UL> 7<!-- lm: 0x2 19 -->
<UL> PRTALERT_CORE_JOB_STACKED
- 0x00000080
<BR>
Job completed and stacked.<!-- lm: 0x2 4 -->
</UL> 8<!-- lm: 0x2 19 -->
<UL> PRTALERT_CORE_PAGE_PRINTED
- 0x00000100
<BR>
Page printed.<!-- lm: 0x2 4 -->
</UL> 9<!-- lm: 0x2 19 -->
<UL> PRTALERT_CORE_JOB_CANCELLED
- 0x00000200
<BR>
Job cancelled inside printer.<!-- lm: 0x2 4 -->
</UL> 10<!-- lm: 0x2 19 -->
<UL> PRTALERT_CORE_JOB_HELD
- 0x00000400
<BR>
Job held inside printer.<!-- lm: 0x2 4 -->
</UL> 11<!-- lm: 0x2 19 -->
<UL> PRTALERT_CORE_COVER_OPEN
- 0x00000800
<BR>
Cover or panel open.<!-- lm: 0x2 4 -->
</UL> 12<!-- lm: 0x2 19 -->
<UL> PRTALERT_CORE_POWER_ON
- 0x00001000
<BR>
Printer powered on.<!-- lm: 0x2 4 -->
</UL><!-- entering slot 1566 --> 13
<!-- lm: 0x2 19 -->
<UL>PRTALERT_CORE_RESET - 0x00002000
<BR>
Printer reset.<!-- lm: 0x2 4 -->
</UL> 14<!-- lm: 0x2 19 -->
<UL> PRTALERT_CORE_ONLINE
- 0x00004000
<BR>
Printer now online.<!-- lm: 0x2 4 -->
</UL> 15<!-- lm: 0x2 19 -->
<UL> PRTALERT_CORE_OFFLINE
- 0x00008000
<BR>
Printer now offline.<!-- lm: 0x2 4 -->
</UL> 16<!-- lm: 0x2 19 -->
<UL> PRTALERT_CORE_TIMED_ALERT
- 0x00010000
<BR>
Timed alert.<!-- lm: 0x2 4 -->
</UL> 17<!-- lm: 0x2 19 -->
<UL> PRTALERT_CORE_COMMUNICATION_PROBLEM
- 0x00020000
<BR>
Communication problem.<!-- lm: 0x2 4 -->
</UL> 18<!-- lm: 0x2 19 -->
<UL> PRTALERT_CORE_COMM_STATUS_CHANGED
- 0x00040000
<BR>
Communication status changed.<!-- lm: 0x2 4 --><!-- lm: 0x2 1 -->
</UL><!-- lm: 0x2 1 -->
<P>
<B>pulHandle</B> (<A><!-- external link: 1D 84 C8 61 -->PULONG</A>) - in/out
<!-- lm: 0x11 4 -->
<UL>Pointer to spooler alert handle.
<P>
For initial registration, the value pointed to by this parameter should
be 0 (zero). If an application wants to make better use of spooler resources,
the application can use the same returned spooler handle for all of its
alert registration.<!-- lm: 0x2 1 -->
</UL><!-- lm: 0x2 1 -->
<P>
<B>rc</B> (<A><!-- external link: 1D 84 C8 7D -->ULONG</A>) - returns<!-- lm: 0x11 4 -->
<UL> Return
codes.
<P>
<!-- lm: 0x2 4 -->
<P>
<LI><!-- lm: 0x2 19 -->Success<!-- lm: 0x2 4 --><!-- lm: 0x2 4 -->
<P>
ERROR_INVALID_CATEGORY(117)<!-- lm: 0x11 19 -->
<UL> The protocol converter
does not support the extended alert category.<!-- lm: 0x2 4 -->
</UL> ERROR_INVALID_FLAG_NUMBER(186)
<!-- lm: 0x11 19 -->
<UL>The protocol converter did not understand a core
alert that was set.<!-- lm: 0x2 4 -->
</UL> ERROR_INVALID_HANDLE(6)<!-- lm: 0x11 19 -->
<UL> The
value pointed to by<I> pulHandle</I> is not a valid spooler alert handle.
The value at<I> *pulHandle</I> should be set to 0 (zero) to allocate a new
spooler alert handle.<!-- lm: 0x2 4 -->
</UL> ERROR_INVALID_PARAMETER(87)
<!-- lm: 0x11 19 -->
<UL>An invalid buffer given.<!-- lm: 0x2 4 -->
</UL> ERROR_NOT_SUPPORTED(50)
<!-- lm: 0x11 19 -->
<UL>The spooler on the given print server cannot support
alert notification.<!-- lm: 0x2 4 -->
</UL> PMERR_SPL_SPOOLER_NOT_INSTALLED(0x4009)
<!-- lm: 0x11 19 -->
<UL>The spooler is not enabled.<!-- lm: 0x2 4 --><!-- lm: 0x2 1 -->
</UL>

<P><HR>

<A HREF="1551_L2H_SplRegisterReturnVal.html">[Back: SplRegister Return Value - rc]</A> <BR>
<A HREF="1553_L2H_SplRegisterRemarks.html">[Next: SplRegister - Remarks]</A> 
</BODY>
</HTML>
