<HTML XPOS=30% YPOS=TOP WIDTH=70% HEIGHT=100%HIDDEN>
<HEAD>
<META HTTP-EQUIV="CONTENT-TYPE" CONTENT="TEXT/HTML; CHARSET=UTF-8">
<!-- extra bytes: 03 00 14 1E 00 04 00 11 46 00 64 00 --><TITLE>DrgVerifyTypeSet - Example Code</TITLE>
<STYLE>
PRE {
  FONT-FAMILY: Consolas, "Lucida Console", "Courier New", Courier, MONOSPACE;
}
</STYLE>
</HEAD>
<BODY>
<H1>DrgVerifyTypeSet - Example Code</H1><!-- entering slot 560 -->
<P>
In this example, the DrgVerifyTypeSet function is used to determine whether
DRT_TEXT is among the types associated with the object. If it is, the drop
is accepted.
<PRE>#define INCL_WINSTDDRAG  /* Direct Manipulation (Drag) Functions */
#include &lt;OS2.H&gt;
#include &lt;stdio.h&gt;
BOOL     flResult;
DRAGITEM pditem;
char     szBuffer[32];

case DM_DRAGOVER:

   flResult = DrgVerifyTypeSet(&amp;pditem,
                               DRT_TEXT,
                               sizeof(szBuffer),
                               szBuffer);

   flResult = strcmp(szBuffer,DRT_TEXT);

   /**************************************************************/
   /* See if the object is an OS/2 file as well as being of text */
   /* format.  AND result flag with previous result flag to get  */
   /* the "effective" return code.                               */
   /**************************************************************/

   flResult = DrgVerifyRMF(&amp;pditem,"DRM_OS2FILE","DRF_TEXT");

   /**************************************************************/
   /* See if DRT_TEXT is the true type of the object             */
   /**************************************************************/

   flResult = DrgVerifyTrueType(&amp;pditem,"DRF_TEXT");

   if(!flResult)

   /**************************************************************/
   /* Inform the application that you will accept the drop       */
   /**************************************************************/

   return(MRFROM2SHORT(DOR_DROP, DO_COPY));
   break;
</PRE>


<P><HR>

<A HREF="551_L2H_DrgVerifyTypeSetRela.html">[Back: DrgVerifyTypeSet - Related Functions]</A> <BR>
<A HREF="553_L2H_DrgVerifyTypeSetTopi.html">[Next: DrgVerifyTypeSet - Topics]</A> 
</BODY>
</HTML>
