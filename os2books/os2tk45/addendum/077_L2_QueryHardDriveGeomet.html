<HTML>
<HEAD>
<META HTTP-EQUIV="CONTENT-TYPE" CONTENT="TEXT/HTML; CHARSET=UTF-8">
<TITLE>Query Hard Drive Geometry and Physical ParametersOEMHLP_QUERYDISKINFO (0Eh)</TITLE>
</HEAD>
<BODY>
<H1>Query Hard Drive Geometry and Physical ParametersOEMHLP_QUERYDISKINFO (0Eh)</H1><!-- entering slot 119 -->
<P>
<B>Purpose</B> 
<P>
 This function returns geometry and physical parameters about the specified
physical hard disk, if available. This information is acquired from BIOS
via INT 13h function 48h at system boot.
<P>
<B>Parameter Packet Format</B>
<PRE>Field                            Length
Drive Number                     BYTE
</PRE>
<!-- lm: 0x2 1 -->
<UL>
<P>
Drive Number<!-- lm: 0x11 6 -->
<UL> The BIOS drive number for which geometry
and physical parameters are requested. The value must be 80h or greater.
<!-- lm: 0x2 1 -->
</UL>
<P>
<B>Data Packet Format</B>
<PRE>Field                                     LengthReserved                                  WORD
Information Flags                         WORD
Number of Physical Cylinders              DWORD
Number of Physical Heads                  DWORD
Number of Sectors Per Track               DWORD
Number of Physical Sectors                QWORD
Number of Bytes in a Sector               WORD
Reserved                                  DWORD
I/O Port Base Address                     WORD
Control Port Address                      WORD
Head Register Upper Nibble                BYTE
Reserved                                  BYTE
IRQ Information                           BYTE
Block Count for ATA R/W Multiple          BYTE
DMA Information                           BYTE
PIO Information                           BYTE
BIOS Selected Hardware Option Flags       WORD
Reserved                                  WORD
DPT Extension Revision                    BYTE
</PRE>
<!-- lm: 0x2 1 -->
<P>
Information Flags<!-- lm: 0x11 6 -->
<UL> Bits are defined as follows <!-- lm: 0x2 6 -->
<P>
Bit<!-- lm: 0x2 21 -->
<UL> Description<!-- lm: 0x2 6 -->
</UL> 0<!-- lm: 0x2 21 -->
<UL> DMA
boundary errors are handled transparently<!-- lm: 0x2 6 -->
</UL> 1<!-- lm: 0x2 21 -->
<UL> The
geometry returned in bytes 4 15 is valid<!-- lm: 0x2 6 -->
</UL> 2<!-- lm: 0x2 21 -->
<UL> Media
is removable. Bits 4 6 are not valid if this bit is 0<!-- lm: 0x2 6 -->
</UL> 3
<!-- lm: 0x2 21 -->
<UL>Device supports write verify<!-- lm: 0x2 6 -->
</UL> 4
<!-- lm: 0x2 21 -->
<UL>Device has media change notification<!-- lm: 0x2 6 -->
</UL> 5
<!-- lm: 0x2 21 -->
<UL>Media is lockable<!-- lm: 0x2 6 -->
</UL> 6<!-- lm: 0x2 21 -->
<UL> Device
geometry is set to maximum and no media is present when this bit is set
to 1.<!-- lm: 0x2 6 -->
</UL> 7 15<!-- lm: 0x2 21 -->
<UL> Reserved<!-- lm: 0x2 6 --><!-- lm: 0x2 1 -->
</UL> Number
of Physical Cylinders<!-- lm: 0x11 6 -->
<UL> The number of physical cylinders
on the physical drive. This field is valid only if BIT 1 of the information
flags is set to 1.<!-- lm: 0x2 1 -->
</UL> Number of Physical Heads<!-- lm: 0x11 6 -->
<UL> The
number of physical heads on the physical drive. This field is valid only
if BIT 1 of the information flags is set to 1.<!-- lm: 0x2 1 -->
</UL> Number
of Sectors Per Track<!-- lm: 0x11 6 -->
<UL> The number of sectors per track
on the physical drive. This field is valid only if BIT 1 of the information
flags is set to 1.<!-- lm: 0x2 1 -->
</UL> Number of Physical Sectors<!-- lm: 0x11 6 -->
<UL> The
number of physical sectors on the physical drive.<!-- lm: 0x2 1 -->
</UL> Number
of Bytes in a Sector<!-- lm: 0x11 6 -->
<UL> The number of bytes per sector
on the physical drive.<!-- lm: 0x2 1 -->
</UL> I/O Port Base Address<!-- lm: 0x11 6 -->
<UL> This
word is the address of the data register in ATA Command Block.<!-- lm: 0x2 1 -->
</UL> Control
Port Address<!-- lm: 0x11 6 -->
<UL> This word is the address of the ATA
Control Block Register.<!-- lm: 0x2 1 -->
</UL> Head Register Upper Nibble
<!-- lm: 0x11 6 -->
<UL>The upper nibble of this byte is logically ORed
with the head number, or upper 4 bits of the LBA, each time the disk is
accessed.<!-- lm: 0x2 6 -->
<P>
Bit<!-- lm: 0x2 21 -->
<UL> Description<!-- lm: 0x2 6 --><!-- lm: 0x2 6 -->
</UL> 0
3<!-- lm: 0x2 21 -->
<UL> 0<!-- lm: 0x2 6 --><!-- lm: 0x2 6 -->
</UL> 4
<!-- lm: 0x2 21 -->
<UL>ATA DEV bit<!-- lm: 0x2 6 --><!-- lm: 0x2 6 -->
</UL> 5
<!-- lm: 0x2 21 -->
<UL>1<!-- lm: 0x2 6 --><!-- lm: 0x2 6 -->
</UL> 6<!-- lm: 0x2 21 -->
<UL> LBA
enabled (1 = enabled)<!-- lm: 0x2 6 -->
</UL> 7<!-- lm: 0x2 21 -->
<UL> 1
<!-- lm: 0x2 6 --><!-- lm: 0x2 1 -->
</UL>IRQ Information<!-- lm: 0x11 6 -->
<UL> Bits
are defined as follows <!-- lm: 0x2 6 -->
<P>
Bit<!-- lm: 0x2 21 -->
<UL> Description<!-- lm: 0x2 6 --><!-- lm: 0x2 6 -->
</UL> 0
3<!-- lm: 0x2 21 -->
<UL> IRQ for this drive<!-- lm: 0x2 6 --><!-- lm: 0x2 6 -->
</UL> 4
7<!-- lm: 0x2 21 -->
<UL> 0<!-- lm: 0x2 6 --><!-- lm: 0x2 1 -->
</UL> Block
Count for ATA R/W Multiple<!-- lm: 0x11 6 -->
<UL> If the hard disk was
configured to use the READ/WRITE MULTIPLE command, then this field contains
the block size of the transfer in sectors.<!-- lm: 0x2 1 -->
</UL> DMA Information
<!-- lm: 0x11 6 -->
<UL>If the BIOS has configured the system to perform
multi-word DMA transfers in place of the normal PIO transfers, this field
specified the DMA mode in the upper nibble, as per the ATA-2 or later definition,
and the DMA Channel in the lower nibble. ATA Channels which conform to SFF-8038i
set the DMA channel to 0. Note that the DMA Type field does not follow the
format of the data returned by the drive. The value of the DMA mode is not
limited to 2.<!-- lm: 0x2 6 -->
<P>
Bit<!-- lm: 0x2 21 -->
<UL> Description<!-- lm: 0x2 6 --><!-- lm: 0x2 6 -->
</UL> 0
3<!-- lm: 0x2 21 -->
<UL> DMA Channel<!-- lm: 0x2 6 --><!-- lm: 0x2 6 -->
</UL> 4
7<!-- lm: 0x2 21 -->
<UL> DMA Type<!-- lm: 0x2 6 --><!-- lm: 0x2 1 -->
</UL> PIO
Information<!-- lm: 0x11 6 -->
<UL> If the BIOS has configured the system
to perform PIO data transfers other than mode 0, this field specifies the
PIO mode as per the ATA-2 or later definition.<!-- lm: 0x2 6 -->
<P>
Bit<!-- lm: 0x2 21 -->
<UL> Description<!-- lm: 0x2 6 --><!-- lm: 0x2 6 -->
</UL> 0
3<!-- lm: 0x2 21 -->
<UL> PIO Type<!-- lm: 0x2 6 --><!-- lm: 0x2 6 -->
</UL> 4
7<!-- lm: 0x2 21 -->
<UL> 0<!-- lm: 0x2 6 --><!-- lm: 0x2 1 -->
</UL> BIOS
Selected Hardware Option Flags<!-- lm: 0x11 6 -->
<UL> Bits are defined
as follows <!-- lm: 0x2 6 -->
<P>
Bit<!-- lm: 0x2 21 -->
<UL> Description<!-- lm: 0x2 6 --><!-- lm: 0x2 6 -->
</UL> 0
<!-- lm: 0x2 21 -->
<UL>Fast PIO accessing enabled<!-- lm: 0x2 6 -->
</UL> 1
<!-- lm: 0x2 21 -->
<UL>DMA accessing enabled<!-- lm: 0x2 6 -->
</UL> 2
<!-- lm: 0x2 21 -->
<UL>ATA READ/WRITE MULTIPLE accessing enabled<!-- lm: 0x2 6 -->
</UL> 3
<!-- lm: 0x2 21 -->
<UL>CHS translation enabled<!-- lm: 0x2 6 -->
</UL> 4
<!-- lm: 0x2 21 -->
<UL>LBA translation enabled<!-- lm: 0x2 6 -->
</UL> 5
<!-- lm: 0x2 21 -->
<UL>Removeable media<!-- lm: 0x2 6 -->
</UL> 6<!-- lm: 0x2 21 -->
<UL> ATAPI
device<!-- lm: 0x2 6 -->
</UL> 7<!-- lm: 0x2 21 -->
<UL> 32 bit transfer
mode<!-- lm: 0x2 6 -->
</UL> 8<!-- lm: 0x2 21 -->
<UL> ATAPI device uses
command packet interrupt<!-- lm: 0x2 6 -->
</UL> 9 10<!-- lm: 0x2 21 -->
<UL> Translation
type<!-- lm: 0x2 21 -->
<P>
00<!-- lm: 0x2 36 -->
<UL> Bit-shift translation<!-- lm: 0x2 21 --><!-- lm: 0x2 21 -->
</UL> 01
<!-- lm: 0x2 36 -->
<UL>LBA assisted translation<!-- lm: 0x2 21 -->
</UL> 10
<!-- lm: 0x2 36 -->
<UL>Reserved<!-- lm: 0x2 21 -->
</UL> 11<!-- lm: 0x2 36 -->
<UL> Vendor
specific translation<!-- lm: 0x2 21 --><!-- lm: 0x2 6 -->
</UL> 11<!-- lm: 0x2 21 -->
<UL> Ultra
DMA accessing enabled<!-- lm: 0x2 6 -->
</UL> 12 15<!-- lm: 0x2 21 -->
<UL> Reserved
<!-- lm: 0x2 6 --><!-- lm: 0x2 1 -->
</UL>DPT Extension Revision<!-- lm: 0x11 6 -->
<UL> Revision
of DPT Extension provided by BIOS<!-- lm: 0x2 1 -->
</UL>
<P>
<B>Returns</B>
<P>
Possible<!-- entering slot 120 --> values are shown in the following list
 <!-- lm: 0x2 1 -->
<P>
<LI><!-- lm: 0x2 11 -->NO_ERROR<!-- lm: 0x2 1 -->
<P>
87<!-- lm: 0x2 11 -->
<UL> ERROR_INVALID_PARAMETER<!-- lm: 0x2 1 -->
</UL>
<P>
<B>Remarks</B>
<P>
Information in the data packet will be filled in, if BIOS supports INT 13h
Function 48h and if BIOS can access the entire hardfile through INT 13h
Function 42h and Function 43h. If either condition is not met, all fields
in the data packet with be 0.

<P><HR>

<A HREF="076_L2_LogicalVolumeManagem.html">[Back: Logical Volume ManagementDSK_LVMMGMT(69h)]</A> <BR>
<A HREF="078_L1_NetworkAPIs.html">[Next: Network APIs]</A> 
</BODY>
</HTML>
