<HTML XPOS=30% YPOS=TOP WIDTH=70% HEIGHT=100%HIDDEN>
<HEAD>
<!-- extra bytes: 03 00 14 1E 00 04 00 11 46 00 64 00 --><TITLE>mciGetErrorString - Example Code</TITLE>
</HEAD>
<BODY>
<H1>mciGetErrorString - Example Code</H1><!-- entering slot 20 -->
<P>
The following code illustrates how to obtain the description of a given
error code.
<PRE>
    #define ILLEGAL_COMMAND  (USHORT) 0x0000FFFF /* Illegal command   */
    #define MCI_ERROR_STRING_LENGTH  128         /* Length of error
                                                    message buffer    */

    CHAR acErrorStringBuffer[MCI_ERROR_STRING_LENGTH];
    ULONG ulRC;

    ulRC =
      mciSendCommand(
         0,                           /* Don't know the device yet     */
         ILLEGAL_COMMAND,             /* Command to be performed       */
         MCI_WAIT,                    /* Flags for the command         */
         (ULONG) NULL,                /* No parameter list             */
         0 );                         /* No notify message             */

    if ( ulRC != MCIERR_SUCCESS)
     {
      ulRC =
       mciGetErrorString(
         ulRC,
         (PSZ) acErrorStringBuffer,         /* acErrorStringBuffer     */
         (USHORT) MCI_ERROR_STRING_LENGTH );/* should = "unrecognized
                                               command"                */
     }
</PRE>


<P><HR>

<A HREF="019_L2H_mciGetErrorStringRem.html">[Back: mciGetErrorString - Remarks]</A> <BR>
<A HREF="021_L2H_mciGetErrorStringTop.html">[Next: mciGetErrorString - Topics]</A> 
</BODY>
</HTML>
