<HTML XPOS=30% YPOS=TOP WIDTH=70% HEIGHT=100%HIDDEN>
<HEAD>
<!-- extra bytes: 03 00 14 1E 00 04 00 11 46 00 64 00 --><TITLE>MCI_OPEN - Example Code</TITLE>
</HEAD>
<BODY>
<H1>MCI_OPEN - Example Code</H1><!-- entering slot 421 -->
<P>
The following code illustrates how to open a waveaudio device instance by
specifying SPEECH.WAV.
<PRE>/* Open a waveaudio device context, specifying the element
   "speech.wav".

ULONG          rc;
MCI_OPEN_PARMS mop;

mop.hwndCallback = (HWND) NULL;      /* N/A - we're waiting       */
mop.usDeviceID = (USHORT) NULL;      /* This is returned          */
mop.pszDeviceType = (PSZ) NULL;      /* using default device type */
mop.pszElementName = (PSZ) "speech.wav"
                                     /* File name to open         */
rc = mciSendCommand( 0,
    MCI_OPEN,                        /* MCI open message          */
    MCI_WAIT | MCI_OPEN_ELEMENT |
    MCI_OPEN_SHAREABLE,              /* Flags for this message    */
    (ULONG) &amp;mop,                    /* Data structure            */
    0);                              /* No user parm              */
if (LOUSHORT(rc) == MCIERR_SUCCESS)
  {
   usDeviceID = mop.usDeviceID;      /* Return device ID          */
  }

</PRE>


<P><HR>

<A HREF="414_L2H_MCI_OPENRelatedMessa.html">[Back: MCI_OPEN - Related Messages]</A> <BR>
<A HREF="416_L2H_MCI_OPENTopics.html">[Next: MCI_OPEN - Topics]</A> 
</BODY>
</HTML>
