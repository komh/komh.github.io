<HTML XPOS=30% YPOS=TOP WIDTH=70% HEIGHT=100%HIDDEN>
<HEAD>
<!-- extra bytes: 03 00 14 1E 00 04 00 11 46 00 64 00 --><TITLE>MCI_COPY - Remarks</TITLE>
</HEAD>
<BODY>
<H1>MCI_COPY - Remarks</H1><!-- entering slot 254 -->
<P>
MCI_COPY copies the range of media data specified by the<I> ulFrom</I> and
<I>ulTo</I> fields in the<A><!-- external link: 1D 01 29 FC --> MCI_EDIT_PARMS
</A>data structure to an application-supplied buffer or the system clipboard.
If the<I> pBuff</I> field of the data structure contains a pointer and the
MCI_TO_BUFFER flag is specified, the data is copied to a buffer. If the
MCI_FROM_BUFFER flag is specified, the information is copied from the buffer
to the clipboard.
<P>
The units of the MCI_FROM and MCI_TO parameters are interpreted in the currently
selected time format.  If neither MCI_FROM nor MCI_TO are specified, the
range is assumed from the current file position to the end of the file.
The difference between MCI_FROM and MCI_TO must be greater than zero, otherwise
an error is returned.
<P>
Edited Audio/Video Interleaved (AVI) movie files cannot always be saved
with their original name after a copy operation.  If the clipboard contains
a reference to data that would be erased during saving or if another instance
of the digital video device has a pending paste operation which depends
on this data, the file cannot be saved unless a new file name has been provided.
 If a new file name is not provided, MMIOERR_NEED_NEW_FILENAME is returned
by the AVI I/O procedure and a temporary file is created to save the edited
movie.
<P>
<B>Note: </B> AVI is the only video file format supporting editing commands.
<!-- lm: 0x2 1 -->
<UL>
<P>

<P>
If data is already in the clipboard, then it is overwritten. If a copy interrupts
an in-progress operation, such as play, the operation is aborted and an
<A HREF="152_L2_MM_MCINOTIFY.html">MM_MCINOTIFY</A> message is sent to the
application.
<P>
If an invalid buffer length is passed in,<I> ulBufLen</I> is updated with
the correct length.
<P>
Waveaudio Specific
<P>
If MCI_FROM_BUFFER or MCI_TO_BUFFER are used, the<I> pHeader</I> field of
<A><!-- external link: 1D 01 29 FC -->MCI_EDIT_PARMS</A> must contain a
pointer to an<A><!-- external link: 1D 36 29 53 --> MMAUDIOHEADER</A> structure.
The<I> ulBufLen</I> field of<A><!-- external link: 1D 01 29 FC --> MCI_EDIT_PARMS
</A>must be filled in.

<P><HR>

<A HREF="252_L2H_MCI_COPYDescription.html">[Back: MCI_COPY - Description]</A> <BR>
<A HREF="254_L2H_MCI_COPYRelatedMessa.html">[Next: MCI_COPY - Related Messages]</A> 
</BODY>
</HTML>
