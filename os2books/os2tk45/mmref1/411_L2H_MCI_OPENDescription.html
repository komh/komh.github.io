<HTML XPOS=30% YPOS=TOP WIDTH=70% HEIGHT=100%HIDDEN>
<HEAD>
<META HTTP-EQUIV="CONTENT-TYPE" CONTENT="TEXT/HTML; CHARSET=UTF-8">
<!-- extra bytes: 03 00 14 1E 00 04 00 11 46 00 64 00 --><TITLE>MCI_OPEN - Description</TITLE>
</HEAD>
<BODY>
<H1>MCI_OPEN - Description</H1><!-- entering slot 416 -->
<P>
This message is used to open or create a new device instance.
<P>

<PRE></PRE>
<!-- lm: 0x2 1 -->
<UL>
<P>
<B>ulParam1</B> (<A><!-- external link: 1D 96 29 E1 -->ULONG</A>)<!-- lm: 0x11 4 -->
<UL> This
parameter can contain any of the following flags. MCI_OPEN_ELEMENT and MCI_OPEN_MMIO
are mutually exclusive flags.<!-- lm: 0x2 4 -->
<P>
MCI_NOTIFY<!-- lm: 0x11 12 -->
<UL> A notification message will be posted
to the window specified in the<I> hwndCallback</I> parameter of the data
structure pointed to by the<I> pParam2</I> parameter.  The notification
will be posted when the action indicated by this message is completed or
when an error occurs.<!-- lm: 0x2 4 -->
</UL> MCI_WAIT<!-- lm: 0x11 12 -->
<UL> Control
is not to be returned until the action indicated by this message is completed
or an error occurs.<!-- lm: 0x2 4 -->
</UL> MCI_DOS_QUEUE<!-- lm: 0x11 12 -->
<UL> This
flag specifies that window handles passed in for this device instance will
be treated as OS/2 Control Program queue handles.<!-- lm: 0x2 4 -->
</UL> MCI_OPEN_ALIAS
<!-- lm: 0x11 12 -->
<UL>This flag specifies that the<I> pszAlias</I> field
of the open structure contains an alias for this device instance.  This
alias can then be used on subsequent commands using the string interface.
<!-- lm: 0x2 4 -->
</UL>MCI_OPEN_ELEMENT<!-- lm: 0x11 12 -->
<UL> This flag
specifies that an element name is included.  The element name can be that
of a file or a file element in a compound file.  The element name is specified
in the<I> pszElementName</I> field of the open data structure.  If the element
name does not exist or is NULL, then a temporary element is created for
subsequent use.  The temporary file can be made permanent by providing a
name using the <A HREF="506_L2_MCI_SAVE.html">MCI_SAVE</A> message.<!-- lm: 0x2 4 -->
</UL> MCI_OPEN_MMIO
<!-- lm: 0x11 12 -->
<UL>This flag specifies that an MMIO handle (<I>hmmio</I>)
is passed in the<I> pszElementName</I> field of the open data structure.
 The file must have been opened through MMIO with<I> ulTranslate</I> of
the<A><!-- external link: 1D 42 29 81 --> MMIOINFO</A> data structure set
to MMIO_TRANSLATEHEADER, unless a particular MCD indicates differently.
<!-- lm: 0x2 4 -->
</UL>MCI_OPEN_PLAYLIST<!-- lm: 0x11 12 -->
<UL> This
flag indicates that the<I> pszElementName</I> field of the open data structure
contains a pointer to a memory playlist structure.<!-- lm: 0x2 4 -->
</UL> MCI_OPEN_READONLY
<!-- lm: 0x11 12 -->
<UL>This flag specifies that the file is to be opened
in read-only mode. The load and run-time performance for the wave audio
and digital video devices can be improved by specifying this flag.  This
flag can only be used in conjunction with the MCI_OPEN_ELEMENT or MCI_OPEN_MMIO
flags.  By specifying this flag, MCI_RECORD and MCI_SAVE are automatically
disabled.<!-- lm: 0x2 4 -->
</UL> MCI_OPEN_SHAREABLE<!-- lm: 0x11 12 -->
<UL> This
flag specifies that the device instance is to be opened in a fully shareable
mode.  Omitting this flag causes the device instance to be opened for exclusive
use.<!-- lm: 0x2 4 -->
</UL> MCI_OPEN_TYPE_ID<!-- lm: 0x11 12 -->
<UL> This
flag specifies that the<I> pszDeviceType</I> field of the open data structure
is to be interpreted as follows. The low-order word is a standard device
type and the high-order word is the ordinal index for the device. If MCI_OPEN_TYPE_ID
is specified and the index is 0, the default device will be opened. If MCI_OPEN_TYPE_ID
is not specified and the<I> pszDeviceType</I> field is not NULL, the media
control interface will attempt to open the device specified by<I> pszDeviceType</I>.
If MCI_OPEN_TYPE_ID is not specified,<I> pszDeviceType</I> is NULL, and
the MCI_OPEN_ELEMENT flag is specified, the system attempts to select and
open a device based on the element extension or EA type of the file specified
in the<I> pszElementName</I> field of the open data structure.<!-- lm: 0x2 4 -->
</UL> Digital
Video Extensions
<P>
The following flags apply to digital video devices:<!-- lm: 0x2 4 -->
<P>
MCI_DGV_OPEN_PARENT<!-- lm: 0x11 12 -->
<UL> This flag indicates that the
<I>hwndParent</I> field of the open data structure contains a valid parent
window handle. If this flag is not specified, HWND_DESKTOP is assumed to
be the parent window handle.<!-- lm: 0x2 4 -->
</UL> Video Overlay Extensions

<P>
The following flag applies to video overlay devices:<!-- lm: 0x2 4 -->
<P>
MCI_OVLY_OPEN_PARENT<!-- lm: 0x11 12 -->
<UL> This flag indicates that the
<I>hwndParent</I> field of the open data structure contains a valid parent
window handle. If this flag is not specified, HWND_DESKTOP is assumed to
be the parent window handle.<!-- lm: 0x2 4 --><!-- lm: 0x2 1 -->
</UL><!-- lm: 0x2 1 -->
<P>
<B>pParam2</B> (<A><!-- external link: 1D 0D 29 AA -->PMCI_OPEN_PARMS</A>)
<!-- lm: 0x11 4 -->
<UL>A pointer to the<A><!-- external link: 1D 0D 29 FC --> MCI_OPEN_PARMS
</A>data structure. Devices with extended command sets might replace this
pointer with a pointer to a device-specific data structure as follows:<!-- lm: 0x2 4 -->
<P>
PMCI_AMP_OPEN_PARMS<!-- lm: 0x11 12 -->
<UL> A pointer to the<A><!-- external link: 1D EE 28 FC --> MCI_AMP_OPEN_PARMS
</A>data structure.<!-- lm: 0x2 4 -->
</UL> PMCI_DGV_OPEN_PARMS<!-- lm: 0x11 12 -->
<UL> A
pointer to the<A><!-- external link: 1D FA 28 FC --> MCI_DGV_OPEN_PARMS
</A>data structure.<!-- lm: 0x2 4 -->
</UL> PMCI_OVLY_OPEN_PARMS<!-- lm: 0x11 12 -->
<UL> A
pointer to the<A><!-- external link: 1D 0E 29 FC --> MCI_OVLY_OPEN_PARMS
</A>data structure.<!-- lm: 0x2 4 --><!-- lm: 0x2 1 -->
</UL><!-- lm: 0x2 1 -->
<P>
<B>rc</B> (<A><!-- external link: 1D 96 29 E1 -->ULONG</A>)<!-- lm: 0x11 4 -->
<UL> Return
codes indicating success or type of failure:<!-- lm: 0x2 4 -->
<P>
MCIERR_SUCCESS<!-- lm: 0x11 12 -->
<UL> MMPM/2 command completed successfully.
<!-- lm: 0x2 4 -->
</UL>MCIERR_OUT_OF_MEMORY<!-- lm: 0x11 12 -->
<UL> System
out of memory.<!-- lm: 0x2 4 -->
</UL> MCIERR_INVALID_DEVICE_ID<!-- lm: 0x11 12 -->
<UL> Invalid
device ID given.<!-- lm: 0x2 4 -->
</UL> MCIERR_MISSING_PARAMETER<!-- lm: 0x11 12 -->
<UL> Missing
parameter for this command.<!-- lm: 0x2 4 -->
</UL> MCIERR_DRIVER<!-- lm: 0x11 12 -->
<UL> Internal
MMPM/2 driver error.<!-- lm: 0x2 4 -->
</UL> MCIERR_INVALID_FLAG<!-- lm: 0x11 12 -->
<UL> Invalid
flag specified for this command.<!-- lm: 0x2 4 -->
</UL> MCIERR_UNSUPPORTED_FLAG
<!-- lm: 0x11 12 -->
<UL>Flag not supported by this MMPM/2 driver for this
command.<!-- lm: 0x2 4 -->
</UL> MCIERR_DEVICE_LOCKED<!-- lm: 0x11 12 -->
<UL> Device
is locked.<!-- lm: 0x2 4 -->
</UL> MCIERR_FLAGS_NOT_COMPATIBLE<!-- lm: 0x11 12 -->
<UL> Flags
cannot be used together.<!-- lm: 0x2 4 -->
</UL> MCIERR_FILE_NOT_<!-- entering slot 417 -->FOUND<!-- lm: 0x11 12 -->
<UL>Filenotfound
.<!-- lm: 0x2 4 -->
</UL>MCIERR _ INI _ FILE<!-- lm: 0x11 12 -->
<UL>MMPM2
. INIfileerror .<!-- lm: 0x2 4 -->
</UL>MCIERR _ OVLY _ MAX _ OPEN _ LIMIT<!-- lm: 0x11 12 -->
<UL>Openedmaximumlimit
.<!-- lm: 0x2 4 -->
</UL>MCIERR _ INVALID _ MEDIA _ TYPE<!-- lm: 0x11 12 -->
<UL>Invalidmediatypegiven
.<!-- lm: 0x2 4 -->
</UL>MCIERR _ HARDWARE<!-- lm: 0x11 12 -->
<UL>Hardwareerror
.<!-- lm: 0x2 4 -->
</UL>MCIERR _ FILE _ ATTRIBUTE<!-- lm: 0x11 12 -->
<UL>Fileattributeerrorspecified
.<!-- lm: 0x2 4 -->
</UL>MCIERR _ NO _ DEVICEDRIVER<!-- lm: 0x11 12 -->
<UL>Therewasnodevicedriverfoundoritisnotoperational
.<!-- lm: 0x2 4 -->
</UL>MCIERR _ UNSUPP _ SAMPLESPERSEC<!-- lm: 0x11 12 -->
<UL>Thehardwaredoesnotsupportthissamplingrate<!-- lm: 0x2 4 -->
</UL>MCIERR
_ UNSUPP _ BITSPERSAMPLE<!-- lm: 0x11 12 -->
<UL>Thehardwaredoesnotsupportthisbitspersamplesetting
.<!-- lm: 0x2 4 -->
</UL>MCIERR _ UNSUPP _ CHANNELS<!-- lm: 0x11 12 -->
<UL>Thehardwaredoesnotsupportthischannelsetting
.<!-- lm: 0x2 4 -->
</UL>MCIERR _ UNSUPP _ FORMAT _ MODE<!-- lm: 0x11 12 -->
<UL>Thehardwaredoesnotsupportthisformatmode
.<!-- lm: 0x2 4 -->
</UL>MCIERR _ UNSUPP _ FORMAT _ TAG<!-- lm: 0x11 12 -->
<UL>Thehardwaredoesnotsupportthisformattag
.<!-- lm: 0x2 4 -->
</UL>MMIOERR _ ACCESS _ DENIED<!-- lm: 0x11 12 -->
<UL>Thefilecannotbeopened
.<!-- lm: 0x2 4 --><!-- lm: 0x2 1 -->
</UL>

<P><HR>

<A HREF="410_L2H_MCI_OPENReturnValuer.html">[Back: MCI_OPEN Return Value - rc]</A> <BR>
<A HREF="412_L2H_MCI_OPENRemarks.html">[Next: MCI_OPEN - Remarks]</A> 
</BODY>
</HTML>
