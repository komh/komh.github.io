<HTML XPOS=30% YPOS=TOP WIDTH=70% HEIGHT=100%HIDDEN>
<HEAD>
<META HTTP-EQUIV="CONTENT-TYPE" CONTENT="TEXT/HTML; CHARSET=UTF-8">
<!-- extra bytes: 03 00 14 1E 00 04 00 11 46 00 64 00 --><TITLE>MCI_SYSINFO - Example Code</TITLE>
</HEAD>
<BODY>
<H1>MCI_SYSINFO - Example Code</H1><!-- entering slot 651 -->
<P>
The following code illustrates how to determine the number of waveform devices
installed.
<PRE>   #define  RETBUFSIZE 128

   MCI_SYSINFO_PARMS  SysInfo;
   CHAR  SysInfoRet[RETBUFSIZE];
                                       /*  Set unused fields to zero.  */
   memset(&amp;SysInfo, 0x00, sizeof(MCI_SYSINFO_PARMS));
   SysInfo.usDeviceType  = MCI_DEVTYPE_WAVEFORM_AUDIO;
                                       /* Device type                  */
   SysInfo.pszReturn = (PSZ) &amp;SysInfoRet;
                                       /* Pointer to return buffer     */
   SysInfo.ulRetSize = RETBUFSIZE;

           /* Determine the number of waveform audio devices installed */

   mciSendCommand (0,                  /* Don't know device ID yet     */
    MCI_SYSINFO,                       /* MCI sysinfo message          */
    MCI_SYSINFO_QUANTITY | MCI_WAIT,
                                       /* Flags for this message       */
    (PVOID)&amp;SysInfo,                   /* Data structure               */
    0);                                /* No user parm                 */

           /* SysInfoRet now contains number of wave audio devices.    */
</PRE>


<P><HR>

<A HREF="624_L2H_MCI_SYSINFODefaultPr.html">[Back: MCI_SYSINFO - Default Processing]</A> <BR>
<A HREF="626_L2H_MCI_SYSINFOTopics.html">[Next: MCI_SYSINFO - Topics]</A> 
</BODY>
</HTML>
