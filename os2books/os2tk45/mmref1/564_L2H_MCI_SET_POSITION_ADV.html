<HTML XPOS=30% YPOS=TOP WIDTH=70% HEIGHT=100%HIDDEN>
<HEAD>
<META HTTP-EQUIV="CONTENT-TYPE" CONTENT="TEXT/HTML; CHARSET=UTF-8">
<!-- extra bytes: 03 00 14 1E 00 04 00 11 46 00 64 00 --><TITLE>MCI_SET_POSITION_ADVISE - Example Code</TITLE>
</HEAD>
<BODY>
<H1>MCI_SET_POSITION_ADVISE - Example Code</H1><!-- entering slot 582 -->
<P>
The following code illustrates how to set periodic position-change messages
from a media device.
<PRE>/* Request position advise notification every 2 seconds             */

USHORT usDeviceID;
HWND hwndMyWindow;
MCI_POSITION_PARMS positionparms; /* Position advise parm structure */

/* Assign hwndCallback the handle to the PM Window - this is where
   MM_MCIPOSITIONCHANGE messages will be received.                  */

positionparms.hwndCallback = hwndMyWindow;
positionparms.ulUnits = (ULONG) 2000; /* (Current time format = MS) */

mciSendCommand(usDeviceID,            /* Device ID                  */
 MCI_SET_POSITION_ADVISE,             /* MCI set position advise
                                         message                    */
 MCI_SET_POSITION_ADVISE_ON | MCI_WAIT,
                                      /* Flags for this message     */
 (PVOID) &amp;positionparms,              /* Data structure             */
 0);                                  /* No user parm               */

</PRE>


<P><HR>

<A HREF="563_L2H_MCI_SET_POSITION_ADV.html">[Back: MCI_SET_POSITION_ADVISE - Remarks]</A> <BR>
<A HREF="565_L2H_MCI_SET_POSITION_ADV.html">[Next: MCI_SET_POSITION_ADVISE - Topics]</A> 
</BODY>
</HTML>
