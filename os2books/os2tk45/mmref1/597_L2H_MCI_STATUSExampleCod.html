<HTML XPOS=30% YPOS=TOP WIDTH=70% HEIGHT=100%HIDDEN>
<HEAD>
<META HTTP-EQUIV="CONTENT-TYPE" CONTENT="TEXT/HTML; CHARSET=UTF-8">
<!-- extra bytes: 03 00 14 1E 00 04 00 11 46 00 64 00 --><TITLE>MCI_STATUS - Example Code</TITLE>
<STYLE>
PRE {
  FONT-FAMILY: Consolas, "Lucida Console", "Courier New", Courier, MONOSPACE;
}
</STYLE>
</HEAD>
<BODY>
<H1>MCI_STATUS - Example Code</H1><!-- entering slot 622 -->
<P>
The following code illustrates how to obtain information about the status
of a media device.
<PRE>   USHORT   usDeviceID;
   ULONG    ulError;
   BOOL     disc_loaded;
                    /* Set to TRUE by this example if media is present */
   MCI_STATUS_PARMS  mstatusp;

   mstatusp.ulItem = MCI_STATUS_MEDIA_PRESENT;

   ulError = mciSendCommand(usDeviceID,      /* Device ID              */
    MCI_STATUS,                              /* MCI status message     */
    MCI_WAIT | MCI_STATUS_ITEM,
                                             /* Flags for this message */
    (PVOID) &amp;mstatusp,                       /* Data structure         */
    0);                                      /* No user parm           */

   if (LOUSHORT(ulError) == MCIERR_SUCCESS)
     {
       disc_loaded = (BOOL) mstatusp.ulReturn;    /* Media present
                                                     status            */
     }

</PRE>


<P><HR>

<A HREF="596_L2H_MCI_STATUSRelatedMes.html">[Back: MCI_STATUS - Related Messages]</A> <BR>
<A HREF="598_L2H_MCI_STATUSTopics.html">[Next: MCI_STATUS - Topics]</A> 
</BODY>
</HTML>
