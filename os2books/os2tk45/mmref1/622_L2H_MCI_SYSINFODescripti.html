<HTML XPOS=30% YPOS=TOP WIDTH=70% HEIGHT=100%HIDDEN>
<HEAD>
<META HTTP-EQUIV="CONTENT-TYPE" CONTENT="TEXT/HTML; CHARSET=UTF-8">
<!-- extra bytes: 03 00 14 1E 00 04 00 11 46 00 64 00 --><TITLE>MCI_SYSINFO - Description</TITLE>
</HEAD>
<BODY>
<H1>MCI_SYSINFO - Description</H1><!-- entering slot 647 -->
<P>
This message returns information about media control devices and device
instances.
<P>

<PRE></PRE>
<!-- lm: 0x2 1 -->
<UL>
<P>
<B>ulParam1</B> (<A><!-- external link: 1D 96 29 E4 -->ULONG</A>)<!-- lm: 0x11 4 -->
<UL> This
parameter can contain any of the following flags. If the size of the buffer
passed in is too small to hold all the data returned, then the<I> ulRetSize
</I>field of the<A><!-- external link: 1D 24 29 FC --> MCI_SYSINFO_PARMS
</A>data structure will contain the required buffer size, MCIERR_INVALID_BUFFER
will be returned, and the buffer will contain only as much of the SYSINFO
data as its size permits. Only one MCI_SYSINFO_<I>xxxxx</I> flag can be
used per MCI_SYSINFO message. The MCI_SYSINFO_NAME and MCI_SYSINFO_QUANTITY
flags are mutually exclusive.<!-- lm: 0x2 4 -->
<P>
MCI_WAIT<!-- lm: 0x11 12 -->
<UL> Control is not to be returned until the
action indicated by this message is completed or an error occurs.<!-- lm: 0x2 4 -->
</UL> MCI_SYSINFO_INSTALLNAME
<!-- lm: 0x11 12 -->
<UL>This flag returns the name used to install the
device.<!-- lm: 0x2 4 -->
</UL> MCI_SYSINFO_QUANTITY<!-- lm: 0x11 12 -->
<UL> This
flag sets the media to return the number of devices of the given type. If
the MCI_SYSINFO_OPEN flag is set, the number of open devices is returned.
<!-- lm: 0x2 4 -->
</UL>MCI_SYSINFO_NAME<!-- lm: 0x11 12 -->
<UL> This flag
is used to select a number or device ordinal parameter. The media returns
the name(s) of a device that satisfies the query.  If more than one name
is returned then the names are separated by a single blank and the string
is null terminated.<!-- lm: 0x2 4 -->
</UL> MCI_SYSINFO_OPEN<!-- lm: 0x11 12 -->
<UL> This
flag returns the number or name of open devices.<!-- lm: 0x2 4 -->
</UL> MCI_SYSINFO_ITEM
<!-- lm: 0x11 12 -->
<UL>This flag indicates that the<I> ulItem</I> field
contains a constant that indicates the desired MCI_SYSINFO action as indicated
by one of the following values:<!-- lm: 0x2 12 -->
<P>
MCI_SYSINFO_INSTALL_DRIVER<!-- lm: 0x11 20 -->
<UL> This message creates
or updates a logical device entry in the INI file. The<I> pSysInfoParm</I> field
points to the<A><!-- external link: 1D 23 29 FC --> MCI_SYSINFO_LOGDEVICE
</A>data structure.  The driver becomes active the next time the system
is started.<!-- lm: 0x2 12 -->
</UL> MCI_SYSINFO_QUERY_DRIVER<!-- lm: 0x11 20 -->
<UL> This
message queries the information for the driver indicated in the<I> szInstallName
</I>field of the<A><!-- external link: 1D 23 29 FC --> MCI_SYSINFO_LOGDEVICE
</A>data structure. The<I> pSysInfoParm</I> field points to the<A><!-- external link: 1D 23 29 FC --> MCI_SYSINFO_LOGDEVICE
</A>data structure.<!-- lm: 0x2 12 -->
</UL> MCI_SYSINFO_INI_LOCK<!-- lm: 0x11 20 -->
<UL> Writes
out and then locks the MMPM2.INI file from updates.<!-- lm: 0x2 12 -->
</UL> MCI_SYSINFO_DELETE_DRIVER
<!-- lm: 0x11 20 -->
<UL>This message removes the specified driver from
the INI file. The<I> pSysInfoParm</I> field points to the installation name.
<!-- lm: 0x2 12 -->
</UL>MCI_SYSINFO_SET_PARAMS<!-- lm: 0x11 20 -->
<UL> This
message sets the device-specific parameters for a particular device.  Device-specific
parameters should be printable ASCII characters only so that response files
can be supported. The<I> pSysInfoParm</I> field points to the<A><!-- external link: 1D 21 29 FC --> MCI_SYSINFO_DEVPARAMS
</A>data structure.<!-- lm: 0x2 12 -->
</UL> MCI_SYSINFO_QUERY_PARAMS<!-- lm: 0x11 20 -->
<UL> This
message retrieves the device-specific parameters for a particular device.
The<I> pSysInfoParm</I> field points to the<A><!-- external link: 1D 21 29 FC --> MCI_SYSINFO_DEVPARAMS
</A>data structure.<!-- lm: 0x2 12 -->
</UL> MCI_SYSINFO_SET_CONNECTORS
<!-- lm: 0x11 20 -->
<UL>This message sets the logical connector information
for a particular device.  The connector array defined by<I> ConnectorList
</I>(in the<A><!-- external link: 1D 1F 29 FC --> MCI_SYSINFO_CONPARAMS
</A>data structure) is a list of the connectors in sequential order.  For
example, ConnectorList[0] is connector index 1.  The<I> pSysInfoParm</I> field
points to the<A><!-- external link: 1D 1F 29 FC --> MCI_SYSINFO_CONPARAMS
</A>data structure.<!-- lm: 0x2 12 -->
</UL> MCI_SYSINFO_QUERY_CONNECTORS
<!-- lm: 0x11 20 -->
<UL>This message retrieves the device connector information
for a particular device.  The<I> pSysInfoParm</I> field points to the<A><!-- external link: 1D 1F 29 FC --> MCI_SYSINFO_CONPARAMS
</A>data structure.<!-- lm: 0x2 12 -->
</UL> MCI_SYSINFO_SET_EXTENSIONS
<!-- lm: 0x11 20 -->
<UL>This message sets the file extension associated
with a particular device.  The<I> pSysInfoParm</I> field points to the<A><!-- external link: 1D 22 29 FC --> MCI_SYSINFO_EXTENSION
</A>data structure. Extensions are unique across installation names.  That
is, no two installation names can have the same extension.<!-- lm: 0x2 12 -->
</UL> MCI_SYSINFO_QUERY_EXTENSIONS
<!-- lm: 0x11 20 -->
<UL>This message queries the file extensions associated
with a particular device.  The<I> pSysInfoParm</I> field points to the<A><!-- external link: 1D 22 29 FC --> MCI_SYSINFO_EXTENSION
</A>data structure.<!-- lm: 0x2 12 -->
</UL> MCI_SYSINFO_SET_TYPES<!-- lm: 0x11 20 -->
<UL> This
message sets the extended type attribute associated with a particular device.
The<I> pSysInfoParm</I> field points to the<A><!-- external link: 1D 26 29 FC --> MCI_SYSINFO_TYPES
</A>data structure.<!-- lm: 0x2 12 -->
</UL> MCI_SYSINFO_QUERY_TYPES<!-- lm: 0x11 20 -->
<UL> This
message queries query the extended type attributes associated with a particular
device. The<I> pSysInfoParm</I> field points to the<A><!-- external link: 1D 26 29 FC --> MCI_SYSINFO_TYPES
</A>data structure.<!-- lm: 0x2 12 -->
</UL> MCI_SYSINFO_SET_ALIAS<!-- lm: 0x11 20 -->
<UL> This
message associates an alias to a particular device. The<I> pSysInfoParm
</I>field points to the<A><!-- external link: 1D 1E 29 FC --> MCI_SYSINFO_ALIAS
</A>data structure.<!-- lm: 0x2 12 -->
</UL> MCI_SYSINFO_QUERY_NAMES<!-- lm: 0x11 20 -->
<UL> This
message queries the names associated with a particular device. This message
will accept any of the three types of names or device type and device ordinal
and fill in the remaining structure if possible. If the device type is given
and 0 for the device ordinal then the first device of that type is returned.
Only one non-null name or 0 in device type field on input is allowed. The
<I>pSysInfoParm</I> field points to the<A><!-- external link: 1D 25 29 FC --> MCI_SYSINFO_QUERY_NAME
</A>data structure.<!-- lm: 0x2 12 -->
</UL> MCI_SYSINFO_SET_DEFAULT<!-- lm: 0x11 20 -->
<UL> This
message sets a device as the default for its device type. If another device
is already the default for this device type, then it will be superseded
by the new device. The<I> pSysInfoParm</I> field points to the<A><!-- external link: 1D 20 29 FC --> MCI_SYSINFO_DEFAULTDEVICE
</A>data structure.<!-- lm: 0x2 12 -->
</UL> MCI_SYSINFO_QUERY_DEFAULT<!-- lm: 0x11 20 -->
<UL> This
message queries the default device for a given device type. If no explicit
default exists, then the first device of the indicated type is implicitly
the default. The<I> pSysInfoParm</I> field points to the<A><!-- external link: 1D 20 29 FC --> MCI_SYSINFO_DEFAULTDEVICE
</A>data structure.<!-- lm: 0x2 12 --><!-- lm: 0x2 4 --><!-- lm: 0x2 1 -->
</UL><!-- lm: 0x2 1 -->
<P>
<B>pParam2</B> (<A><!-- external link: 1D 24 29 A2 -->PMCI_SYSINFO_PARMS</A>)
<!-- lm: 0x11 4 -->
<UL>A pointer to the<A><!-- external link: 1D 24 29 FC --> MCI_SYSINFO_PARMS
</A>structure.<!-- lm: 0x2 1 -->
</UL><!-- lm: 0x2 1 -->
<P>
<B>rc</B> (<A><!-- external link: 1D 96 29 E4 -->ULONG</A>)<!-- lm: 0x11 4 -->
<UL> Return
codes indicating success or type of failure:<!-- lm: 0x2 4 -->
<P>
MCIERR_SUCCESS<!-- lm: 0x11 12 -->
<UL> If the function succeeds, 0 is returned.
<!-- lm: 0x2 4 -->
</UL>MCIERR_MISSING_FLAG<!-- lm: 0x11 12 -->
<UL> A required
flag is missing.<!-- lm: 0x2 4 -->
</UL> MCIERR_UNSUPPORTED_FLAG<!-- lm: 0x11 12 -->
<UL><!-- entering slot 648 --> Given
flag is unsupported for this device.<!-- lm: 0x2 4 -->
</UL> MCIERR_INVALID_CALLBACK_HANDLE
<!-- lm: 0x11 12 -->
<UL>Given callback handle is invalid.<!-- lm: 0x2 4 -->
</UL> MCIERR_INVALID_FLAG
<!-- lm: 0x11 12 -->
<UL>Flag (<I>ulParam1</I>) is invalid.<!-- lm: 0x2 4 -->
</UL> MCIERR_FLAGS_NOT_COMPATIBLE
<!-- lm: 0x11 12 -->
<UL>Flags cannot be used together.<!-- lm: 0x2 4 -->
</UL> MCIERR_MISSING_PARAMETER
<!-- lm: 0x11 12 -->
<UL>Required parameter is missing.<!-- lm: 0x2 4 -->
</UL> MCIERR_INVALID_BUFFER
<!-- lm: 0x11 12 -->
<UL>Invalid return buffer given.<!-- lm: 0x2 4 -->
</UL> MCIERR_DUPLICATE_ALIAS
<!-- lm: 0x11 12 -->
<UL>Alias already exists.<!-- lm: 0x2 4 -->
</UL> MCIERR_DUPLICATE_EXTENSION
<!-- lm: 0x11 12 -->
<UL>Extension already exists.<!-- lm: 0x2 4 -->
</UL> MCIERR_NODEFAULT_DEVICE
<!-- lm: 0x11 12 -->
<UL>No device of this type exists.<!-- lm: 0x2 4 -->
</UL> MCIERR_DEVICE_NOT_FOUND
<!-- lm: 0x11 12 -->
<UL>Device not found for this query.<!-- lm: 0x2 4 -->
</UL> MCIERR_DUPLICATE_EA
<!-- lm: 0x11 12 -->
<UL>The given EA already exists for another device.
<!-- lm: 0x2 4 --><!-- lm: 0x2 1 -->
</UL>

<P><HR>

<A HREF="621_L2H_MCI_SYSINFOReturnVal.html">[Back: MCI_SYSINFO Return Value - rc]</A> <BR>
<A HREF="623_L2H_MCI_SYSINFORemarks.html">[Next: MCI_SYSINFO - Remarks]</A> 
</BODY>
</HTML>
