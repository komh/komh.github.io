<HTML XPOS=30% YPOS=TOP WIDTH=70% HEIGHT=100%HIDDEN>
<HEAD>
<!-- extra bytes: 03 00 14 1E 00 04 00 11 46 00 64 00 --><TITLE>mciSendCommand - Example Code</TITLE>
</HEAD>
<BODY>
<H1>mciSendCommand - Example Code</H1><!-- entering slot 42 -->
<P>
The following code illustrates how to send a command to a specified device.

<PRE>

      MCI_OPEN_PARMS mciOpenParameters;
      MCI_PLAY_PARMS mciPlayParameters;
      CHAR DeviceType[] = "cdaudio";
                                      /* Device type "cdaudio"          */

      mciPlayParameters.hwndCallback = PM_Win_Handle;
                                      /* Assign hwndCallback the handle
                                         to the PM Window routine       */

      mciOpenParameters.pszDeviceType = (PSZ)&amp;DeviceType;


      mciSendCommand(
       0,                                /* Don't know the device yet   */
       MCI_OPEN,                         /* MCI message                 */
       MCI_WAIT | MCI_OPEN_TYPE_ID,      /* Flags for the MCI
                                            message                     */
       (PVOID) &amp;mciOpenParameters,       /* Parameters for the message  */
       0 );                              /* No notify message           */



      mciSendCommand(
         mciOpenParameters.usDeviceID,   /* Device to play the cdaudio  */
         MCI_PLAY,                        /* MCI message                */
         MCI_WAIT,                        /* Flags for the MCI message  */
         (PVOID) &amp;mciPlayParameters,      /* Parameters for the message */
         0);                              /* No notify message          */


       mciSendCommand(
        mciOpenParameters.usDeviceID,     /* Device to play the cdaudio */
        MCI_CLOSE,                        /* MCI message                */
        MCI_WAIT,                         /* Flags for the MCI message  */
        (PVOID) NULL,                     /* No Parameter list          */
        0);                               /* No notify message          */
</PRE>


<P><HR>

<A HREF="041_L2H_mciSendCommandRelate.html">[Back: mciSendCommand - Related Functions]</A> <BR>
<A HREF="043_L2H_mciSendCommandTopics.html">[Next: mciSendCommand - Topics]</A> 
</BODY>
</HTML>
