<HTML>
<HEAD>
<META HTTP-EQUIV="CONTENT-TYPE" CONTENT="TEXT/HTML; CHARSET=UTF-8">
<TITLE>The DPI_PACKET_LEN() Macro</TITLE>
<STYLE>
PRE {
  FONT-FAMILY: Consolas, "Lucida Console", "Courier New", Courier, MONOSPACE;
}
</STYLE>
</HEAD>
<BODY>
<H1>The DPI_PACKET_LEN() Macro</H1><!-- entering slot 32 -->
<P>
<B>Syntax</B>
<PRE>#include &lt;snmp_dpi.h&gt;

int DPI_PACKET_LEN(unsigned char *packet_p)
</PRE>

<P>
<B>Parameters</B><!-- lm: 0x2 1 -->
<UL>
<P>
packet_p<!-- lm: 0x11 3 -->
<UL> A pointer to a serialized DPI packet.<!-- lm: 0x2 1 -->
</UL>
<P>
<B>Return Values</B><!-- lm: 0x2 6 -->
<UL>
<P>
An integer representing the total DPI packet length.<!-- lm: 0x2 1 -->
</UL>
<P>
<B>Description</B>
<P>
The DPI_PACKET_LEN macro generates C-code that returns an integer representing
the length of a DPI packet.  It uses the first two octets in network byte
order of the packet to calculate the length.
<P>
<B>Examples</B>
<PRE>  #include &lt;snmp_dpi.h&gt;  unsigned char *pack_p;
  int            length;

  pack_p = mkDPIclose(SNMP_CLOSE_goingDown);
  if (pack_p) {
     length = DPI_PACKET_LEN(pack_p);
     /* send packet to agent or subagent */
  } /* endif */
</PRE>


<P><HR>

<A HREF="031_L2_TheDPIdebugFunction.html">[Back: The DPIdebug() Function]</A> <BR>
<A HREF="033_L2_ThefDPIparseFunction.html">[Next: The fDPIparse() Function]</A> 
</BODY>
</HTML>
