<HTML>
<HEAD>
<TITLE>Linking with an Import Library</TITLE>
</HEAD>
<BODY>
<H1>Linking with an Import Library</H1><!-- entering slot 189 -->
<P>
The figure below illustrates a simple case in which you create an application
that uses a single dynamic-link library (.DLL) file.
<PRE>
ÚÄÄÄÄÄÄÄÄÄÄ¿   ÚÄÄÄÄÄÄÄÄÄ¿       ÚÄÄÄÄÄÄÄÄÄ¿   ÚÄÄÄÄÄÄÄÄÄÄ¿
³ .OBJ and ³   ³.DEF file³       ³.LIB file³   ³ .OBJ and ³
³.LIB files³   ³(LIBRARY)³       ³(imports)³   ³.LIB files³
³          ³   ³(exports)³       ³         ³   ³          ³
ÀÄÄÄÄÂÄÄÄÄÄÙ   ÀÄÄÂÄÄÄÂÄÄÙ       ÀÄÄÂÄÄÄÂÄÄÙ   ÀÄÄÄÄÂÄÄÄÄÄÙ
     ³            ³   ³             ³   ³           ³
     ÀÄÄÄÄÄÄÂÄÄÄÄÄÙ   ³                ÀÄÄÄÄÄÂÄÄÄÄÄÙ
            ³         ÀÄ(2) IMPLIBÄÙ         ³
                                             
      (1) LINK386                       (3) LINK386
                                             
            ³                                 ³
       ÚÄÄÄÄÁÄÄÄÄ¿                     ÚÄÄÄÄÄÄÁÄÄÄÄÄÄ¿
       ³.DLL file³                     ³ .EXE file   ³
       ³(library)³                     ³(application)³
       ÀÄÄÄÄÄÄÄÄÄÙ                     ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÙ

</PRE>

<P>
As depicted above, linking occurs in three steps:<!-- lm: 0x2 2 -->
<UL>
<P>
 <LI><LI><!-- lm: 0x2 6 -->Object files (and dynamic-link libraries) are
linked with a module definition (.DEF) file to create a .DLL file. A .DEF
file is used that defines all functions exported by the .DLL file.<!-- lm: 0x2 2 -->
<P>
 <LI><LI><!-- lm: 0x2 6 -->The IMPLIB program is used to generate an<I> import
library</I> (.LIB) file.  IMPLIB takes as input the same module definition
file used in the first step.  For each export definition in the .DEF file,
IMPLIB generates a corresponding import definition.  (IMPLIB can also use
the .DLL file generated in step 1 if you use the _export keyword in C declarations
to export functions.)<!-- lm: 0x2 2 -->
<P>
 <LI><LI><!-- lm: 0x2 6 -->The .LIB file generated by IMPLIB is used as
input to LINK386, which creates an application (.EXE) file.  This .LIB file
provides LINK386 with information about imported dynamic-link functions.
<!-- lm: 0x2 1 -->
</UL>

<P><HR>

<A HREF="183_L4_LinkingwithoutanImpo.html">[Back: Linking without an Import Library]</A> <BR>
<A HREF="185_L3_ModuleDefinitionFile.html">[Next: Module Definition Files Basics]</A> 
</BODY>
</HTML>
