<HTML>
<HEAD>
<META HTTP-EQUIV="CONTENT-TYPE" CONTENT="TEXT/HTML; CHARSET=UTF-8">
<TITLE>Linking with an Import Library</TITLE>
<STYLE>
PRE {
  FONT-FAMILY: Consolas, "Lucida Console", "Courier New", Courier, MONOSPACE;
}
</STYLE>
</HEAD>
<BODY>
<H1>Linking with an Import Library</H1><!-- entering slot 189 -->
<P>
The figure below illustrates a simple case in which you create an application
that uses a single dynamic-link library (.DLL) file.
<PRE>
┌──────────┐   ┌─────────┐       ┌─────────┐   ┌──────────┐
│ .OBJ and │   │.DEF file│       │.LIB file│   │ .OBJ and │
│.LIB files│   │(LIBRARY)│       │(imports)│   │.LIB files│
│          │   │(exports)│       │         │   │          │
└────┬─────┘   └──┬───┬──┘       └──┬───┬──┘   └────┬─────┘
     │            │   │             │   │           │
     └──────┬─────┘   │                └─────┬─────┘
            │         └─(2) IMPLIB─┘         │
                                             
      (1) LINK386                       (3) LINK386
                                             
            │                                 │
       ┌────┴────┐                     ┌──────┴──────┐
       │.DLL file│                     │ .EXE file   │
       │(library)│                     │(application)│
       └─────────┘                     └─────────────┘

</PRE>

<P>
As depicted above, linking occurs in three steps:<!-- lm: 0x2 2 -->
<UL>
<P>
 <LI><LI><!-- lm: 0x2 6 -->Object files (and dynamic-link libraries) are
linked with a module definition (.DEF) file to create a .DLL file. A .DEF
file is used that defines all functions exported by the .DLL file.<!-- lm: 0x2 2 -->
<P>
 <LI><LI><!-- lm: 0x2 6 -->The IMPLIB program is used to generate an<I> import
library</I> (.LIB) file.  IMPLIB takes as input the same module definition
file used in the first step.  For each export definition in the .DEF file,
IMPLIB generates a corresponding import definition.  (IMPLIB can also use
the .DLL file generated in step 1 if you use the _export keyword in C declarations
to export functions.)<!-- lm: 0x2 2 -->
<P>
 <LI><LI><!-- lm: 0x2 6 -->The .LIB file generated by IMPLIB is used as
input to LINK386, which creates an application (.EXE) file.  This .LIB file
provides LINK386 with information about imported dynamic-link functions.
<!-- lm: 0x2 1 -->
</UL>

<P><HR>

<A HREF="183_L4_LinkingwithoutanImpo.html">[Back: Linking without an Import Library]</A> <BR>
<A HREF="185_L3_ModuleDefinitionFile.html">[Next: Module Definition Files Basics]</A> 
</BODY>
</HTML>
