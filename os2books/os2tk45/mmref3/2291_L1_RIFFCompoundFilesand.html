<HTML>
<HEAD>
<META HTTP-EQUIV="CONTENT-TYPE" CONTENT="TEXT/HTML; CHARSET=UTF-8">
<TITLE>RIFF Compound Files and Elements - Sharing and Access</TITLE>
<STYLE>
PRE {
  FONT-FAMILY: Consolas, "Lucida Console", "Courier New", Courier, MONOSPACE;
}
</STYLE>
</HEAD>
<BODY>
<H1>RIFF Compound Files and Elements - Sharing and Access</H1><!-- entering slot 2297 -->
<P>
The following tables show the relationship between sharing and accessing
RIFF compound files and elements within those files, both within the current
process and between processes.  The following scenarios are presented:<!-- lm: 0x2 3 -->
<UL>
<P>
<LI><!-- lm: 0x2 6 -->Element Opened Again - (any process)<!-- lm: 0x2 3 -->
<P>
<LI><!-- lm: 0x2 6 -->Elements Opened - (same process)<!-- lm: 0x2 3 -->
<P>
<LI><!-- lm: 0x2 6 -->Fully Qualified Element Open<!-- lm: 0x2 3 -->
<P>
<LI><!-- lm: 0x2 6 -->CF Opened Again - (same process)<!-- lm: 0x2 3 -->
<P>
<LI><!-- lm: 0x2 6 -->Element Open - (different process)<!-- lm: 0x2 3 -->
<P>
<LI><!-- lm: 0x2 6 -->CF Opened Again - (different process)<!-- lm: 0x2 1 -->
</UL>
<P>
<I>A</I> indicates that the function is allowed.  Both the access and sharing
values must be<I> A</I> for the open to work. For example, in the CF Open
- CF Open of the same process, if the first CF Open is RO - DW, then the
next CF Open must be RO - DW.  Any access other than RO fails.  Any sharing
other than DW also will fail.
<P>
Abbreviations of access modes are:<!-- lm: 0x2 3 -->
<UL>
<P>
<LI><!-- lm: 0x2 6 -->RO - READ ONLY<!-- lm: 0x2 3 -->
<P>
<LI><!-- lm: 0x2 6 -->WO - WRITE ONLY<!-- lm: 0x2 3 -->
<P>
<LI><!-- lm: 0x2 6 -->WR - READ and WRITE<!-- lm: 0x2 1 -->
</UL>
<P>
Abbreviations for sharing modes are:<!-- lm: 0x2 3 -->
<UL>
<P>
<LI><!-- lm: 0x2 6 -->DR - DENY READ<!-- lm: 0x2 3 -->
<P>
<LI><!-- lm: 0x2 6 -->DW - DENY WRITE<!-- lm: 0x2 3 -->
<P>
<LI><!-- lm: 0x2 6 -->DN - DENY NONE<!-- lm: 0x2 3 -->
<P>
<LI><!-- lm: 0x2 6 -->EX - EXCLUSIVE  (DENY ALL)<!-- lm: 0x2 1 -->
</UL>
<P>

<PRE>
                          Element Opened Again

                   ┌┬─────────────────┬┬───────────────────────┐
          Element  ││     Access      ││        Sharing        │
          Opened   ││ RO    WO    RW  ││ DR    DW     DN   EX  │
        ┌──────────┼┼─────┬─────┬─────┼┼─────┬─────┬─────┬─────┤
        │RO - DR   ││  X  │  A  │  X  ││  X  │  A  │  A  │  X  │
        ├──────────┼┼─────┼─────┼─────┼┼─────┼─────┼─────┼─────┤
        │RO - DW   ││  A  │  X  │  X  ││  X  │  A  │  A  │  X  │
        ├──────────┼┼─────┼─────┼─────┼┼─────┼─────┼─────┼─────┤
        │RO - DN   ││  A  │  A  │  A  ││  X  │  A  │  A  │  X  │
        ├──────────┼┼─────┼─────┼─────┼┼─────┼─────┼─────┼─────┤
        │RO - EX   ││  X  │  X  │  X  ││  X  │  X  │  X  │  X  │
        ├──────────┼┼─────┼─────┼─────┼┼─────┼─────┼─────┼─────┤
        ├──────────┼┼─────┼─────┼─────┼┼─────┼─────┼─────┼─────┤
        │RW - DR   ││  X  │  A  │  X  ││  X  │  X  │  A  │  X  │
        ├──────────┼┼─────┼─────┼─────┼┼─────┼─────┼─────┼─────┤
        │RW - DW   ││  A  │  X  │  X  ││  X  │  X  │  A  │  X  │
        ├──────────┼┼─────┼─────┼─────┼┼─────┼─────┼─────┼─────┤
        │RW - DN   ││  A  │  A  │  A  ││  X  │  X  │  A  │  X  │
        ├──────────┼┼─────┼─────┼─────┼┼─────┼─────┼─────┼─────┤
        │RW - EX   ││  X  │  X  │  X  ││  X  │  X  │  X  │  X  │
        ├──────────┼┼─────┼─────┼─────┼┼─────┼─────┼─────┼─────┤
        ├──────────┼┼─────┼─────┼─────┼┼─────┼─────┼─────┼─────┤
        │WO - DR   ││  X  │  A  │  X  ││  A  │  X  │  A  │  X  │
        ├──────────┼┼─────┼─────┼─────┼┼─────┼─────┼─────┼─────┤
        │WO - DW   ││  A  │  X  │  X  ││  A  │  X  │  A  │  X  │
        ├──────────┼┼─────┼─────┼─────┼┼─────┼─────┼─────┼─────┤
        │WO - DN   ││  A  │  A  │  A  ││  A  │  X  │  A  │  X  │
        ├──────────┼┼─────┼─────┼─────┼┼─────┼─────┼─────┼─────┤
        │WO - EX   ││  X  │  X  │  X  ││  X  │  X  │  X  │  X  │
        ├──────────┼┼─────┼─────┼─────┼┼─────┼─────┼─────┼─────┤
        └──────────┴┴─────┴─────┴─────┴┴─────┴─────┴─────┴─────┘

                             Any Process
                            ──────────────

</PRE>

<PRE>


                                Elements Opened

                   ┌┬─────────────────┬┬───────────────────────┐
                   ││     Access      ││        Sharing        │
         CF Opened ││ RO    WO    RW  ││ DR    DW     DN   EX  │
        ┌──────────┼┼─────┬─────┬─────┼┼─────┬─────┬─────┬─────┤
        │RO - DR   ││  A  │  X  │  X  ││  A  │  A  │  A  │  A  │
        ├──────────┼┼─────┼─────┼─────┼┼─────┼─────┼─────┼─────┤
        │RO - DW   ││  A  │  X  │  X  ││  A  │  A  │  A  │  A  │
        ├──────────┼┼─────┼─────┼─────┼┼─────┼─────┼─────┼─────┤
        │RO - DN   ││  A  │  X  │  X  ││  A  │  A  │  A  │  A  │
        ├──────────┼┼─────┼─────┼─────┼┼─────┼─────┼─────┼─────┤
        │RO - EX   ││  A  │  X  │  X  ││  A  │  A  │  A  │  A  │
        ├──────────┼┼─────┼─────┼─────┼┼─────┼─────┼─────┼─────┤
        ├──────────┼┼─────┼─────┼─────┼┼─────┼─────┼─────┼─────┤
        │RW - DR   ││  A  │  A  │  A  ││  A  │  A  │  A  │  A  │
        ├──────────┼┼─────┼─────┼─────┼┼─────┼─────┼─────┼─────┤
        │RW - DW   ││  A  │  A  │  A  ││  A  │  A  │  A  │  A  │
        ├──────────┼┼─────┼─────┼─────┼┼─────┼─────┼─────┼─────┤
        │RW - DN   ││  A  │  A  │  A  ││  A  │  A  │  A  │  A  │
        ├──────────┼┼─────┼─────┼─────┼┼─────┼─────┼─────┼─────┤
        │RW - EX   ││  A  │  A  │  A  ││  A  │  A  │  A  │  A  │
        ├──────────┼┼─────┼─────┼─────┼┼─────┼─────┼─────┼─────┤
        ├──────────┼┼─────┼─────┼─────┼┼─────┼─────┼─────┼─────┤
        │WO - DR   ││  X  │  A  │  X  ││  A  │  A  │  A  │  A  │
        ├──────────┼┼─────┼─────┼─────┼┼─────┼─────┼─────┼─────┤
        │WO - DW   ││  X  │  A  │  X  ││  A  │  A  │  A  │  A  │
        ├──────────┼┼─────┼─────┼─────┼┼─────┼─────┼─────┼─────┤
        │WO - DN   ││  X  │  A  │  X  ││  A  │  A  │  A  │  A  │
        ├──────────┼┼─────┼─────┼─────┼┼─────┼─────┼─────┼─────┤
        │WO - EX   ││  X  │  A  │  X  ││  A  │  A  │  A  │  A  │
        ├──────────┼┼─────┼─────┼─────┼┼─────┼─────┼─────┼─────┤
        └──────────┴┴─────┴─────┴─────┴┴─────┴─────┴─────┴─────┘


                             Same Process
                            ──────────────

</PRE>

<PRE>

                      Fully Qualified Element Open
                      ────────────────────────────

                   ┌┬─────────────────┬┬───────────────────────┐
                   ││     Access      ││        Sharing        │
         CF Opened ││ RO    WO    RW  ││ DR    DW     DN   EX  │
        ┌──────────┼┼─────┬─────┬─────┼┼─────┬─────┬─────┬─────┤
        │RW - DN   ││  A  │  A  │  A  ││  A  │  A  │  A  │  A  │
        ├──────────┼┼─────┼─────┼─────┼┼─────┼─────┼─────┼─────┤
        └──────────┴┴─────┴─────┴─────┴┴─────┴─────┴─────┴─────┘

</PRE>

<PRE>


                              CF Opened Again

                   ┌┬─────────────────┬┬───────────────────────┐
                   ││     Access      ││        Sharing        │
         CF Opened ││ RO    WO    RW  ││ DR    DW     DN   EX  │
        ┌──────────┼┼─────┬─────┬─────┼┼─────┬─────┬─────┬─────┤
        │RO - DR   ││  X  │  X  │  X  ││  X  │  X  │  X  │  X  │
        ├──────────┼┼─────┼─────┼─────┼┼─────┼─────┼─────┼─────┤
        │RO - DW   ││  A  │  X  │  X  ││  X  │  A  │  X  │  X  │
        ├──────────┼┼─────┼─────┼─────┼┼─────┼─────┼─────┼─────┤
        │RO - DN   ││  A  │  X  │  X  ││  X  │  X  │  A  │  X  │
        ├──────────┼┼─────┼─────┼─────┼┼─────┼─────┼─────┼─────┤
        │RO - EX   ││  X  │  X  │  X  ││  X  │  X  │  X  │  X  │
        ├──────────┼┼─────┼─────┼─────┼┼─────┼─────┼─────┼─────┤
        ├──────────┼┼─────┼─────┼─────┼┼─────┼─────┼─────┼─────┤
        │RW - DR   ││  X  │  X  │  X  ││  X  │  X  │  X  │  X  │
        ├──────────┼┼─────┼─────┼─────┼┼─────┼─────┼─────┼─────┤
        │RW - DW   ││  X  │  X  │  X  ││  X  │  X  │  X  │  X  │
        ├──────────┼┼─────┼─────┼─────┼┼─────┼─────┼─────┼─────┤
        │RW - DN   ││  X  │  X  │  A  ││  X  │  X  │  A  │  X  │
        ├──────────┼┼─────┼─────┼─────┼┼─────┼─────┼─────┼─────┤
        │RW - EX   ││  X  │  X  │  X  ││  X  │  X  │  X  │  X  │
        ├──────────┼┼─────┼─────┼─────┼┼─────┼─────┼─────┼─────┤
        ├──────────┼┼─────┼─────┼─────┼┼─────┼─────┼─────┼─────┤
        │WO - DR   ││  X  │  A  │  X  ││  A  │  X  │  X  │  X  │
        ├──────────┼┼─────┼─────┼─────┼┼─────┼─────┼─────┼─────┤
        │WO - DW   ││  X  │  X  │  X  ││  X  │  X  │  X  │  X  │
        ├──────────┼┼─────┼─────┼─────┼┼─────┼─────┼─────┼─────┤
        │WO - DN   ││  X  │  A  │  X  ││  X  │  X  │  A  │  X  │
        ├──────────┼┼─────┼─────┼─────┼┼─────┼─────┼─────┼─────┤
        │WO - EX   ││  X  │  X  │  X  ││  X  │  X  │  X  │  X  │
        ├──────────┼┼─────┼─────┼─────┼┼─────┼─────┼─────┼─────┤
        └──────────┴┴─────┴─────┴─────┴┴─────┴─────┴─────┴─────┘


                            Same Process
                           ──────────────



</PRE>

<PRE>

                              Element Opened
                             (different process)

                   ┌┬─────────────────┬┬───────────────────────┐
                   ││     Access      ││        Sharing        │
         CF Opened ││ RO    WO    RW  ││ DR    DW     DN   EX  │
        ┌──────────┼┼─────┬─────┬─────┼┼─────┬─────┬─────┬─────┤
        │RO - DR   ││  X  │  A  │  X  ││  X  │  A  │  A  │  X  │
        ├──────────┼┼─────┼─────┼─────┼┼─────┼─────┼─────┼─────┤
        │RO - DW   ││  A  │  X  │  X  ││  X  │  A  │  A  │  X  │
        ├──────────┼┼─────┼─────┼─────┼┼─────┼─────┼─────┼─────┤
        │RO - DN   ││  A  │  A  │  A  ││  X  │  X  │  A  │  X  │
        ├──────────┼┼─────┼─────┼─────┼┼─────┼─────┼─────┼─────┤
        │RO - EX   ││  X  │  X  │  X  ││  X  │  X  │  X  │  X  │
        ├──────────┼┼─────┼─────┼─────┼┼─────┼─────┼─────┼─────┤
        ├──────────┼┼─────┼─────┼─────┼┼─────┼─────┼─────┼─────┤
        │RW - DR   ││  X  │  A  │  X  ││  X  │  X  │  A  │  X  │
        ├──────────┼┼─────┼─────┼─────┼┼─────┼─────┼─────┼─────┤
        │RW - DW   ││  A  │  X  │  X  ││  X  │  X  │  A  │  X  │
        ├──────────┼┼─────┼─────┼─────┼┼─────┼─────┼─────┼─────┤
        │RW - DN   ││  A  │  A  │  A  ││  X  │  X  │  A  │  X  │
        ├──────────┼┼─────┼─────┼─────┼┼─────┼─────┼─────┼─────┤
        │RW - EX   ││  X  │  X  │  X  ││  X  │  X  │  X  │  X  │
        ├──────────┼┼─────┼─────┼─────┼┼─────┼─────┼─────┼─────┤
        ├──────────┼┼─────┼─────┼─────┼┼─────┼─────┼─────┼─────┤
        │WO - DR   ││  X  │  A  │  X  ││  A  │  X  │  A  │  X  │
        ├──────────┼┼─────┼─────┼─────┼┼─────┼─────┼─────┼─────┤
        │WO - DW   ││  A  │  X  │  X  ││  A  │  X  │  A  │  X  │
        ├──────────┼┼─────┼─────┼─────┼┼─────┼─────┼─────┼─────┤
        │WO - DN   ││  A  │  A  │  A  ││  X  │  X  │  A  │  X  │
        ├──────────┼┼─────┼─────┼─────┼┼─────┼─────┼─────┼─────┤
        │WO - EX   ││  X  │  X  │  X  ││  X  │  X  │  X  │  X  │
        ├──────────┼┼─────┼─────┼─────┼┼─────┼─────┼─────┼─────┤
        └──────────┴┴─────┴─────┴─────┴┴─────┴─────┴─────┴─────┘

</PRE>

<PRE>


                              CF Opened Again

                   ┌┬─────────────────┬┬───────────────────────┐
                   ││     Access      ││        Sharing        │
         CF Opened ││ RO    WO    RW  ││ DR    DW     DN   EX  │
        ┌──────────┼┼─────┬─────┬─────┼┼─────┬─────┬─────┬─────┤
        │RO - DR   ││  X  │  A  │  X  ││  X  │  A  │  A  │  X  │
        ├──────────┼┼─────┼─────┼─────┼┼─────┼─────┼─────┼─────┤
        │RO - DW   ││  A  │  X  │  X  ││  X  │  A  │  A  │  X  │
        ├──────────┼┼─────┼─────┼─────┼┼─────┼─────┼─────┼─────┤
        │RO - DN   ││  A  │  A  │  A  ││  X  │  A  │  A  │  X  │
        ├──────────┼┼─────┼─────┼─────┼┼─────┼─────┼─────┼─────┤
        │RO - EX   ││  X  │  X  │  X  ││  X  │  X  │  X  │  X  │
        ├──────────┼┼─────┼─────┼─────┼┼─────┼─────┼─────┼─────┤
        ├──────────┼┼─────┼─────┼─────┼┼─────┼─────┼─────┼─────┤
        │RW - DR   ││  X  │  A  │  X  ││  X  │  X  │  A  │  X  │
        ├──────────┼┼─────┼─────┼─────┼┼─────┼─────┼─────┼─────┤
        │RW - DW   ││  A  │  X  │  X  ││  X  │  X  │  A  │  X  │
        ├──────────┼┼─────┼─────┼─────┼┼─────┼─────┼─────┼─────┤
        │RW - DN   ││  A  │  A  │  A  ││  X  │  X  │  A  │  X  │
        ├──────────┼┼─────┼─────┼─────┼┼─────┼─────┼─────┼─────┤
        │RW - EX   ││  X  │  X  │  X  ││  X  │  X  │  X  │  X  │
        ├──────────┼┼─────┼─────┼─────┼┼─────┼─────┼─────┼─────┤
        ├──────────┼┼─────┼─────┼─────┼┼─────┼─────┼─────┼─────┤
        │WO - DR   ││  X  │  A  │  X  ││  A  │  X  │  A  │  X  │
        ├──────────┼┼─────┼─────┼─────┼┼─────┼─────┼─────┼─────┤
        │WO - DW   ││  A  │  X  │  X  ││  A  │  X  │  A  │  X  │
        ├──────────┼┼─────┼─────┼─────┼┼─────┼─────┼─────┼─────┤
        │WO - DN   ││  A  │  A  │  A  ││  A  │  X  │  A  │  X  │
        ├──────────┼┼─────┼─────┼─────┼┼─────┼─────┼─────┼─────┤
        │WO - EX   ││  X  │  X  │  X  ││  X  │  X  │  X  │  X  │
        ├──────────┼┼─────┼─────┼─────┼┼─────┼─────┼─────┼─────┤
        └──────────┴┴─────┴─────┴─────┴┴─────┴─────┴─────┴─────┘


                           Different Process
                          ───────────────────
</PRE>


<P><HR>

<A HREF="2290_L4_EmbeddedFileInformat.html">[Back: Embedded File Information]</A> <BR>
<A HREF="2292_L1_ReturnCodes.html">[Next: Return Codes]</A> 
</BODY>
</HTML>
