<HTML>
<HEAD>
<META HTTP-EQUIV="CONTENT-TYPE" CONTENT="TEXT/HTML; CHARSET=UTF-8">
<TITLE>Setting and Querying Menu-Item Attributes</TITLE>
</HEAD>
<BODY>
<H1>Setting and Querying Menu-Item Attributes</H1><!-- entering slot 1657 -->
<P>
Menu-item attributes are represented in the<I> fAttribute</I> field of the
MENUITEM data structure.  Typically, attributes are set in the resource-definition
file of the menu and are changed at run time as required.  Applications
can use the MM_SETITEMATTR and MM_QUERYITEMATTR messages to set and query
attributes for a particular menu item.  One of the most common uses of these
messages is to check and uncheck menu items to let the user know what option
is selected currently.  For example, if you have a menu item that should
toggle between checked and unchecked each time the user selects it, you
can use the following figure to change the checked attribute. In this example,
you send an MM_QUERYITEMATTR message to the menu item to obtain its current
checked attribute; then, you use the exclusive OR operator to toggle the
state; and finally, you send the new attribute state back to the item using
an MM_SETITEMATTR message.
<PRE>

    usAttrib = SHORT1FROMMR(
        WinSendMsg(hwndMenu,           /* Submenu window        */
        MM_QUERYITEMATTR,              /* Message               */
        (MPARAM)itemID,                /* Item identifier       */
        (MPARAM)MIA_CHECKED            /* Attribute mask        */
        ));

    usAttrib = MIA_CHECKED;        /* XOR to toggle checked attribute */

    WinSendMsg(hwndMenu,                      /* Submenu window        */
        MM_SETITEMATTR,                       /* Message               */
        (MPARAM)itemID,                       /* Item identifier       */
        MPFROM2SHORT(MIA_CHECKED, usAttrib)); /* Attribute mask, value */

</PRE>


<P><HR>

<A HREF="1621_L3_RespondingtoaUsersMe.html">[Back: Responding to a User's Menu Choice]</A> <BR>
<A HREF="1623_L3_AddingandDeletingMen.html">[Next: Adding and Deleting Menu Items]</A> 
</BODY>
</HTML>
