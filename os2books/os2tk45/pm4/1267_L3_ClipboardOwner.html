<HTML>
<HEAD>
<TITLE>Clipboard Owner</TITLE>
</HEAD>
<BODY>
<H1>Clipboard Owner</H1><!-- entering slot 1288 -->
<P>
The<I> clipboard owner</I> is any application window connected to the clipboard
data.  Following are situations in which an application would call WinSetClipbrdOwner
to become the clipboard owner:<!-- lm: 0x2 3 -->
<UL>
<P>
<LI><!-- lm: 0x2 6 -->The application calling WinSetClipbrdData passes a
NULL pointer or handle to the clipboard, indicating that the application
renders the data in a particular format on request.  As a result, the system
sends rendering requests to the current clipboard owner.<!-- lm: 0x2 3 -->
<P>
<LI><!-- lm: 0x2 6 -->The application calling WinSetClipbrdData passes data
with the CFI_OWNERFREE attribute, indicating that the application frees
memory for data when the clipboard is emptied.  As a result, the system
sends owner-free requests to the current clipboard owner.<!-- lm: 0x2 3 -->
<P>
<LI><!-- lm: 0x2 6 -->The application calling WinSetClipbrdData passes data
with the CFI_OWNERDISPLAY attribute, indicating that the owner application
draws the data in the clipboard viewer.  As a result, the clipboard viewer
sends drawing-related requests to the current clipboard owner.<!-- lm: 0x2 1 -->
</UL>
<P>
The window specified in the call to the WinSetClipbrdOwner function responds
to the following messages:
<PRE>ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿³Message             ³Description                             ³
ÃÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
³WM_RENDERFMT        ³Sent by the system to the clipboard     ³
³                    ³owner when a particular format with     ³
³                    ³delayed rendering must be rendered.  The³
³                    ³receiver must render the data in the    ³
³                    ³specified format and pass it to the     ³
³                    ³clipboard by calling the                ³
³                    ³WinSetClipbrdData function.             ³
ÃÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
³WM_RENDERALLFMTS    ³Sent by the system to the clipboard     ³
³                    ³owner just before the owner application ³
³                    ³terminates.  The receiver must render   ³
³                    ³the clipboard data in all formats on the³
³                    ³clipboard with delayed rendering.  It   ³
³                    ³must pass the data for each format to   ³
³                    ³the clipboard by calling the            ³
³                    ³WinSetClipbrdData function.             ³
ÃÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
³WM_DESTROYCLIPBOARD ³Sent by the system to the clipboard     ³
³                    ³owner when the clipboard is cleared by  ³
³                    ³another application calling the         ³
³                    ³WinEmptyClipbrd function.  The receiver ³
³                    ³must free the memory occupied by any    ³
³                    ³clipboard formats using the             ³
³                    ³CFI_OWNERFREE attribute.                ³
ÃÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
³WM_SIZECLIPBOARD    ³Sent by the clipboard viewer to the     ³
³                    ³clipboard owner when the clipboard      ³
³                    ³contains the data handle with the       ³
³                    ³CFI_OWNERDISPLAY attribute and when the ³
³                    ³clipboard-viewer changes size.  When the³
³                    ³clipboard viewer is being destroyed or  ³
³                    ³reduced to an icon, this message is sent³
³                    ³with the coordinates of the opposite    ³
³                    ³corners set to (0,0), which permits the ³
³                    ³owner to free its display resources.    ³
ÃÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
³WM_VSCROLLCLIPBOARD ³Sent by the clipboard viewer to the     ³
³                    ³clipboard owner when the clipboard      ³
³                    ³contains data with the CFI_OWNERDISPLAY ³
³                    ³attribute and when an event occurs in   ³
³                    ³the clipboard-viewer scroll bars.  The  ³
³                    ³receiver must respond to this message by³
³                    ³scrolling the image, invalidating the   ³
³                    ³appropriate area of the clipboard       ³
³                    ³viewer, and updating the slider         ³
³                    ³position.                               ³
ÃÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
³WM_HSCROLLCLIPBOARD ³Sent by the clipboard viewer to the     ³
³                    ³clipboard owner when the clipboard      ³
³                    ³contains data with the CFI_OWNERDISPLAY ³
³                    ³attribute and when an event occurs in   ³
³                    ³the scroll bars of the clipboard viewer.³
³                    ³The receiver must respond to this       ³
³                    ³message by scrolling the image,         ³
³                    ³invalidating the appropriate area of the³
³                    ³clipboard viewer, and updating the      ³
³                    ³slider position.                        ³
ÃÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
³WM_PAINTCLIPBOARD   ³Sent by the clipboard viewer to the     ³
³                    ³clipboard owner when the clipboard      ³
³                    ³contains data with the CFI_OWNERDISPLAY ³
³                    ³attribute and when the clipboard-viewer ³
³                    ³client area needs repainting.  The      ³
³                    ³receiver must respond to this message by³
³                    ³painting the requested format (by       ³
³                    ³calling WinGetPS for the window handle  ³
³                    ³of the clipboard viewer).               ³
ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ
</PRE>

<P>
An application automatically loses ownership of the clipboard when the clipboard
data is cleared by the WinEmptyClipbrd function.  Ownership is necessary
only when data is present on the clipboard.  Typically, an application loses
ownership when another application places data on the clipboard.

<P><HR>

<A HREF="1266_L3_ClipboardViewer.html">[Back: Clipboard Viewer]</A> <BR>
<A HREF="1268_L2_UsingtheClipboard.html">[Next: Using the Clipboard]</A> 
</BODY>
</HTML>
