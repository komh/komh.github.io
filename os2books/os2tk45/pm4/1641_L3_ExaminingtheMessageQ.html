<HTML>
<HEAD>
<META HTTP-EQUIV="CONTENT-TYPE" CONTENT="TEXT/HTML; CHARSET=UTF-8">
<TITLE>Examining the Message Queue</TITLE>
</HEAD>
<BODY>
<H1>Examining the Message Queue</H1><!-- entering slot 1678 -->
<P>
An application can examine the contents of the message queue by using the
WinPeekMsg or WinQueryQueueStatus function.  It is useful to examine the
queue if the application starts a lengthy operation that additional user
input might affect, or if the application needs to look ahead in the queue
to anticipate a response to user input.
<P>
An application can use WinPeekMsg to check for specific messages in the
message queue.  This function is useful for extracting messages for a specific
window from the queue.  It returns immediately if there is no message in
the queue.  An application can use WinPeekMsg in a loop without requiring
the loop to wait for a message to arrive.  The following code fragment checks
the queue for WM_CHAR messages:
<P>

<PRE>    HAB hab;
    QMSG qmsg;

    if (WinPeekMsg(hab, &amp;qmsg, (HWND) NULL, WM_CHAR, WM_CHAR, PM_NOREMOVE)){
              .
              . /* Process the message. */
              .
    }

</PRE>

<P>
An application also can use the WinQueryQueueStatus function to check for
messages in the queue.  This function is very fast and returns information
about the kinds of messages available in the queue and which messages have
been posted recently.  Most applications use this function in message loops
that need to be as fast as possible.

<P><HR>

<A HREF="1640_L3_CreatingaMessageQueu.html">[Back: Creating a Message Queue and Message Loop]</A> <BR>
<A HREF="1642_L3_PostingaMessagetoaWi.html">[Next: Posting a Message to a Window]</A> 
</BODY>
</HTML>
