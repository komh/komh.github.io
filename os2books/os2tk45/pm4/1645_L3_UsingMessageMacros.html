<HTML>
<HEAD>
<META HTTP-EQUIV="CONTENT-TYPE" CONTENT="TEXT/HTML; CHARSET=UTF-8">
<TITLE>Using Message Macros</TITLE>
<STYLE>
PRE {
  FONT-FAMILY: Consolas, "Lucida Console", "Courier New", Courier, MONOSPACE;
}
</STYLE>
</HEAD>
<BODY>
<H1>Using Message Macros</H1><!-- entering slot 1682 -->
<P>
The system header files define several macros that help create and interpret
message parameters.
<P>
One set of macros helps you construct message parameters.  These macros
are useful for sending and posting messages.  For example, the following
code fragment uses the MPFROMSHORT macro to convert a 16-bit integer into
the 32-bit message parameter:
<PRE>
    HWND hwndButton;

    WinSendMsg(hwndButton, BM_SETCHECK, MPFROMSHORT(1), NULL);

</PRE>

<P>
A second set of macros helps you extract values from a message parameter.
 These macros are useful for handling messages in a window procedure.  The
following code fragment determines whether the window receiving the WM_FOCUSCHANGE
message is gaining or losing the keyboard focus.  The fragment uses the
SHORT1FROMMP macro to extract the focus-change flag, the SHORT2FROMMP macro
to extract the focus flag, and the HWNDFROMMP macro to extract the window
handle.
<PRE>    USHORT fsFocusChange;
    MPARAM mp1, mp2;
    HWND hwndGainFocus;


    case WM_FOCUSCHANGE:
        fsFocusChange = SHORT2FROMMP(mp2);    /* Gets focus-change flags  */
        if (SHORT1FROMMP(mp2))                /* Gaining or losing focus? */
            hwndGainFocus = HWNDFROMMP(mp1);
</PRE>

<P>
A third set of macros helps you construct a message result.  These macros
are useful for returning message results in a window procedure, as the following
code fragment illustrates:
<PRE>    return (MRFROM2SHORT(1, 2));

</PRE>


<P><HR>

<A HREF="1644_L3_BroadcastingaMessage.html">[Back: Broadcasting a Message]</A> <BR>
<A HREF="1646_L1_MultipleLineEntryFie.html">[Next: Multiple-Line Entry Field Controls]</A> 
</BODY>
</HTML>
