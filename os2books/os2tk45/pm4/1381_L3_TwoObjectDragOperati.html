<HTML>
<HEAD>
<META HTTP-EQUIV="CONTENT-TYPE" CONTENT="TEXT/HTML; CHARSET=UTF-8">
<TITLE>Two-Object Drag Operation</TITLE>
</HEAD>
<BODY>
<H1>Two-Object Drag Operation</H1><!-- entering slot 1407 -->
<P>
The following diagram represents the sequence of functions and message flows
for a typical direct manipulation operation. The flow shows a two-object
drag from App1 to App3, dragging over App2.
<P>
The direct manipulation operation is started by the source window procedure
after the user selects the objects to be manipulated and the source receives
a WM_BEGINDRAG message.
<PRE>
<PRE>                                <B>Two-Object Drag</B>
┌─────────────────────────────────────────────────────────────────────────────┐
│               App1                   App2                    App3           │
└─────────────────────────────────────────────────────────────────────────────┘
                  .                      .                       .
  (user select)   .                      .                       .
 ────────────────.                      .                       .
                  .                      .                       .
  WM_BEGINDRAG    .                      .                       .
 ────────────────.                      .                       .
                  .                      .                       .
                  .                      .                       .
            DrgAllocDraginfo             .                       .
                  .                      .                       .
            DrgAddStrHandle              .                       .
                  .                      .                       .
            DrgAddStrHandle              .                       .
                  .                      .                       .
            DrgSetDragitem               .                       .
                  .                      .                       .
            DrgSetDragitem               .                       .
                  .                      .                       .
               DrgDrag                   .                       .
                  .                      .                       .
                  .     DM_DRAGOVER      .                       .
                  .─────────────────────.                       .
                  .                      .                       .
                  .               DrgAccessDraginfo              .
                  .                      .                       .
                  .           DrgSetDragImage (optional)         .
                  .                      .                       .
                  .       (Verify that drop can be accepted)     .
                  .                      .                       .
                  .              (Target emphasis on)            .
                  .                      .                       .
                  .                 DrgFreeDraginfo              .
                  .                      .                       .
                  .                      .                       .
                  .      DOR_DROP        .                       .
                  .─────────────────────.                       .
                  .                      .                       .
                  .    DM_DRAGLEAVE      .                       .
                  .─────────────────────.                       .
                  .                      .                       .
                  .              (Target emphasis off)           .
                  .                      .                       .
                  .                      .                       .
                  .                      .                       .
                  .                      .                       .
                  .                 DM_DRAGOVER                  .
                  .─────────────────────────────────────────────.
                  .                      .                       .
                  .                      .                DrgAccessDraginfo
                  .                      .                       .
                  .                      .            DrgSetDragImage (optional)
                  .                      .                       .
                  .                      .               (Target emphasis on)
                  .                      .                       .
                  .                      .                       .
                  .                      .                       .

                  .                  DOR_DROP                    .
                  .─────────────────────────────────────────────.
   (WM_ENDDRAG)   .                      .                       .
 ────────────────.                      .                       .
                  .                      .                       .
                  .                      .                       .
                  .                   DM_DROP                    .
                  .─────────────────────────────────────────────.
                  .                      .                       .
                  .                      .                       .
                  .                      .            (Target emphasis off)
                  .                      .                       .
           (DrgDrag returns)             .             (Perform operation)
                  .                      .                       .
            DrgFreeDraginfo              .         DrgDeleteDraginfoStrHandles
                  .                      .                       .
                  .                      .               DrgFreeDraginfo
                  .                      .                       .
                  .                      .                       .

</PRE>
</PRE>


<P><HR>

<A HREF="1380_L4_ResponsetoMessagesSe.html">[Back: Response to Messages Sent to a Target Application]</A> <BR>
<A HREF="1382_L3_Conversationafterthe.html">[Next: Conversation after the Drop]</A> 
</BODY>
</HTML>
