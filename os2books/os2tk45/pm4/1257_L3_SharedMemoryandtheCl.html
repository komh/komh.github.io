<HTML>
<HEAD>
<TITLE>Shared Memory and the Clipboard</TITLE>
</HEAD>
<BODY>
<H1>Shared Memory and the Clipboard</H1><!-- entering slot 1278 -->
<P>
An application must store, in shared memory, text data that is destined
for the clipboard.  To do so, the application calls the DosAllocSharedMem
function with the OBJ_GIVEABLE attribute to allocate a shared memory object,
and then copies the text data to the object.  The application passes the
clipboard a pointer, which the clipboard uses to access the shared memory
object.  Clipboard functions use the CFI_POINTER flag to indicate text data
stored in a shared memory object.
<P>
To pass a bit map or metafile to the clipboard, an application passes the
clipboard a bit map or metafile handle.  The clipboard functions make the
bit map or metafile<I> shareable</I>.  The CFI_HANDLE flag is used in clipboard
functions to indicate bit map or metafile data.
<P>
After closing the clipboard, an application no longer can access the data
it passed to the clipboard.  Likewise, when an application requests data
from the clipboard, it receives a pointer or handle that is good only until
the application closes the clipboard.  Typically, the application either
uses the data immediately before closing the clipboard, or it copies the
data to local memory for future use, then closes the clipboard.

<P><HR>

<A HREF="1256_L2_AbouttheClipboard.html">[Back: About the Clipboard]</A> <BR>
<A HREF="1258_L3_ClipboardOperations.html">[Next: Clipboard Operations]</A> 
</BODY>
</HTML>
