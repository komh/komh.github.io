<HTML>
<HEAD>
<META HTTP-EQUIV="CONTENT-TYPE" CONTENT="TEXT/HTML; CHARSET=UTF-8">
<TITLE>Accessing the System Menu</TITLE>
</HEAD>
<BODY>
<H1>Accessing the System Menu</H1><!-- entering slot 1655 -->
<P>
Although most applications do not alter the system menu, you can obtain
the handle of the system menu by calling WinWindowFromID with a frame-window
handle (or dialog-window handle) and the identifier FID_SYSMENU.  Once you
have the handle of the system menu, you can access the individual menu items
by using predefined constants.  For example, the following code fragment
shows how to disable the<I> Close</I> menu item in the system menu of a
window:
<PRE>    HWND hwndSysMenu;
    HWND hwndFrame;

    hwndSysMenu = WinWindowFromID(hwndFrame, FID_SYSMENU);

    WinSendMsg(hwndSysMenu, MM_SETITEMATTR,
        MPFROM2SHORT(SC_CLOSE, TRUE),
        MPFROM2SHORT(MIA_DISABLED, MIA_DISABLED));

</PRE>


<P><HR>

<A HREF="1619_L3_AddingaMenutoaDialog.html">[Back: Adding a Menu to a Dialog Window]</A> <BR>
<A HREF="1621_L3_RespondingtoaUsersMe.html">[Next: Responding to a User's Menu Choice]</A> 
</BODY>
</HTML>
