<HTML>
<HEAD>
<META HTTP-EQUIV="CONTENT-TYPE" CONTENT="TEXT/HTML; CHARSET=UTF-8">
<TITLE>Creating a File Dialog</TITLE>
</HEAD>
<BODY>
<H1>Creating a File Dialog</H1><!-- entering slot 1534 -->
<P>
To present a file dialog to users, your application must do the following:
<!-- lm: 0x2 2 -->
<UL>
<P>
 <LI><LI><!-- lm: 0x2 6 -->Allocate storage for a FILEDLG data structure
and set all fields to NULL.<!-- lm: 0x2 2 -->
<P>
 <LI><LI><!-- lm: 0x2 6 -->Initialize the fields in the FILEDLG data structure.

<P>
The application must do the following:<!-- lm: 0x2 7 -->
<UL>
<P>
 a.<!-- lm: 0x2 11 -->
<UL>Set the<I> cbSize</I> field to the size of the
data structure.<!-- lm: 0x2 7 -->
</UL>  b.<!-- lm: 0x2 11 -->
<UL>Set the
<I>fl</I> field to indicate the type of dialog. You must set the FDS_OPEN_DIALOG
or FDS_SAVEAS_DIALOG flags.<!-- lm: 0x2 6 -->
</UL> The application can
set the following:<!-- lm: 0x2 7 -->
<UL>
<P>
 a.<!-- lm: 0x2 11 -->
<UL>An application-specific title. Pass the pointer
to a null-terminated string in the<I> pszTitle</I> field.<!-- lm: 0x2 7 -->
</UL>
b.<!-- lm: 0x2 11 -->
<UL>An application-specific text for the<I> OK</I> push
button. Pass the pointer to a null-terminated string in the<I> pszOKButton
</I>field.<!-- lm: 0x2 7 -->
</UL>  c.<!-- lm: 0x2 11 -->
<UL>A custom dialog
procedure to provide application-specific function. Pass the pointer to
a window procedure in the<I> pfnDlgProc</I> field.<!-- lm: 0x2 7 -->
</UL>
d.<!-- lm: 0x2 11 -->
<UL>Set other FDS_* flags in the<I> fl</I> field to
customize the dialog style.<!-- lm: 0x2 7 -->
</UL>  e.<!-- lm: 0x2 11 -->
<UL>Pass
the initial position of the dialog in the<I> x</I> and<I> y</I> fields.
<!-- lm: 0x2 6 --><!-- lm: 0x2 2 -->
</UL> 3.<!-- lm: 0x2 6 -->
<UL>Initialize
the FILEDLG data structure with any values that users should see when they
invoke the dialog for the first time. For example, you can:<!-- lm: 0x2 7 -->
<UL>
<P>
 a.<!-- lm: 0x2 11 -->
<UL>Pass the name of the first drive from which file
information will be displayed in the<I> pszIDrive</I> field.<!-- lm: 0x2 7 -->
</UL>
b.<!-- lm: 0x2 11 -->
<UL>If you want to limit user selections, pass a list
of drives from which the user can choose in the<I> papszIDriveList</I> field.
Otherwise, the system defaults to showing all available drives.<!-- lm: 0x2 7 -->
</UL>
c.<!-- lm: 0x2 11 -->
<UL>Pass the name of an extended-attribute filter
to be used to filter file information in the<I> pszIType</I> field.<!-- lm: 0x2 7 -->
</UL>
d.<!-- lm: 0x2 11 -->
<UL>Pass a list of extended attributes in the<I> papszITypeList
</I>field. By selecting from this list, users can filter file information.
<!-- lm: 0x2 7 -->
</UL> e.<!-- lm: 0x2 11 -->
<UL>Pass the name of the
initial file to be used by the dialog in the<I> szFullFile</I> field. This
can be a file name or a string filter, such as *.dat, to filter the initial
file information. This field can be fully qualified to select the initial
drive and directory.<!-- lm: 0x2 6 --><!-- lm: 0x2 2 -->
</UL>  4.<!-- lm: 0x2 6 -->
<UL>Invoke
the file dialog. Call WinFileDlg and pass the dialog's owner window handle
and a pointer to the initialized FILEDLG data structure.<!-- lm: 0x2 2 -->
</UL>
5.<!-- lm: 0x2 6 -->
<UL>Verify the return value from WinFileDlg. If it
is successful, the application can create the file dialog (either Open or
SaveAs) by using the file name or file names returned from the dialog.<!-- lm: 0x2 1 -->
</UL>

<P><HR>

<A HREF="1500_L2_UsingFileDialogContr.html">[Back: Using File Dialog Controls]</A> <BR>
<A HREF="1502_L3_CreatinganOpenDialog.html">[Next: Creating an Open Dialog]</A> 
</BODY>
</HTML>
