<HTML>
<HEAD>
<TITLE>Menu-Item Structure</TITLE>
</HEAD>
<BODY>
<H1>Menu-Item Structure</H1><!-- entering slot 1646 -->
<P>
A single menu item is defined by the MENUITEM data structure.  This structure
is used with the MM_INSERTITEM message to insert items in a menu or to query
and set item characteristics with the MM_QUERYITEM and MM_SETITEM messages.
 The MENUITEM structure has the following form:
<P>

<PRE>    typedef struct _MENUITEM { /* mi */
        SHORT  iPosition;
        USHORT afStyle;
        USHORT afAttribute;
        USHORT id;
        HWND   hwndSubMenu;
        ULONG  hItem;
    } MENUITEM;

</PRE>

<P>
You can derive the values of most of the fields in this structure directly
from the resource-definition file.  However, the last field in the structure,
<I>hItem</I>, depends on the style of the menu item.
<P>
The<I> iPosition</I> field specifies the ordinal position of the item within
its menu window.  If the item is part of the menu bar,<I> iPosition</I> specifies
its relative left-to-right position, with 0 being the leftmost item.  If
the item is part of a submenu,<I> iPosition</I> specifies its relative top-to-bottom
and left-to-right positions, with 0 being the upper-left item.  An item
with the MIS_BREAKSEPARATOR style in a pull-down menu causes a new column
to begin.
<P>
The<I> afStyle</I> field contains the style bits of the item.  The<I> afAttribute
</I>field contains the attribute bits.
<P>
The<I> id</I> field contains the menu-item identifier.  The identifier<I> should
</I>be unique but does not<I> have</I> to be.  Just remember that, when
multiple items have the same identifier, they post the same command number
in the WM_COMMAND, WM_SYSCOMMAND, and WM_HELP messages.  Also, any message
that specifies a menu item with a non-unique identifier will find the first
item that has that identifier.
<P>
The<I> hwndSubMenu</I> field contains the window handle of a submenu window
(if the item is a submenu item).  The<I> hwndSubMenu</I> field is NULL for
command items.
<P>
The<I> hItem</I> field contains a handle to the display object for the item,
unless the item has the MIS_TEXT style, in which case,<I> hItem</I> is 0.
 For example, a menu item with the MIS_BITMAP style has an<I> hItem</I> field
that is equal to its bit-map handle.

<P><HR>

<A HREF="1610_L4_MenuItemAttributes.html">[Back: Menu-Item Attributes]</A> <BR>
<A HREF="1612_L3_MenuAccess.html">[Next: Menu Access]</A> 
</BODY>
</HTML>
