<HTML>
<HEAD>
<META HTTP-EQUIV="CONTENT-TYPE" CONTENT="TEXT/HTML; CHARSET=UTF-8">
<TITLE>Clipboard Viewer</TITLE>
</HEAD>
<BODY>
<H1>Clipboard Viewer</H1><!-- entering slot 1287 -->
<P>
A window can become a clipboard viewer and display the current contents
of the clipboard.  The clipboard viewer is informed whenever the clipboard
contents change.  Typically, the clipboard viewer is a window that can draw
the standard clipboard formats.  The clipboard viewer is a convenience for
the user; it does not have any effect on the data-transaction functions
of the clipboard.
<P>
To create a clipboard viewer, an application calls WinSetClipbrdViewer,
specifying the window in which the clipboard data will be displayed.  Usually
this is the client window of an application.  There can be only one clipboard
viewer at any time in the system, so setting a clipboard viewer replaces
any previous clipboard viewer.  The WinQueryClipbrdViewer function receives
the handle to the current clipboard viewer so that the application can reset
it when finished with the clipboard viewer.
<P>
Once a window becomes the clipboard viewer, it receives WM_DRAWCLIPBOARD
messages whenever the contents of the clipboard change.  The window should
respond to these messages by drawing the contents of the clipboard.
<P>
The clipboard viewer displays all the standard formats and should process
CFI_OWNERDISPLAY items by sending the appropriate message to the clipboard
owner.
<P>
The clipboard viewer cannot display private-format data.  For this reason,
an application that writes private-format data to the clipboard also must
write the data in one of the three standard-display formats:  CF_DSPTEXT,
CF_DSPBITMAP, or CF_DSPMETAFILE.
<P>
If a standard format is not provided in addition to the private formats,
the clipboard owner must draw the clipboard data in the clipboard-viewer
window.  An application uses the CFI_OWNERDRAW flag to identify clipboard
data that the clipboard owner draws.  When the clipboard viewer encounters
data with the CFI_OWNERDRAW flag set, it sends WM_PAINTCLIPBOARD messages
to the clipboard owner whenever the data must be drawn, scrolled, or sized.

<P>
The clipboard viewer determines the attributes of a particular clipboard
format by calling the WinQueryClipbrdFmtInfo function.  The identity of
the current owner is found by calling the WinQueryClipbrdOwner function.


<P><HR>

<A HREF="1265_L3_DelayedRendering.html">[Back: Delayed Rendering]</A> <BR>
<A HREF="1267_L3_ClipboardOwner.html">[Next: Clipboard Owner]</A> 
</BODY>
</HTML>
