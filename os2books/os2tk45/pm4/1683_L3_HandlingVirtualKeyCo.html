<HTML>
<HEAD>
<META HTTP-EQUIV="CONTENT-TYPE" CONTENT="TEXT/HTML; CHARSET=UTF-8">
<TITLE>Handling Virtual-Key Codes</TITLE>
</HEAD>
<BODY>
<H1>Handling Virtual-Key Codes</H1><!-- entering slot 1720 -->
<P>
The following code fragment shows how to decode a WM_CHAR message containing
a valid virtual-key code:
<PRE>    USHORT fsKeyFlags;

    case WM_CHAR:
    fsKeyFlags = (USHORT) SHORT1FROMMP(mp1);

    if (fsKeyFlags &amp; KC_VIRTUALKEY) {

        /* Get the virtual key from mp2.       */
        switch (SHORT2FROMMP(mp2)) {
         case VK_TAB:
             .
             . /* Process the TAB key.         */
             .
             return TRUE;
         case VK_LEFT:
             .
             . /* Process the LEFT key.        */
             .
             return TRUE;
         case VK_UP:
             .
             . /* Process the UP key.          */
             .
             return TRUE;
         case VK_RIGHT:
             .
             . /* Process the RIGHT key.       */
             .
             return TRUE;
         case VK_DOWN:
             .
             . /* Process the DOWN key.        */
             .
             return TRUE;
           .
           . /* Etc...                         */
           .
           default:
               return FALSE;
           }
       }

</PRE>


<P><HR>

<A HREF="1682_L3_RespondingtoaCharact.html">[Back: Responding to a Character Message]</A> <BR>
<A HREF="1684_L3_HandlingaScanCode.html">[Next: Handling a Scan Code]</A> 
</BODY>
</HTML>
