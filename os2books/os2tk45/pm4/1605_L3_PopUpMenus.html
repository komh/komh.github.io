<HTML>
<HEAD>
<META HTTP-EQUIV="CONTENT-TYPE" CONTENT="TEXT/HTML; CHARSET=UTF-8">
<TITLE>Pop-Up Menus</TITLE>
</HEAD>
<BODY>
<H1>Pop-Up Menus</H1><!-- entering slot 1640 -->
<P>
A pop-up menu is like a pull-down submenu, except that it is not attached
to the menu bar; it can appear anywhere in its parent window.  A pop-up
menu usually is associated with a<I> portion</I> of a window, such as the
client window, or it is associated with a specific object, such as an icon.

<P>
A pop-up menu remains hidden until the user selects it (either by moving
the cursor to the appropriate location and pressing Enter or clicking on
the location with the mouse).  Typically, pop-up menus are displayed at
the position of the cursor or mouse pointer; they provide a quick mechanism
for selecting often-used menu items.
<P>
To include a pop-up menu in an application, you first must define a menu
resource in a resource-definition file, then load the resource using the
WinLoadMenu or WinCreateMenu functions.  You must call WinPopupMenu to create
the pop-up menu and display it in the parent window.  Applications typically
call WinPopupMenu in a window procedure in response to a user-generated
message, such as WM_BUTTON2DBLCLK or WM_CHAR.
<P>
WinPopupMenu requires that you specify the pop-up menu's handle and also
the handles of the parent and owner windows of the pop-up menu.  WinLoadMenu
and WinCreateMenu return the handle of the pop-up menu window, but you must
obtain the handles of the parent and owner by using WinQueryWindow.
<P>
You determine the position of the pop-up menu in relation to its parent
by specifying coordinates and style flags in WinPopupMenu.  The<I> x</I> and
<I>y</I> coordinates determine the position of the lower-left corner of
the menu relative to the lower-left corner of the parent.  The system may
adjust this position, however, if you include the PU_HCONSTRAIN or PU_VCONSTRAIN
style flags in the call to WinPopupMenu.  If necessary, PU_HCONSTRAIN adjusts
the horizontal position of the menu so that its left and right edges are
within the borders of the desktop window.  PU_VCONSTRAIN makes the same
adjustments vertically.  Without these flags, a desktop-level pop-up menu
can lie partially off the screen, with some items not visible nor selectable.

<P>
The PU_POSITIONONITEM flag also can affect the position of the pop-up menu.
 This flag positions the pop-up menu so that, when the pop-up menu appears,
the specified item lies directly under the mouse pointer.  Also, PU_POSITIONONITEM
automatically selects the item.  PU_POSITIONONITEM is useful for placing
the current menu selection under the pointer so that, if the user releases
the mouse button without selecting a new item, the current selection remains
unchanged.
<P>
The PU_SELECTITEM flag is similar to PU_POSITIONONITEM except that it just
selects the specified item; it does not affect the position of the menu.

<P>
You can enable the user to choose an item from a pop-up menu by using the
same mouse button that was used to display the menu.  To do this, specify
the PU_MOUSEBUTTON<I>n</I> flag, where<I> n</I> corresponds to the mouse
button used to display the menu.  This flag specifies the mouse buttons
for the user to interact with a pop-up menu once it is displayed.
<P>
By using the PU_MOUSEBUTTON<I>n</I> flag, you can enable the user to display
the pop-up menu, select an item, and dismiss the menu, all in one operation.
 For example, if your window procedure displays the pop-up window when the
user double-clicks mouse button 2, specify the PU_MOUSEBUTTON2DOWN flag
in the WinPopupMenu function.  Then, the user can display the menu with
mouse button 2; and, while holding the button down, select an item.  When
the user releases the button, the item is chosen and the menu dismissed.


<P><HR>

<A HREF="1604_L3_MenuBarandPullDownMe.html">[Back: Menu Bar and Pull-Down Menus]</A> <BR>
<A HREF="1606_L3_SystemMenu.html">[Next: System Menu]</A> 
</BODY>
</HTML>
