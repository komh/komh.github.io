<HTML>
<HEAD>
<TITLE>Retrieving Data from the Clipboard</TITLE>
</HEAD>
<BODY>
<H1>Retrieving Data from the Clipboard</H1><!-- entering slot 1291 -->
<P>
The following code fragment shows how to open the clipboard, retrieve data
in the requested format, copy the data to local memory, and close the clipboard:

<P>

<PRE>    PSZ pszClipText, pszLocalText;

    if (WinOpenClipbrd(hab)) {
        if (pszClipText = (PSZ) WinQueryClipbrdData(hab, CF_TEXT)) {

            /* Copy text from the shared memory object to local memory. */
            while (*pszLocalText++ = *pszClipText++);
        }
        WinCloseClipbrd(hab);
    }

</PRE>


<P><HR>

<A HREF="1269_L3_PuttingDataontheClip.html">[Back: Putting Data on the Clipboard]</A> <BR>
<A HREF="1271_L3_ViewingDataontheClip.html">[Next: Viewing Data on the Clipboard]</A> 
</BODY>
</HTML>
