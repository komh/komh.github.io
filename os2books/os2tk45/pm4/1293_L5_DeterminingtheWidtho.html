<HTML>
<HEAD>
<TITLE>Determining the Width of a Column in a Details View</TITLE>
</HEAD>
<BODY>
<H1>Determining the Width of a Column in a Details View</H1><!-- entering slot 1314 -->
<BR>
There are instances when you might want to determine the width of a column
in the Details view. A function has been added to the container control
to allow you to determine the width of the data in a column. You can then
compute the width of the entire column by adding the width of the data to
the left and right margins of the column. To determine the width of a column:
<!-- lm: 0x2 2 -->
<UL>
<P>
 <LI><LI><!-- lm: 0x2 6 -->Define an attribute with a value of 0x0200 and
give it a name such as CMA_DATAWIDTH.<!-- lm: 0x2 2 -->
<P>
 <LI><LI><!-- lm: 0x2 6 -->Issue the CM_QUERYDETAILFIELDINFO message with
the following values:<!-- lm: 0x2 7 -->
<UL>
<P>
 a.<!-- lm: 0x2 11 -->
<UL>Provide a pointer to the FIELDINFO data structure
in<I> param1</I>.<!-- lm: 0x2 7 -->
</UL>  b.<!-- lm: 0x2 11 -->
<UL>Specify
your attribute (see step 1) in<I> param2</I>.<!-- lm: 0x2 7 -->
</UL>  c.<!-- lm: 0x2 11 -->
<UL>Request
a return value with a type of LONG, not PFIELDINFO, to retrieve the width
of the column in the FIELDINFO data structure to which you are pointing.
The value returned is the width of the data (text, icon, or bit map) in
this column.<!-- lm: 0x2 6 --><!-- lm: 0x2 2 -->
</UL>  3.<!-- lm: 0x2 6 -->
<UL>Use
GpiQueryFontMetrics to query the average character width of the font used
by the container. This value will be used to calculate the total column
width.<!-- lm: 0x2 2 -->
</UL>  4.<!-- lm: 0x2 6 -->
<UL>Multiply 3 by the
average character width and add this to the data width returned from step
2 for all columns except the following:<!-- lm: 0x2 8 -->
<UL>
<P>
<LI><!-- lm: 0x2 11 -->The first and last columns in each split window.
In these cases, multiply 2.5 by the average character width and add the
column data width returned from step 2.<!-- lm: 0x2 8 -->
<P>
<LI><!-- lm: 0x2 11 -->The only other special case is where there is only
1 column in either the left or right split windows. In this case, you would
multiply 2 by the average character width and add the column data width
returned from step 2.<!-- lm: 0x2 6 --><!-- lm: 0x2 2 -->
</UL>  5.<!-- lm: 0x2 6 -->
<UL>The
value returned is the total width of the column.<!-- lm: 0x2 1 -->
</UL>

<P><HR>

<A HREF="1292_L4_DetailsView.html">[Back: Details View]</A> <BR>
<A HREF="1294_L5_SplitBarSupportforth.html">[Next: Split Bar Support for the Details View]</A> 
</BODY>
</HTML>
