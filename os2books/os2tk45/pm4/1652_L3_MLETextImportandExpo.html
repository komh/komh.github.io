<HTML>
<HEAD>
<META HTTP-EQUIV="CONTENT-TYPE" CONTENT="TEXT/HTML; CHARSET=UTF-8">
<TITLE>MLE Text Import and Export Operations</TITLE>
</HEAD>
<BODY>
<H1>MLE Text Import and Export Operations</H1><!-- entering slot 1689 -->
<P>
An application can copy text to and from an MLE field by importing and exporting.
To import text to an MLE field, an application can use the MLM_IMPORT message,
which copies text from a buffer to the MLE field. To export text from an
MLE field, the application can use the MLM_EXPORT message, which copies
text from the MLE field to a buffer. The application uses the MLM_SETIMPORTEXPORT
message to set the import and export buffers.
<P>
An application can import and export text in a variety of formats. A text
format, set with the MLM_FORMAT message, identifies which characters are
used for the end-of-line characters. An MLE field can have the following
text formats:
<PRE>┌────────────────────┬────────────────────────────────────────┐
│Format Name         │Description                             │
├────────────────────┼────────────────────────────────────────┤
│MLFIE_CFTEXT        │Exported lines end with a carriage      │
│                    │return/newline character pair (<I>0x0D,    </I>│
│                    │<I>0x0A</I>). Imported lines must end with a   │
│                    │newline character, carriage             │
│                    │return/newline character pair, or       │
│                    │newline/carriage return character pair. │
├────────────────────┼────────────────────────────────────────┤
│MLFIE_NOTRANS       │Imported and exported lines end with a  │
│                    │newline character (<I>0x0A</I>).               │
├────────────────────┼────────────────────────────────────────┤
│MLFIE_WINFMT        │For exported lines, the carriage        │
│                    │return/newline character pair marks a   │
│                    │<I>hard</I> linebreak (a break entered by the  │
│                    │user). Two carriage-return characters   │
│                    │and a newline character (<I>0x0D, 0x0D,    </I>│
│                    │<I>0x0A</I>) mark a <I>soft</I> linebreak (a break    │
│                    │inserted during word wrapping and not   │
│                    │entered by the user). For imported      │
│                    │lines, the extra carriage-return in soft│
│                    │linebreak characters is ignored.        │
└────────────────────┴────────────────────────────────────────┘
</PRE>

<P>
The text format can affect the number of characters in a selection. To ensure
that the export buffer is large enough to hold exported text, an application
can send the MLM_QUERYFORMATLINELENGTH message. The application can send
the MLM_QUERYFORMATTEXTLENGTH message to determine the number of bytes in
the text to be exported.
<P>
Each time an application inserts text in an MLE field, the MLE field control
automatically refreshes (repaints) the display by drawing the new text.
When an application copies large amounts of text to an MLE field, refreshing
can be quite time-consuming, so the application should disable the refresh
state. The application disables the refresh state by sending the MLM_DISABLEREFRESH
message. After copying all the text, the application can restore the refresh
state by sending the MLM_ENABLEREFRESH message.

<P><HR>

<A HREF="1651_L3_MLETextFormatting.html">[Back: MLE Text Formatting]</A> <BR>
<A HREF="1653_L3_MLECutCopyandPasteOp.html">[Next: MLE Cut, Copy, and Paste Operations]</A> 
</BODY>
</HTML>
