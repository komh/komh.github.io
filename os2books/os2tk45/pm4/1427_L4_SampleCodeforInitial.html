<HTML>
<HEAD>
<TITLE>Sample Code for Initializing DRAGITEM Data Structure</TITLE>
</HEAD>
<BODY>
<H1>Sample Code for Initializing DRAGITEM Data Structure</H1><!-- entering slot 1453 -->
<P>
The following code fragment shows how to initialize the DRAGITEM array:

<PRE>/***********************************************************************/
/*  Get our current directory for the container name.                  */
/***********************************************************************/
   dirlen                     = CCHMAXPATH-1;
   DosQueryCurrentDir(0, szDir, &amp;dirlen);
   sprintf(szContainer, "\\%s\\", szDir);
   hstrContainer              = DrgAddStrHandle(szContainer);
   Dragitem.hwndItem          = hListWnd;
   Dragitem.hstrType          = hstrType;
   Dragitem.hstrRMF           = hstrRMF;
   Dragitem.hstrContainerName = hstrContainer;
   Dragitem.fsControl         = 0;
   Dragitem.fsSupportedOps    = DO_COPYABLE | DO_MOVEABLE;
   Dragitem.hstrSourceName    = DrgAddStrHandle (szBuffer);
   Dragitem.hstrTargetName    = Dragitem.hstrSourceName;
   Dragitem.ulItemID          = index;

/***********************************************************************/
/*  Set info, prepare for drag.                                        */
/***********************************************************************/
   DrgSetDragitem(pSourceDraginfo,
                  &amp;Dragitem,
                  sizeof(DRAGITEM),
                  0);

</PRE>


<P><HR>

<A HREF="1426_L4_SourceName.html">[Back: Source Name]</A> <BR>
<A HREF="1428_L3_InitializingDRAGIMAG.html">[Next: Initializing DRAGIMAGE Data Structure]</A> 
</BODY>
</HTML>
