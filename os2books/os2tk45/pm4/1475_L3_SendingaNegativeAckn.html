<HTML>
<HEAD>
<META HTTP-EQUIV="CONTENT-TYPE" CONTENT="TEXT/HTML; CHARSET=UTF-8">
<TITLE>Sending a Negative Acknowledgment</TITLE>
</HEAD>
<BODY>
<H1>Sending a Negative Acknowledgment</H1><!-- entering slot 1504 -->
<P>
You can send a negative acknowledgment by posting a WM_DDE_ACK message with
the DDE_NOTPROCESSED flag set in the status word of the shared-memory data
structure. By not specifying DDE_FACK, it is legal to specify DDE_NOTPROCESSED,
but only if the message is not supported, such as WM_DDE_POKE for the specified
item. DDE_NOTPROCESSED is not the negative respond. The following code fragment
shows how to do so:
<PRE>/*  Specify the status flag, when allocating shared memory */
pDDEdata-&gt;fstatus &amp;= 0;
    .
    .
    .

/*  Post the message */
WinDdePostMsg(hwndDest,           /* Handle of destination  */
              hwndSource,         /* Handle of source       */
              WM_DDE_ACK,         /* Message                */
              pDDEdata,           /* Shared-memory pointer  */
              DDEPM_RETRY);       /* Retry                  */

</PRE>

<P>
If an application is busy when it receives a DDE message, it can post a
WM_DDE_ACK message with the DDE_FBUSY flag set.

<P><HR>

<A HREF="1474_L3_SendingaPositiveAckn.html">[Back: Sending a Positive Acknowledgment]</A> <BR>
<A HREF="1476_L3_PerformingaOneTimeDa.html">[Next: Performing a One-Time Data Transfer]</A> 
</BODY>
</HTML>
