<HTML>
<HEAD>
<META HTTP-EQUIV="CONTENT-TYPE" CONTENT="TEXT/HTML; CHARSET=UTF-8">
<TITLE>Response to Messages Sent to a Target Application</TITLE>
<STYLE>
PRE {
  FONT-FAMILY: Consolas, "Lucida Console", "Courier New", Courier, MONOSPACE;
}
</STYLE>
</HEAD>
<BODY>
<H1>Response to Messages Sent to a Target Application</H1><!-- entering slot 1406 -->
<P>
The following table shows the four possible responses available to the target
when it receives a DM_DRAGOVER message. The target sends these values to
the window handle specified in the DRAGINFO data structure.
<PRE>┌────────────────────┬────────────────────────────────────────┐
│Message Name        │Description                             │
├────────────────────┼────────────────────────────────────────┤
│DOR_DROP            │Sent if the objects being dragged are   │
│                    │acceptable. A drop does not occur unless│
│                    │DOR_DROP is returned.                   │
├────────────────────┼────────────────────────────────────────┤
│DOR_NODROP          │Sent if the objects being dragged are   │
│                    │acceptable and the target supports the  │
│                    │current operation, but the objects      │
│                    │cannot be dropped on the current        │
│                    │location in the target window. For      │
│                    │example, a list box might return        │
│                    │DOR_NODROP if it contains objects that  │
│                    │can be dropped on, but the pointer is   │
│                    │over an object that cannot be dropped   │
│                    │on.                                     │
│                    │If the target response is DOR_NODROP,   │
│                    │the DM_DRAGOVER message continues to be │
│                    │sent to the target when:                │
│                    │o The pointer is moved                  │
│                    │o A keyboard key is pressed             │
│                    │o The pointer is moved out of           │
│                    │  and back into the window.             │
├────────────────────┼────────────────────────────────────────┤
│DOR_NODROPOP        │Sent if the objects being dragged are   │
│                    │acceptable, but the target does not     │
│                    │support the current operation. This     │
│                    │response implies that the drop may be   │
│                    │valid if the drag operation changes. For│
│                    │example, copying a file to a shredder   │
│                    │would not be valid, but moving a file to│
│                    │a shredder would be.                    │
│                    │Once the target has sent DOR_NODROPOP,  │
│                    │no further DM_DRAGOVER messages is sent │
│                    │to the target until:                    │
│                    │o A keyboard key is pressed             │
│                    │o The pointer is moved out of           │
│                    │  and back into the window.             │
├────────────────────┼────────────────────────────────────────┤
│DOR_NEVERDROP       │Sent when the objects being dragged are │
│                    │not acceptable, and the target will     │
│                    │never accept them.                      │
│                    │Once the target has sent DOR_NEVERDROP, │
│                    │no further DM_DRAGOVER messages are sent│
│                    │to that target until the pointer is     │
│                    │moved out of and back into the target   │
│                    │window.                                 │
└────────────────────┴────────────────────────────────────────┘
</PRE>

<P>
If a reply other than DOR_DROP is received from a target, the augmentation
emphasis is automatically changed to indicate that no drop is allowed. This
gives the user a visible cue that a drop cannot occur. The emphasis is reverted
to<I> drop allowed</I> when a DOR_DROP reply is received from some target.


<P><HR>

<A HREF="1379_L4_MessagesSenttoaTarge.html">[Back: Messages Sent to a Target Application]</A> <BR>
<A HREF="1381_L3_TwoObjectDragOperati.html">[Next: Two-Object Drag Operation]</A> 
</BODY>
</HTML>
