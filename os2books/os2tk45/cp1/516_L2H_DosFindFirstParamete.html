<HTML XPOS=30% YPOS=TOP WIDTH=70% HEIGHT=100%HIDDEN>
<HEAD>
<META HTTP-EQUIV="CONTENT-TYPE" CONTENT="TEXT/HTML; CHARSET=UTF-8">
<!-- extra bytes: 03 00 14 1E 00 04 00 11 46 00 64 00 --><TITLE>DosFindFirst - Parameters</TITLE>
<STYLE>
PRE {
  FONT-FAMILY: Consolas, "Lucida Console", "Courier New", Courier, MONOSPACE;
}
</STYLE>
</HEAD>
<BODY>
<H1>DosFindFirst - Parameters</H1><!-- entering slot 522 --><!-- lm: 0x2 1 -->
<UL>
<P>
<B>pszFileSpec</B> (<A><!-- external link: 1D C1 C4 B3 -->PSZ</A>) - input
<!-- lm: 0x11 4 -->
<UL>Address of the ASCIIZ path name of the file or subdirectory
to be found.
<P>
The name component can contain global file name characters.<!-- lm: 0x2 1 -->
</UL><!-- lm: 0x2 1 -->
<P>
<B>phdir</B> (<A><!-- external link: 1D 96 C4 B0 -->PHDIR</A>) - in/out
<!-- lm: 0x11 4 -->
<UL>Address of the handle associated with this DosFindFirst
request.
<P>
The values that can be specified for the handle are shown in the following
list:<!-- lm: 0x2 4 -->
<P>
HDIR_CREATE (0xFFFFFFFF)<!-- lm: 0x11 13 -->
<UL> The system allocates and
returns a handle. Upon return to the caller,<I> phdir</I> contains the handle
allocated by the system for use by the process.  This is the recommended
option to use.<!-- lm: 0x2 4 -->
</UL> HDIR_SYSTEM (0x00000001)<!-- lm: 0x11 13 -->
<UL> The
system assigns the handle for standard output, which is always available
to a process.<!-- lm: 0x2 4 -->
</UL> The DosFindFirst handle is used with
subsequent <A HREF="521_L2_DosFindNext.html">DosFindNext</A> requests. Reuse
of this handle in another DosFindFirst request closes the association with
the previous DosFindFirst request, and opens a new association with the
current DosFindFirst request.<!-- lm: 0x2 1 -->
</UL><!-- lm: 0x2 1 -->
<P>
<B>flAttribute</B> (<A><!-- external link: 1D DB C4 E6 -->ULONG</A>) - input
<!-- lm: 0x11 4 -->
<UL>Attribute value that determines the file objects
to be searched for.
<P>
The bit values are shown in the following list:<!-- lm: 0x2 4 -->
<P>
31-14<!-- lm: 0x2 19 -->
<UL> Reserved; must be 0.<!-- lm: 0x2 4 -->
</UL> 13
<!-- lm: 0x2 19 -->
<UL>MUST_HAVE_ARCHIVED (0x00002000) Must-Have Archive
bit; excludes files without the archive bit set if bit 13 is set to 1. Files
may have the Archive bit set if bit 13 is set to 0.<!-- lm: 0x2 4 -->
</UL> 12
<!-- lm: 0x2 19 -->
<UL>MUST_HAVE_DIRECTORY (0x00001000)
<BR>
Must-Have Subdirectory bit; excludes files that are not subdirectories if
bit 12 is set to 1. Files may have the Subdirectory bit set if bit 12 is
set to 0.<!-- lm: 0x2 4 -->
</UL> 11<!-- lm: 0x2 19 -->
<UL> Reserved; must
be 0.<!-- lm: 0x2 4 -->
</UL> 10<!-- lm: 0x2 19 -->
<UL> MUST_HAVE_SYSTEM
(0x00000400)
<BR>
Must-Have System File bit; excludes nonsystem files if bit 10 is set to
1. Files may be system files if bit 10 is set to 0.<!-- lm: 0x2 4 -->
</UL> 9
<!-- lm: 0x2 19 -->
<UL>MUST_HAVE_HIDDEN (0x00000200)
<BR>
Must-Have Hidden File bit; excludes nonhidden files if bit 9 is set to 1.
Files may be nonhidden if bit 9 is set to 0.<!-- lm: 0x2 4 -->
</UL> 8<!-- lm: 0x2 19 -->
<UL> MUST_HAVE_READONLY
(0x00000100)
<BR>
Must-Have Read-Only File bit; excludes writeable files if bit 8 is set to
1. Files may be read-only if bit 8 is set to 0.<!-- lm: 0x2 4 -->
</UL> 7-6
<!-- lm: 0x2 19 -->
<UL>Reserved; must be 0.<!-- lm: 0x2 4 -->
</UL> 5<!-- lm: 0x2 19 -->
<UL> FILE_ARCHIVED
(0x00000020)
<BR>
May-Have Archive bit; includes files with the Archive bit set if bit 5 is
set to 1. Excludes files with the Archive bit set if bit 5 is set to 0.
<!-- lm: 0x2 4 -->
</UL>4<!-- lm: 0x2 19 -->
<UL> FILE_DIRECTORY (0x00000010)

<BR>
May-Have Subdirectory bit; includes files that are subdirectories if bit
4 is set to 1. Excludes files that are subdirectories if bit 4 is set to
0.<!-- lm: 0x2 4 -->
</UL> 3<!-- lm: 0x2 19 -->
<UL> Reserved; must be 0.
<!-- lm: 0x2 4 -->
</UL>2<!-- lm: 0x2 19 -->
<UL> FILE_SYSTEM (0x00000004)

<BR>
May-Have System File bit; includes system files if bit 2 is set to 1. Excludes
system files if bit 2 is set to 0.<!-- lm: 0x2 4 -->
</UL> 1<!-- lm: 0x2 19 -->
<UL> FILE_HIDDEN
(0x00000002)
<BR>
May-Have Hidden File bit; includes hidden files if bit 1 is set to 1.  Excludes
hidden files if bit 1 is set to 0.<!-- lm: 0x2 4 -->
</UL> 0<!-- lm: 0x2 19 -->
<UL> FILE_READONLY
(0x00000001)
<BR>
May-Have Read-Only File bit; includes read-only files if bit 0 is set to
1. Excludes read-only files if bit 0 is set to 0.<!-- lm: 0x2 4 -->
</UL> These
bits may be set individually or in combination. For example, an attribute
value of 0x00000024 (bits 5 and 2 set to 1) indicates searching for system
files that have been archived.
<P>
Bits 8 through 13 are "Must-Have" flags. These allow you to obtain files
that definitely have the given attributes. For example, if the Must-Have
Subdirectory bit is set to 1, then all returned items are subdirectories.

<P>
If a Must-Have bit is set to 1, and the corresponding May-Have bit is set
to 0, no items are returned for that attribute.
<P>
The attribute FILE_NORMAL (0x00000000) can be used to include files with
any of the above bits set.
<P>
<I>flAttribute</I> cannot specify the volume label. Volume labels are queried
using <A HREF="1190_L2_DosQueryFSInfo.html">DosQueryFSInfo</A>.<!-- lm: 0x2 1 -->
</UL><!-- lm: 0x2 1 -->
<P>
<B>pfindbuf</B> (<A><!-- external link: 1D C6 C4 B5 -->PVOID</A>) - in/out
<!-- lm: 0x11 4 -->
<UL>Result buffer.
<P>
The result buffer from DosFindFirst should be less than 64KB.
<P>
Address of the directory search structures for file object information Levels
1 through 3. The structure required for<I> pfindbuf</I> is dependent on
the value specified for<I> ulInfoLevel</I>. The information returned reflects
the most recent call to <A HREF="132_L2_DosClose.html">DosClose</A> or <A HREF="1475_L2_DosResetBuffer.html">DosResetBuffer</A>.
<!-- lm: 0x2 4 -->
<P>
For Level 1 File Information (<I>ulInfoLevel</I> == FIL_STANDARD) :<!-- lm: 0x11 12 -->
<UL> On
output,<I> pfindbuf</I> contains the<A><!-- external link: 1D 86 C4 6B --> FILEFINDBUF3
</A>data structure without the last two fields:<I> cchName</I> and<I> achName</I>.
This is used without EAs.
<P>
The<I> oNextEntryOffset</I><!-- entering slot 523 --> field indicates the
number of bytes from the beginning of the current structure to the beginning
of the next structure. When this field is 0, the last structure has been
reached.<!-- lm: 0x2 4 -->
</UL> For Level 2 File Information (<I>ulInfoLevel
</I>== FIL_QUERYEASIZE) :<!-- lm: 0x11 12 -->
<UL> On output,<I> pfindbuf
</I>contains the<A><!-- external link: 1D 87 C4 5F --> FILEFINDBUF4</A> data
structure without the last two fields:<I> cchName</I> and<I> achName</I>.
This is used with EAs.
<P>
The<I> cbList</I> field contains the size, in bytes, of the file's entire
EA set on disk. You can use this field to calculate the maximum size of
the buffer needed for Level 3 file information. The size of the buffer required
to hold the entire EA set is less than or equal to twice the size of the
EA set on disk.<!-- lm: 0x2 4 -->
</UL> For Level 3 File Information (<I>ulInfoLevel
</I>== FIL_QUERYEASFROMLIST) :<!-- lm: 0x11 12 -->
<UL> On input,<I> pfindbuf
</I>contains an<A><!-- external link: 1D 7B C4 4A --> EAOP2</A> data structure.
<I>fpGEA2List</I> contains a pointer to a<A><!-- external link: 1D 93 C4 6B --> GEA2
</A>list, which defines the attribute names whose values are to be returned.
Entries in the<A><!-- external link: 1D 93 C4 6B --> GEA2</A> list must
be aligned on a doubleword boundary. Each<I> oNextEntryOffset</I> field
must contain the number of bytes from the beginning of the current entry
to the beginning of the next entry.
<P>
On output,<I> pfindbuf</I> contains a structure with a set of records, each
aligned on a doubleword boundary. These records represent the directory
entry and associated EAs for the matched file object.<I> pfindbuf</I> has
the following format:<!-- lm: 0x2 14 -->
<UL>
<P>
<LI><!-- lm: 0x2 17 -->The<A><!-- external link: 1D 7B C4 4A --> EAOP2</A> data
structure, with the<I> fpFEA2List</I> pointer incorrect.
<P>
The<A><!-- external link: 1D 7B C4 4A --> EAOP2</A> data structure occurs
only once in the<I> pfindbuf</I> buffer. The rest of these records are repeated
for the remainder of the file objects found.<!-- lm: 0x2 14 -->
<P>
<LI><!-- lm: 0x2 17 -->A<A><!-- external link: 1D 86 C4 5E --> FILEFINDBUF3
</A>data structure without the last two fields:<I> cchName</I> and<I> achName</I>.
<!-- lm: 0x2 14 -->
<P>
<LI><!-- lm: 0x2 17 -->A<A><!-- external link: 1D 83 C4 58 --> FEA2LIST
</A>data structure contained in and related to the<A><!-- external link: 1D 86 C4 5E --> FILEFINDBUF3
</A>returned.<!-- lm: 0x2 14 -->
<P>
<LI><!-- lm: 0x2 17 -->Length of the name string of the file object (<I>cbName</I>)
<!-- lm: 0x2 14 -->
<P>
<LI><!-- lm: 0x2 17 -->Name of the file object matched by the input pattern
(<I>achName</I>)<!-- lm: 0x2 12 -->
</UL> Even if there is not enough room
to hold all of the requested information, as for return code ERROR_BUFFER_OVERFLOW,
the<I> cbList</I> field of the<A><!-- external link: 1D 83 C4 58 --> FEA2LIST
</A>data structure is valid if there is at least enough space to hold it.

<P>
When buffer overflow occurs,<I> cbList</I> contains the size on disk of
the entire EA set for the file, even if only a subset of its attributes
was requested. The size of the buffer required to hold the EA set is less
than or equal to twice the size of the EA set on disk. If no error occurs,
<I>cbList</I> includes the pad bytes (for doubleword alignment) between
<A><!-- external link: 1D 82 C4 57 -->FEA2</A> structures in the list.
<P>
If a particular attribute is not attached to the object,<I> pfindbuf</I> has
an<A><!-- external link: 1D 82 C4 57 --> FEA2</A> structure containing the
name of the attribute, and the length value is 0.
<P>
The<A><!-- external link: 1D 93 C4 6B --> GEA2</A> list contained inside
<I>pfindbuf</I> during a Level 3 DosFindFirst and <A HREF="521_L2_DosFindNext.html">DosFindNext
</A>call is not "read-only"; it is used by OS/2. When the function returns,
the list is restored to it's original state, but inside the function, the
list is manipulated by OS/2. This is of concern to a multithreaded application,
where two different threads might use the same<A><!-- external link: 1D 93 C4 6B --> GEA2
</A>list as input. If one thread calls DosFindFirst or <A HREF="521_L2_DosFindNext.html">DosFindNext
</A>while another thread is inside DosFindFirst or <A HREF="521_L2_DosFindNext.html">DosFindNext</A>,
the second thread will fail with a return code of ERROR_BAD_FORMAT.<!-- lm: 0x2 4 --><!-- lm: 0x2 1 -->
</UL><!-- lm: 0x2 1 -->
<P>
<B>cbBuf</B> (<A><!-- external link: 1D DB C4 E4 -->ULONG</A>) - input<!-- lm: 0x11 4 -->
<UL> The
length, in bytes, of<I> pfindbuf</I>.<!-- lm: 0x2 1 -->
</UL><!-- lm: 0x2 1 -->
<P>
<B>pcFileNames</B> (<A><!-- external link: 1D DB C4 B3 -->PULONG</A>) -
in/out<!-- lm: 0x11 4 -->
<UL> Pointer to the number of entries:
<P>
<!-- lm: 0x2 4 -->
<P>
Input<!-- lm: 0x2 17 -->
<UL> The address of the number of matching entries
requested in<I> pfindbuf</I>.<!-- lm: 0x2 4 -->
</UL> Output<!-- lm: 0x2 17 -->
<UL> The
number of entries placed into<I> pfindbuf</I>.<!-- lm: 0x2 4 --><!-- lm: 0x2 1 -->
</UL><!-- lm: 0x2 1 -->
<P>
<B>ulInfoLevel</B> (<A><!-- external link: 1D DB C4 E4 -->ULONG</A>) - input
<!-- lm: 0x11 4 -->
<UL>The level of file information required.
<P>
Possible values are:<!-- lm: 0x2 4 -->
<P>
<LI><!-- lm: 0x2 13 -->FIL_STANDARD Level 1 file information (return standard
file information).<!-- lm: 0x2 4 -->
<P>
<LI><!-- lm: 0x2 13 -->FIL_QUERYEASIZE Level 2 file information (return
full EA size).<!-- lm: 0x2 4 -->
<P>
<LI><!-- lm: 0x2 13 -->FIL_QUERYEASFROMLIST Level 3 file information (return
requested EA).<!-- lm: 0x2 4 -->
<P>
The structures described in<I> pfindbuf</I> indicate the information returned
for each of these levels.
<P>
Regardless of the level specified, a DosFindFirst request (and an associated
<A HREF="521_L2_DosFindNext.html">DosFindNext</A>) request on a handle returned
by DosFindFirst) always includes Level 1 information as part of the information
that is returned;<!-- entering slot 524 --> however, when Level 1 information
is specifically requested, and<I> flAttribute</I> specifies hidden files,
system files, or subdirectory files, an inclusive search is made. That is,
all normal file entries plus all entries matching any specified attributes
are returned. Normal files are files without any mode bits set. They may
be read from or written to.<!-- lm: 0x2 1 -->
</UL><!-- lm: 0x2 1 -->
<P>
<B>ulrc</B> (<A><!-- external link: 1D 67 C4 1B -->APIRET</A>) - returns
<!-- lm: 0x11 4 -->
<UL>Return Code.
<P>
DosFindFirst returns one of the following values:<!-- lm: 0x2 4 -->
<P>
<LI><!-- lm: 0x2 19 -->NO_ERROR<!-- lm: 0x2 4 --> 2<!-- lm: 0x2 19 -->
<UL> ERROR_FILE_NOT_FOUND
<!-- lm: 0x2 4 -->
</UL>3<!-- lm: 0x2 19 -->
<UL> ERROR_PATH_NOT_FOUND<!-- lm: 0x2 4 -->
</UL>6<!-- lm: 0x2 19 -->
<UL> ERROR_INVALID_HANDLE<!-- lm: 0x2 4 -->
</UL>18<!-- lm: 0x2 19 -->
<UL> ERROR_NO_MORE_FILES<!-- lm: 0x2 4 -->
</UL>26<!-- lm: 0x2 19 -->
<UL> ERROR_NOT_DOS_DISK<!-- lm: 0x2 4 -->
</UL>87<!-- lm: 0x2 19 -->
<UL> ERROR_INVALID_PARAMETER<!-- lm: 0x2 4 -->
</UL>108<!-- lm: 0x2 19 -->
<UL> ERROR_DRIVE_LOCKED<!-- lm: 0x2 4 -->
</UL>111<!-- lm: 0x2 19 -->
<UL> ERROR_BUFFER_OVERFLOW<!-- lm: 0x2 4 -->
</UL>113<!-- lm: 0x2 19 -->
<UL> ERROR_NO_MORE_SEARCH_HANDLES<!-- lm: 0x2 4 -->
</UL>206<!-- lm: 0x2 19 -->
<UL> ERROR_FILENAME_EXCED_RANGE<!-- lm: 0x2 4 -->
</UL>208<!-- lm: 0x2 19 -->
<UL> ERROR_META_EXPANSION_TOO_LONG<!-- lm: 0x2 4 -->
</UL>254<!-- lm: 0x2 19 -->
<UL> ERROR_INVALID_EA_NAME<!-- lm: 0x2 4 -->
</UL>255<!-- lm: 0x2 19 -->
<UL> ERROR_EA_LIST_INCONSISTENT<!-- lm: 0x2 4 -->
</UL>275<!-- lm: 0x2 19 -->
<UL> ERROR_EAS_DIDNT_FIT<!-- lm: 0x2 4 -->
</UL> For
a full list of error codes, see<A><!-- external link: 1D E8 C4 FC --> Errors</A>.
<!-- lm: 0x2 1 -->
</UL>

<P><HR>

<A HREF="515_L2H_DosFindFirstReturnVa.html">[Back: DosFindFirst Return Value - ulrc]</A> <BR>
<A HREF="517_L2H_DosFindFirstRemarks.html">[Next: DosFindFirst - Remarks]</A> 
</BODY>
</HTML>
