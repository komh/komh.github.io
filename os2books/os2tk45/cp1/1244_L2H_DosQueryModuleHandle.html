<HTML XPOS=30% YPOS=TOP WIDTH=70% HEIGHT=100%HIDDEN>
<HEAD>
<!-- extra bytes: 03 00 14 1E 00 04 00 11 46 00 64 00 --><TITLE>DosQueryModuleHandle - Example Code</TITLE>
</HEAD>
<BODY>
<H1>DosQueryModuleHandle - Example Code</H1><!-- entering slot 1261 -->
<P>
This example attempts to obtain the handle of a dynamic link module. This
allows the caller to test whether a given dynamic link module is currently
loaded.
<PRE>#define INCL_DOSMODULEMGR   /* Module Manager values */
#define INCL_DOSERRORS      /* DOS Error values */
#include &lt;os2.h&gt;
#include &lt;stdio.h&gt;

int main(VOID) {
   PSZ     ModuleName    = "C:\\OS2\\DLL\\DISPLAY.DLL";  /* Module name   */
   HMODULE ModuleHandle  = NULLHANDLE;                   /* Module handle */
   APIRET  rc            = NO_ERROR;                     /* Return code   */

   rc = DosQueryModuleHandle(ModuleName,      /* Module to look for       */
                             &amp;ModuleHandle);  /* Handle (returned)        */
   if (rc != NO_ERROR) {
      printf("DosQueryModuleHandle error: return code = %u\n", rc);
      return 1;
   } else {
      printf ("Module handle = %u\n", ModuleHandle);
   }

   rc = DosQueryModuleName (ModuleHandle,   /* Module handle to query     */
                            256L,           /* Maximum length of result   */
                            ModuleName);    /* Module name returned       */

   if (rc != NO_ERROR) {
      printf("DosQueryModuleName error: return code = %u\n", rc);
      return 1;
   } else {
      printf ("Module name = %s\n", ModuleName);
   }
   return NO_ERROR;
}
</PRE>


<P><HR>

<A HREF="1243_L2H_DosQueryModuleHandle.html">[Back: DosQueryModuleHandle - Related Functions]</A> <BR>
<A HREF="1245_L2H_DosQueryModuleHandle.html">[Next: DosQueryModuleHandle - Topics]</A> 
</BODY>
</HTML>
