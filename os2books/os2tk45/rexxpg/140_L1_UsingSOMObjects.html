<HTML>
<HEAD>
<TITLE>Using SOM Objects</TITLE>
</HEAD>
<BODY>
<H1>Using SOM Objects</H1><!-- entering slot 148 -->
<P>
In addition to creating your own classes with REXX, you can use classes,
objects, and methods created with the OS/2 System Object Model, or SOM.
You no longer need to work in C or C++ to use SOM objects.
<P>
To build SOM classes for use in REXX, you need to use the SOMobjects Developer
Toolkit, Release 2.1 or later. The interface repository files must be available
and specified correctly in the SOMIR environment variable. (See <A HREF="145_L3_BuildingSOMclassesfo.html">Building
SOM classes for Use within REXX</A> and the SOMObjects Developer Toolkit
publications for more information.)
<P>
Because the OS/2 Workplace Shell is composed of SOM objects, you now also
have complete control over the Workplace Shell from a REXX program.
<P>
Previously, traditional REXX provided some access to Workplace Shell objects
from REXX utility functions (such as SysQueryClassList, SysCreateObject,
SysSetObjectData and so on). Now you have access to all workplace classes
and methods. The following example shows how to create a folder on the desktop
by sending a wpclsNew message to the WPFolder class.
<PRE>folder = .wpFolder~wpclsNew('New Folder', /* Folder will have title "New Folder" */
                          '',             /* No Specific Setup String            */
                          .wpDeskTop,     /* Create new folder on the Desktop    */
                           1)             /* Lock the object to start with       */
folder~wpOpen(0,0,0)                      /* Open the folder (Default View)      */
folder~wpClose                            /* Now close the folder.               */
</PRE>

<P>
This REXX information does not include documentation for the workplace classes
and methods. They are documented with the reference information for the
Workplace Shell in the OS/2 Technical Library. The documentation for the
methods is in the form of C-language function calls. To use the function
calls to REXX, do the following:<!-- lm: 0x2 2 -->
<UL>
<P>
 <LI><LI><!-- lm: 0x2 6 -->Use the function name as the REXX method name.
<!-- lm: 0x2 2 -->
<P>
 <LI><LI><!-- lm: 0x2 6 -->Omit the first parameter (usually a pointer to
a class object or a pointer to an object) as an argument on the REXX call.
<!-- lm: 0x2 2 -->
<P>
 <LI><LI><!-- lm: 0x2 6 -->Use the other parameters in order. When string
input is required, simply use a REXX string. You don't need to worry about
supplying a zero terminator. For numeric or Boolean values, use REXX numbers
(which are actually strings).
<P>
In some cases, you'll be using several methods to do a task. Often, one
of these methods will return a pointer to an object, and this pointer will
be needed on other calls. To do this, assign the pointer to a regular REXX
variable and then pass this variable on subsequent methods.
<P>
For functions that require pointers to classes, use the class name as shown
in the preceding example (.wpDesktop). Remember to precede the class name
with a period.<!-- lm: 0x2 1 -->
</UL>
<P>
In addition to Workplace Shell objects, REXX can also create objects and
run methods for classes created using SOM.
<P>


<P><HR>

<A HREF="139_L2_UsingDevices.html">[Back: Using Devices]</A> <BR>
<A HREF="141_L2_ImportingSOMClasses.html">[Next: Importing SOM Classes]</A> 
</BODY>
</HTML>
