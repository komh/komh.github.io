<HTML>
<HEAD>
<TITLE>Example</TITLE>
</HEAD>
<BODY>
<H1>Example</H1><!-- entering slot 378 -->
<P>
The following is a sample of macrospace usage:
<BR>
Sample macrospace usage
<BR>

<PRE>                                       /* first load entire package  */
  RexxLoadMacroSpace(0, NULL, "EDITOR.MAC");
  for (i = 0; i &lt; MACRO_COUNT; i++) {  /* verify each macro          */
                                       /* if not there               */
    if (RexxQueryMacro(macroíiù, &amp;position))
                                       /* add to list                */
      RexxAddMacro(macroíiù, macro_filesíiù,
          RXMACRO_SEARCH_BEFORE);
  }
                                       /* rebuild the macrospace     */
  RexxSaveMacroSpace(0, NULL, "EDITOR.MAC");
.
.
.

                                       /* build the argument string  */
  MAKERXSTRING(argv[0], macro_argument,
      strlen(macro_argument));
                                       /* set up default return      */
  MAKERXSTRING(retstr, return_buffer, sizeof(return_buffer));
                                       /* set up for macrospace call */
  MAKERXSTRING(macrospace[0],NULL, 0);
  MAKERXSTRING(macrospace[1],NULL, 0);
  return_code = RexxStart(1,           /* one argument               */
                          argv,        /* argument array             */
                          macro[pos],  /* REXX procedure name        */
                          macrospace,  /* use macrospace version     */
                          "Editor",    /* default address name       */
                          RXCOMMAND,   /* calling as a subcommand    */
                          NULL,        /* no exits used              */
                          &amp;rc,         /* converted return code      */
                          &amp;retstr);    /* returned result            */
</PRE>


<P><HR>

<A HREF="366_L3_MacrospaceInterfaceR.html">[Back: Macrospace Interface Returns]</A> <BR>
<A HREF="368_L1_SampleREXXPrograms.html">[Next: Sample REXX Programs]</A> 
</BODY>
</HTML>
