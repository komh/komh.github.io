<HTML>
<HEAD>
<META HTTP-EQUIV="CONTENT-TYPE" CONTENT="TEXT/HTML; CHARSET=UTF-8">
<TITLE>Creating External Functions</TITLE>
<STYLE>
PRE {
  FONT-FAMILY: Consolas, "Lucida Console", "Courier New", Courier, MONOSPACE;
}
</STYLE>
</HEAD>
<BODY>
<H1>Creating External Functions</H1><!-- entering slot 203 -->
<P>
The following is a sample external function definition:
<BR>
Sample external function definition
<BR>

<PRE>ULONG SysLoadFuncs(
     PSZ       Name,                   /* name of the function       */
     LONG      Argc,                   /* number of arguments        */
     RXSTRING  Argv[],                 /* list of argument strings   */
     PSZ       Queuename,              /* current queue name         */
     PRXSTRING Retstr)                 /* returned result string     */
</PRE>

<P>
<!-- lm: 0x2 1 -->
<UL>
<P>
Name<!-- lm: 0x12 13 -->
<UL> Address of ASCIIZ function name used to call
the external function.<!-- lm: 0x2 1 -->
</UL> Argc<!-- lm: 0x12 13 -->
<UL> The
number of elements in the<I> Argv</I> array.<I> Argv</I> will contain<I> Argc
</I>RXSTRINGs.<!-- lm: 0x2 1 -->
</UL> Argv<!-- lm: 0x12 13 -->
<UL> An
array of null-terminated RXSTRINGs for the function arguments.<!-- lm: 0x2 1 -->
</UL> Queuename
<!-- lm: 0x12 13 -->
<UL>The name of the currently defined REXX external
data queue.<!-- lm: 0x2 1 -->
</UL> Retstr<!-- lm: 0x12 13 -->
<UL> Address
of an RXSTRING for the returned value.<I> Retstr</I> is a character string
function or subroutine return value. When a REXX program calls an external
function with the REXX CALL instruction,<I> Retstr</I> is assigned to the
REXX special variable RESULT. When the REXX program calls an external function
with a function call,<I> Retstr</I> is used directly within the REXX expression.

<P>
The REXX interpreter provides a default 256-byte RXSTRING in<I> Retstr</I>.
A longer RXSTRING can be allocated with DosAllocMem if the returned string
is longer than 256 bytes. The REXX interpreter releases<I> Retstr</I> with
DosFreeMem when the external function completes.<!-- lm: 0x2 1 -->
</UL> Returns
<!-- lm: 0x12 13 -->
<UL>An integer return code from the function. When
the external function returns 0, the function completed successfully.<I> Retstr
</I>contains the function return value. When the external function returns
a non-zero return code, the REXX interpreter raises REXX error 40 ("Incorrect
call to routine"). The<I> Retstr</I> value is ignored.
<P>
If the external function does not have a return value, the function should
set<I> Retstr</I> to an empty RXSTRING (NULL<I> strptr</I>). When an external
function called as a function does not return a value, the interpreter raises
error 44, "Function or message did not return data". When an external function
called with the REXX CALL instruction does not return a value, the REXX
interpreter drops (unassigns) the special variable RESULT.<!-- lm: 0x2 1 -->
</UL>

<P><HR>

<A HREF="192_L3_RegisteringExternalF.html">[Back: Registering External Functions]</A> <BR>
<A HREF="194_L3_CallingExternalFunct.html">[Next: Calling External Functions]</A> 
</BODY>
</HTML>
