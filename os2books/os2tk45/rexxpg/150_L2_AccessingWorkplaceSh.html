<HTML>
<HEAD>
<META HTTP-EQUIV="CONTENT-TYPE" CONTENT="TEXT/HTML; CHARSET=UTF-8">
<TITLE>Accessing Workplace Shell Objects</TITLE>
<STYLE>
PRE {
  FONT-FAMILY: Consolas, "Lucida Console", "Courier New", Courier, MONOSPACE;
}
</STYLE>
</HEAD>
<BODY>
<H1>Accessing Workplace Shell Objects</H1><!-- entering slot 159 -->
<P>
REXX automatically imports several workplace classes and adds them to the
global environment. These include:<!-- lm: 0x2 6 -->
<UL>
<P>
WPObject<!-- lm: 0x2 6 -->
<BR>
WPTransient<!-- lm: 0x2 6 -->
<BR>
WPAbstract<!-- lm: 0x2 6 -->
<BR>
WPProgram<!-- lm: 0x2 6 -->
<BR>
WPFolder<!-- lm: 0x2 1 -->
</UL>
<P>
You can import other workplace classes just as you can import SOM classes,
except for Workplace Shell classes the class server is WPS instead of SOM.
Here are two ways to import the WPClock class:
<PRE>::class WPClock external 'WPS WPClock'
WPClock = .wps~import('WPClock')
</PRE>

<P>
REXX also creates an entry in the environment for one other workplace object,
WPDesktop. The other explicitly named system folders can be added to the
environment by running the WPSYSOBJ.CMD utility. The REXX folder names followed
by their workplace functions are:<!-- lm: 0x2 1 -->
<P>
WPNoWhere<!-- lm: 0x12 5 -->
<UL> The hidden folder<!-- lm: 0x2 1 -->
</UL> WPOS2SYS
<!-- lm: 0x12 5 -->
<UL>The system folder<!-- lm: 0x2 1 -->
</UL> WPTemps
<!-- lm: 0x12 5 -->
<UL>The templates folder<!-- lm: 0x2 1 -->
</UL> WPStart
<!-- lm: 0x12 5 -->
<UL>The startup folder<!-- lm: 0x2 1 -->
</UL> WPInfo
<!-- lm: 0x12 5 -->
<UL>The information folder<!-- lm: 0x2 1 -->
</UL> WPDrives
<!-- lm: 0x12 5 -->
<UL>The drives folder<!-- lm: 0x2 1 -->
</UL> WPConfig
<!-- lm: 0x12 5 -->
<UL>The system setup folder<!-- lm: 0x2 1 -->
</UL>
<P>
After calling WPSYSOBJ.CMD, you can refer to the information folder directly
by using .wpinfo.
<P>
It is easy to locate other items on the desktop using the WPFIND.CMD utility.
You can use WPFIND directly from a command line or within a program. From
a command line, the syntax is:
<PRE>wpfind -p name path</PRE>

<P>
The<I> path</I> is the title of a workplace object to locate and place into
the global environment<I> name</I> specifies.
<P>
From within a program, the syntax is:
<PRE>obj = wpfind(path)
</PRE>

<P>
The<I> path</I> is the title of a workplace object that<I> obj</I> will
reference.
<P>
The path must always be a string. If you are looking for a folder with the
title "Folder2" and know it is inside the folder entitled "Folder1," which
resides on the desktop, you can call it as follows:
<PRE>is_found=wpfind('Folder1;Folder2')
</PRE>

<P>
Another way to call WPFIND is to use the folder itself directly. If<I> f1
</I>is the folder entitled "Folder1" and<I> f2</I> is the folder entitled
"Folder2," the call:
<PRE>is_found = wpfind(f1~wpQueryTitle';'f2~wpQueryTitle)
</PRE>

<P>
changes everything in parenthesis to a valid string.
<P>
The basic assumption is that the very first folder that using WPFIND searches
is .wpDesktop. WPFIND returns the object itself. If the requested object
is not found, WPFIND returns the NIL object.
<P>
The Workplace documentation frequently uses named constant values. REXX
provides the WPCONST.CMD utility to let programmers use the named constants
instead of looking up their values. Running WPCONST.CMD sets up a directory
called WPCONST in the global environment that contains the names and their
values. For example, the OPEN_SETTINGS constant could be referenced as:

<PRE>.wpconst['OPEN_SETTINGS'].
</PRE>

<P>
<B>Note: </B> Use quotation marks around constant names, such as "OPEN_SETTINGS"
in the preceding example.<!-- lm: 0x2 1 -->
<P>

<P>


<P><HR>

<A HREF="149_L4_ObjectOrientedSuppor.html">[Back: Object-Oriented Support]</A> <BR>
<A HREF="151_L3_WorkplaceShellExampl.html">[Next: Workplace Shell Example:  Creating Folders]</A> 
</BODY>
</HTML>
