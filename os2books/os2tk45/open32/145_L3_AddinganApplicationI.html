<HTML>
<HEAD>
<TITLE>Adding an Application INI File to Registry</TITLE>
</HEAD>
<BODY>
<H1>Adding an Application INI File to Registry</H1><!-- entering slot 145 -->
<P>
Applications can add their own INI file to registry by:<!-- lm: 0x2 2 -->
<UL>
<P>
 <LI><LI><!-- lm: 0x2 6 -->Updating REGH_INIMAPPING:  Add the name of the
application INI file under REGH_INIMAPPING.  For example, for application
XYZ, create a new node under REGH_INIMAPPING called XYZ.INI.  For each section
in XYZ.INI, create a value under the XYZ.INI node.  The value name is the
section name.  The value content is the corresponding directory path under
the REGH_WINOS2INI node.  See step 2.<!-- lm: 0x2 2 -->
<P>
 <LI><LI><!-- lm: 0x2 6 -->Updating REGH_WINOS2INI:  Add the name of the
application INI file under REGH_WINOS2INI.  For example, for application
XYZ, create a new node under REGH_WINOS2INI called XYZ.INI.  Add a new node
under XYZ.INI.  The name of the node is the group name.<!-- lm: 0x2 1 -->
</UL>
<P>
After completing these two steps, the application can use Windows 32-bit
profile functions to modify the contents of XYZ.INI.
<P>
When finished, the registry structure looks like this:
<PRE>winreg (root)  ---                  |
                  |-- REGH_WINOS2INI --- XYZ.INI
                  |
                                          |--section 1
                                          |
                                          |  (value name=key name 11;
                                          |   value content...)
                                          |   value name=key name 12;
                                          |   value content...)
                                          |
                                          |--section 2
                                          |
                                             (value name=key name 21;
                                              value content...)
                                              value name=key name 22;
                                              value content...)

                  |-- REGH_INIMAPPING
                        |--- XYZ.INI
                        (value name=section1;
                         value content="XYZ.INI\section1")
                        (value name=section2;
                         value content="XYZ.INI\section2")

</PRE>

<P>
All new keys added under HKEY_LOCAL_MACHINE\SOFTWARE\MICROSOFT\WINDOWS NT\CURRENTVERSION\INIFILEMAPPING
are added to REGH_INIMAPPING.
<P>
All references to HKEY_LOCAL_MACHINE\SOFTWARE are mapped to REGH_WINOS2INI.


<P><HR>

<A HREF="144_L3_RegistryTreeStructur.html">[Back: Registry Tree Structure]</A> <BR>
<A HREF="146_L3_ViewingRegistry.html">[Next: Viewing Registry]</A> 
</BODY>
</HTML>
