<HTML>
<HEAD>
<META HTTP-EQUIV="CONTENT-TYPE" CONTENT="TEXT/HTML; CHARSET=UTF-8">
<TITLE>user_rapi_callback()</TITLE>
<STYLE>
PRE {
  FONT-FAMILY: Consolas, "Lucida Console", "Courier New", Courier, MONOSPACE;
}
</STYLE>
</HEAD>
<BODY>
<H1>user_rapi_callback()</H1><!-- entering slot 446 -->
<P>
The user_rapi_callback() call provides the RSVP callback function.
<P>
<B>Syntax</B>
<PRE>       #include &lt;rsvprapi.h&gt;

int  _System user_rapi_callback(
       rapi_sid_t         sid,
       rapi_eventinfo_t   eventType,
       rapi_styleid_t     styleID,
       int                errorCode,
       int                errorValue,
       struct sockaddr   *pErrorNodeAddr,
       u_char             errorFlags,
       int                nFilterSpecs,
       rapi_filter_t     *pFilterSpec,
       int                nFlowSpecs,
       rapi_flowspec_t   *pFlowSpec,
       int                nAdSpecs,
       rapi_adspec_t     *pAdSpec,
       void              *pClientArg);
</PRE>

<P>
<B>Parameters</B><!-- lm: 0x2 0 -->
<P>
<I>sid</I><!-- lm: 0x11 10 -->
<UL> Session identifier of the session that
generated the event.<!-- lm: 0x2 0 -->
</UL><I> eventType</I><!-- lm: 0x11 10 -->
<UL> One
of these event types:<!-- lm: 0x2 10 -->
<P>
RAPI_PATH_EVENT<!-- lm: 0x2 25 -->
<UL> A path event is generated by a rapi_sender()
call for the session.  This can be received by a program that has called
rapi_session().  A non-zero value of nFlowSpecs indicates that a path exists
from a sender to a potential receiver. A zero value of nFlowSpecs indicates
that a previous path may have gone away.<!-- lm: 0x2 10 -->
</UL> RAPI_RESV_EVENT
<!-- lm: 0x2 25 -->
<UL>A reservation event is generated by a rapi_reserve()
call for the session.  This is received by a sender to which the reservation
applies. A zero value of nFlowSpecs indicates that a previous reservation
may have gone away.<!-- lm: 0x2 10 -->
</UL> RAPI_PATH_ERROR<!-- lm: 0x2 25 -->
<UL> There
has been an error associated with the path event. See errorCode for the
type of error.<!-- lm: 0x2 10 -->
</UL> RAPI_RESV_ERROR<!-- lm: 0x2 25 -->
<UL> There
has been an error associated with the reservation event.  See errorCode
for the type of error.<!-- lm: 0x2 10 -->
</UL> RAPI_RESV_CONFIRM<!-- lm: 0x2 25 -->
<UL> When
a rapi_reserve() call specifies that confirmation of the reservation is
requested, this event can be generated to confirm (with a very high probability)
that the reservation has been made from receiver to sender.<!-- lm: 0x2 10 --><!-- lm: 0x2 0 -->
</UL><I> styleID
</I><!-- lm: 0x11 10 -->
<UL>Reservation style. This is non-zero only for
RAPI_RESV_EVENT and RAPI_RESV_ERROR.<!-- lm: 0x2 0 -->
</UL><I> errorCode
</I><!-- lm: 0x11 10 -->
<UL>Type of error that occurred, for a RAPI_PATH_ERROR
or RAPI_RESV_ERROR event.<!-- lm: 0x2 0 -->
</UL><I> errorValue</I><!-- lm: 0x11 10 -->
<UL> Extra
error value for a RAPI_PATH_ERROR or RAPI_RESV_ERROR event. This parameter
is used if it is necessary for RSVP to report an extra error. An example
might be an "errno" value.<!-- lm: 0x2 0 -->
</UL><I> pErrorNodeAddr</I><!-- lm: 0x11 10 -->
<UL> A
pointer to the IP address and port of the node that detected an error. For
this implementation, this is a pointer to a sockaddr_in structure. This
is set only for a RAPI_PATH_ERROR or RAPI_RESV_ERROR event.<!-- lm: 0x2 0 -->
</UL><I> errorFlags
</I><!-- lm: 0x11 10 -->
<UL>
<P>
Error flag for a RAPI_PATH_ERROR event. Set to one of these values:<!-- lm: 0x2 10 -->
<P>
RAPI_ERRF_InPlace<!-- lm: 0x2 25 -->
<UL> This value indicates that the
reservation failed, but another probably smaller reservation was left in
place at the failing node address.<!-- lm: 0x2 10 -->
</UL> RAPI_ERRF_NotGuilty
<!-- lm: 0x2 25 -->
<UL>This value indicates that the flowspec that was
requested by this receiver was not the cause of the error, even though the
reservation failed. Presumably the failure was due to a larger reservation
that this one was merged with.<!-- lm: 0x2 10 --><!-- lm: 0x2 0 -->
</UL><I> nFilterSpecs
</I><!-- lm: 0x11 10 -->
<UL>The number of filterspecs or sender templates
pointed to by pFilterSpec.<!-- lm: 0x2 0 -->
</UL><I> pFilterSpec</I><!-- lm: 0x11 10 -->
<UL> A
pointer to an array of filterspecs or sender templates, or NULL.<!-- lm: 0x2 0 -->
</UL><I> nFlowSpecs
</I><!-- lm: 0x11 10 -->
<UL>The number of flowspecs or tspecs pointed to
by pFlowSpec.<!-- lm: 0x2 0 -->
</UL><I> pFlowSpec</I><!-- lm: 0x11 10 -->
<UL> A
pointer to an array of flowspecs or tspecs, or NULL.<!-- lm: 0x2 0 -->
</UL><I> nAdSpecs
</I><!-- lm: 0x11 10 -->
<UL>The number of adspecs pointed to by pAdSpec.
<!-- lm: 0x2 0 -->
</UL><I>pAdSpec</I><!-- lm: 0x11 10 -->
<UL> A pointer
to an array of adspecs, or NULL.<!-- lm: 0x2 0 -->
</UL><I> pClientArg</I><!-- lm: 0x11 10 -->
<UL> The
client-supplied argument that was provided when rapi_session() was called.
<!-- lm: 0x2 0 -->
</UL>
<P>
<B>Description</B>
<P>
The user_rapi_callback() call processes asynchronous events from the RSVP
API.  A pointer to the function is passed to rapi_session(). The callback
function must be declared as shown above.  The name of the function is chosen
by the user, but is shown above as user_rapi_callback().
<P>
The rapi_getfd() call returns a socket for the session.  The socket may
be used with the select() call as a read socket.  When a select() call indicates
that there is some data to read, a rapi_dispatch() call should be issued
to read and process the data from the socket.  Typically the rapi_dispatch()
call will invoke the user callback function to provide the program with
information, if the user supplied such a function in the rapi_session()
call.
<P>
The user callback function should copy any information that it wants to
save, because the storage that is pointed to by the pErrorNodeAddr, pFilterSpec,
pFlowSpec, and pAdSpec will be freed as soon as the callback function returns.

<P>
<B>Return Values</B>
<P>
The function is declared to have an integer return value, but nothing is
done with the value<!-- entering slot 447 --> currently.  It is recommended
that the user always return 0.
<P>
<B>Related Calls</B><!-- lm: 0x2 5 -->
<UL>
<P>
<A HREF="397_L2_rapi_dispatch.html">rapi_dispatch()</A><!-- lm: 0x2 5 --> <A HREF="402_L2_rapi_getfd.html">rapi_getfd()
</A><!-- lm: 0x2 5 -->
<BR>
<A HREF="406_L2_rapi_session.html">rapi_session()</A><!-- lm: 0x2 5 -->
<BR>
<A HREF="197_L2_select.html">select()</A><!-- lm: 0x2 0 -->
</UL>

<P><HR>

<A HREF="407_L2_rapi_version.html">[Back: rapi_version()]</A> <BR>
<A HREF="409_L1_Appendixes.html">[Next: Appendixes]</A> 
</BODY>
</HTML>
