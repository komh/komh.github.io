<HTML>
<HEAD>
<META HTTP-EQUIV="CONTENT-TYPE" CONTENT="TEXT/HTML; CHARSET=UTF-8">
<TITLE>R0LIB32 Library</TITLE>
</HEAD>
<BODY>
<H1>R0LIB32 Library</H1><!-- entering slot 316 -->
<P>
The following include files are available:<!-- lm: 0x2 2 -->
<UL>
<P>
<LI><!-- lm: 0x2 5 -->r0lib.h<!-- lm: 0x2 2 -->
<P>
<LI><!-- lm: 0x2 5 -->nerrno.h<!-- lm: 0x2 0 -->
</UL>
<P>
The following socket calls are available:<!-- lm: 0x2 2 -->
<UL>
<P>
<LI><!-- lm: 0x2 5 --><B>long sock_init(void);</B><!-- lm: 0x2 2 -->
<P>
<LI><!-- lm: 0x2 5 --><B>long socket(long, long,long);</B><!-- lm: 0x2 2 -->
<P>
<LI><!-- lm: 0x2 5 --><B>long bind(long,char *, long);</B><!-- lm: 0x2 2 -->
<P>
<LI><!-- lm: 0x2 5 --><B>long connect(long, char *, long);</B><!-- lm: 0x2 2 -->
<P>
<LI><!-- lm: 0x2 5 --><B>long listen(long,long);</B><!-- lm: 0x2 2 -->
<P>
<LI><!-- lm: 0x2 5 --><B>long accept(long, char *, long  *);</B><!-- lm: 0x2 2 -->
<P>
<LI><!-- lm: 0x2 5 --><B>long sendto(long, char *, long, long, char *, long);
</B><!-- lm: 0x2 2 -->
<P>
<LI><!-- lm: 0x2 5 --><B>long send(long, char  *, long, long);</B><!-- lm: 0x2 2 -->
<P>
<LI><!-- lm: 0x2 5 --><B>long sendmsg(long, char  *, long);</B><!-- lm: 0x2 2 -->
<P>
<LI><!-- lm: 0x2 5 --><B>long recvfrom(long, char *, long, long, char *,
long *);</B><!-- lm: 0x2 2 -->
<P>
<LI><!-- lm: 0x2 5 --><B>long recv(long, char  *, long, long);</B><!-- lm: 0x2 2 -->
<P>
<LI><!-- lm: 0x2 5 --><B>long recvmsg(long, char  *, long);</B><!-- lm: 0x2 2 -->
<P>
<LI><!-- lm: 0x2 5 --><B>long shutdown(long, long);</B><!-- lm: 0x2 2 -->
<P>
<LI><!-- lm: 0x2 5 --><B>long setsockopt(long, long, long, char  *, long);
</B><!-- lm: 0x2 2 -->
<P>
<LI><!-- lm: 0x2 5 --><B>long getsockopt(long, long, long, char  *, long
 *);</B><!-- lm: 0x2 2 -->
<P>
<LI><!-- lm: 0x2 5 --><B>long getsockname(long, char  *, long *);</B><!-- lm: 0x2 2 -->
<P>
<LI><!-- lm: 0x2 5 --><B>long getpeername(long, char  *, long  *);</B><!-- lm: 0x2 2 -->
<P>
<LI><!-- lm: 0x2 5 --><B>ulong gethostid(void);</B><!-- lm: 0x2 2 -->
<P>
<LI><!-- lm: 0x2 5 --><B>long soclose(long);</B><!-- lm: 0x2 2 -->
<P>
<LI><!-- lm: 0x2 5 --><B>long ioctl(long, long, char  *, long);</B><!-- lm: 0x2 2 -->
<P>
<LI><!-- lm: 0x2 5 --><B>long select(long  *, long, long, long, long);</B><!-- lm: 0x2 0 -->
</UL>
<P>
<B>sock_init()</B> returns 0 for success else failure.<B> sock_init()</B> must
be called before any other socket call is made. Internally<B> sock_init()
</B>attaches to INET$ and prepares the library to do socket calls. If<B> sock_init()
</B>fails, it means that INET$ (sockets.sys) is not loaded. Check your config.sys
"device=" statement, or execute the "inetver" command at OS/2 command prompt.
The command should return a TCP/IP version greater than 3.00. Link your
Ring-0 code with r0lib32.lib and you will be ready to use all sockets API
calls.
<P>
<B>Example</B>
<P>
To test<B> r0lib32.lib</B> build test.sys, add an entry for the device driver
in config.sys, and copy test.sys in \mptn\protocol directory. Reboot the
machine so that test.sys is loaded in memory. Now compile testini.c and
generate testini.exe.
<P>
By running testini.exe the function test_server(), in driver.c is invoked,
which acts as a server and waits for the client at port no 5000. Compile
and run the client program (client.c) on any other machine.
<P>
The test_server opens a STREAM socket in the internet domain and waits for
a client at port no 5000. In the client program, the IP address of the server
machine that has test.sys is to be specified while filling the structure
sockaddr_in. To compile the client program use makefile.cli.
<P>
<B>For more information:</B>
<P>
The<B> TCP/IP Toolkit</B> contains a programming example in detail, which
exploits the use of<B> r0lib32.</B>

<P><HR>

<A HREF="278_L2_setservent.html">[Back: setservent()]</A> <BR>
<A HREF="280_L1_RemoteProcedureandeX.html">[Next: Remote Procedure and eXternal Data Representation API]</A> 
</BODY>
</HTML>
