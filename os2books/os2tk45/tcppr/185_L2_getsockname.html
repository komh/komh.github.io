<HTML>
<HEAD>
<META HTTP-EQUIV="CONTENT-TYPE" CONTENT="TEXT/HTML; CHARSET=UTF-8">
<TITLE>getsockname()</TITLE>
<STYLE>
PRE {
  FONT-FAMILY: Consolas, "Lucida Console", "Courier New", Courier, MONOSPACE;
}
</STYLE>
</HEAD>
<BODY>
<H1>getsockname()</H1><!-- entering slot 200 -->
<P>
The getsockname() socket call gets the local socket name.  If you are using
a SOCKS server, see <A HREF="089_L2_SocketSecureSupport.html">Socket Secure
Support</A> for information about SOCKS.
<P>
<B>Syntax</B>
<PRE>#include &lt;types.h&gt;
#include &lt;sys\socket.h&gt;
int getsockname(<I>s</I>, <I>name</I>, <I>namelen</I>)
int <I>s</I>;
struct sockaddr *<I>name</I>;
int *<I>namelen</I>;
</PRE>

<P>
<B>Parameters</B><!-- lm: 0x2 0 -->
<P>
<I>s</I><!-- lm: 0x11 2 -->
<UL> Socket descriptor.<!-- lm: 0x2 0 -->
</UL><I> name
</I><!-- lm: 0x11 2 -->
<UL>Pointer to a sockaddr structure. The name of
<I>s</I> is returned.<!-- lm: 0x2 0 -->
</UL><I> namelen</I><!-- lm: 0x11 2 -->
<UL> Pointer
to the size in bytes of the buffer pointed to by<I> name</I>.<!-- lm: 0x2 0 -->
</UL>
<P>
<B>Description</B>
<P>
This call returns the name for the socket specified by the<I> s</I> parameter
in the structure pointed to by the<I> name</I> parameter.  It returns the
address to the socket that has been bound.  If the socket is not bound to
an address, the call returns with the family set and the rest of the structure
is set to zero. For example, an unbound socket in the internet domain would
cause the name to point to a sockaddr_in structure with the<I> sin_family
</I>field set to AF_INET and all other fields zeroed.
<P>
The<I> namelen</I> parameter must be initialized to indicate the size of
the space pointed to by<I> name</I> and is set to the size of the local
name copied. If the buffer is too small, the local name is truncated.
<P>
Sockets are explicitly assigned a name after a successful call to bind().
Stream and sequenced packet sockets are implicitly assigned a name after
a successful call to connect() or accept() if bind() was not called.
<P>
If the socket is connected through a SOCKS server, this call returns the
IP address and port of the local machine that is being used to communicate
with the SOCKS server.
<P>
The getsockname() call is often used to discover the port assigned to a
socket after the socket has been implicitly bound to a port.  For example,
an application can call connect() without previously calling bind(). In
this case, the connect() call completes the binding necessary by assigning
a port to the socket.
<P>
A process can use the getpeername() call to determine the address of a destination
socket in a socket connection.
<P>
<B>Return Values</B>
<P>
The value 0 indicates success; the value -1 indicates an error. You can
get the specific error code by calling sock_errno() or psock_errno().<!-- lm: 0x2 0 -->
<P>
<B>Error Code</B><!-- lm: 0x2 18 -->
<UL><B>Description</B><!-- lm: 0x2 0 -->
</UL>SOCENOTSOCK<!-- lm: 0x12 18 -->
<UL>The<I>s</I>parameterisnotavalidsocketdescriptor
.<!-- lm: 0x2 0 -->
</UL>SOCEFAULT<!-- lm: 0x12 18 -->
<UL>Usingthe<I>name</I>and<I>namelen</I>parametersasspecifiedwouldresultinanattempttoaccessstorageoutsideoftheaddressspaceofthecaller
.<!-- lm: 0x2 0 -->
</UL>SOCENOBUFS<!-- lm: 0x12 18 -->
<UL>Nobufferspaceavailable
.<!-- lm: 0x2 0 -->
</UL>
<P>
<B>Related Calls</B><!-- lm: 0x2 5 -->
<UL>
<P>
<A HREF="179_L2_accept.html">accept()</A><!-- lm: 0x2 5 --> <A HREF="180_L2_accept_and_recv.html">accept_and_recv()
</A><!-- lm: 0x2 5 -->
<BR>
<A HREF="182_L2_bind.html">bind()</A><!-- lm: 0x2 5 -->
<BR>
<A HREF="183_L2_connect.html">connect()</A><!-- lm: 0x2 5 -->
<BR>
<A HREF="184_L2_getpeername.html">getpeername()</A><!-- lm: 0x2 5 -->
<BR>
<A HREF="273_L2_Rgetsockname.html">Rgetsockname()</A><!-- lm: 0x2 5 -->
<BR>
<A HREF="205_L2_sock_errno.html">sock_errno()</A><!-- lm: 0x2 5 -->
<BR>
<A HREF="206_L2_socket.html">socket()</A><!-- lm: 0x2 0 -->
</UL>

<P><HR>

<A HREF="184_L2_getpeername.html">[Back: getpeername()]</A> <BR>
<A HREF="186_L2_getsockopt.html">[Next: getsockopt()]</A> 
</BODY>
</HTML>
