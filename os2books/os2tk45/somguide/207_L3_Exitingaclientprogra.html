<HTML>
<HEAD>
<META HTTP-EQUIV="CONTENT-TYPE" CONTENT="TEXT/HTML; CHARSET=UTF-8">
<TITLE>Exiting a client program</TITLE>
<STYLE>
PRE {
  FONT-FAMILY: Consolas, "Lucida Console", "Courier New", Courier, MONOSPACE;
}
</STYLE>
</HEAD>
<BODY>
<H1>Exiting a client program</H1><!-- entering slot 244 -->
<P>
At the end of a client program, the<B> SOMD_Uninit</B> procedure must be
called to free DSOM run-time objects, and to release system resources such
as semaphores, shared memory segments, and so on.<B> SOMD_Uninit</B> should
be called even if the client program terminates unsuccessfully; otherwise,
system resources will not be released.
<P>
For example, the exit code in the client program might look like this:
<PRE>    ...
    SOMD_Uninit(&amp;e);
    SOM_UninitEnvironment(&amp;e);
}

</PRE>

<P>
Note also the<B> SOM_UninitEnvironment</B> call, which frees any memory
associated with the specified<B> Environment</B> structure.
<P>
<B>Note: </B> When a Windows DSOM client receives a WM-QUIT message while
processing a remote method invocation, DSOM will clean up and terminate
the client without returning to the client's WinProc or WinMain.<!-- lm: 0x2 1 -->
<UL>
<P>


<P><HR>

<A HREF="206_L3_Initializingaclientp.html">[Back: Initializing a client program]</A> <BR>
<A HREF="208_L3_Creatingremoteobject.html">[Next: Creating remote objects]</A> 
</BODY>
</HTML>
