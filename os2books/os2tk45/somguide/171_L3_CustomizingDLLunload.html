<HTML>
<HEAD>
<META HTTP-EQUIV="CONTENT-TYPE" CONTENT="TEXT/HTML; CHARSET=UTF-8">
<TITLE>Customizing DLL unloading</TITLE>
<STYLE>
PRE {
  FONT-FAMILY: Consolas, "Lucida Console", "Courier New", Courier, MONOSPACE;
}
</STYLE>
</HEAD>
<BODY>
<H1>Customizing DLL unloading</H1><!-- entering slot 206 -->
<P>
To unload a SOM class, the<B> SOMClassMgrObject</B> calls the function pointed
to by the global variable<B> SOMDeleteModule</B>. The<B> SOMDeleteModule
</B>function has the following signature:
<P>
<B>long  (*SOMDeleteModule)  (in somToken</B><I> modHandle</I><B>);</B>
<P>
This function is responsible for unloading the DLL designated by the<I> modHandle
</I>parameter and returning either zero (for success) or a nonzero system-specific
error code. The parameter<I> modHandle</I> contains the value returned by
the DLL loading routine (described above) when the DLL was loaded.
<P>
An application program can replace the default DLL-unloading routine by
assigning the entry point address of the new DLL-unloading function (such
as,<I> MyDeleteModule</I>) to the global variable<B> SOMDeleteModule</B>,
as follows:
<PRE>#include &lt;som.h&gt;
/* Define a replacement routine: */
long myDeleteModule (somToken modHandle)
{
     (Customized code goes here)
}
...
SOMDeleteModule = MyDeleteModule;
</PRE>


<P><HR>

<A HREF="170_L3_CustomizingDLLloadin.html">[Back: Customizing DLL loading]</A> <BR>
<A HREF="172_L2_CustomizingCharacter.html">[Next: Customizing Character Output]</A> 
</BODY>
</HTML>
