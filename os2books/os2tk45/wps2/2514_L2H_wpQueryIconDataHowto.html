<HTML XPOS=30% YPOS=TOP WIDTH=70% HEIGHT=100%HIDDEN>
<HEAD>
<META HTTP-EQUIV="CONTENT-TYPE" CONTENT="TEXT/HTML; CHARSET=UTF-8">
<!-- extra bytes: 03 00 14 1E 00 04 00 11 46 00 64 00 --><TITLE>wpQueryIconData - How to Override</TITLE>
<STYLE>
PRE {
  FONT-FAMILY: Consolas, "Lucida Console", "Courier New", Courier, MONOSPACE;
}
</STYLE>
</HEAD>
<BODY>
<H1>wpQueryIconData - How to Override</H1><!-- entering slot 2514 -->
<P>
Workplace classes that wish to have a unique icon for each instance must
override this method and fill out the appropriate fields within the<A><!-- external link: 1D D1 C5 2D --> ICONINFO
</A>structure. In addition, the correct size for the<A><!-- external link: 1D D1 C5 2D --> ICONINFO
</A>must always be returned.
<P>
This example shows how to override wpQueryIconData by returning information
about the icon associated with the instance if<I> pIconInfo</I> is not NULL.

<PRE>SOM_Scope ULONG SOMLINK Calendar_wpQueryIconData(_Calendar *somSelf,
                                                 PICONINFO pIconInfo)
{
  _CalendarData *somThis = _CalendarGetData(somSelf);
  _CalendarMethodDebug("_Calendar","myf_wpQueryIconData");

  if (pIconInfo)
  {
    pIconInfo-&gt;fFormat = ICON_RESOURCE;
    pIconInfo-&gt;hmod    = _clsQueryModuleHandle(_somGetClass(somSelf));
    pIconInfo-&gt;resid   = ID_ICON;
  } /* endif */
  return (sizeof(ICONINFO));
}

</PRE>


<P><HR>

<A HREF="2513_L2H_wpQueryIconDataUsage.html">[Back: wpQueryIconData - Usage]</A> <BR>
<A HREF="2515_L2H_wpQueryIconDataRelat.html">[Next: wpQueryIconData - Related Methods]</A> 
</BODY>
</HTML>
