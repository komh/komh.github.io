<HTML XPOS=30% YPOS=TOP WIDTH=70% HEIGHT=100%HIDDEN>
<HEAD>
<!-- extra bytes: 03 00 14 1E 00 04 00 11 46 00 64 00 --><TITLE>wpQueryLockupBackground - Example Code</TITLE>
</HEAD>
<BODY>
<H1>wpQueryLockupBackground - Example Code</H1><!-- entering slot 2655 -->
<P>
This example lets you find the current Desktop object and retrieves the
current lockup background definition.
<PRE>  WPDesktop    *Desktop;
  PSZ          pszImageFile;
  ULONG        ulImageMode;
  ULONG        ulScaleFactor;
  ULONG        ulBackgroundType;
  LONG         lBackgroundColor;

  Desktop = _wpclsQueryObjectFromPath("&lt;WP_DESKTOP&gt;");
  _wpQueryLockupBackground(Desktop,
                           &amp;pszImageFileName,
                           &amp;ulImageMode,
                           &amp;ulScaleFactor,
                           &amp;ulBackgroundType,
                           &amp;lBackgroundColor);
  /* pszImageFileName contains the pointer to the name of the image file
   * ulImageMode is BACKGROUND_NORMAL_IMAGE,
   *                BACKGROUND_TILED_IMAGE,
   *                or BACKGROUND_SCALED_IMAGE
   * ulScaleFactor is a number between 1 and 20
   * ulBackgroundType is BACKGROUND_COLOR_ONLY or BACKGROUND_IMAGE
   * lBackgroundColor is an encoded RGB color value
   */
</PRE>


<P><HR>

<A HREF="2654_L2H_wpQueryLockupBackgro.html">[Back: wpQueryLockupBackground - Related Methods]</A> <BR>
<A HREF="2656_L2H_wpQueryLockupBackgro.html">[Next: wpQueryLockupBackground - Topics]</A> 
</BODY>
</HTML>
