<HTML XPOS=30% YPOS=TOP WIDTH=70% HEIGHT=100%HIDDEN>
<HEAD>
<META HTTP-EQUIV="CONTENT-TYPE" CONTENT="TEXT/HTML; CHARSET=UTF-8">
<!-- extra bytes: 03 00 14 1E 00 04 00 11 46 00 64 00 --><TITLE>wpQueryIconPosition - Example Code</TITLE>
</HEAD>
<BODY>
<H1>wpQueryIconPosition - Example Code</H1><!-- entering slot 2530 -->
<P>
This example shows how you can use the wpInitIconPosData, wpIdentify, wpQueryIconPosition,
and wpFreeIconPosData methods to find the icon position information for
all objects within a folder.  In this example, somSelf contains the pointer
to the folder being examined.
<PRE>    BOOL        bSem;
    WPObject    *Object;
    CHAR        szIdentity[CCHMAXSTRING];
    POINTL      ptl;
    ULONG       ulIndex;

    /* Retrieve the icon position information for all objects within
     * the folder    */
    _wpInitIconPosData(somSelf);

    /* Find the every object within the folder   */
    bSem = !_wpRequestObjectMutexSem(somSelf,SEM_INDEFINITE_WAIT);
    for (Object = _wpQueryContent(somSelf,NULL,QC_FIRST);
         Object;
         Object = _wpQueryContent(somSelf,Object,QC_NEXT));
    {

       /* For each object in the folder, find the position of its icon
        * in an Icon View of the folder   */
       if (_wpIdentify(Object,szIdentity))
       {
          if (_wpQueryIconPosition(somSelf,szIdentity,&amp;ptl,&amp;ulIndex))
          {
             /***** ptl contains the position of the icon for this object *****/
          }
       }
    }
    if (bSem)
    {
       _wpReleaseObjectMutexSem(somSelf);
    }

    /* Free the icon position data structure    */
    _wpFreeIconPosData(somSelf);



</PRE>


<P><HR>

<A HREF="2529_L2H_wpQueryIconPositionR.html">[Back: wpQueryIconPosition - Related Methods]</A> <BR>
<A HREF="2531_L2H_wpQueryIconPositionT.html">[Next: wpQueryIconPosition - Topics]</A> 
</BODY>
</HTML>
