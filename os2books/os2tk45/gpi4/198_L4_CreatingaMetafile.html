<HTML>
<HEAD>
<META HTTP-EQUIV="CONTENT-TYPE" CONTENT="TEXT/HTML; CHARSET=UTF-8">
<TITLE>Creating a Metafile</TITLE>
</HEAD>
<BODY>
<H1>Creating a Metafile</H1><!-- entering slot 207 -->
<P>
Pictures are drawn in presentation spaces associated with device contexts.
PM considers a metafile to be an output device or destination, in the same
manner as a window or printer. This means that to record a picture in a
metafile, a metafile device context must be created and associated with
a presentation space.
<P>
A metafile device context is created by calling DevOpenDC and specifying
the type of device context as:<!-- lm: 0x2 3 -->
<UL>
<P>
<LI><!-- lm: 0x2 6 -->OD_METAFILE<!-- lm: 0x2 3 -->
<BR>
<LI><!-- lm: 0x2 6 -->OD_METAFILE_NOQUERY.<!-- lm: 0x2 1 -->
</UL>
<P>
OD_METAFILE is generally used to specify a metafile device context, although
OD_METAFILE_NOQUERY provides better recording performance. OD_METAFILE_NOQUERY
does not support attribute queries, for example,<A><!-- external link: 1D D1 C3 FC --> GpiQueryCurrentPosition</A>,
or<A><!-- external link: 1D CD C3 FC --> GpiQueryColor</A>.
<P>
The device driver for the device that the metafile device context is associated
with is specified in the<A><!-- external link: 1D 71 C4 1E --> DEVOPENSTRUC
</A>data structure required for DevOpenDC.<A><!-- external link: 1D 71 C4 1E --> DEVOPENSTRUC
</A>is described in <A HREF="219_L1_PrintJobSubmissionan.html">Print Job
Submission and Manipulation</A>.
<P>

<P>
A metafile device context can be associated with a newly-created presentation
space by calling<A><!-- external link: 1D 77 C3 28 --> GpiCreatePS</A> and
specifying the handle to the metafile device context returned from the call
to DevOpenDC. A metafile device context can also be associated with an existing,
normal presentation space by calling<A><!-- external link: 1D 5E C3 27 --> GpiAssociate
</A>and specifying the handle to the metafile device context returned from
the call to DevOpenDC.
<P>


<P><HR>

<A HREF="197_L3_MetafileFunctions.html">[Back: Metafile Functions]</A> <BR>
<A HREF="199_L4_StoringPicturesinaMe.html">[Next: Storing Pictures in a Metafile]</A> 
</BODY>
</HTML>
