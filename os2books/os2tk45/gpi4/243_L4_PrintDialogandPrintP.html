<HTML>
<HEAD>
<META HTTP-EQUIV="CONTENT-TYPE" CONTENT="TEXT/HTML; CHARSET=UTF-8">
<TITLE>Print Dialog and Print Processing</TITLE>
</HEAD>
<BODY>
<H1>Print Dialog and Print Processing</H1><!-- entering slot 254 -->
<P>
The print menu must display a dialog to enable the user to specify the number
of copies, start page, end page, or any other application-specific print
options. A confirm push button (for example,<B> Print</B>) initiates the
print. The following figure is an example of a print dialog.
<P>
<!-- Unable to decode bitmap format --><IMG SRC="243_L4_PrintDialogandPrintP_60.gif" WIDTH=500 HEIGHT=370>
<P>
Application Printer Setup Dialog
<P>

<P>
The<B> Printer</B> entry field is the read-only name of the printer object
(queue) that the user chose from the Printer Setup dialog. The<B> Preview
</B>checkbox is used to preview the printed output on the screen. This can
be achieved by opening an OD_MEMORY device context to the printer driver
and drawing the picture into the bit map. A BITBLT (Bit Block Logical Transfer)
to the screen shows the resultant page. System fonts should be used instead
of device fonts.
<P>
Once the user has initiated the print, a PM application must execute the
following steps.<!-- lm: 0x2 2 -->
<UL>
<P>
 <LI><LI><!-- lm: 0x2 6 -->Create a new thread.<!-- lm: 0x2 1 -->
</UL> Then,
on this new thread:<!-- lm: 0x2 2 -->
<UL>
<P>
 <LI><LI><!-- lm: 0x2 6 -->Open a device context.<!-- lm: 0x2 2 -->
<P>
 <LI><LI><!-- lm: 0x2 6 -->Associate a presentation space.<!-- lm: 0x2 2 -->
<P>
 <LI><LI><!-- lm: 0x2 6 -->Start the print job.<!-- lm: 0x2 2 -->
<P>
 <LI><LI><!-- lm: 0x2 6 -->Query the device capabilities.<!-- lm: 0x2 2 -->
<P>
 <LI><LI><!-- lm: 0x2 6 -->Format the page.<!-- lm: 0x2 2 -->
<P>
 <LI><LI><!-- lm: 0x2 6 -->Start the next page.<!-- lm: 0x2 1 -->
</UL> Repeat
steps 6 through 7 for each page.<!-- lm: 0x2 2 -->
<UL>
<P>
 <LI><LI><!-- lm: 0x2 6 -->End the print job.<!-- lm: 0x2 1 -->
</UL> For
another print job, repeat from step 4.<!-- lm: 0x2 2 -->
<UL>
<P>
 <LI><LI><!-- lm: 0x2 6 -->Disassociate the presentation space.<!-- lm: 0x2 2 -->
<P>
10.<!-- lm: 0x2 6 -->
<UL>Close the device context.<!-- lm: 0x2 1 -->
</UL>
<P>
The following sections describe each of the above steps in turn.
<P>


<P><HR>

<A HREF="242_L4_FontDialogandDeviceF.html">[Back: Font Dialog and Device Font Considerations]</A> <BR>
<A HREF="244_L5_CreatingaNewThread.html">[Next: Creating a New Thread]</A> 
</BODY>
</HTML>
