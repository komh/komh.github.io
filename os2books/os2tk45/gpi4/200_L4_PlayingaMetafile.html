<HTML>
<HEAD>
<TITLE>Playing a Metafile</TITLE>
</HEAD>
<BODY>
<H1>Playing a Metafile</H1><!-- entering slot 210 -->
<P>
An application can redraw a picture stored in a metafile by executing the
contents of metafile. This is known as<I> playing</I> a metafile into a
graphics presentation space. How a picture is redrawn (that is, how the
metafile is replayed) depends on the current drawing-mode of the target
presentation space. The following table describes these dependencies.
<P>
<B>Drawing Mode Dependencies When Playing Metafiles</B>
<PRE>ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
³Drawing Mode      ³Result               ³If the metafile      ³
³                  ³                     ³contains a segment   ³
³                  ³                     ³chain...             ³
ÃÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
³DM_DRAW           ³The metafile contents³The contents of the  ³
³                  ³are executed, and the³segments in the chain³
³                  ³picture is directed  ³represent the picture³
³                  ³to the current output³output that is       ³
³                  ³device.              ³directed at the      ³
³                  ³                     ³target output device.³
ÃÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
³DM_RETAIN         ³The metafile contents³The chain is added to³
³                  ³are retained in the  ³the end of any chain ³
³                  ³application's segment³that may already be  ³
³                  ³store. The picture   ³in the segment store.³
³                  ³defined in the       ³If any segment in the³
³                  ³metafile is not      ³metafile has the same³
³                  ³directed to an output³nonzero name as a    ³
³                  ³device until the     ³segment already in   ³
³                  ³application issues an³the segment store of ³
³                  ³appropriate          ³the presentation     ³
³                  ³GpiDraw... function. ³space, an error      ³
³                  ³                     ³condition is raised. ³
ÃÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
³DM_DRAWANDRETAIN  ³The metafile contents³See above.           ³
³                  ³are both stored and  ³                     ³
³                  ³executed.            ³                     ³
ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ
</PRE>

<P>
<B>Note: </B> Unchained segments in the metafile are always retained, regardless
of the current drawing-mode parameter.
<P>
When the contents of a metafile are retained in the segment store of the
target presentation space, they can be manipulated by the application as
if the application had created them. For example, the segments can be edited,
drawn, correlated, and deleted.
<P>
A metafile is "played" by calling<A><!-- external link: 1D A9 C3 FC --> GpiPlayMetaFile</A>.
A metafile cannot, however, be "played" within a segment bracket.<A><!-- external link: 1D A9 C3 64 --> GpiPlayMetaFile
</A>requires a metafile handle, an option count, an options array, a byte
count of a descriptive record, and the descriptive record.
<P>
The<A><!-- external link: 1D A9 C3 64 --> GpiPlayMetaFile</A> descriptive
record is a natural-language description of the picture contents. For example,
its value might be<I> A House</I>. This description is provided on input
to the DevOpenDC function that defines the metafile device context. It can
be used, for example, in a list box from which a user can select a picture.

<P>
The<A><!-- external link: 1D A9 C3 64 --> GpiPlayMetaFile</A> options array
specifies how the operating system alters your application's presentation
space before playing the metafile. The options array determines the display
attributes of the metafile. The array fields and their respective attributes,
as numbered consecutively in the array, are shown in the following table.

<PRE>ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
³Option                        ³Attribute                     ³
ÃÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
³PMF_SEGBASE                   ³Reserved, must be 0.          ³
ÃÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
³PMF_LOADTYPE                  ³Viewing transform, graphics.  ³
ÃÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
³PMF_RESOLVE                   ³Reserved, must be 0.          ³
ÃÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
³PMF_LCIDS                     ³Font and local bit map local  ³
³                              ³identifiers.                  ³
ÃÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
³PMF_RESET                     ³Drawing attributes.           ³
ÃÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
³PMF_SUPPRESS                  ³Actual playing of the         ³
³                              ³metafile.                     ³
ÃÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
³PMF_COLORTABLES               ³Color tables, color palettes. ³
ÃÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
³PMF_COLORREALIZABLE           ³Realization of metafile color ³
³                              ³table.                        ³
ÃÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
³PMF_DEFAULTS                  ³Drawing defaults values.      ³
ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ
</PRE>

<P>


<P><HR>

<A HREF="199_L4_StoringPicturesinaMe.html">[Back: Storing Pictures in a Metafile]</A> <BR>
<A HREF="201_L5_PMF_RESETOption.html">[Next: PMF_RESET Option]</A> 
</BODY>
</HTML>
