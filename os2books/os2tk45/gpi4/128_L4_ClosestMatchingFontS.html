<HTML>
<HEAD>
<TITLE>Closest-Matching Font Selection</TITLE>
</HEAD>
<BODY>
<H1>Closest-Matching Font Selection</H1><!-- entering slot 133 -->
<P>
The alternative to selecting a specific font is to set the match value to
0. To have the Presentation Manager programming interface select the closest-matching
font available, do the following:<!-- lm: 0x2 2 -->
<UL>
<P>
 <LI><LI><!-- lm: 0x2 6 -->Define a logical font with<A><!-- external link: 1D 75 C3 FC --> GpiCreateLogFont</A>.
This function establishes a link between the calling application and an
appropriate physical font.<A><!-- external link: 1D 75 C3 5E --> GpiCreateLogFont
</A>accepts a number of options as input, including the<I> font attributes</I>,
which describe the physical features and capabilities of the font.<!-- lm: 0x2 2 -->
<P>
 <LI><LI><!-- lm: 0x2 6 -->Complete the<A><!-- external link: 1D 76 C4 4E --> FATTRS
</A>structure of<A><!-- external link: 1D 75 C3 FC --> GpiCreateLogFont</A>.
The<A><!-- external link: 1D 76 C4 4E --> FATTRS</A> structure describes
a logical font, which the system uses to find the closest matching physical
font. Depending on whether you are selecting a font using a match number,
fill in the<A><!-- external link: 1D 76 C4 4E --> FATTRS</A> structure,
observing the rules listed in the following table.
<P>
<B>Filling in the FATTRS Structure</B>
<PRE>ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
³If using a match number       ³If not using a match number   ³
ÃÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
³Set the match number to the   ³Set the match number to zero. ³
³required FONTMETRICS value.   ³                              ³
³The FONTMETRICS value is the  ³If your font is an image font:³
³value in the FONTMETRICS      ³                              ³
³structure for the required    ³Set the maximum baseline      ³
³font returned by <A><!-- external link: 1D E4 C3 60 -->GpiQueryFonts</A>³extent to the required        ³
³.                             ³FONTMETRICS value.            ³
³                              ³                              ³
³Set the maximum baseline      ³Set the average character     ³
³extent to zero.               ³width to the required         ³
³                              ³FONTMETRICS value.            ³
³Set the average character     ³                              ³
³width to zero.                ³                              ³
³                              ³                              ³
³Note:  A negative lMatch is   ³                              ³
³only unique for a device. A   ³                              ³
³positive lMatch is only unique³                              ³
³on a particular system at a   ³                              ³
³particular time.              ³                              ³
ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ
</PRE>

<P>
Also observe the rules concerning the font-use indicator that are listed
in the following table.
<P>
<B>Font-Use Indicator Considerations</B>
<PRE>ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
³If you have <I>not</I> set the       ³If you have set the           ³
³FATTR_FONTUSE_OUTLINE         ³FATTR_FONTUSE_OUTLINE         ³
³indicator:                    ³indicator:                    ³
ÃÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
³PM looks for an image font    ³PM looks for a suitable       ³
³that has the required         ³outline font whose selection  ³
³selection indicators and whose³indicators match those you    ³
³maximum baseline extent and   ³have specified.               ³
³average character width match ³                              ³
³those you have specified.     ³If no suitable outline font is³
³                              ³found, the default font is    ³
³If no suitable image font is  ³used. No attempt is made to   ³
³found, PM looks for an outline³substitute an image font.     ³
³font with the required face   ³                              ³
³name and selection indicators.³                              ³
³                              ³                              ³
³If no suitable outline font is³                              ³
³found, the default font is    ³                              ³
³made available to you.        ³                              ³
ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ
</PRE>
<!-- lm: 0x2 1 -->
</UL>
<P>
Outline fonts are affected by the current character attributes (for example,
character box, shear, and angle). Because an outline font might be made
available to you, even when you requested an image font, call<A><!-- external link: 1D E3 C3 5F --> GpiQueryFontMetrics
</A>to determine whether the font is an image font or an outline font.<A><!-- external link: 1D E3 C3 5F --> GpiQueryFontMetrics
</A>returns the metrics of the current logical font in world coordinates.

<P>
The setting of the definition indicators in the<A><!-- external link: 1D 7B C4 56 --> FONTMETRICS
</A>structure tell you whether the font is either an image or outline font,
or a device or generic font. If the font is an outline font, specify values
for the character attributes before using the font. Outline fonts are unaffected
by the maximum baseline extent and average character width values specified
in<A><!-- external link: 1D 75 C3 FC --> GpiCreateLogFont</A>.
<P>
If the default font provided is an image font, and you also have specified
FATTR_FONTUSE_TRANSFORMABLE, any attempt to draw graphics characters in
CM_MODE3 raises an error condition. This is an exception to the general
rule that a FATTR_FONTUSE_TRANSFORMABLE font must be used in CM_MODE3 only.

<P>


<P><HR>

<A HREF="127_L4_FontResolution.html">[Back: Font Resolution]</A> <BR>
<A HREF="129_L3_SelectingtheNewCurre.html">[Next: Selecting the New Current Font]</A> 
</BODY>
</HTML>
