<HTML>
<HEAD>
<META HTTP-EQUIV="CONTENT-TYPE" CONTENT="TEXT/HTML; CHARSET=UTF-8">
<TITLE>MMIO Messages</TITLE>
<STYLE>
PRE {
  FONT-FAMILY: Consolas, "Lucida Console", "Courier New", Courier, MONOSPACE;
}
</STYLE>
</HEAD>
<BODY>
<H1>MMIO Messages</H1><!-- entering slot 2771 -->
<P>
The MMIO messages are sent to an I/O procedure as a result of an MMIO function
call. For example, when an application calls <A HREF="2591_L2_mmioOpen.html">mmioOpen</A>,
the <A HREF="2940_L2_MMIOM_OPEN.html">MMIOM_OPEN</A> message is sent to
an I/O procedure.  An application can also send the MMIO messages to an
I/O procedure by issuing <A HREF="2685_L2_mmioSendMessage.html">mmioSendMessage
</A>or by directly calling the I/O procedure.
<P>
The <A HREF="2685_L2_mmioSendMessage.html">mmioSendMessage</A> function
should be used only to pass user-defined messages, or messages not automatically
generated by an MMIO function, to the I/O procedure of the user's application.

<P>
When an application issues <A HREF="2685_L2_mmioSendMessage.html">mmioSendMessage</A>,
it passes an<I> hmmio</I> parameter, which MMIO converts to an<A><!-- external link: 1D 42 29 7F --> MMIOINFO
</A>block before sending the parameter to the I/O procedure. When an application
calls an I/O procedure directly, a<I> pmmioinfo</I> parameter is passed
to the I/O procedure instead of an<I> hmmio</I>. The following is a function
prototype for a direct I/O procedure call:
<PRE>LONG APIENTRY MMIOPROC (PVOID pmmioinfo, USHORT usMsg,
                        LONG lParam1, LONG lParam2);
</PRE>

<PRE>┌──────────────────────────┬──────────────────────────────────┐
│Message                   │Description                       │
├──────────────────────────┼──────────────────────────────────┤
│<A HREF="2766_L2_MMIOM_BEGININSERT.html">MMIOM_BEGININSERT</A>         │Requests that all subsequent      │
│                          │Writes insert data at the current │
│                          │seek position.                    │
├──────────────────────────┼──────────────────────────────────┤
│<A HREF="2774_L2_MMIOM_BEGINRECORD.html">MMIOM_BEGINRECORD</A>         │Requests all subsequent Writes be │
│                          │considered one logical unit by an │
│                          │UNDO or REDO.                     │
├──────────────────────────┼──────────────────────────────────┤
│<A HREF="2782_L2_MMIOM_BEGINSTREAM.html">MMIOM_BEGINSTREAM</A>         │Sent before the first <A HREF="2653_L2_mmioRead.html">mmioRead</A> or │
│                          │<A HREF="2754_L2_mmioWrite.html">mmioWrite</A> to start the stream at  │
│                          │the optimum rate for the file.    │
├──────────────────────────┼──────────────────────────────────┤
│<A HREF="2791_L2_MMIOM_CLEAR.html">MMIOM_CLEAR</A>               │Requests that a specified range be│
│                          │deleted from a file.              │
├──────────────────────────┼──────────────────────────────────┤
│<A HREF="2800_L2_MMIOM_CLOSE.html">MMIOM_CLOSE</A>               │Requests that the file be closed. │
├──────────────────────────┼──────────────────────────────────┤
│<A HREF="2816_L2_MMIOM_COPY.html">MMIOM_COPY</A>                │Requests that a specified range be│
│                          │copied to the clipboard.          │
├──────────────────────────┼──────────────────────────────────┤
│<A HREF="2825_L2_MMIOM_CUT.html">MMIOM_CUT</A>                 │Requests that a specified range be│
│                          │copied to the clipboard and then  │
│                          │deleted.                          │
├──────────────────────────┼──────────────────────────────────┤
│<A HREF="2866_L2_MMIOM_ENDSTREAM.html">MMIOM_ENDSTREAM</A>           │Sent after the last <A HREF="2653_L2_mmioRead.html">mmioRead</A> or   │
│                          │<A HREF="2754_L2_mmioWrite.html">mmioWrite</A> to end the stream.      │
├──────────────────────────┼──────────────────────────────────┤
│<A HREF="2842_L2_MMIOM_DELETE.html">MMIOM_DELETE</A>              │Requests that information be      │
│                          │removed from a file.              │
├──────────────────────────┼──────────────────────────────────┤
│<A HREF="2850_L2_MMIOM_ENDINSERT.html">MMIOM_ENDINSERT</A>           │Requests that all subsequent      │
│                          │Writes overwrite data at the      │
│                          │current seek position.            │
├──────────────────────────┼──────────────────────────────────┤
│<A HREF="2858_L2_MMIOM_ENDRECORD.html">MMIOM_ENDRECORD</A>           │Indicates that the logical record │
│                          │operation has ended and data      │
│                          │structures should be updated, if  │
│                          │necessary.                        │
├──────────────────────────┼──────────────────────────────────┤
│<A HREF="2874_L2_MMIOM_GETCF.html">MMIOM_GETCF</A>               │Obtains the handle (<I>hmmcf</I>) of the │
│                          │RIFF compound file.               │
├──────────────────────────┼──────────────────────────────────┤
│<A HREF="2882_L2_MMIOM_GETCFENTRY.html">MMIOM_GETCFENTRY</A>          │Requests a CTOC entry for an      │
│                          │element of a RIFF compound file.  │
├──────────────────────────┼──────────────────────────────────┤
│<A HREF="2890_L2_MMIOM_GETFORMATINFO.html">MMIOM_GETFORMATINFO</A>       │Requests that the IOProc return an│
│                          │<A><!-- external link: 1D 3E 29 7D -->MMFORMATINFO</A> structure.           │
├──────────────────────────┼──────────────────────────────────┤
│<A HREF="2898_L2_MMIOM_GETFORMATNAME.html">MMIOM_GETFORMATNAME</A>       │Requests the format name for the  │
│                          │IOProc.                           │
├──────────────────────────┼──────────────────────────────────┤
│<A HREF="2906_L2_MMIOM_GETHEADER.html">MMIOM_GETHEADER</A>           │Requests that the IOProc return   │
│                          │media-specific information.       │
├──────────────────────────┼──────────────────────────────────┤
│<A HREF="2915_L2_MMIOM_IDENTIFYFILE.html">MMIOM_IDENTIFYFILE</A>        │Attempts to determine if any      │
│                          │IOProc can process a file.        │
├──────────────────────────┼──────────────────────────────────┤
│<A HREF="2924_L2_MMIOM_MULTITRACKREAD.html">MMIOM_MULTITRACKREAD</A>      │Requests that data be read from a │
│                          │movie file.                       │
├──────────────────────────┼──────────────────────────────────┤
│<A HREF="2932_L2_MMIOM_MULTITRACKWRIT.html">MMIOM_MULTITRACKWRITE</A>     │Requests that data be written to a│
│                          │movie file.                       │
├──────────────────────────┼──────────────────────────────────┤
│<A HREF="2940_L2_MMIOM_OPEN.html">MMIOM_OPEN</A>                │Requests that a file be opened or │
│                          │deleted.                          │
├──────────────────────────┼──────────────────────────────────┤
│<A HREF="2949_L2_MMIOM_PASTE.html">MMIOM_PASTE</A>               │Requests that data from the       │
│                          │clipboard be inserted into a file.│
├──────────────────────────┼──────────────────────────────────┤
│<A HREF="2958_L2_MMIOM_QUERYHEADERLEN.html">MMIOM_QUERYHEADERLENGTH</A>   │Requests that the IOProc return   │
│                          │the size the header.              │
├──────────────────────────┼──────────────────────────────────┤
│<A HREF="2967_L2_MMIOM_QUERYIMAGE.html">MMIOM_QUERYIMAGE</A>          │Requests that the IOProc return   │
│                          │the currently selected image index│
│                          │in the image file.                │
├──────────────────────────┼──────────────────────────────────┤
│<A HREF="2976_L2_MMIOM_QUERYIMAGECOUN.html">MMIOM_QUERYIMAGECOUNT</A>     │Requests that the IOProc return   │
│                          │the number of images stored in the│
│                          │image file.                       │
├──────────────────────────┼──────────────────────────────────┤
│<A HREF="2985_L2_MMIOM_READ.html">MMIOM_READ</A>                │Requests that bytes be read from  │
│                          │an open file.                     │
├──────────────────────────┼──────────────────────────────────┤
│<A HREF="2993_L2_MMIOM_REDO.html">MMIOM_REDO</A>                │Requests that the last logical    │
│                          │action which was undone be redone.│
├──────────────────────────┼──────────────────────────────────┤
│<A HREF="3001_L2_MMIOM_SAVE.html">MMIOM_SAVE</A>                │Requests temporary changes in a   │
│                          │file.                             │
├──────────────────────────┼──────────────────────────────────┤
│<A HREF="3009_L2_MMIOM_SEEK.html">MMIOM_SEEK</A>                │Requests that the current file    │
│                          │position be moved.                │
├──────────────────────────┼──────────────────────────────────┤
│<A HREF="3017_L2_MMIOM_SEEKBYTIME.html">MMIOM_SEEKBYTIME</A>          │Requests that the file position be│
│                          │moved relative to some unit of    │
│                          │time.                             │
├──────────────────────────┼──────────────────────────────────┤
│<A HREF="3026_L2_MMIOM_SET.html">MMIOM_SET</A>                 │Requests that extended file       │
│                          │information be set or queried.    │
├──────────────────────────┼──────────────────────────────────┤
│<A HREF="3034_L2_MMIOM_SETHEADER.html">MMIOM_SETHEADER</A>           │Requests that the IOProc use      │
│                          │media-specific information when   │
│                          │writing or accepting data.        │
├──────────────────────────┼──────────────────────────────────┤
│<A HREF="3043_L2_MMIOM_SETIMAGE.html">MMIOM_SETIMAGE</A>            │Selects a new image index in the  │
│                          │image file.                       │
├──────────────────────────┼──────────────────────────────────┤
│<A HREF="3052_L2_MMIOM_STATUS.html">MMIOM_STATUS</A>              │Used to pass <!-- entering slot 2772 -->appropriate          │
│                          │<A><!-- external link: 1D 55 27 2B -->MCI_STATUS</A> requests to an IOProc. │
├──────────────────────────┼──────────────────────────────────┤
│<A HREF="3061_L2_MMIOM_TEMPCHANGE.html">MMIOM_TEMPCHANGE</A>          │Requests that all subsequent      │
│                          │Writes to the media be treated as │
│                          │temporary changes.                │
├──────────────────────────┼──────────────────────────────────┤
│<A HREF="3069_L2_MMIOM_UNDO.html">MMIOM_UNDO</A>                │Requests that the last logical    │
│                          │action, either a delete, insert,  │
│                          │undo, or redo, be undone.         │
├──────────────────────────┼──────────────────────────────────┤
│<A HREF="3077_L2_MMIOM_WINMSG.html">MMIOM_WINMSG</A>              │Allows an application or an MCD to│
│                          │pass PM messages from a window    │
│                          │procedure to an IOProc.           │
├──────────────────────────┼──────────────────────────────────┤
│<A HREF="3085_L2_MMIOM_WRITE.html">MMIOM_WRITE</A>               │Requests that the bytes be written│
│                          │to an open file.                  │
└──────────────────────────┴──────────────────────────────────┘
</PRE>

<P>
The MMIO messages indicate, to the I/O procedure, the type of MMIO operation
to be performed.  I/O procedures can be called to process files that might
or might not use the RIFF format standard.
<P>
<B>Note: </B> The compound-file messages must not be used while creating
or appending to the compound file itself.<!-- lm: 0x2 1 -->
<UL>
<P>


<P><HR>

<A HREF="2764_L2H_mmioWriteTopics.html">[Back: mmioWrite - Topics]</A> <BR>
<A HREF="2766_L2_MMIOM_BEGININSERT.html">[Next: MMIOM_BEGININSERT]</A> 
</BODY>
</HTML>
