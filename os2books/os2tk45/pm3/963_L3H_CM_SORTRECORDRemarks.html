<HTML XPOS=30% YPOS=TOP WIDTH=70% HEIGHT=100%HIDDEN>
<HEAD>
<!-- extra bytes: 03 00 14 1E 00 04 00 11 46 00 64 00 --><TITLE>CM_SORTRECORD - Remarks</TITLE>
</HEAD>
<BODY>
<H1>CM_SORTRECORD - Remarks</H1><!-- entering slot 965 -->
<P>
The<I> pfnCompare</I> parameter must be declared as:
<PRE>SHORT EXPENTRY <I>pfnCompare</I>(
      PRECORDCORE <B>p1</B>,
      PRECORDCORE <B>p2</B>,
      PVOID <I>pStorage</I>);
</PRE>

<P>
<B>Note: </B> If the CCS_MINIRECORDCORE style bit is specified when a container
is created, then<A><!-- external link: 1D 29 C8 46 --> MINIRECORDCORE</A> should
be used instead of<A><!-- external link: 1D 65 C8 64 --> RECORDCORE</A> and
PMINIRECORDCORE should be used instead of PRECORDCORE in all applicable
data structures and messages.<!-- lm: 0x2 1 -->
<UL>
<P>
The<I> pfnCompare</I> parameter points to an application-provided function
that compares two<A><!-- external link: 1D 65 C8 64 --> RECORDCORE</A> structures
and returns a<A><!-- external link: 1D 6F C8 6F --> SHORT</A> value that
specifies their relationship. The<I> pfnCompare</I> parameter is called
one or more times during the sorting process and is passed pointers to two
<A><!-- external link: 1D 65 C8 64 -->RECORDCORE</A> structures on each
call. The routine must compare the<A><!-- external link: 1D 65 C8 64 --> RECORDCORE
</A>structures, and then return one of the following values:<!-- lm: 0x2 1 -->
<P>
Value<!-- lm: 0x2 11 -->
<UL> Meaning        <!-- lm: 0x2 1 -->
</UL>&gt;0<!-- lm: 0x2 11 -->
<UL><I> p1</I> is less than<I> p2</I>.<!-- lm: 0x2 1 -->
</UL>0<!-- lm: 0x2 11 -->
<UL><I> p1</I> is equal to<I> p2</I>.<!-- lm: 0x2 1 -->
</UL>&lt;0<!-- lm: 0x2 11 -->
<UL><I> p1</I> is greater than<I> p2</I>.
<!-- lm: 0x2 1 -->
</UL>
<P>
The container records are sorted in increasing order, as defined by the
<I>pfnCompare</I> parameter. The records can be sorted in reverse order
by reversing the sense of "greater than" and "less than" in the<I> pfnCompare
</I>parameter.
<P>
If the container has only one record, the PMERR_COMPARISON_FAILED error
is set.
<P>
The application must provide an NLS-enabled function for the<I> pfnCompare
</I>parameter. The container control does not provide NLS enablement for
sorting.
<P>
An alternative to using the CM_SORTRECORD message is to provide an application-defined
comparison function to sort the container records, which can be specified
in the<A><!-- external link: 1D D5 C7 20 --> CNRINFO</A> structure's<I> pSortRecord
</I>field. If this function is provided, the container records are sorted
as they are inserted into the container control. If this field is NULL,
the records are not sorted on insertion.

<P><HR>

<A HREF="962_L3H_CM_SORTRECORDSyntax.html">[Back: CM_SORTRECORD - Syntax]</A> <BR>
<A HREF="964_L3H_CM_SORTRECORDDefault.html">[Next: CM_SORTRECORD - Default Processing]</A> 
</BODY>
</HTML>
