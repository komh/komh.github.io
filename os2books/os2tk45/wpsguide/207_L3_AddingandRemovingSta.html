<HTML>
<HEAD>
<TITLE>Adding and Removing Standard Pop-Up Menu Items</TITLE>
</HEAD>
<BODY>
<H1>Adding and Removing Standard Pop-Up Menu Items</H1><!-- entering slot 222 -->
<P>
The pop-up menu of a Workplace Shell object consists of a subset of the
standard pop-up menu items and any new menu items defined for the object's
class or inherited from other ancestors. The WPObject class defines a set
of standard pop-up menu items that are inherited by all Workplace Shell
objects. The WPDesktop, WPFolder, WPPalette, and WPProgram Workplace Shell
classes define standard pop-up menu items for their descendants. Each standard
pop-up menu item is associated with a flag, as shown in the following table:

<PRE>旼컴컴컴컴컴컴컴컴컴컫컴컴컴컴컴컴컴컴컴컴쩡컴컴컴컴컴컴컴컴컴커
쿎lass               쿔tem Flag           쿏escription         
쳐컴컴컴컴컴컴컴컴컴컵컴컴컴컴컴컴컴컴컴컴탠컴컴컴컴컴컴컴컴컴캑
쿥PDesktop           쿎TXT_LOCKUP         쿚pen Lockup now     
쳐컴컴컴컴컴컴컴컴컴컵컴컴컴컴컴컴컴컴컴컴탠컴컴컴컴컴컴컴컴컴캑
쿎TXT_SHUTDOWN       쿚pen Shut down                          
쳐컴컴컴컴컴컴컴컴컴컵컴컴컴컴컴컴컴컴컴컴탠컴컴컴컴컴컴컴컴컴캑
쿥PFolder            쿎TXT_ARRANGE        쿚pen Arrange        
쳐컴컴컴컴컴컴컴컴컴컵컴컴컴컴컴컴컴컴컴컴탠컴컴컴컴컴컴컴컴컴캑
쿎TXT_DETAILS        쿚pen Details view                       
쳐컴컴컴컴컴컴컴컴컴컵컴컴컴컴컴컴컴컴컴컴탠컴컴컴컴컴컴컴컴컴캑
쿎TXT_FIND           쿚pen Find dialog                        
쳐컴컴컴컴컴컴컴컴컴컵컴컴컴컴컴컴컴컴컴컴탠컴컴컴컴컴컴컴컴컴캑
쿎TXT_ICON           쿚pen Icon view                          
쳐컴컴컴컴컴컴컴컴컴컵컴컴컴컴컴컴컴컴컴컴탠컴컴컴컴컴컴컴컴컴캑
쿎TXT_SELECT         쿚pen Select                             
쳐컴컴컴컴컴컴컴컴컴컵컴컴컴컴컴컴컴컴컴컴탠컴컴컴컴컴컴컴컴컴캑
쿎TXT_SORT           쿚pen Sort dialog                        
쳐컴컴컴컴컴컴컴컴컴컵컴컴컴컴컴컴컴컴컴컴탠컴컴컴컴컴컴컴컴컴캑
쿎TXT_TREE           쿚pen Tree view                          
쳐컴컴컴컴컴컴컴컴컴컵컴컴컴컴컴컴컴컴컴컴탠컴컴컴컴컴컴컴컴컴캑
쿥PObject            쿎TXT_ARRANGE        쿚pen Arrange        
쳐컴컴컴컴컴컴컴컴컴컵컴컴컴컴컴컴컴컴컴컴탠컴컴컴컴컴컴컴컴컴캑
쿎TXT_CLOSE          쿎lose                                   
쳐컴컴컴컴컴컴컴컴컴컵컴컴컴컴컴컴컴컴컴컴탠컴컴컴컴컴컴컴컴컴캑
쿎TXT_COPY           쿎opy                                    
쳐컴컴컴컴컴컴컴컴컴컵컴컴컴컴컴컴컴컴컴컴탠컴컴컴컴컴컴컴컴컴캑
쿎TXT_CRANOTHER      쿎reate another                          
쳐컴컴컴컴컴컴컴컴컴컵컴컴컴컴컴컴컴컴컴컴탠컴컴컴컴컴컴컴컴컴캑
쿎TXT_DELETE         쿏elete                                  
쳐컴컴컴컴컴컴컴컴컴컵컴컴컴컴컴컴컴컴컴컴탠컴컴컴컴컴컴컴컴컴캑
쿎TXT_DETAILS        쿚pen Details view                       
쳐컴컴컴컴컴컴컴컴컴컵컴컴컴컴컴컴컴컴컴컴탠컴컴컴컴컴컴컴컴컴캑
쿎TXT_HELP           쿓elp                                    
쳐컴컴컴컴컴컴컴컴컴컵컴컴컴컴컴컴컴컴컴컴탠컴컴컴컴컴컴컴컴컴캑
쿎TXT_ICON           쿚pen Icon view                          
쳐컴컴컴컴컴컴컴컴컴컵컴컴컴컴컴컴컴컴컴컴탠컴컴컴컴컴컴컴컴컴캑
쿎TXT_LINK           쿎reate shadow                           
쳐컴컴컴컴컴컴컴컴컴컵컴컴컴컴컴컴컴컴컴컴탠컴컴컴컴컴컴컴컴컴캑
쿎TXT_LOCKUP         쿚pen Lockup dialog                      
쳐컴컴컴컴컴컴컴컴컴컵컴컴컴컴컴컴컴컴컴컴탠컴컴컴컴컴컴컴컴컴캑
쿎TXT_MOVE           쿘ove                                    
쳐컴컴컴컴컴컴컴컴컴컵컴컴컴컴컴컴컴컴컴컴탠컴컴컴컴컴컴컴컴컴캑
쿎TXT_NEW            쿎reate another                          
쳐컴컴컴컴컴컴컴컴컴컵컴컴컴컴컴컴컴컴컴컴탠컴컴컴컴컴컴컴컴컴캑
쿎TXT_OPEN           쿚pen                                    
쳐컴컴컴컴컴컴컴컴컴컵컴컴컴컴컴컴컴컴컴컴탠컴컴컴컴컴컴컴컴컴캑
쿎TXT_PALETTE        쿚pen Palette                            
쳐컴컴컴컴컴컴컴컴컴컵컴컴컴컴컴컴컴컴컴컴탠컴컴컴컴컴컴컴컴컴캑
쿎TXT_PICKUP         쿛ick up an object                       
쳐컴컴컴컴컴컴컴컴컴컵컴컴컴컴컴컴컴컴컴컴탠컴컴컴컴컴컴컴컴컴캑
쿎TXT_PRINT          쿛rint                                   
쳐컴컴컴컴컴컴컴컴컴컵컴컴컴컴컴컴컴컴컴컴탠컴컴컴컴컴컴컴컴컴캑
쿎TXT_PROGRAM        쿚pen program                            
쳐컴컴컴컴컴컴컴컴컴컵컴컴컴컴컴컴컴컴컴컴탠컴컴컴컴컴컴컴컴컴캑
쿎TXT_PUTDOWN        쿛ut an object down                      
쳐컴컴컴컴컴컴컴컴컴컵컴컴컴컴컴컴컴컴컴컴탠컴컴컴컴컴컴컴컴컴캑
쿎TXT_REFRESH        쿝efresh                                 
쳐컴컴컴컴컴컴컴컴컴컵컴컴컴컴컴컴컴컴컴컴탠컴컴컴컴컴컴컴컴컴캑
쿎TXT_SELECT         쿚pen Select                             
쳐컴컴컴컴컴컴컴컴컴컵컴컴컴컴컴컴컴컴컴컴탠컴컴컴컴컴컴컴컴컴캑
쿎TXT_SETTINGS       쿚pen Settings                           
                    쿻otebook                                
쳐컴컴컴컴컴컴컴컴컴컵컴컴컴컴컴컴컴컴컴컴탠컴컴컴컴컴컴컴컴컴캑
쿎TXT_SHADOW         쿎reate shadow                           
쳐컴컴컴컴컴컴컴컴컴컵컴컴컴컴컴컴컴컴컴컴탠컴컴컴컴컴컴컴컴컴캑
쿎TXT_SHUTDOWN       쿚pen Shut down                          
쳐컴컴컴컴컴컴컴컴컴컵컴컴컴컴컴컴컴컴컴컴탠컴컴컴컴컴컴컴컴컴캑
쿎TXT_SORT           쿚pen Sort dialog                        
쳐컴컴컴컴컴컴컴컴컴컵컴컴컴컴컴컴컴컴컴컴탠컴컴컴컴컴컴컴컴컴캑
쿎TXT_SWITCHTO       쿞witch to                               
쳐컴컴컴컴컴컴컴컴컴컵컴컴컴컴컴컴컴컴컴컴탠컴컴컴컴컴컴컴컴컴캑
쿎TXT_TREE           쿚pen Tree view                          
쳐컴컴컴컴컴컴컴컴컴컵컴컴컴컴컴컴컴컴컴컴탠컴컴컴컴컴컴컴컴컴캑
쿎TXT_WINDOW         쿥indow                                  
쳐컴컴컴컴컴컴컴컴컴컵컴컴컴컴컴컴컴컴컴컴탠컴컴컴컴컴컴컴컴컴캑
쿥PPalette           쿎TXT_PALETTE        쿚pen palette        
쳐컴컴컴컴컴컴컴컴컴컵컴컴컴컴컴컴컴컴컴컴탠컴컴컴컴컴컴컴컴컴캑
쿥PProgram           쿎TXT_PROGRAM        쿚pen program        
읕컴컴컴컴컴컴컴컴컴컨컴컴컴컴컴컴컴컴컴컴좔컴컴컴컴컴컴컴컴컴켸
</PRE>

<P>
Workplace Shell classes can add or delete standard pop-up menu items from
their pop-up menu by overriding wpFilterPopupMenu. The wpFilterPopupMenu
method returns the flags that represent the standard pop-up menu items for
the object. By removing a standard menu item from the pop-up menu, the override
to wpFilterPopupMenu masks the flag that corresponds to the item being removed
from the flags that represent the standard pop-up menu items inherited from
the object's parent. For example, suppose that printing MyObject has no
meaning. To remove the<B> Print</B> option from MyObject's pop-up menu,
wpFilterPopupMenu is overridden as shown in the following figure:
<PRE>/************************* Method Overrides ****************************/

/* Filters out any options from the pop-up menu that don't apply */
SOM_Scope ULONG SOMLINK MyObject_wpFilterPopupMenu
   (MyObject *somSelf,ULONG ulFlags, HWND hwndCnr, BOOL32 fMultiSelect)

{
  MyObjectData *somThis = MyObjectGetData(somSelf);
  MyObjectMethodDebug("MyObject","MyObject_wpFilterPopupMenu");

  /* Don't allow anyone to print MyObject  */
  return(parent_wpFilterPopupMenu(somSelf,ulFlags,hwndCnr,fMultiSelect)
                                  &amp; ~CTXT_PRINT);
}

</PRE>

<P>
The flags that represent the standard pop-up menu items of MyObject's parent
class are returned from the call to parent_wpFilterPopupMenu. To remove
the<B> Print</B> option from MyObject's pop-up menu, these flags are joined
to the complement of CTXT_PRINT using the AND logical operand. Conversely,
if the pop-up menu of MyObject's parent class did not include the<B> Print
</B>option, the<B> Print</B> option can be added to MyObject's pop-up menu
by joining these flags to CTXT_PRINT using the OR logical operand.
<P>
<B>Note: </B> An object's pop-up menu is inherited from its ancestors. To
ensure that calls to wpFilterPopupMenu belonging to the object's ancestors
do not add the menu item after it is deleted, or remove the menu item after
it is added, the parent_wpFilterPopupMenu is called<!-- entering slot 223 --> first.
<!-- lm: 0x2 1 -->
<UL>
<P>


<P><HR>

<A HREF="206_L2_UsingPopUpMenuMethod.html">[Back: Using Pop-Up Menu Methods]</A> <BR>
<A HREF="208_L3_AddingandRemovingCla.html">[Next: Adding and Removing Class Items to a Pop-Up Menu]</A> 
</BODY>
</HTML>
