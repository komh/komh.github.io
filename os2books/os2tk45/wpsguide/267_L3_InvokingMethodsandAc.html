<HTML>
<HEAD>
<META HTTP-EQUIV="CONTENT-TYPE" CONTENT="TEXT/HTML; CHARSET=UTF-8">
<TITLE>Invoking Methods and Accessing Object Data</TITLE>
</HEAD>
<BODY>
<H1>Invoking Methods and Accessing Object Data</H1><!-- entering slot 286 -->
<P>
The basic rules for invoking methods and accessing object data can be summarized
as follows:<!-- lm: 0x2 3 -->
<UL>
<P>
<LI><!-- lm: 0x2 6 -->Object data can be referred to by preceding the name
of the data element with an underscore ( _ ) character. This is valid only
in a method of the class, and then only for the object being operated on.
<!-- lm: 0x2 3 -->
<P>
<LI><!-- lm: 0x2 6 -->Methods can be invoked by preceding the method name
with an underscore character. Method parameters always include a pointer
to the object being operated on. Invocation of instance methods requires
a pointer to an instance object. Invocation of class methods requires a
pointer to a class object.<!-- lm: 0x2 1 -->
</UL>
<P>
These rules can be illustrated by introducing three new methods for the
Dog class that relate to more dog characteristics and getting and setting
behaviors. Because dogs can be characterized by their breed, a user should
be able to get and set the breed for a dog. It also would be desirable to
display the characteristics of a dog. In the following sample code, the
action of getting and setting a dog's breed corresponds to the prototype
for the getBreed and setBreed methods in the DOG.IDL file.
<PRE>/* *   A class defining a set of objects (dogs)
 */

#ifndef dog4_idl
#define dog4_idl

#include &lt;somobj.idl&gt;

interface Dog : SOMObject
{
  attribute string breed;

  // The breed for the dog

  void display();

  // Display the characteristics for this dog.
  // Show the breed and make the dog speak.

  void bark();

  // Have the dog bark
  #ifdef __SOMIDL__
  implementation

  {
    releaseorder:  _get_breed, _set_breed, display, bark;

    //# Class modifiers

    callstyle = oidl;    // For compatibility with SOM1
    majorversion = 1;
    minorversion = 2;
  };
  #endif /* __SOMIDL__ */
};
#endif  /* dog4_idl */

</PRE>

<P>
The action of displaying a dog's characteristics corresponds to the prototype
for the display method. This example also introduces the use of an attribute.
Each dog has its own copy of the attribute associated with it. The breed
of a dog is stored in a string called "breed". By default, SOM provides
a  _get_breed method to return the contents of the breed and a  _set_breed
method to set the contents of breed. If no set method was used, breed should
be defined as "readonly attribute" string breed.
<P>
From the new DOG.IDL file, the SOM compiler generates a new C-language source-program
template, as shown in the following sample code. This template is used to
complete the implementation of the new Dog class.
<PRE>/*
 *  This file was generated by the SOM compiler and Emitter Framework.
 *  Generated using:  SOM Emitter emitctm: 2.38
 */

#ifndef SOM_Module_dog_Source
#define SOM_Module_dog_Source
#endif

#define Dog_Class_Source

#include "dog.ih"
#include &lt;stdio.h&gt;   /* Needed because of printf */

/*
 * Display the characteristics for this dog.
 * Show the breed and make the dog speak.
 */

SOM_Scope void  SOMLINK display(Dog *somSelf)
{
  DogData *somThis = DogGetData(somSelf);
  DogMethodDebug("Dog","display");

  /* Note that there are two underscores before */
  /* the get_breed method                    */
  printf("\nMy breed is %s.\n", __get_breed(somSelf));
  printf("I say:\n");

  /* Prefix method name with either an underscore */
  /* ( _ ) or somThis                  */
  _bark(somSelf);
}

/*
 * Have the dog bark
 */

SOM_Scope void  SOMLINK bark(Dog *somSelf)
{
  DogData *somThis = DogGetData(somSelf);
  DogMethodDebug("Dog","bark");

  printf("Unknown dog noise\n");   /* Speak! */
}

</PRE>

<P>
The first thing that is noticeable in this sample code is that the attribute
declarations are not present. They have been placed in the class-implementation
file (DOG.IH) by the SOM compiler. As before, DOG.IH contains all the definitions
of the Dog class data,<!-- entering slot 287 --> macros, and functions.

<P>
The _set_breed and _get_breed methods, also in the DOG.IH file, operate
on the string "breed" and refer to it by prefixing the string name with
<I>somThis</I>.
<P>
The display method requires the dog's characteristics, that is, its breed
and its bark, to be displayed. To do this, the display method calls both
the _get_breed and bark methods, which are referenced by prefixing the method
name with the underscore ( _ ) character.
<P>
Finally, as in the previous implementation of the Dog class, the Include
file, STDIO.H, is added to the source program to resolve the reference to
the C-library routine, printf, which is used to display the dog's characteristics.
The SOM function, somPrintf, can be used in place of printf; no additional
Include file is required in this case. In fact, it is recommended that SOM
class implementations use the SOM functions, where appropriate, instead
of the C-library functions. SOM functions offer flexibility and replaceability.


<P><HR>

<A HREF="266_L3_ReplacingSOMFunction.html">[Back: Replacing SOM Functions]</A> <BR>
<A HREF="268_L3_CreatingandManipulat.html">[Next: Creating and Manipulating SOM Objects]</A> 
</BODY>
</HTML>
