<HTML>
<HEAD>
<META HTTP-EQUIV="CONTENT-TYPE" CONTENT="TEXT/HTML; CHARSET=UTF-8">
<TITLE>Removing Items from the Object's In-Use List</TITLE>
</HEAD>
<BODY>
<H1>Removing Items from the Object's In-Use List</H1><!-- entering slot 214 -->
<P>
When wpCnrInsertObject puts an object into a container window, its adds
a USAGE_RECORD item to the object's in-use list. Conversely, when wpCnrRemoveObject
is called, the USAGE_RECORD item is deleted from the object's in-use list
and the object is removed from the container. The following figure shows
the syntax of the RECORDITEM data structure:
<PRE>typedef struct _RECORDITEM
{
  HWND   hwndCnr;            /* Container into which object      */
                             /* is being inserted                */
  PMINIRECORDCORE pRecord;   /* Record pointer within container  */
  ULONG  ulUser;             /* For application use              */
}RECORDITEM;

</PRE>

<P>
Likewise, when wpFreeMem is called to free memory, it calls wpDeleteFromObjUseList
to delete a USAGE_MEMORY item from the object's in-use list.
<P>
When views are closed by the object's wpClose, wpDeleteFromObjUseList removes
the applicable USAGE_OPENVIEW item from the object's in-use list. The wpCnrDeleteUseItem
method deletes the USAGE_RECORD use-item for the specified container, but
does not remove the object from the container. Use wpCnrRemoveObject to
delete the USAGE_RECORD use-item and also to remove the object from the
container.

<P><HR>

<A HREF="198_L3_AddingItemstotheObje.html">[Back: Adding Items to the Object's In-Use List]</A> <BR>
<A HREF="200_L3_IncreasingorDecreasi.html">[Next: Increasing or Decreasing the Object's Lock Count]</A> 
</BODY>
</HTML>
