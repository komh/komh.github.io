<HTML>
<HEAD>
<TITLE>DosQueryModFromEIP</TITLE>
</HEAD>
<BODY>
<H1>DosQueryModFromEIP</H1><!-- entering slot 9 --><!-- lm: 0x2 1 -->
<UL>Prototype:
<P>
<!-- lm: 0x2 6 -->
<UL> APIRET APIENTRY DosQueryModFromEIP ( HMODULE *phMod,
ULONG *pObjNum, ULONG BuffLen, PCHAR pBuff, ULONG *pOffset, PVOID Address
) ;<!-- lm: 0x2 1 -->
</UL> Linkage Definition:
<P>
<!-- lm: 0x2 6 -->
<UL> IMPORTS DOSQUERYMODFROMEIP = DOSCALL1.360<!-- lm: 0x2 1 -->
</UL> Parameters:
<!-- lm: 0x2 6 -->
<UL><!-- lm: 0x2 11 -->
<UL>
<P>
HMODULE *phMod  The address into which to store the address's module handle.
<!-- lm: 0x2 11 -->
<BR>
ULONG *pObjNum  The address into which to store the module's object/segment
number.<!-- lm: 0x2 11 -->
<BR>
ULONG BuffLen  The size of the buffer into which the module name will be
stored.<!-- lm: 0x2 11 -->
<BR>
PCHAR pBuff   The address of the buffer into which the module name will
be stored.<!-- lm: 0x2 11 -->
<BR>
ULONG *pOffset  The address into which the offset into the module segment
will be stored.<!-- lm: 0x2 11 -->
<BR>
PVOID Address  The address to be analyzed.<!-- lm: 0x2 6 -->
</UL><!-- lm: 0x2 1 -->
</UL>Comments:
<P>
 This function may be used to get a program module name, segment number
and offset within the segment if you have an absolute address within the
calling program.  This can be useful when trying to build an exception handler
for debugging.
<P>
 Example:
<P>
 In this code fragment,<B> pContextRecord</B> is one of the parameters passed
to an OS/2 exception handler.<!-- lm: 0x2 6 -->
<UL>
<P>
HMODULE hModule ( 0 ) ; ULONG ObjectNumber ( 0 ), Offset ( 0 ) ;
<BR>
char ModuleName [ CCHMAXPATH + 1 ] = { 0 } ;
<BR>
DosQueryModFromEIP ( &amp;hModule, &amp;ObjectNumber, sizeof(ModuleName),
ModuleName,
<BR>
  &amp;Offset, (PVOID)pContextRecord-&gt;ctx_RegEip ) ;
<BR>
printf ( "Exception occurred in module '%s', segment %i, offset %08X.\n",

<BR>
  ModuleName, ObjectNumber, Offset ) ;<!-- lm: 0x2 1 --> 

<P><HR>

<A HREF="006_L1_DosQueryMemState.html">[Back: DosQueryMemState]</A> <BR>
<A HREF="008_L1_DosQuerySysState.html">[Next: DosQuerySysState]</A> 
</BODY>
</HTML>
