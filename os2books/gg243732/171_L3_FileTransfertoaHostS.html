<HTML>
<HEAD>
<TITLE>File Transfer to a Host Session</TITLE>
</HEAD>
<BODY>
<H1>File Transfer to a Host Session</H1><!-- entering slot 182 -->
<P>
The following procedure is useful for uploading files from the PS/2 to a
host system. Both methods hide file transfer programs from the user and
thus helps him maintain a consistent way of working with the WPS.
<P>
Two alternative approaches are used; the first creates an icon onto which
the user can drop the file to be transferred, the second simply adds a file
transfer command to the pop-up menu.
<P>
<B>File Transfer Icon</B><!-- lm: 0x2 0 -->
<P>
 <LI><LI><!-- lm: 0x2 4 -->Create a folder to hold the files that are to
be uploaded<!-- lm: 0x2 0 -->
<P>
 <LI><LI><!-- lm: 0x2 4 -->Copy the CMD file in <A HREF="037_L2_REXXProcedureforHost.html">Figure
"REXX Procedure for Host Upload"</A> into that folder<!-- lm: 0x2 0 -->
<P>
 <LI><LI><!-- lm: 0x2 4 -->Create a program reference by pulling a program
template into your folder<!-- lm: 0x2 0 -->
<P>
 <LI><LI><!-- lm: 0x2 4 -->Open a<I> Settings</I>view for the program reference
<!-- lm: 0x2 0 -->
<P>
 <LI><LI><!-- lm: 0x2 4 -->Put your CMD file path and filename in the Physical
Name field<!-- lm: 0x2 0 -->
<P>
 <LI><LI><!-- lm: 0x2 4 -->Put  %*  in the Parameters field<!-- lm: 0x2 0 -->
<P>
 <LI><LI><!-- lm: 0x2 4 -->Close the<I> Settings</I> view.<!-- lm: 0x2 0 -->
<BR>

<P>
The following REXX procedure is called when an object is dropped on the
program reference icon that was created above. The name of the object is
passed to the procedure which then eliminates the path information from
the object. A target file type is set up and an appropriate send option
(ASCII or binary) is determined.  Then the Communications Manager SEND command
is used to transfer the file.
<P>
This REXX procedure does not take care of all possible problems.  For instance,
if the folder is on the desktop, a filename is created with the desktop
folder name.  As that name contains blanks, it needs to be enclosed in quotes,
which is not done here.  Therefore the upload folder needs to be in some
other folder.  However, the procedure shows how a simple REXX procedure
can help create an object-oriented environment for a user.
<P>
<B>File Transfer from a Pop-up Menu</B>
<P>
For an alternative to the file upload icon, you can:<!-- lm: 0x2 0 -->
<P>
 <LI><LI><!-- lm: 0x2 4 -->Create a folder to hold program references<!-- lm: 0x2 0 -->
<P>
 <LI><LI><!-- lm: 0x2 4 -->Peel a program icon off the program template
in Templates and drag it to this new folder<!-- lm: 0x2 0 -->
<P>
 <LI><LI><!-- lm: 0x2 4 -->Enter the path and filename of your file upload
utility<!-- lm: 0x2 0 -->
<P>
 <LI><LI><!-- lm: 0x2 4 -->Enter the following for parameters: %* h[Enter
host session letter (a,b,c,d)&gt;]:<!-- lm: 0x2 0 -->
<P>
 <LI><LI><!-- lm: 0x2 4 -->Set the working directory to the path where your
file upload utility resides<!-- lm: 0x2 0 -->
<P>
 <LI><LI><!-- lm: 0x2 4 -->Click on the General tab and change the name
to "Upload to Host"<!-- lm: 0x2 0 -->
<P>
 <LI><LI><!-- lm: 0x2 4 -->Click on Associations and type an asterisk in
the Names field, then click on the "Add" push button<!-- lm: 0x2 0 -->
<P>
 <LI><LI><!-- lm: 0x2 4 -->Close the Settings window.<!-- lm: 0x2 0 -->
<BR>

<P>
Now, when you click on any file in your system with the right mouse button,
you can click on the arrow to the right of "Open" and you will be offered
"Upload to Host" as one of the programs that may be executed against it.


<P><HR>

<A HREF="170_L3_PreventProgramsResta.html">[Back: Prevent Programs Restarting at IPL]</A> <BR>
<A HREF="172_L3_LimitingaUsersAccess.html">[Next: Limiting a User's Access to Settings]</A> 
</BODY>
</HTML>
