<HTML>
<HEAD>
<META HTTP-EQUIV="CONTENT-TYPE" CONTENT="TEXT/HTML; CHARSET=UTF-8">
<TITLE>Associating an Object with a Program</TITLE>
<STYLE>
PRE {
  FONT-FAMILY: Consolas, "Lucida Console", "Courier New", Courier, MONOSPACE;
}
</STYLE>
</HEAD>
<BODY>
<H1>Associating an Object with a Program</H1><!-- entering slot 150 -->
<P>
There are three ways to set up a data file object so that a program is started
when the user double clicks on the data file icon.  These are:<!-- lm: 0x2 0 -->
<P>
 <LI><LI><!-- lm: 0x2 4 -->Create a<I> Filename</I> association in the program
settings<!-- lm: 0x2 0 -->
<BR>
 <LI><LI><!-- lm: 0x2 4 -->Create a<I> Type</I> association in the data
file settings<!-- lm: 0x2 0 -->
<BR>
 <LI><LI><!-- lm: 0x2 4 -->Make the program name the default setting in
the "Open" cascade menu for the data file.<!-- lm: 0x2 0 -->
<BR>

<P>
An association is a special link which can be assigned to a program object.
 This link allows the user to specify which program will be invoked when
the user double clicks on specified types of files, individual files, or
files described by a global file name.
<P>
<B>Filename Association in a Program</B>
<P>
The major disadvantages of this approach are that it provides little flexibility
to the user and it is not very robust. Any association is easily destroyed
by changing the file extension and it is therefore only recommended for
programs which do not support associations by "Type".
<P>
The inflexibility of this method can be seen when a user subsequently wants
to use a different program with his data file. To do this, he will have
to either change the filename or add a new program to the "Open" menu and
make it the default. Neither approach is suitable for the inexperienced
user.
<P>
A text editor may, for example, have associations for plain text files (that
is, a type of file), the individual file CONFIG.SYS, and all files described
with the global name READ*.*.  Whenever a file object that meets these criteria
is selected with a double click, OS/2 will start the appropriate program
object. The workings of the association mechanism are described in <A HREF="197_L1_WorkplaceShellImplem.html">Workplace
Shell Implementation</A>.
<P>
There are some editing strings for filenames and extensions that can be
used with associations to allow parameters to be passed without having to
fully specify the qualified filename (or parts of it):<!-- lm: 0x2 0 -->
<P>
<B><LI><LI></B><!-- lm: 0x2 10 -->Fully qualified path<!-- lm: 0x2 0 -->
<P>
<B><LI><LI><LI>P</B><!-- lm: 0x2 10 -->
<UL> Path with last backslash<!-- lm: 0x2 0 -->
</UL><B> %%*D
</B><!-- lm: 0x2 10 -->
<UL>Drive with  : or UNC name<!-- lm: 0x2 0 -->
</UL><B> %%*N
</B><!-- lm: 0x2 10 -->
<UL>Name without extension<!-- lm: 0x2 0 -->
</UL><B> %%*F
</B><!-- lm: 0x2 10 -->
<UL>Name with extension<!-- lm: 0x2 0 -->
</UL><B> %%*E
</B><!-- lm: 0x2 10 -->
<UL>Extension without period.<!-- lm: 0x2 0 -->
</UL>
<P>
<B>Type Association in a Data File</B>
<P>
This is the preferred approach. It is described in more detail in <A HREF="181_L1_PresentationManagera.html">Presentation
Manager and Workplace Shell Application Development</A> and <A HREF="197_L1_WorkplaceShellImplem.html">Workplace
Shell Implementation</A>. The advantage of this approach is that it is easy
for a user to use a different program with his object, simply by choosing
a new "Type" in the<I> Settings</I> view. The process is simple:<!-- lm: 0x2 0 -->
<P>
 <LI><LI><!-- lm: 0x2 4 -->Open the<I> Settings</I> view for the object
<!-- lm: 0x2 0 -->
<P>
 <LI><LI><!-- lm: 0x2 4 -->Select the "Type" page of the notebook<!-- lm: 0x2 0 -->
<P>
 <LI><LI><!-- lm: 0x2 4 -->Select from the list of "Available types"<!-- lm: 0x2 0 -->
<P>
 <LI><LI><!-- lm: 0x2 4 -->Press the "Add" button<!-- lm: 0x2 0 -->
<P>
 <LI><LI><!-- lm: 0x2 4 -->Close the<I> Settings</I> window.<!-- lm: 0x2 0 -->
<P>
Each program can be associated with a "Type" but, in practice, not all are.
DOS programs are very unlikely to support the concept of file type associations.
It will, therefore, probably be necessary to use the filename association
technique for such files.
<P>
If a program does not set a file type, the user can create a new one. This
is described in <A HREF="174_L3_AddingNewFileTypes.html">Adding New File
Types</A>.
<P>
<B>Add a Default Program to the File Menu</B>
<P>
The process to do this is described in <A HREF="139_L3_ModifyingtheContextM.html">Modifying
the Context Menu of an Object</A> and <A HREF="140_L3_ChangingtheDefaultVi.html">Changing
the Default View on "Open"</A>. This approach is limited to users who understand
the workings of the Workplace Shell in some detail. Its main disadvantage
is found when many existing files must be set up to use a particular program;
each one must be modified<!-- entering slot 151 --> separately. Under these
circumstances the filename association would be preferred.
<P>
If you are setting up a system for a new user, however, you can create one
data file with the program set as the default on "Open" in the context menu,
then make that file into a template so all new files subsequently created
from it will inherit this attribute.

<P><HR>

<A HREF="141_L3_ChangingtheIconforan.html">[Back: Changing the Icon for an Object]</A> <BR>
<A HREF="143_L2_GivingOS2V20theLooka.html">[Next: Giving OS/2 V2.0 the Look and Feel of OS/2 Version 1.3]</A> 
</BODY>
</HTML>
