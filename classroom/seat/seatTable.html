<html>

<head>

<meta http-equiv="Content-Type" content="text/html; charset=euc-kr" />

<title>자리배치표</title>

<script language="javascript">
<!--
function addEvent(obj, eventType, functionName) {
    if (obj.addEventListener) {
        obj.addEventListener(eventType, functionName, false);
    }
    else if (obj.attachEvent) {
        obj.attachEvent("on" + eventType, functionName);
    }
    else {
        obj["on" + eventType] = functionName; // same as "obj.onType = functionName"
    }
}

    addEvent( window, "load", function ()
{
    makeSeat();
}
            );
    
    addEvent( document, "keyup", function ( e )
{
    var keyCode = e.keyCode;

    if( keyCode == 27 )
        window.close();

    return true;     // do the default action
}
            );

function printList( seat )
{    
    var table = document.createElement("table");
    table.setAttribute("border", "1");
    table.setAttribute("align", "center");
    table.style.borderCollapse = "collapse";

    var tbody = document.createElement("tbody");
    var tr;
    var td;
    
    tr = document.createElement("tr");
    
    td = document.createElement("th");
    td.innerHTML = "좌석<br>번호";
    td.setAttribute("align", "center");
    tr.appendChild( td );

    td = document.createElement("th");
    td.innerHTML = "출석<br>번호";
    td.setAttribute("align", "center");
    tr.appendChild( td );

    tbody.appendChild( tr );

    table.appendChild( tbody );

    for( var i = 0; i < seat.length; i++ )
    {
        tr = document.createElement("tr");

        td = document.createElement("td");
        td.innerHTML = parseInt( i ) + 1;
        td.setAttribute("align", "center");
        tr.appendChild( td );

        td = document.createElement("td");
        td.innerHTML = seat[ i ];
        td.setAttribute("align", "center");
        tr.appendChild( td );

        tbody.appendChild( tr );
    }

    document.getElementById("seatTableDiv").appendChild( table );
}

function makeSeat()
{
    var firstNo = window.opener.document.seatForm.firstNo.value;
    var lastNo  = window.opener.document.seatForm.lastNo.value;
    var missingNumsStr = window.opener.document.seatForm.missingNums.value;
    var missingNums = missingNumsStr.split(" ");
    var count   = lastNo - firstNo + 1 - missingNums.length;
    var student = new Array();
    var seat    = new Array();
    var i;
  
    for( i = 0; i < count; )
    {
        var number = Math.floor( Math.random() * lastNo ) + 1;

        if( missingNums.indexOf( number.toString()) !== -1 )
            continue;

        if( student[ number - 1 ])
            continue;

        student[ number - 1 ] = true;
        seat[ i ]             = number;
        i++;
    }

    printList( seat );
}
-->
</script>

</head>

<body>

<div id="seatTableDiv">
</div>

</body>

</html>
